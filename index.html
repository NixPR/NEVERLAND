<!DOCTYPE html>
<html data-init="no-js">
<head>
<meta charset="UTF-8" />
<title>NEVERLAND</title>
<meta name="viewport" content="width=device-width,initial-scale=1" />
<meta name="application-name" content="SugarCube" />
<meta name="version" content="2.37.0" />
<!--

SugarCube (v2.37.0): A free (gratis and libre) story format.

Copyright © 2013–2021 Thomas Michael Edwards <thomasmedwards@gmail.com>.
All rights reserved.

Redistribution and use in source and binary forms, with or without
modification, are permitted provided that the following conditions are met:

1. Redistributions of source code must retain the above copyright notice, this
   list of conditions and the following disclaimer.
2. Redistributions in binary form must reproduce the above copyright notice,
   this list of conditions and the following disclaimer in the documentation
   and/or other materials provided with the distribution.

THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND
ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE FOR
ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES
(INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND
ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
(INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.

-->
<script id="script-libraries" type="text/javascript">
if(document.head&&document.addEventListener&&document.querySelector&&Object.create&&Object.freeze&&JSON){document.documentElement.setAttribute("data-init", "loading");
/*! @source http://purl.eligrey.com/github/classList.js/blob/1.2.20171210/classList.js */
"document"in self&&("classList"in document.createElement("_")&&(!document.createElementNS||"classList"in document.createElementNS("http://www.w3.org/2000/svg","g"))||!function(t){"use strict";if("Element"in t){var e="classList",n="prototype",i=t.Element[n],s=Object,r=String[n].trim||function(){return this.replace(/^\s+|\s+$/g,"")},o=Array[n].indexOf||function(t){for(var e=0,n=this.length;n>e;e++)if(e in this&&this[e]===t)return e;return-1},c=function(t,e){this.name=t,this.code=DOMException[t],this.message=e},a=function(t,e){if(""===e)throw new c("SYNTAX_ERR","The token must not be empty.");if(/\s/.test(e))throw new c("INVALID_CHARACTER_ERR","The token must not contain space characters.");return o.call(t,e)},l=function(t){for(var e=r.call(t.getAttribute("class")||""),n=e?e.split(/\s+/):[],i=0,s=n.length;s>i;i++)this.push(n[i]);this._updateClassName=function(){t.setAttribute("class",this.toString())}},u=l[n]=[],h=function(){return new l(this)};if(c[n]=Error[n],u.item=function(t){return this[t]||null},u.contains=function(t){return~a(this,t+"")},u.add=function(){var t,e=arguments,n=0,i=e.length,s=!1;do t=e[n]+"",~a(this,t)||(this.push(t),s=!0);while(++n<i);s&&this._updateClassName()},u.remove=function(){var t,e,n=arguments,i=0,s=n.length,r=!1;do for(t=n[i]+"",e=a(this,t);~e;)this.splice(e,1),r=!0,e=a(this,t);while(++i<s);r&&this._updateClassName()},u.toggle=function(t,e){var n=this.contains(t),i=n?e!==!0&&"remove":e!==!1&&"add";return i&&this[i](t),e===!0||e===!1?e:!n},u.replace=function(t,e){var n=a(t+"");~n&&(this.splice(n,1,e),this._updateClassName())},u.toString=function(){return this.join(" ")},s.defineProperty){var f={get:h,enumerable:!0,configurable:!0};try{s.defineProperty(i,e,f)}catch(p){void 0!==p.number&&-2146823252!==p.number||(f.enumerable=!1,s.defineProperty(i,e,f))}}else s[n].__defineGetter__&&i.__defineGetter__(e,h)}}(self),function(){"use strict";var t=document.createElement("_");if(t.classList.add("c1","c2"),!t.classList.contains("c2")){var e=function(t){var e=DOMTokenList.prototype[t];DOMTokenList.prototype[t]=function(t){var n,i=arguments.length;for(n=0;i>n;n++)t=arguments[n],e.call(this,t)}};e("add"),e("remove")}if(t.classList.toggle("c3",!1),t.classList.contains("c3")){var n=DOMTokenList.prototype.toggle;DOMTokenList.prototype.toggle=function(t,e){return 1 in arguments&&!this.contains(t)==!e?e:n.call(this,t)}}"replace"in document.createElement("_").classList||(DOMTokenList.prototype.replace=function(t,e){var n=this.toString().split(" "),i=n.indexOf(t+"");~i&&(n=n.slice(i),this.remove.apply(this,n),this.add(e),this.add.apply(this,n.slice(1)))}),t=null}());
/*!
 * https://github.com/es-shims/es5-shim
 * @license es5-shim Copyright 2009-2020 by contributors, MIT License
 * see https://github.com/es-shims/es5-shim/blob/v4.5.14/LICENSE
 */
(function(t,r){"use strict";if(typeof define==="function"&&define.amd){define(r)}else if(typeof exports==="object"){module.exports=r()}else{t.returnExports=r()}})(this,function(){var t=Array;var r=t.prototype;var e=Object;var n=e.prototype;var i=Function;var a=i.prototype;var o=String;var f=o.prototype;var u=Number;var l=u.prototype;var s=r.slice;var c=r.splice;var v=r.push;var h=r.unshift;var p=r.concat;var y=r.join;var d=a.call;var g=a.apply;var w=Math.max;var b=Math.min;var T=n.toString;var m=typeof Symbol==="function"&&typeof Symbol.toStringTag==="symbol";var D;var S=Function.prototype.toString,x=/^\s*class /,O=function isES6ClassFn(t){try{var r=S.call(t);var e=r.replace(/\/\/.*\n/g,"");var n=e.replace(/\/\*[.\s\S]*\*\//g,"");var i=n.replace(/\n/gm," ").replace(/ {2}/g," ");return x.test(i)}catch(a){return false}},E=function tryFunctionObject(t){try{if(O(t)){return false}S.call(t);return true}catch(r){return false}},j="[object Function]",I="[object GeneratorFunction]",D=function isCallable(t){if(!t){return false}if(typeof t!=="function"&&typeof t!=="object"){return false}if(m){return E(t)}if(O(t)){return false}var r=T.call(t);return r===j||r===I};var M;var U=RegExp.prototype.exec,$=function tryRegexExec(t){try{U.call(t);return true}catch(r){return false}},F="[object RegExp]";M=function isRegex(t){if(typeof t!=="object"){return false}return m?$(t):T.call(t)===F};var N;var C=String.prototype.valueOf,k=function tryStringObject(t){try{C.call(t);return true}catch(r){return false}},A="[object String]";N=function isString(t){if(typeof t==="string"){return true}if(typeof t!=="object"){return false}return m?k(t):T.call(t)===A};var R=e.defineProperty&&function(){try{var t={};e.defineProperty(t,"x",{enumerable:false,value:t});for(var r in t){return false}return t.x===t}catch(n){return false}}();var P=function(t){var r;if(R){r=function(t,r,n,i){if(!i&&r in t){return}e.defineProperty(t,r,{configurable:true,enumerable:false,writable:true,value:n})}}else{r=function(t,r,e,n){if(!n&&r in t){return}t[r]=e}}return function defineProperties(e,n,i){for(var a in n){if(t.call(n,a)){r(e,a,n[a],i)}}}}(n.hasOwnProperty);var J=function isPrimitive(t){var r=typeof t;return t===null||r!=="object"&&r!=="function"};var Y=u.isNaN||function isActualNaN(t){return t!==t};var z={ToInteger:function ToInteger(t){var r=+t;if(Y(r)){r=0}else if(r!==0&&r!==1/0&&r!==-(1/0)){r=(r>0||-1)*Math.floor(Math.abs(r))}return r},ToPrimitive:function ToPrimitive(t){var r,e,n;if(J(t)){return t}e=t.valueOf;if(D(e)){r=e.call(t);if(J(r)){return r}}n=t.toString;if(D(n)){r=n.call(t);if(J(r)){return r}}throw new TypeError},ToObject:function(t){if(t==null){throw new TypeError("can't convert "+t+" to object")}return e(t)},ToUint32:function ToUint32(t){return t>>>0}};var Z=function Empty(){};P(a,{bind:function bind(t){var r=this;if(!D(r)){throw new TypeError("Function.prototype.bind called on incompatible "+r)}var n=s.call(arguments,1);var a;var o=function(){if(this instanceof a){var i=g.call(r,this,p.call(n,s.call(arguments)));if(e(i)===i){return i}return this}else{return g.call(r,t,p.call(n,s.call(arguments)))}};var f=w(0,r.length-n.length);var u=[];for(var l=0;l<f;l++){v.call(u,"$"+l)}a=i("binder","return function ("+y.call(u,",")+"){ return binder.apply(this, arguments); }")(o);if(r.prototype){Z.prototype=r.prototype;a.prototype=new Z;Z.prototype=null}return a}});var G=d.bind(n.hasOwnProperty);var H=d.bind(n.toString);var W=d.bind(s);var B=g.bind(s);if(typeof document==="object"&&document&&document.documentElement){try{W(document.documentElement.childNodes)}catch(X){var L=W;var q=B;W=function arraySliceIE(t){var r=[];var e=t.length;while(e-- >0){r[e]=t[e]}return q(r,L(arguments,1))};B=function arraySliceApplyIE(t,r){return q(W(t),r)}}}var K=d.bind(f.slice);var Q=d.bind(f.split);var V=d.bind(f.indexOf);var _=d.bind(v);var tt=d.bind(n.propertyIsEnumerable);var rt=d.bind(r.sort);var et=t.isArray||function isArray(t){return H(t)==="[object Array]"};var nt=[].unshift(0)!==1;P(r,{unshift:function(){h.apply(this,arguments);return this.length}},nt);P(t,{isArray:et});var it=e("a");var at=it[0]!=="a"||!(0 in it);var ot=function properlyBoxed(t){var r=true;var e=true;var n=false;if(t){try{t.call("foo",function(t,e,n){if(typeof n!=="object"){r=false}});t.call([1],function(){"use strict";e=typeof this==="string"},"x")}catch(i){n=true}}return!!t&&!n&&r&&e};P(r,{forEach:function forEach(t){var r=z.ToObject(this);var e=at&&N(this)?Q(this,""):r;var n=-1;var i=z.ToUint32(e.length);var a;if(arguments.length>1){a=arguments[1]}if(!D(t)){throw new TypeError("Array.prototype.forEach callback must be a function")}while(++n<i){if(n in e){if(typeof a==="undefined"){t(e[n],n,r)}else{t.call(a,e[n],n,r)}}}}},!ot(r.forEach));P(r,{map:function map(r){var e=z.ToObject(this);var n=at&&N(this)?Q(this,""):e;var i=z.ToUint32(n.length);var a=t(i);var o;if(arguments.length>1){o=arguments[1]}if(!D(r)){throw new TypeError("Array.prototype.map callback must be a function")}for(var f=0;f<i;f++){if(f in n){if(typeof o==="undefined"){a[f]=r(n[f],f,e)}else{a[f]=r.call(o,n[f],f,e)}}}return a}},!ot(r.map));P(r,{filter:function filter(t){var r=z.ToObject(this);var e=at&&N(this)?Q(this,""):r;var n=z.ToUint32(e.length);var i=[];var a;var o;if(arguments.length>1){o=arguments[1]}if(!D(t)){throw new TypeError("Array.prototype.filter callback must be a function")}for(var f=0;f<n;f++){if(f in e){a=e[f];if(typeof o==="undefined"?t(a,f,r):t.call(o,a,f,r)){_(i,a)}}}return i}},!ot(r.filter));P(r,{every:function every(t){var r=z.ToObject(this);var e=at&&N(this)?Q(this,""):r;var n=z.ToUint32(e.length);var i;if(arguments.length>1){i=arguments[1]}if(!D(t)){throw new TypeError("Array.prototype.every callback must be a function")}for(var a=0;a<n;a++){if(a in e&&!(typeof i==="undefined"?t(e[a],a,r):t.call(i,e[a],a,r))){return false}}return true}},!ot(r.every));P(r,{some:function some(t){var r=z.ToObject(this);var e=at&&N(this)?Q(this,""):r;var n=z.ToUint32(e.length);var i;if(arguments.length>1){i=arguments[1]}if(!D(t)){throw new TypeError("Array.prototype.some callback must be a function")}for(var a=0;a<n;a++){if(a in e&&(typeof i==="undefined"?t(e[a],a,r):t.call(i,e[a],a,r))){return true}}return false}},!ot(r.some));var ft=false;if(r.reduce){ft=typeof r.reduce.call("es5",function(t,r,e,n){return n})==="object"}P(r,{reduce:function reduce(t){var r=z.ToObject(this);var e=at&&N(this)?Q(this,""):r;var n=z.ToUint32(e.length);if(!D(t)){throw new TypeError("Array.prototype.reduce callback must be a function")}if(n===0&&arguments.length===1){throw new TypeError("reduce of empty array with no initial value")}var i=0;var a;if(arguments.length>=2){a=arguments[1]}else{do{if(i in e){a=e[i++];break}if(++i>=n){throw new TypeError("reduce of empty array with no initial value")}}while(true)}for(;i<n;i++){if(i in e){a=t(a,e[i],i,r)}}return a}},!ft);var ut=false;if(r.reduceRight){ut=typeof r.reduceRight.call("es5",function(t,r,e,n){return n})==="object"}P(r,{reduceRight:function reduceRight(t){var r=z.ToObject(this);var e=at&&N(this)?Q(this,""):r;var n=z.ToUint32(e.length);if(!D(t)){throw new TypeError("Array.prototype.reduceRight callback must be a function")}if(n===0&&arguments.length===1){throw new TypeError("reduceRight of empty array with no initial value")}var i;var a=n-1;if(arguments.length>=2){i=arguments[1]}else{do{if(a in e){i=e[a--];break}if(--a<0){throw new TypeError("reduceRight of empty array with no initial value")}}while(true)}if(a<0){return i}do{if(a in e){i=t(i,e[a],a,r)}}while(a--);return i}},!ut);var lt=r.indexOf&&[0,1].indexOf(1,2)!==-1;P(r,{indexOf:function indexOf(t){var r=at&&N(this)?Q(this,""):z.ToObject(this);var e=z.ToUint32(r.length);if(e===0){return-1}var n=0;if(arguments.length>1){n=z.ToInteger(arguments[1])}n=n>=0?n:w(0,e+n);for(;n<e;n++){if(n in r&&r[n]===t){return n}}return-1}},lt);var st=r.lastIndexOf&&[0,1].lastIndexOf(0,-3)!==-1;P(r,{lastIndexOf:function lastIndexOf(t){var r=at&&N(this)?Q(this,""):z.ToObject(this);var e=z.ToUint32(r.length);if(e===0){return-1}var n=e-1;if(arguments.length>1){n=b(n,z.ToInteger(arguments[1]))}n=n>=0?n:e-Math.abs(n);for(;n>=0;n--){if(n in r&&t===r[n]){return n}}return-1}},st);var ct=function(){var t=[1,2];var r=t.splice();return t.length===2&&et(r)&&r.length===0}();P(r,{splice:function splice(t,r){if(arguments.length===0){return[]}else{return c.apply(this,arguments)}}},!ct);var vt=function(){var t={};r.splice.call(t,0,0,1);return t.length===1}();P(r,{splice:function splice(t,r){if(arguments.length===0){return[]}var e=arguments;this.length=w(z.ToInteger(this.length),0);if(arguments.length>0&&typeof r!=="number"){e=W(arguments);if(e.length<2){_(e,this.length-t)}else{e[1]=z.ToInteger(r)}}return c.apply(this,e)}},!vt);var ht=function(){var r=new t(1e5);r[8]="x";r.splice(1,1);return r.indexOf("x")===7}();var pt=function(){var t=256;var r=[];r[t]="a";r.splice(t+1,0,"b");return r[t]==="a"}();P(r,{splice:function splice(t,r){var e=z.ToObject(this);var n=[];var i=z.ToUint32(e.length);var a=z.ToInteger(t);var f=a<0?w(i+a,0):b(a,i);var u=arguments.length===0?0:arguments.length===1?i-f:b(w(z.ToInteger(r),0),i-f);var l=0;var s;while(l<u){s=o(f+l);if(G(e,s)){n[l]=e[s]}l+=1}var c=W(arguments,2);var v=c.length;var h;if(v<u){l=f;var p=i-u;while(l<p){s=o(l+u);h=o(l+v);if(G(e,s)){e[h]=e[s]}else{delete e[h]}l+=1}l=i;var y=i-u+v;while(l>y){delete e[l-1];l-=1}}else if(v>u){l=i-u;while(l>f){s=o(l+u-1);h=o(l+v-1);if(G(e,s)){e[h]=e[s]}else{delete e[h]}l-=1}}l=f;for(var d=0;d<c.length;++d){e[l]=c[d];l+=1}e.length=i-u+v;return n}},!ht||!pt);var yt=r.join;var dt;try{dt=Array.prototype.join.call("123",",")!=="1,2,3"}catch(X){dt=true}if(dt){P(r,{join:function join(t){var r=typeof t==="undefined"?",":t;return yt.call(N(this)?Q(this,""):this,r)}},dt)}var gt=[1,2].join(undefined)!=="1,2";if(gt){P(r,{join:function join(t){var r=typeof t==="undefined"?",":t;return yt.call(this,r)}},gt)}var wt=function push(t){var r=z.ToObject(this);var e=z.ToUint32(r.length);var n=0;while(n<arguments.length){r[e+n]=arguments[n];n+=1}r.length=e+n;return e+n};var bt=function(){var t={};var r=Array.prototype.push.call(t,undefined);return r!==1||t.length!==1||typeof t[0]!=="undefined"||!G(t,0)}();P(r,{push:function push(t){if(et(this)){return v.apply(this,arguments)}return wt.apply(this,arguments)}},bt);var Tt=function(){var t=[];var r=t.push(undefined);return r!==1||t.length!==1||typeof t[0]!=="undefined"||!G(t,0)}();P(r,{push:wt},Tt);P(r,{slice:function(t,r){var e=N(this)?Q(this,""):this;return B(e,arguments)}},at);var mt=function(){try{[1,2].sort(null)}catch(t){try{[1,2].sort({})}catch(r){return false}}return true}();var Dt=function(){try{[1,2].sort(/a/);return false}catch(t){}return true}();var St=function(){try{[1,2].sort(undefined);return true}catch(t){}return false}();P(r,{sort:function sort(t){if(typeof t==="undefined"){return rt(this)}if(!D(t)){throw new TypeError("Array.prototype.sort callback must be a function")}return rt(this,t)}},mt||!St||!Dt);var xt=!tt({toString:null},"toString");var Ot=tt(function(){},"prototype");var Et=!G("x","0");var jt=function(t){var r=t.constructor;return r&&r.prototype===t};var It={$applicationCache:true,$console:true,$external:true,$frame:true,$frameElement:true,$frames:true,$innerHeight:true,$innerWidth:true,$onmozfullscreenchange:true,$onmozfullscreenerror:true,$outerHeight:true,$outerWidth:true,$pageXOffset:true,$pageYOffset:true,$parent:true,$scrollLeft:true,$scrollTop:true,$scrollX:true,$scrollY:true,$self:true,$webkitIndexedDB:true,$webkitStorageInfo:true,$window:true,$width:true,$height:true,$top:true,$localStorage:true};var Mt=function(){if(typeof window==="undefined"){return false}for(var t in window){try{if(!It["$"+t]&&G(window,t)&&window[t]!==null&&typeof window[t]==="object"){jt(window[t])}}catch(r){return true}}return false}();var Ut=function(t){if(typeof window==="undefined"||!Mt){return jt(t)}try{return jt(t)}catch(r){return false}};var $t=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"];var Ft=$t.length;var Nt=function isArguments(t){return H(t)==="[object Arguments]"};var Ct=function isArguments(t){return t!==null&&typeof t==="object"&&typeof t.length==="number"&&t.length>=0&&!et(t)&&D(t.callee)};var kt=Nt(arguments)?Nt:Ct;P(e,{keys:function keys(t){var r=D(t);var e=kt(t);var n=t!==null&&typeof t==="object";var i=n&&N(t);if(!n&&!r&&!e){throw new TypeError("Object.keys called on a non-object")}var a=[];var f=Ot&&r;if(i&&Et||e){for(var u=0;u<t.length;++u){_(a,o(u))}}if(!e){for(var l in t){if(!(f&&l==="prototype")&&G(t,l)){_(a,o(l))}}}if(xt){var s=Ut(t);for(var c=0;c<Ft;c++){var v=$t[c];if(!(s&&v==="constructor")&&G(t,v)){_(a,v)}}}return a}});var At=e.keys&&function(){return e.keys(arguments).length===2}(1,2);var Rt=e.keys&&function(){var t=e.keys(arguments);return arguments.length!==1||t.length!==1||t[0]!==1}(1);var Pt=e.keys;P(e,{keys:function keys(t){if(kt(t)){return Pt(W(t))}else{return Pt(t)}}},!At||Rt);var Jt=new Date(-0xc782b5b342b24).getUTCMonth()!==0;var Yt=new Date(-0x55d318d56a724);var zt=new Date(14496624e5);var Zt=Yt.toUTCString()!=="Mon, 01 Jan -45875 11:59:59 GMT";var Gt;var Ht;var Wt=Yt.getTimezoneOffset();if(Wt<-720){Gt=Yt.toDateString()!=="Tue Jan 02 -45875";Ht=!/^Thu Dec 10 2015 \d\d:\d\d:\d\d GMT[-+]\d\d\d\d(?: |$)/.test(String(zt))}else{Gt=Yt.toDateString()!=="Mon Jan 01 -45875";Ht=!/^Wed Dec 09 2015 \d\d:\d\d:\d\d GMT[-+]\d\d\d\d(?: |$)/.test(String(zt))}var Bt=d.bind(Date.prototype.getFullYear);var Xt=d.bind(Date.prototype.getMonth);var Lt=d.bind(Date.prototype.getDate);var qt=d.bind(Date.prototype.getUTCFullYear);var Kt=d.bind(Date.prototype.getUTCMonth);var Qt=d.bind(Date.prototype.getUTCDate);var Vt=d.bind(Date.prototype.getUTCDay);var _t=d.bind(Date.prototype.getUTCHours);var tr=d.bind(Date.prototype.getUTCMinutes);var rr=d.bind(Date.prototype.getUTCSeconds);var er=d.bind(Date.prototype.getUTCMilliseconds);var nr=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"];var ir=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];var ar=function daysInMonth(t,r){return Lt(new Date(r,t,0))};P(Date.prototype,{getFullYear:function getFullYear(){if(!this||!(this instanceof Date)){throw new TypeError("this is not a Date object.")}var t=Bt(this);if(t<0&&Xt(this)>11){return t+1}return t},getMonth:function getMonth(){if(!this||!(this instanceof Date)){throw new TypeError("this is not a Date object.")}var t=Bt(this);var r=Xt(this);if(t<0&&r>11){return 0}return r},getDate:function getDate(){if(!this||!(this instanceof Date)){throw new TypeError("this is not a Date object.")}var t=Bt(this);var r=Xt(this);var e=Lt(this);if(t<0&&r>11){if(r===12){return e}var n=ar(0,t+1);return n-e+1}return e},getUTCFullYear:function getUTCFullYear(){if(!this||!(this instanceof Date)){throw new TypeError("this is not a Date object.")}var t=qt(this);if(t<0&&Kt(this)>11){return t+1}return t},getUTCMonth:function getUTCMonth(){if(!this||!(this instanceof Date)){throw new TypeError("this is not a Date object.")}var t=qt(this);var r=Kt(this);if(t<0&&r>11){return 0}return r},getUTCDate:function getUTCDate(){if(!this||!(this instanceof Date)){throw new TypeError("this is not a Date object.")}var t=qt(this);var r=Kt(this);var e=Qt(this);if(t<0&&r>11){if(r===12){return e}var n=ar(0,t+1);return n-e+1}return e}},Jt);P(Date.prototype,{toUTCString:function toUTCString(){if(!this||!(this instanceof Date)){throw new TypeError("this is not a Date object.")}var t=Vt(this);var r=Qt(this);var e=Kt(this);var n=qt(this);var i=_t(this);var a=tr(this);var o=rr(this);return nr[t]+", "+(r<10?"0"+r:r)+" "+ir[e]+" "+n+" "+(i<10?"0"+i:i)+":"+(a<10?"0"+a:a)+":"+(o<10?"0"+o:o)+" GMT"}},Jt||Zt);P(Date.prototype,{toDateString:function toDateString(){if(!this||!(this instanceof Date)){throw new TypeError("this is not a Date object.")}var t=this.getDay();var r=this.getDate();var e=this.getMonth();var n=this.getFullYear();return nr[t]+" "+ir[e]+" "+(r<10?"0"+r:r)+" "+n}},Jt||Gt);if(Jt||Ht){Date.prototype.toString=function toString(){if(!this||!(this instanceof Date)){throw new TypeError("this is not a Date object.")}var t=this.getDay();var r=this.getDate();var e=this.getMonth();var n=this.getFullYear();var i=this.getHours();var a=this.getMinutes();var o=this.getSeconds();var f=this.getTimezoneOffset();var u=Math.floor(Math.abs(f)/60);var l=Math.floor(Math.abs(f)%60);return nr[t]+" "+ir[e]+" "+(r<10?"0"+r:r)+" "+n+" "+(i<10?"0"+i:i)+":"+(a<10?"0"+a:a)+":"+(o<10?"0"+o:o)+" GMT"+(f>0?"-":"+")+(u<10?"0"+u:u)+(l<10?"0"+l:l)};if(R){e.defineProperty(Date.prototype,"toString",{configurable:true,enumerable:false,writable:true})}}var or=-621987552e5;var fr="-000001";var ur=Date.prototype.toISOString&&new Date(or).toISOString().indexOf(fr)===-1;var lr=Date.prototype.toISOString&&new Date(-1).toISOString()!=="1969-12-31T23:59:59.999Z";var sr=d.bind(Date.prototype.getTime);P(Date.prototype,{toISOString:function toISOString(){if(!isFinite(this)||!isFinite(sr(this))){throw new RangeError("Date.prototype.toISOString called on non-finite value.")}var t=qt(this);var r=Kt(this);t+=Math.floor(r/12);r=(r%12+12)%12;var e=[r+1,Qt(this),_t(this),tr(this),rr(this)];t=(t<0?"-":t>9999?"+":"")+K("00000"+Math.abs(t),0<=t&&t<=9999?-4:-6);for(var n=0;n<e.length;++n){e[n]=K("00"+e[n],-2)}return t+"-"+W(e,0,2).join("-")+"T"+W(e,2).join(":")+"."+K("000"+er(this),-3)+"Z"}},ur||lr);var cr=function(){try{return Date.prototype.toJSON&&new Date(NaN).toJSON()===null&&new Date(or).toJSON().indexOf(fr)!==-1&&Date.prototype.toJSON.call({toISOString:function(){return true}})}catch(t){return false}}();if(!cr){Date.prototype.toJSON=function toJSON(t){var r=e(this);var n=z.ToPrimitive(r);if(typeof n==="number"&&!isFinite(n)){return null}var i=r.toISOString;if(!D(i)){throw new TypeError("toISOString property is not callable")}return i.call(r)}}var vr=Date.parse("+033658-09-27T01:46:40.000Z")===1e15;var hr=!isNaN(Date.parse("2012-04-04T24:00:00.500Z"))||!isNaN(Date.parse("2012-11-31T23:59:59.000Z"))||!isNaN(Date.parse("2012-12-31T23:59:60.000Z"));var pr=isNaN(Date.parse("2000-01-01T00:00:00.000Z"));if(pr||hr||!vr){var yr=Math.pow(2,31)-1;var dr=Y(new Date(1970,0,1,0,0,0,yr+1).getTime());Date=function(t){var r=function Date(e,n,i,a,f,u,l){var s=arguments.length;var c;if(this instanceof t){var v=u;var h=l;if(dr&&s>=7&&l>yr){var p=Math.floor(l/yr)*yr;var y=Math.floor(p/1e3);v+=y;h-=y*1e3}c=s===1&&o(e)===e?new t(r.parse(e)):s>=7?new t(e,n,i,a,f,v,h):s>=6?new t(e,n,i,a,f,v):s>=5?new t(e,n,i,a,f):s>=4?new t(e,n,i,a):s>=3?new t(e,n,i):s>=2?new t(e,n):s>=1?new t(e instanceof t?+e:e):new t}else{c=t.apply(this,arguments)}if(!J(c)){P(c,{constructor:r},true)}return c};var e=new RegExp("^"+"(\\d{4}|[+-]\\d{6})"+"(?:-(\\d{2})"+"(?:-(\\d{2})"+"(?:"+"T(\\d{2})"+":(\\d{2})"+"(?:"+":(\\d{2})"+"(?:(\\.\\d{1,}))?"+")?"+"("+"Z|"+"(?:"+"([-+])"+"(\\d{2})"+":(\\d{2})"+")"+")?)?)?)?"+"$");var n=[0,31,59,90,120,151,181,212,243,273,304,334,365];var i=function dayFromMonth(t,r){var e=r>1?1:0;return n[r]+Math.floor((t-1969+e)/4)-Math.floor((t-1901+e)/100)+Math.floor((t-1601+e)/400)+365*(t-1970)};var a=function toUTC(r){var e=0;var n=r;if(dr&&n>yr){var i=Math.floor(n/yr)*yr;var a=Math.floor(i/1e3);e+=a;n-=a*1e3}return u(new t(1970,0,1,0,0,e,n))};for(var f in t){if(G(t,f)){r[f]=t[f]}}P(r,{now:t.now,UTC:t.UTC},true);r.prototype=t.prototype;P(r.prototype,{constructor:r},true);var l=function parse(r){var n=e.exec(r);if(n){var o=u(n[1]),f=u(n[2]||1)-1,l=u(n[3]||1)-1,s=u(n[4]||0),c=u(n[5]||0),v=u(n[6]||0),h=Math.floor(u(n[7]||0)*1e3),p=Boolean(n[4]&&!n[8]),y=n[9]==="-"?1:-1,d=u(n[10]||0),g=u(n[11]||0),w;var b=c>0||v>0||h>0;if(s<(b?24:25)&&c<60&&v<60&&h<1e3&&f>-1&&f<12&&d<24&&g<60&&l>-1&&l<i(o,f+1)-i(o,f)){w=((i(o,f)+l)*24+s+d*y)*60;w=((w+c+g*y)*60+v)*1e3+h;if(p){w=a(w)}if(-864e13<=w&&w<=864e13){return w}}return NaN}return t.parse.apply(this,arguments)};P(r,{parse:l});return r}(Date)}if(!Date.now){Date.now=function now(){return(new Date).getTime()}}var gr=l.toFixed&&(8e-5.toFixed(3)!=="0.000"||.9.toFixed(0)!=="1"||1.255.toFixed(2)!=="1.25"||(1000000000000000128).toFixed(0)!=="1000000000000000128");var wr={base:1e7,size:6,data:[0,0,0,0,0,0],multiply:function multiply(t,r){var e=-1;var n=r;while(++e<wr.size){n+=t*wr.data[e];wr.data[e]=n%wr.base;n=Math.floor(n/wr.base)}},divide:function divide(t){var r=wr.size;var e=0;while(--r>=0){e+=wr.data[r];wr.data[r]=Math.floor(e/t);e=e%t*wr.base}},numToString:function numToString(){var t=wr.size;var r="";while(--t>=0){if(r!==""||t===0||wr.data[t]!==0){var e=o(wr.data[t]);if(r===""){r=e}else{r+=K("0000000",0,7-e.length)+e}}}return r},pow:function pow(t,r,e){return r===0?e:r%2===1?pow(t,r-1,e*t):pow(t*t,r/2,e)},log:function log(t){var r=0;var e=t;while(e>=4096){r+=12;e/=4096}while(e>=2){r+=1;e/=2}return r}};var br=function toFixed(t){var r,e,n,i,a,f,l,s;r=u(t);r=Y(r)?0:Math.floor(r);if(r<0||r>20){throw new RangeError("Number.toFixed called with invalid number of decimals")}e=u(this);if(Y(e)){return"NaN"}if(e<=-1e21||e>=1e21){return o(e)}n="";if(e<0){n="-";e=-e}i="0";if(e>1e-21){a=wr.log(e*wr.pow(2,69,1))-69;f=a<0?e*wr.pow(2,-a,1):e/wr.pow(2,a,1);f*=4503599627370496;a=52-a;if(a>0){wr.multiply(0,f);l=r;while(l>=7){wr.multiply(1e7,0);l-=7}wr.multiply(wr.pow(10,l,1),0);l=a-1;while(l>=23){wr.divide(1<<23);l-=23}wr.divide(1<<l);wr.multiply(1,1);wr.divide(2);i=wr.numToString()}else{wr.multiply(0,f);wr.multiply(1<<-a,0);i=wr.numToString()+K("0.00000000000000000000",2,2+r)}}if(r>0){s=i.length;if(s<=r){i=n+K("0.0000000000000000000",0,r-s+2)+i}else{i=n+K(i,0,s-r)+"."+K(i,s-r)}}else{i=n+i}return i};P(l,{toFixed:br},gr);var Tr=function(){try{return 1..toPrecision(undefined)==="1"}catch(t){return true}}();var mr=l.toPrecision;P(l,{toPrecision:function toPrecision(t){return typeof t==="undefined"?mr.call(this):mr.call(this,t)}},Tr);if("ab".split(/(?:ab)*/).length!==2||".".split(/(.?)(.?)/).length!==4||"tesst".split(/(s)*/)[1]==="t"||"test".split(/(?:)/,-1).length!==4||"".split(/.?/).length||".".split(/()()/).length>1){(function(){var t=typeof/()??/.exec("")[1]==="undefined";var r=Math.pow(2,32)-1;f.split=function(e,n){var i=String(this);if(typeof e==="undefined"&&n===0){return[]}if(!M(e)){return Q(this,e,n)}var a=[];var o=(e.ignoreCase?"i":"")+(e.multiline?"m":"")+(e.unicode?"u":"")+(e.sticky?"y":""),f=0,u,l,s,c;var h=new RegExp(e.source,o+"g");if(!t){u=new RegExp("^"+h.source+"$(?!\\s)",o)}var p=typeof n==="undefined"?r:z.ToUint32(n);l=h.exec(i);while(l){s=l.index+l[0].length;if(s>f){_(a,K(i,f,l.index));if(!t&&l.length>1){l[0].replace(u,function(){for(var t=1;t<arguments.length-2;t++){if(typeof arguments[t]==="undefined"){l[t]=void 0}}})}if(l.length>1&&l.index<i.length){v.apply(a,W(l,1))}c=l[0].length;f=s;if(a.length>=p){break}}if(h.lastIndex===l.index){h.lastIndex++}l=h.exec(i)}if(f===i.length){if(c||!h.test("")){_(a,"")}}else{_(a,K(i,f))}return a.length>p?W(a,0,p):a}})()}else if("0".split(void 0,0).length){f.split=function split(t,r){if(typeof t==="undefined"&&r===0){return[]}return Q(this,t,r)}}var Dr=f.replace;var Sr=function(){var t=[];"x".replace(/x(.)?/g,function(r,e){_(t,e)});return t.length===1&&typeof t[0]==="undefined"}();if(!Sr){f.replace=function replace(t,r){var e=D(r);var n=M(t)&&/\)[*?]/.test(t.source);if(!e||!n){return Dr.call(this,t,r)}else{var i=function(e){var n=arguments.length;var i=t.lastIndex;t.lastIndex=0;var a=t.exec(e)||[];t.lastIndex=i;_(a,arguments[n-2],arguments[n-1]);return r.apply(this,a)};return Dr.call(this,t,i)}}}var xr=f.substr;var Or="".substr&&"0b".substr(-1)!=="b";P(f,{substr:function substr(t,r){var e=t;if(t<0){e=w(this.length+t,0)}return xr.call(this,e,r)}},Or);var Er="\t\n\x0B\f\r \xa0\u1680\u2000\u2001\u2002\u2003"+"\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028"+"\u2029\ufeff";var jr="\u200b";var Ir="["+Er+"]";var Mr=new RegExp("^"+Ir+Ir+"*");var Ur=new RegExp(Ir+Ir+"*$");var $r=f.trim&&(Er.trim()||!jr.trim());P(f,{trim:function trim(){if(typeof this==="undefined"||this===null){throw new TypeError("can't convert "+this+" to object")}return o(this).replace(Mr,"").replace(Ur,"")}},$r);var Fr=d.bind(String.prototype.trim);var Nr=f.lastIndexOf&&"abc\u3042\u3044".lastIndexOf("\u3042\u3044",2)!==-1;P(f,{lastIndexOf:function lastIndexOf(t){if(typeof this==="undefined"||this===null){throw new TypeError("can't convert "+this+" to object")}var r=o(this);var e=o(t);var n=arguments.length>1?u(arguments[1]):NaN;var i=Y(n)?Infinity:z.ToInteger(n);var a=b(w(i,0),r.length);var f=e.length;var l=a+f;while(l>0){l=w(0,l-f);var s=V(K(r,l,a+f),e);if(s!==-1){return l+s}}return-1}},Nr);var Cr=f.lastIndexOf;P(f,{lastIndexOf:function lastIndexOf(t){return Cr.apply(this,arguments)}},f.lastIndexOf.length!==1);if(parseInt(Er+"08")!==8||parseInt(Er+"0x16")!==22){parseInt=function(t){var r=/^[-+]?0[xX]/;return function parseInt(e,n){if(typeof e==="symbol"){""+e}var i=Fr(String(e));var a=u(n)||(r.test(i)?16:10);return t(i,a)}}(parseInt)}if(1/parseFloat("-0")!==-Infinity){parseFloat=function(t){return function parseFloat(r){var e=Fr(String(r));var n=t(e);return n===0&&K(e,0,1)==="-"?-0:n}}(parseFloat)}if(String(new RangeError("test"))!=="RangeError: test"){var kr=function toString(){if(typeof this==="undefined"||this===null){throw new TypeError("can't convert "+this+" to object")}var t=this.name;if(typeof t==="undefined"){t="Error"}else if(typeof t!=="string"){t=o(t)}var r=this.message;if(typeof r==="undefined"){r=""}else if(typeof r!=="string"){r=o(r)}if(!t){return r}if(!r){return t}return t+": "+r};Error.prototype.toString=kr}if(R){var Ar=function(t,r){if(tt(t,r)){var e=Object.getOwnPropertyDescriptor(t,r);if(e.configurable){e.enumerable=false;Object.defineProperty(t,r,e)}}};Ar(Error.prototype,"message");if(Error.prototype.message!==""){Error.prototype.message=""}Ar(Error.prototype,"name")}if(String(/a/gim)!=="/a/gim"){var Rr=function toString(){var t="/"+this.source+"/";if(this.global){t+="g"}if(this.ignoreCase){t+="i"}if(this.multiline){t+="m"}return t};RegExp.prototype.toString=Rr}});
/*!
 * https://github.com/paulmillr/es6-shim
 * @license es6-shim Copyright 2013-2016 by Paul Miller (http://paulmillr.com)
 *   and contributors,  MIT License
 * es6-shim: v0.35.4
 * see https://github.com/paulmillr/es6-shim/blob/0.35.4/LICENSE
 * Details and documentation:
 * https://github.com/paulmillr/es6-shim/
 */
(function(e,t){if(typeof define==="function"&&define.amd){define(t)}else if(typeof exports==="object"){module.exports=t()}else{e.returnExports=t()}})(this,function(){"use strict";var e=Function.call.bind(Function.apply);var t=Function.call.bind(Function.call);var r=Array.isArray;var n=Object.keys;var o=function notThunker(t){return function notThunk(){return!e(t,this,arguments)}};var i=function(e){try{e();return false}catch(t){return true}};var a=function valueOrFalseIfThrows(e){try{return e()}catch(t){return false}};var u=o(i);var f=function(){return!i(function(){return Object.defineProperty({},"x",{get:function(){}})})};var s=!!Object.defineProperty&&f();var c=function foo(){}.name==="foo";var l=Function.call.bind(Array.prototype.forEach);var p=Function.call.bind(Array.prototype.reduce);var v=Function.call.bind(Array.prototype.filter);var y=Function.call.bind(Array.prototype.some);var h=function(e,t,r,n){if(!n&&t in e){return}if(s){Object.defineProperty(e,t,{configurable:true,enumerable:false,writable:true,value:r})}else{e[t]=r}};var b=function(e,t,r){l(n(t),function(n){var o=t[n];h(e,n,o,!!r)})};var g=Function.call.bind(Object.prototype.toString);var d=typeof/abc/==="function"?function IsCallableSlow(e){return typeof e==="function"&&g(e)==="[object Function]"}:function IsCallableFast(e){return typeof e==="function"};var m={getter:function(e,t,r){if(!s){throw new TypeError("getters require true ES5 support")}Object.defineProperty(e,t,{configurable:true,enumerable:false,get:r})},proxy:function(e,t,r){if(!s){throw new TypeError("getters require true ES5 support")}var n=Object.getOwnPropertyDescriptor(e,t);Object.defineProperty(r,t,{configurable:n.configurable,enumerable:n.enumerable,get:function getKey(){return e[t]},set:function setKey(r){e[t]=r}})},redefine:function(e,t,r){if(s){var n=Object.getOwnPropertyDescriptor(e,t);n.value=r;Object.defineProperty(e,t,n)}else{e[t]=r}},defineByDescriptor:function(e,t,r){if(s){Object.defineProperty(e,t,r)}else if("value"in r){e[t]=r.value}},preserveToString:function(e,t){if(t&&d(t.toString)){h(e,"toString",t.toString.bind(t),true)}}};var O=Object.create||function(e,t){var r=function Prototype(){};r.prototype=e;var o=new r;if(typeof t!=="undefined"){n(t).forEach(function(e){m.defineByDescriptor(o,e,t[e])})}return o};var w=function(e,t){if(!Object.setPrototypeOf){return false}return a(function(){var r=function Subclass(t){var r=new e(t);Object.setPrototypeOf(r,Subclass.prototype);return r};Object.setPrototypeOf(r,e);r.prototype=O(e.prototype,{constructor:{value:r}});return t(r)})};var j=function(){if(typeof self!=="undefined"){return self}if(typeof window!=="undefined"){return window}if(typeof global!=="undefined"){return global}throw new Error("unable to locate global object")};var S=j();var T=S.isFinite;var I=Function.call.bind(String.prototype.indexOf);var E=Function.apply.bind(Array.prototype.indexOf);var P=Function.call.bind(Array.prototype.concat);var C=Function.call.bind(String.prototype.slice);var M=Function.call.bind(Array.prototype.push);var x=Function.apply.bind(Array.prototype.push);var N=Function.call.bind(Array.prototype.shift);var A=Math.max;var R=Math.min;var _=Math.floor;var k=Math.abs;var L=Math.exp;var F=Math.log;var D=Math.sqrt;var z=Function.call.bind(Object.prototype.hasOwnProperty);var q;var W=function(){};var G=S.Map;var H=G&&G.prototype["delete"];var V=G&&G.prototype.get;var B=G&&G.prototype.has;var U=G&&G.prototype.set;var $=S.Symbol||{};var J=$.species||"@@species";var X=Number.isNaN||function isNaN(e){return e!==e};var K=Number.isFinite||function isFinite(e){return typeof e==="number"&&T(e)};var Z=d(Math.sign)?Math.sign:function sign(e){var t=Number(e);if(t===0){return t}if(X(t)){return t}return t<0?-1:1};var Y=function log1p(e){var t=Number(e);if(t<-1||X(t)){return NaN}if(t===0||t===Infinity){return t}if(t===-1){return-Infinity}return 1+t-1===0?t:t*(F(1+t)/(1+t-1))};var Q=function isArguments(e){return g(e)==="[object Arguments]"};var ee=function isArguments(e){return e!==null&&typeof e==="object"&&typeof e.length==="number"&&e.length>=0&&g(e)!=="[object Array]"&&g(e.callee)==="[object Function]"};var te=Q(arguments)?Q:ee;var re={primitive:function(e){return e===null||typeof e!=="function"&&typeof e!=="object"},string:function(e){return g(e)==="[object String]"},regex:function(e){return g(e)==="[object RegExp]"},symbol:function(e){return typeof S.Symbol==="function"&&typeof e==="symbol"}};var ne=function overrideNative(e,t,r){var n=e[t];h(e,t,r,true);m.preserveToString(e[t],n)};var oe=typeof $==="function"&&typeof $["for"]==="function"&&re.symbol($());var ie=re.symbol($.iterator)?$.iterator:"_es6-shim iterator_";if(S.Set&&typeof(new S.Set)["@@iterator"]==="function"){ie="@@iterator"}if(!S.Reflect){h(S,"Reflect",{},true)}var ae=S.Reflect;var ue=String;var fe=typeof document==="undefined"||!document?null:document.all;var se=fe==null?function isNullOrUndefined(e){return e==null}:function isNullOrUndefinedAndNotDocumentAll(e){return e==null&&e!==fe};var ce={Call:function Call(t,r){var n=arguments.length>2?arguments[2]:[];if(!ce.IsCallable(t)){throw new TypeError(t+" is not a function")}return e(t,r,n)},RequireObjectCoercible:function(e,t){if(se(e)){throw new TypeError(t||"Cannot call method on "+e)}return e},TypeIsObject:function(e){if(e===void 0||e===null||e===true||e===false){return false}return typeof e==="function"||typeof e==="object"||e===fe},ToObject:function(e,t){return Object(ce.RequireObjectCoercible(e,t))},IsCallable:d,IsConstructor:function(e){return ce.IsCallable(e)},ToInt32:function(e){return ce.ToNumber(e)>>0},ToUint32:function(e){return ce.ToNumber(e)>>>0},ToNumber:function(e){if(g(e)==="[object Symbol]"){throw new TypeError("Cannot convert a Symbol value to a number")}return+e},ToInteger:function(e){var t=ce.ToNumber(e);if(X(t)){return 0}if(t===0||!K(t)){return t}return(t>0?1:-1)*_(k(t))},ToLength:function(e){var t=ce.ToInteger(e);if(t<=0){return 0}if(t>Number.MAX_SAFE_INTEGER){return Number.MAX_SAFE_INTEGER}return t},SameValue:function(e,t){if(e===t){if(e===0){return 1/e===1/t}return true}return X(e)&&X(t)},SameValueZero:function(e,t){return e===t||X(e)&&X(t)},IsIterable:function(e){return ce.TypeIsObject(e)&&(typeof e[ie]!=="undefined"||te(e))},GetIterator:function(e){if(te(e)){return new q(e,"value")}var t=ce.GetMethod(e,ie);if(!ce.IsCallable(t)){throw new TypeError("value is not an iterable")}var r=ce.Call(t,e);if(!ce.TypeIsObject(r)){throw new TypeError("bad iterator")}return r},GetMethod:function(e,t){var r=ce.ToObject(e)[t];if(se(r)){return void 0}if(!ce.IsCallable(r)){throw new TypeError("Method not callable: "+t)}return r},IteratorComplete:function(e){return!!e.done},IteratorClose:function(e,t){var r=ce.GetMethod(e,"return");if(r===void 0){return}var n,o;try{n=ce.Call(r,e)}catch(i){o=i}if(t){return}if(o){throw o}if(!ce.TypeIsObject(n)){throw new TypeError("Iterator's return method returned a non-object.")}},IteratorNext:function(e){var t=arguments.length>1?e.next(arguments[1]):e.next();if(!ce.TypeIsObject(t)){throw new TypeError("bad iterator")}return t},IteratorStep:function(e){var t=ce.IteratorNext(e);var r=ce.IteratorComplete(t);return r?false:t},Construct:function(e,t,r,n){var o=typeof r==="undefined"?e:r;if(!n&&ae.construct){return ae.construct(e,t,o)}var i=o.prototype;if(!ce.TypeIsObject(i)){i=Object.prototype}var a=O(i);var u=ce.Call(e,a,t);return ce.TypeIsObject(u)?u:a},SpeciesConstructor:function(e,t){var r=e.constructor;if(r===void 0){return t}if(!ce.TypeIsObject(r)){throw new TypeError("Bad constructor")}var n=r[J];if(se(n)){return t}if(!ce.IsConstructor(n)){throw new TypeError("Bad @@species")}return n},CreateHTML:function(e,t,r,n){var o=ce.ToString(e);var i="<"+t;if(r!==""){var a=ce.ToString(n);var u=a.replace(/"/g,"&quot;");i+=" "+r+'="'+u+'"'}var f=i+">";var s=f+o;return s+"</"+t+">"},IsRegExp:function IsRegExp(e){if(!ce.TypeIsObject(e)){return false}var t=e[$.match];if(typeof t!=="undefined"){return!!t}return re.regex(e)},ToString:function ToString(e){return ue(e)}};if(s&&oe){var le=function defineWellKnownSymbol(e){if(re.symbol($[e])){return $[e]}var t=$["for"]("Symbol."+e);Object.defineProperty($,e,{configurable:false,enumerable:false,writable:false,value:t});return t};if(!re.symbol($.search)){var pe=le("search");var ve=String.prototype.search;h(RegExp.prototype,pe,function search(e){return ce.Call(ve,e,[this])});var ye=function search(e){var t=ce.RequireObjectCoercible(this);if(!se(e)){var r=ce.GetMethod(e,pe);if(typeof r!=="undefined"){return ce.Call(r,e,[t])}}return ce.Call(ve,t,[ce.ToString(e)])};ne(String.prototype,"search",ye)}if(!re.symbol($.replace)){var he=le("replace");var be=String.prototype.replace;h(RegExp.prototype,he,function replace(e,t){return ce.Call(be,e,[this,t])});var ge=function replace(e,t){var r=ce.RequireObjectCoercible(this);if(!se(e)){var n=ce.GetMethod(e,he);if(typeof n!=="undefined"){return ce.Call(n,e,[r,t])}}return ce.Call(be,r,[ce.ToString(e),t])};ne(String.prototype,"replace",ge)}if(!re.symbol($.split)){var de=le("split");var me=String.prototype.split;h(RegExp.prototype,de,function split(e,t){return ce.Call(me,e,[this,t])});var Oe=function split(e,t){var r=ce.RequireObjectCoercible(this);if(!se(e)){var n=ce.GetMethod(e,de);if(typeof n!=="undefined"){return ce.Call(n,e,[r,t])}}return ce.Call(me,r,[ce.ToString(e),t])};ne(String.prototype,"split",Oe)}var we=re.symbol($.match);var je=we&&function(){var e={};e[$.match]=function(){return 42};return"a".match(e)!==42}();if(!we||je){var Se=le("match");var Te=String.prototype.match;h(RegExp.prototype,Se,function match(e){return ce.Call(Te,e,[this])});var Ie=function match(e){var t=ce.RequireObjectCoercible(this);if(!se(e)){var r=ce.GetMethod(e,Se);if(typeof r!=="undefined"){return ce.Call(r,e,[t])}}return ce.Call(Te,t,[ce.ToString(e)])};ne(String.prototype,"match",Ie)}}var Ee=function wrapConstructor(e,t,r){m.preserveToString(t,e);if(Object.setPrototypeOf){Object.setPrototypeOf(e,t)}if(s){l(Object.getOwnPropertyNames(e),function(n){if(n in W||r[n]){return}m.proxy(e,n,t)})}else{l(Object.keys(e),function(n){if(n in W||r[n]){return}t[n]=e[n]})}t.prototype=e.prototype;m.redefine(e.prototype,"constructor",t)};var Pe=function(){return this};var Ce=function(e){if(s&&!z(e,J)){m.getter(e,J,Pe)}};var Me=function(e,t){var r=t||function iterator(){return this};h(e,ie,r);if(!e[ie]&&re.symbol(ie)){e[ie]=r}};var xe=function createDataProperty(e,t,r){if(s){Object.defineProperty(e,t,{configurable:true,enumerable:true,writable:true,value:r})}else{e[t]=r}};var Ne=function createDataPropertyOrThrow(e,t,r){xe(e,t,r);if(!ce.SameValue(e[t],r)){throw new TypeError("property is nonconfigurable")}};var Ae=function(e,t,r,n){if(!ce.TypeIsObject(e)){throw new TypeError("Constructor requires `new`: "+t.name)}var o=t.prototype;if(!ce.TypeIsObject(o)){o=r}var i=O(o);for(var a in n){if(z(n,a)){var u=n[a];h(i,a,u,true)}}return i};if(String.fromCodePoint&&String.fromCodePoint.length!==1){var Re=String.fromCodePoint;ne(String,"fromCodePoint",function fromCodePoint(e){return ce.Call(Re,this,arguments)})}var _e={fromCodePoint:function fromCodePoint(e){var t=[];var r;for(var n=0,o=arguments.length;n<o;n++){r=Number(arguments[n]);if(!ce.SameValue(r,ce.ToInteger(r))||r<0||r>1114111){throw new RangeError("Invalid code point "+r)}if(r<65536){M(t,String.fromCharCode(r))}else{r-=65536;M(t,String.fromCharCode((r>>10)+55296));M(t,String.fromCharCode(r%1024+56320))}}return t.join("")},raw:function raw(e){var t=ce.ToObject(e,"bad callSite");var r=ce.ToObject(t.raw,"bad raw value");var n=r.length;var o=ce.ToLength(n);if(o<=0){return""}var i=[];var a=0;var u,f,s,c;while(a<o){u=ce.ToString(a);s=ce.ToString(r[u]);M(i,s);if(a+1>=o){break}f=a+1<arguments.length?arguments[a+1]:"";c=ce.ToString(f);M(i,c);a+=1}return i.join("")}};if(String.raw&&String.raw({raw:{0:"x",1:"y",length:2}})!=="xy"){ne(String,"raw",_e.raw)}b(String,_e);var ke=function repeat(e,t){if(t<1){return""}if(t%2){return repeat(e,t-1)+e}var r=repeat(e,t/2);return r+r};var Le=Infinity;var Fe={repeat:function repeat(e){var t=ce.ToString(ce.RequireObjectCoercible(this));var r=ce.ToInteger(e);if(r<0||r>=Le){throw new RangeError("repeat count must be less than infinity and not overflow maximum string size")}return ke(t,r)},startsWith:function startsWith(e){var t=ce.ToString(ce.RequireObjectCoercible(this));if(ce.IsRegExp(e)){throw new TypeError('Cannot call method "startsWith" with a regex')}var r=ce.ToString(e);var n;if(arguments.length>1){n=arguments[1]}var o=A(ce.ToInteger(n),0);return C(t,o,o+r.length)===r},endsWith:function endsWith(e){var t=ce.ToString(ce.RequireObjectCoercible(this));if(ce.IsRegExp(e)){throw new TypeError('Cannot call method "endsWith" with a regex')}var r=ce.ToString(e);var n=t.length;var o;if(arguments.length>1){o=arguments[1]}var i=typeof o==="undefined"?n:ce.ToInteger(o);var a=R(A(i,0),n);return C(t,a-r.length,a)===r},includes:function includes(e){if(ce.IsRegExp(e)){throw new TypeError('"includes" does not accept a RegExp')}var t=ce.ToString(e);var r;if(arguments.length>1){r=arguments[1]}return I(this,t,r)!==-1},codePointAt:function codePointAt(e){var t=ce.ToString(ce.RequireObjectCoercible(this));var r=ce.ToInteger(e);var n=t.length;if(r>=0&&r<n){var o=t.charCodeAt(r);var i=r+1===n;if(o<55296||o>56319||i){return o}var a=t.charCodeAt(r+1);if(a<56320||a>57343){return o}return(o-55296)*1024+(a-56320)+65536}}};if(String.prototype.includes&&"a".includes("a",Infinity)!==false){ne(String.prototype,"includes",Fe.includes)}if(String.prototype.startsWith&&String.prototype.endsWith){var De=i(function(){return"/a/".startsWith(/a/)});var ze=a(function(){return"abc".startsWith("a",Infinity)===false});if(!De||!ze){ne(String.prototype,"startsWith",Fe.startsWith);ne(String.prototype,"endsWith",Fe.endsWith)}}if(oe){var qe=a(function(){var e=/a/;e[$.match]=false;return"/a/".startsWith(e)});if(!qe){ne(String.prototype,"startsWith",Fe.startsWith)}var We=a(function(){var e=/a/;e[$.match]=false;return"/a/".endsWith(e)});if(!We){ne(String.prototype,"endsWith",Fe.endsWith)}var Ge=a(function(){var e=/a/;e[$.match]=false;return"/a/".includes(e)});if(!Ge){ne(String.prototype,"includes",Fe.includes)}}b(String.prototype,Fe);var He=["\t\n\x0B\f\r \xa0\u1680\u180e\u2000\u2001\u2002\u2003","\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028","\u2029\ufeff"].join("");var Ve=new RegExp("(^["+He+"]+)|(["+He+"]+$)","g");var Be=function trim(){return ce.ToString(ce.RequireObjectCoercible(this)).replace(Ve,"")};var Ue=["\x85","\u200b","\ufffe"].join("");var $e=new RegExp("["+Ue+"]","g");var Je=/^[-+]0x[0-9a-f]+$/i;var Xe=Ue.trim().length!==Ue.length;h(String.prototype,"trim",Be,Xe);var Ke=function(e){return{value:e,done:arguments.length===0}};var Ze=function(e){ce.RequireObjectCoercible(e);this._s=ce.ToString(e);this._i=0};Ze.prototype.next=function(){var e=this._s;var t=this._i;if(typeof e==="undefined"||t>=e.length){this._s=void 0;return Ke()}var r=e.charCodeAt(t);var n,o;if(r<55296||r>56319||t+1===e.length){o=1}else{n=e.charCodeAt(t+1);o=n<56320||n>57343?1:2}this._i=t+o;return Ke(e.substr(t,o))};Me(Ze.prototype);Me(String.prototype,function(){return new Ze(this)});var Ye={from:function from(e){var r=this;var n;if(arguments.length>1){n=arguments[1]}var o,i;if(typeof n==="undefined"){o=false}else{if(!ce.IsCallable(n)){throw new TypeError("Array.from: when provided, the second argument must be a function")}if(arguments.length>2){i=arguments[2]}o=true}var a=typeof(te(e)||ce.GetMethod(e,ie))!=="undefined";var u,f,s;if(a){f=ce.IsConstructor(r)?Object(new r):[];var c=ce.GetIterator(e);var l,p;s=0;while(true){l=ce.IteratorStep(c);if(l===false){break}p=l.value;try{if(o){p=typeof i==="undefined"?n(p,s):t(n,i,p,s)}f[s]=p}catch(v){ce.IteratorClose(c,true);throw v}s+=1}u=s}else{var y=ce.ToObject(e);u=ce.ToLength(y.length);f=ce.IsConstructor(r)?Object(new r(u)):new Array(u);var h;for(s=0;s<u;++s){h=y[s];if(o){h=typeof i==="undefined"?n(h,s):t(n,i,h,s)}Ne(f,s,h)}}f.length=u;return f},of:function of(){var e=arguments.length;var t=this;var n=r(t)||!ce.IsCallable(t)?new Array(e):ce.Construct(t,[e]);for(var o=0;o<e;++o){Ne(n,o,arguments[o])}n.length=e;return n}};b(Array,Ye);Ce(Array);q=function(e,t){this.i=0;this.array=e;this.kind=t};b(q.prototype,{next:function(){var e=this.i;var t=this.array;if(!(this instanceof q)){throw new TypeError("Not an ArrayIterator")}if(typeof t!=="undefined"){var r=ce.ToLength(t.length);for(;e<r;e++){var n=this.kind;var o;if(n==="key"){o=e}else if(n==="value"){o=t[e]}else if(n==="entry"){o=[e,t[e]]}this.i=e+1;return Ke(o)}}this.array=void 0;return Ke()}});Me(q.prototype);var Qe=Array.of===Ye.of||function(){var e=function Foo(e){this.length=e};e.prototype=[];var t=Array.of.apply(e,[1,2]);return t instanceof e&&t.length===2}();if(!Qe){ne(Array,"of",Ye.of)}var et={copyWithin:function copyWithin(e,t){var r=ce.ToObject(this);var n=ce.ToLength(r.length);var o=ce.ToInteger(e);var i=ce.ToInteger(t);var a=o<0?A(n+o,0):R(o,n);var u=i<0?A(n+i,0):R(i,n);var f;if(arguments.length>2){f=arguments[2]}var s=typeof f==="undefined"?n:ce.ToInteger(f);var c=s<0?A(n+s,0):R(s,n);var l=R(c-u,n-a);var p=1;if(u<a&&a<u+l){p=-1;u+=l-1;a+=l-1}while(l>0){if(u in r){r[a]=r[u]}else{delete r[a]}u+=p;a+=p;l-=1}return r},fill:function fill(e){var t;if(arguments.length>1){t=arguments[1]}var r;if(arguments.length>2){r=arguments[2]}var n=ce.ToObject(this);var o=ce.ToLength(n.length);t=ce.ToInteger(typeof t==="undefined"?0:t);r=ce.ToInteger(typeof r==="undefined"?o:r);var i=t<0?A(o+t,0):R(t,o);var a=r<0?o+r:r;for(var u=i;u<o&&u<a;++u){n[u]=e}return n},find:function find(e){var r=ce.ToObject(this);var n=ce.ToLength(r.length);if(!ce.IsCallable(e)){throw new TypeError("Array#find: predicate must be a function")}var o=arguments.length>1?arguments[1]:null;for(var i=0,a;i<n;i++){a=r[i];if(o){if(t(e,o,a,i,r)){return a}}else if(e(a,i,r)){return a}}},findIndex:function findIndex(e){var r=ce.ToObject(this);var n=ce.ToLength(r.length);if(!ce.IsCallable(e)){throw new TypeError("Array#findIndex: predicate must be a function")}var o=arguments.length>1?arguments[1]:null;for(var i=0;i<n;i++){if(o){if(t(e,o,r[i],i,r)){return i}}else if(e(r[i],i,r)){return i}}return-1},keys:function keys(){return new q(this,"key")},values:function values(){return new q(this,"value")},entries:function entries(){return new q(this,"entry")}};if(Array.prototype.keys&&!ce.IsCallable([1].keys().next)){delete Array.prototype.keys}if(Array.prototype.entries&&!ce.IsCallable([1].entries().next)){delete Array.prototype.entries}if(Array.prototype.keys&&Array.prototype.entries&&!Array.prototype.values&&Array.prototype[ie]){b(Array.prototype,{values:Array.prototype[ie]});if(re.symbol($.unscopables)){Array.prototype[$.unscopables].values=true}}if(c&&Array.prototype.values&&Array.prototype.values.name!=="values"){var tt=Array.prototype.values;ne(Array.prototype,"values",function values(){return ce.Call(tt,this,arguments)});h(Array.prototype,ie,Array.prototype.values,true)}b(Array.prototype,et);if(1/[true].indexOf(true,-0)<0){h(Array.prototype,"indexOf",function indexOf(e){var t=E(this,arguments);if(t===0&&1/t<0){return 0}return t},true)}Me(Array.prototype,function(){return this.values()});if(Object.getPrototypeOf){Me(Object.getPrototypeOf([].values()))}var rt=function(){return a(function(){return Array.from({length:-1}).length===0})}();var nt=function(){var e=Array.from([0].entries());return e.length===1&&r(e[0])&&e[0][0]===0&&e[0][1]===0}();if(!rt||!nt){ne(Array,"from",Ye.from)}var ot=function(){return a(function(){return Array.from([0],void 0)})}();if(!ot){var it=Array.from;ne(Array,"from",function from(e){if(arguments.length>1&&typeof arguments[1]!=="undefined"){return ce.Call(it,this,arguments)}else{return t(it,this,e)}})}var at=-(Math.pow(2,32)-1);var ut=function(e,r){var n={length:at};n[r?(n.length>>>0)-1:0]=true;return a(function(){t(e,n,function(){throw new RangeError("should not reach here")},[]);return true})};if(!ut(Array.prototype.forEach)){var ft=Array.prototype.forEach;ne(Array.prototype,"forEach",function forEach(e){return ce.Call(ft,this.length>=0?this:[],arguments)},true)}if(!ut(Array.prototype.map)){var st=Array.prototype.map;ne(Array.prototype,"map",function map(e){return ce.Call(st,this.length>=0?this:[],arguments)},true)}if(!ut(Array.prototype.filter)){var ct=Array.prototype.filter;ne(Array.prototype,"filter",function filter(e){return ce.Call(ct,this.length>=0?this:[],arguments)},true)}if(!ut(Array.prototype.some)){var lt=Array.prototype.some;ne(Array.prototype,"some",function some(e){return ce.Call(lt,this.length>=0?this:[],arguments)},true)}if(!ut(Array.prototype.every)){var pt=Array.prototype.every;ne(Array.prototype,"every",function every(e){return ce.Call(pt,this.length>=0?this:[],arguments)},true)}if(!ut(Array.prototype.reduce)){var vt=Array.prototype.reduce;ne(Array.prototype,"reduce",function reduce(e){return ce.Call(vt,this.length>=0?this:[],arguments)},true)}if(!ut(Array.prototype.reduceRight,true)){var yt=Array.prototype.reduceRight;ne(Array.prototype,"reduceRight",function reduceRight(e){return ce.Call(yt,this.length>=0?this:[],arguments)},true)}var ht=Number("0o10")!==8;var bt=Number("0b10")!==2;var gt=y(Ue,function(e){return Number(e+0+e)===0});if(ht||bt||gt){var dt=Number;var mt=/^0b[01]+$/i;var Ot=/^0o[0-7]+$/i;var wt=mt.test.bind(mt);var jt=Ot.test.bind(Ot);var St=function(e){var t;if(typeof e.valueOf==="function"){t=e.valueOf();if(re.primitive(t)){return t}}if(typeof e.toString==="function"){t=e.toString();if(re.primitive(t)){return t}}throw new TypeError("No default value")};var Tt=$e.test.bind($e);var It=Je.test.bind(Je);var Et=function(){var e=function Number(t){var r;if(arguments.length>0){r=re.primitive(t)?t:St(t,"number")}else{r=0}if(typeof r==="string"){r=ce.Call(Be,r);if(wt(r)){r=parseInt(C(r,2),2)}else if(jt(r)){r=parseInt(C(r,2),8)}else if(Tt(r)||It(r)){r=NaN}}var n=this;var o=a(function(){dt.prototype.valueOf.call(n);return true});if(n instanceof e&&!o){return new dt(r)}return dt(r)};return e}();Ee(dt,Et,{});b(Et,{NaN:dt.NaN,MAX_VALUE:dt.MAX_VALUE,MIN_VALUE:dt.MIN_VALUE,NEGATIVE_INFINITY:dt.NEGATIVE_INFINITY,POSITIVE_INFINITY:dt.POSITIVE_INFINITY});Number=Et;m.redefine(S,"Number",Et)}var Pt=Math.pow(2,53)-1;b(Number,{MAX_SAFE_INTEGER:Pt,MIN_SAFE_INTEGER:-Pt,EPSILON:2.220446049250313e-16,parseInt:S.parseInt,parseFloat:S.parseFloat,isFinite:K,isInteger:function isInteger(e){return K(e)&&ce.ToInteger(e)===e},isSafeInteger:function isSafeInteger(e){return Number.isInteger(e)&&k(e)<=Number.MAX_SAFE_INTEGER},isNaN:X});h(Number,"parseInt",S.parseInt,Number.parseInt!==S.parseInt);if([,1].find(function(){return true})===1){ne(Array.prototype,"find",et.find)}if([,1].findIndex(function(){return true})!==0){ne(Array.prototype,"findIndex",et.findIndex)}var Ct=Function.bind.call(Function.bind,Object.prototype.propertyIsEnumerable);var Mt=function ensureEnumerable(e,t){if(s&&Ct(e,t)){Object.defineProperty(e,t,{enumerable:false})}};var xt=function sliceArgs(){var e=Number(this);var t=arguments.length;var r=t-e;var n=new Array(r<0?0:r);for(var o=e;o<t;++o){n[o-e]=arguments[o]}return n};var Nt=function assignTo(e){return function assignToSource(t,r){t[r]=e[r];return t}};var At=function(e,t){var r=n(Object(t));var o;if(ce.IsCallable(Object.getOwnPropertySymbols)){o=v(Object.getOwnPropertySymbols(Object(t)),Ct(t))}return p(P(r,o||[]),Nt(t),e)};var Rt={assign:function(e,t){var r=ce.ToObject(e,"Cannot convert undefined or null to object");return p(ce.Call(xt,1,arguments),At,r)},is:function is(e,t){return ce.SameValue(e,t)}};var _t=Object.assign&&Object.preventExtensions&&function(){var e=Object.preventExtensions({1:2});try{Object.assign(e,"xy")}catch(t){return e[1]==="y"}}();if(_t){ne(Object,"assign",Rt.assign)}b(Object,Rt);if(s){var kt={setPrototypeOf:function(e,r){var n;var o=function(e,t){if(!ce.TypeIsObject(e)){throw new TypeError("cannot set prototype on a non-object")}if(!(t===null||ce.TypeIsObject(t))){throw new TypeError("can only set prototype to an object or null"+t)}};var i=function(e,r){o(e,r);t(n,e,r);return e};try{n=e.getOwnPropertyDescriptor(e.prototype,r).set;t(n,{},null)}catch(a){if(e.prototype!=={}[r]){return}n=function(e){this[r]=e};i.polyfill=i(i({},null),e.prototype)instanceof e}return i}(Object,"__proto__")};b(Object,kt)}if(Object.setPrototypeOf&&Object.getPrototypeOf&&Object.getPrototypeOf(Object.setPrototypeOf({},null))!==null&&Object.getPrototypeOf(Object.create(null))===null){(function(){var e=Object.create(null);var t=Object.getPrototypeOf;var r=Object.setPrototypeOf;Object.getPrototypeOf=function(r){var n=t(r);return n===e?null:n};Object.setPrototypeOf=function(t,n){var o=n===null?e:n;return r(t,o)};Object.setPrototypeOf.polyfill=false})()}var Lt=!i(function(){return Object.keys("foo")});if(!Lt){var Ft=Object.keys;ne(Object,"keys",function keys(e){return Ft(ce.ToObject(e))});n=Object.keys}var Dt=i(function(){return Object.keys(/a/g)});if(Dt){var zt=Object.keys;ne(Object,"keys",function keys(e){if(re.regex(e)){var t=[];for(var r in e){if(z(e,r)){M(t,r)}}return t}return zt(e)});n=Object.keys}if(Object.getOwnPropertyNames){var qt=!i(function(){return Object.getOwnPropertyNames("foo")});if(!qt){var Wt=typeof window==="object"?Object.getOwnPropertyNames(window):[];var Gt=Object.getOwnPropertyNames;ne(Object,"getOwnPropertyNames",function getOwnPropertyNames(e){var t=ce.ToObject(e);if(g(t)==="[object Window]"){try{return Gt(t)}catch(r){return P([],Wt)}}return Gt(t)})}}if(Object.getOwnPropertyDescriptor){var Ht=!i(function(){return Object.getOwnPropertyDescriptor("foo","bar")});if(!Ht){var Vt=Object.getOwnPropertyDescriptor;ne(Object,"getOwnPropertyDescriptor",function getOwnPropertyDescriptor(e,t){return Vt(ce.ToObject(e),t)})}}if(Object.seal){var Bt=!i(function(){return Object.seal("foo")});if(!Bt){var Ut=Object.seal;ne(Object,"seal",function seal(e){if(!ce.TypeIsObject(e)){return e}return Ut(e)})}}if(Object.isSealed){var $t=!i(function(){return Object.isSealed("foo")});if(!$t){var Jt=Object.isSealed;ne(Object,"isSealed",function isSealed(e){if(!ce.TypeIsObject(e)){return true}return Jt(e)})}}if(Object.freeze){var Xt=!i(function(){return Object.freeze("foo")});if(!Xt){var Kt=Object.freeze;ne(Object,"freeze",function freeze(e){if(!ce.TypeIsObject(e)){return e}return Kt(e)})}}if(Object.isFrozen){var Zt=!i(function(){return Object.isFrozen("foo")});if(!Zt){var Yt=Object.isFrozen;ne(Object,"isFrozen",function isFrozen(e){if(!ce.TypeIsObject(e)){return true}return Yt(e)})}}if(Object.preventExtensions){var Qt=!i(function(){return Object.preventExtensions("foo")});if(!Qt){var er=Object.preventExtensions;ne(Object,"preventExtensions",function preventExtensions(e){if(!ce.TypeIsObject(e)){return e}return er(e)})}}if(Object.isExtensible){var tr=!i(function(){return Object.isExtensible("foo")});if(!tr){var rr=Object.isExtensible;ne(Object,"isExtensible",function isExtensible(e){if(!ce.TypeIsObject(e)){return false}return rr(e)})}}if(Object.getPrototypeOf){var nr=!i(function(){return Object.getPrototypeOf("foo")});if(!nr){var or=Object.getPrototypeOf;ne(Object,"getPrototypeOf",function getPrototypeOf(e){return or(ce.ToObject(e))})}}var ir=s&&function(){var e=Object.getOwnPropertyDescriptor(RegExp.prototype,"flags");return e&&ce.IsCallable(e.get)}();if(s&&!ir){var ar=function flags(){if(!ce.TypeIsObject(this)){throw new TypeError("Method called on incompatible type: must be an object.")}var e="";if(this.global){e+="g"}if(this.ignoreCase){e+="i"}if(this.multiline){e+="m"}if(this.unicode){e+="u"}if(this.sticky){e+="y"}return e};m.getter(RegExp.prototype,"flags",ar)}var ur=s&&a(function(){return String(new RegExp(/a/g,"i"))==="/a/i"});var fr=oe&&s&&function(){var e=/./;e[$.match]=false;return RegExp(e)===e}();var sr=a(function(){return RegExp.prototype.toString.call({source:"abc"})==="/abc/"});var cr=sr&&a(function(){return RegExp.prototype.toString.call({source:"a",flags:"b"})==="/a/b"});if(!sr||!cr){var lr=RegExp.prototype.toString;h(RegExp.prototype,"toString",function toString(){var e=ce.RequireObjectCoercible(this);if(re.regex(e)){return t(lr,e)}var r=ue(e.source);var n=ue(e.flags);return"/"+r+"/"+n},true);m.preserveToString(RegExp.prototype.toString,lr)}if(s&&(!ur||fr)){var pr=Object.getOwnPropertyDescriptor(RegExp.prototype,"flags").get;var vr=Object.getOwnPropertyDescriptor(RegExp.prototype,"source")||{};var yr=function(){return this.source};var hr=ce.IsCallable(vr.get)?vr.get:yr;var br=RegExp;var gr=function(){return function RegExp(e,t){var r=ce.IsRegExp(e);var n=this instanceof RegExp;if(!n&&r&&typeof t==="undefined"&&e.constructor===RegExp){return e}var o=e;var i=t;if(re.regex(e)){o=ce.Call(hr,e);i=typeof t==="undefined"?ce.Call(pr,e):t;return new RegExp(o,i)}else if(r){o=e.source;i=typeof t==="undefined"?e.flags:t}return new br(e,t)}}();Ee(br,gr,{$input:true});RegExp=gr;m.redefine(S,"RegExp",gr)}if(s){var dr={input:"$_",lastMatch:"$&",lastParen:"$+",leftContext:"$`",rightContext:"$'"};l(n(dr),function(e){if(e in RegExp&&!(dr[e]in RegExp)){m.getter(RegExp,dr[e],function get(){return RegExp[e]})}})}Ce(RegExp);var mr=1/Number.EPSILON;var Or=function roundTiesToEven(e){return e+mr-mr};var wr=Math.pow(2,-23);var jr=Math.pow(2,127)*(2-wr);var Sr=Math.pow(2,-126);var Tr=Math.E;var Ir=Math.LOG2E;var Er=Math.LOG10E;var Pr=Number.prototype.clz;delete Number.prototype.clz;var Cr={acosh:function acosh(e){var t=Number(e);if(X(t)||e<1){return NaN}if(t===1){return 0}if(t===Infinity){return t}var r=1/(t*t);if(t<2){return Y(t-1+D(1-r)*t)}var n=t/2;return Y(n+D(1-r)*n-1)+1/Ir},asinh:function asinh(e){var t=Number(e);if(t===0||!T(t)){return t}var r=k(t);var n=r*r;var o=Z(t);if(r<1){return o*Y(r+n/(D(n+1)+1))}return o*(Y(r/2+D(1+1/n)*r/2-1)+1/Ir)},atanh:function atanh(e){var t=Number(e);if(t===0){return t}if(t===-1){return-Infinity}if(t===1){return Infinity}if(X(t)||t<-1||t>1){return NaN}var r=k(t);return Z(t)*Y(2*r/(1-r))/2},cbrt:function cbrt(e){var t=Number(e);if(t===0){return t}var r=t<0;var n;if(r){t=-t}if(t===Infinity){n=Infinity}else{n=L(F(t)/3);n=(t/(n*n)+2*n)/3}return r?-n:n},clz32:function clz32(e){var t=Number(e);var r=ce.ToUint32(t);if(r===0){return 32}return Pr?ce.Call(Pr,r):31-_(F(r+.5)*Ir)},cosh:function cosh(e){var t=Number(e);if(t===0){return 1}if(X(t)){return NaN}if(!T(t)){return Infinity}var r=L(k(t)-1);return(r+1/(r*Tr*Tr))*(Tr/2)},expm1:function expm1(e){var t=Number(e);if(t===-Infinity){return-1}if(!T(t)||t===0){return t}if(k(t)>.5){return L(t)-1}var r=t;var n=0;var o=1;while(n+r!==n){n+=r;o+=1;r*=t/o}return n},hypot:function hypot(e,t){var r=0;var n=0;for(var o=0;o<arguments.length;++o){var i=k(Number(arguments[o]));if(n<i){r*=n/i*(n/i);r+=1;n=i}else{r+=i>0?i/n*(i/n):i}}return n===Infinity?Infinity:n*D(r)},log2:function log2(e){return F(e)*Ir},log10:function log10(e){return F(e)*Er},log1p:Y,sign:Z,sinh:function sinh(e){var t=Number(e);if(!T(t)||t===0){return t}var r=k(t);if(r<1){var n=Math.expm1(r);return Z(t)*n*(1+1/(n+1))/2}var o=L(r-1);return Z(t)*(o-1/(o*Tr*Tr))*(Tr/2)},tanh:function tanh(e){var t=Number(e);if(X(t)||t===0){return t}if(t>=20){return 1}if(t<=-20){return-1}return(Math.expm1(t)-Math.expm1(-t))/(L(t)+L(-t))},trunc:function trunc(e){var t=Number(e);return t<0?-_(-t):_(t)},imul:function imul(e,t){var r=ce.ToUint32(e);var n=ce.ToUint32(t);var o=r>>>16&65535;var i=r&65535;var a=n>>>16&65535;var u=n&65535;return i*u+(o*u+i*a<<16>>>0)|0},fround:function fround(e){var t=Number(e);if(t===0||t===Infinity||t===-Infinity||X(t)){return t}var r=Z(t);var n=k(t);if(n<Sr){return r*Or(n/Sr/wr)*Sr*wr}var o=(1+wr/Number.EPSILON)*n;var i=o-(o-n);if(i>jr||X(i)){return r*Infinity}return r*i}};var Mr=function withinULPDistance(e,t,r){return k(1-e/t)/Number.EPSILON<(r||8)};b(Math,Cr);h(Math,"sinh",Cr.sinh,Math.sinh(710)===Infinity);h(Math,"cosh",Cr.cosh,Math.cosh(710)===Infinity);h(Math,"log1p",Cr.log1p,Math.log1p(-1e-17)!==-1e-17);h(Math,"asinh",Cr.asinh,Math.asinh(-1e7)!==-Math.asinh(1e7));h(Math,"asinh",Cr.asinh,Math.asinh(1e300)===Infinity);h(Math,"atanh",Cr.atanh,Math.atanh(1e-300)===0);h(Math,"tanh",Cr.tanh,Math.tanh(-2e-17)!==-2e-17);
h(Math,"acosh",Cr.acosh,Math.acosh(Number.MAX_VALUE)===Infinity);h(Math,"acosh",Cr.acosh,!Mr(Math.acosh(1+Number.EPSILON),Math.sqrt(2*Number.EPSILON)));h(Math,"cbrt",Cr.cbrt,!Mr(Math.cbrt(1e-300),1e-100));h(Math,"sinh",Cr.sinh,Math.sinh(-2e-17)!==-2e-17);var xr=Math.expm1(10);h(Math,"expm1",Cr.expm1,xr>22025.465794806718||xr<22025.465794806718);var Nr=Math.round;var Ar=Math.round(.5-Number.EPSILON/4)===0&&Math.round(-.5+Number.EPSILON/3.99)===1;var Rr=mr+1;var _r=2*mr-1;var kr=[Rr,_r].every(function(e){return Math.round(e)===e});h(Math,"round",function round(e){var t=_(e);var r=t===-1?-0:t+1;return e-t<.5?t:r},!Ar||!kr);m.preserveToString(Math.round,Nr);var Lr=Math.imul;if(Math.imul(4294967295,5)!==-5){Math.imul=Cr.imul;m.preserveToString(Math.imul,Lr)}if(Math.imul.length!==2){ne(Math,"imul",function imul(e,t){return ce.Call(Lr,Math,arguments)})}var Fr=function(){var e=S.setTimeout;if(typeof e!=="function"&&typeof e!=="object"){return}ce.IsPromise=function(e){if(!ce.TypeIsObject(e)){return false}if(typeof e._promise==="undefined"){return false}return true};var r=function(e){if(!ce.IsConstructor(e)){throw new TypeError("Bad promise constructor")}var t=this;var r=function(e,r){if(t.resolve!==void 0||t.reject!==void 0){throw new TypeError("Bad Promise implementation!")}t.resolve=e;t.reject=r};t.resolve=void 0;t.reject=void 0;t.promise=new e(r);if(!(ce.IsCallable(t.resolve)&&ce.IsCallable(t.reject))){throw new TypeError("Bad promise constructor")}};var n;if(typeof window!=="undefined"&&ce.IsCallable(window.postMessage)){n=function(){var e=[];var t="zero-timeout-message";var r=function(r){M(e,r);window.postMessage(t,"*")};var n=function(r){if(r.source===window&&r.data===t){r.stopPropagation();if(e.length===0){return}var n=N(e);n()}};window.addEventListener("message",n,true);return r}}var o=function(){var e=S.Promise;var t=e&&e.resolve&&e.resolve();return t&&function(e){return t.then(e)}};var i=ce.IsCallable(S.setImmediate)?S.setImmediate:typeof process==="object"&&process.nextTick?process.nextTick:o()||(ce.IsCallable(n)?n():function(t){e(t,0)});var a=function(e){return e};var u=function(e){throw e};var f=0;var s=1;var c=2;var l=0;var p=1;var v=2;var y={};var h=function(e,t,r){i(function(){g(e,t,r)})};var g=function(e,t,r){var n,o;if(t===y){return e(r)}try{n=e(r);o=t.resolve}catch(i){n=i;o=t.reject}o(n)};var d=function(e,t){var r=e._promise;var n=r.reactionLength;if(n>0){h(r.fulfillReactionHandler0,r.reactionCapability0,t);r.fulfillReactionHandler0=void 0;r.rejectReactions0=void 0;r.reactionCapability0=void 0;if(n>1){for(var o=1,i=0;o<n;o++,i+=3){h(r[i+l],r[i+v],t);e[i+l]=void 0;e[i+p]=void 0;e[i+v]=void 0}}}r.result=t;r.state=s;r.reactionLength=0};var m=function(e,t){var r=e._promise;var n=r.reactionLength;if(n>0){h(r.rejectReactionHandler0,r.reactionCapability0,t);r.fulfillReactionHandler0=void 0;r.rejectReactions0=void 0;r.reactionCapability0=void 0;if(n>1){for(var o=1,i=0;o<n;o++,i+=3){h(r[i+p],r[i+v],t);e[i+l]=void 0;e[i+p]=void 0;e[i+v]=void 0}}}r.result=t;r.state=c;r.reactionLength=0};var O=function(e){var t=false;var r=function(r){var n;if(t){return}t=true;if(r===e){return m(e,new TypeError("Self resolution"))}if(!ce.TypeIsObject(r)){return d(e,r)}try{n=r.then}catch(o){return m(e,o)}if(!ce.IsCallable(n)){return d(e,r)}i(function(){j(e,r,n)})};var n=function(r){if(t){return}t=true;return m(e,r)};return{resolve:r,reject:n}};var w=function(e,r,n,o){if(e===I){t(e,r,n,o,y)}else{t(e,r,n,o)}};var j=function(e,t,r){var n=O(e);var o=n.resolve;var i=n.reject;try{w(r,t,o,i)}catch(a){i(a)}};var T,I;var E=function(){var e=function Promise(t){if(!(this instanceof e)){throw new TypeError('Constructor Promise requires "new"')}if(this&&this._promise){throw new TypeError("Bad construction")}if(!ce.IsCallable(t)){throw new TypeError("not a valid resolver")}var r=Ae(this,e,T,{_promise:{result:void 0,state:f,reactionLength:0,fulfillReactionHandler0:void 0,rejectReactionHandler0:void 0,reactionCapability0:void 0}});var n=O(r);var o=n.reject;try{t(n.resolve,o)}catch(i){o(i)}return r};return e}();T=E.prototype;var P=function(e,t,r,n){var o=false;return function(i){if(o){return}o=true;t[e]=i;if(--n.count===0){var a=r.resolve;a(t)}}};var C=function(e,t,r){var n=e.iterator;var o=[];var i={count:1};var a,u;var f=0;while(true){try{a=ce.IteratorStep(n);if(a===false){e.done=true;break}u=a.value}catch(s){e.done=true;throw s}o[f]=void 0;var c=t.resolve(u);var l=P(f,o,r,i);i.count+=1;w(c.then,c,l,r.reject);f+=1}if(--i.count===0){var p=r.resolve;p(o)}return r.promise};var x=function(e,t,r){var n=e.iterator;var o,i,a;while(true){try{o=ce.IteratorStep(n);if(o===false){e.done=true;break}i=o.value}catch(u){e.done=true;throw u}a=t.resolve(i);w(a.then,a,r.resolve,r.reject)}return r.promise};b(E,{all:function all(e){var t=this;if(!ce.TypeIsObject(t)){throw new TypeError("Promise is not object")}var n=new r(t);var o,i;try{o=ce.GetIterator(e);i={iterator:o,done:false};return C(i,t,n)}catch(a){var u=a;if(i&&!i.done){try{ce.IteratorClose(o,true)}catch(f){u=f}}var s=n.reject;s(u);return n.promise}},race:function race(e){var t=this;if(!ce.TypeIsObject(t)){throw new TypeError("Promise is not object")}var n=new r(t);var o,i;try{o=ce.GetIterator(e);i={iterator:o,done:false};return x(i,t,n)}catch(a){var u=a;if(i&&!i.done){try{ce.IteratorClose(o,true)}catch(f){u=f}}var s=n.reject;s(u);return n.promise}},reject:function reject(e){var t=this;if(!ce.TypeIsObject(t)){throw new TypeError("Bad promise constructor")}var n=new r(t);var o=n.reject;o(e);return n.promise},resolve:function resolve(e){var t=this;if(!ce.TypeIsObject(t)){throw new TypeError("Bad promise constructor")}if(ce.IsPromise(e)){var n=e.constructor;if(n===t){return e}}var o=new r(t);var i=o.resolve;i(e);return o.promise}});b(T,{"catch":function(e){return this.then(null,e)},then:function then(e,t){var n=this;if(!ce.IsPromise(n)){throw new TypeError("not a promise")}var o=ce.SpeciesConstructor(n,E);var i;var b=arguments.length>2&&arguments[2]===y;if(b&&o===E){i=y}else{i=new r(o)}var g=ce.IsCallable(e)?e:a;var d=ce.IsCallable(t)?t:u;var m=n._promise;var O;if(m.state===f){if(m.reactionLength===0){m.fulfillReactionHandler0=g;m.rejectReactionHandler0=d;m.reactionCapability0=i}else{var w=3*(m.reactionLength-1);m[w+l]=g;m[w+p]=d;m[w+v]=i}m.reactionLength+=1}else if(m.state===s){O=m.result;h(g,i,O)}else if(m.state===c){O=m.result;h(d,i,O)}else{throw new TypeError("unexpected Promise state")}return i.promise}});y=new r(E);I=T.then;return E}();if(S.Promise){delete S.Promise.accept;delete S.Promise.defer;delete S.Promise.prototype.chain}if(typeof Fr==="function"){b(S,{Promise:Fr});var Dr=w(S.Promise,function(e){return e.resolve(42).then(function(){})instanceof e});var zr=!i(function(){return S.Promise.reject(42).then(null,5).then(null,W)});var qr=i(function(){return S.Promise.call(3,W)});var Wr=function(e){var t=e.resolve(5);t.constructor={};var r=e.resolve(t);try{r.then(null,W).then(null,W)}catch(n){return true}return t===r}(S.Promise);var Gr=s&&function(){var e=0;var t=Object.defineProperty({},"then",{get:function(){e+=1}});Promise.resolve(t);return e===1}();var Hr=function BadResolverPromise(e){var t=new Promise(e);e(3,function(){});this.then=t.then;this.constructor=BadResolverPromise};Hr.prototype=Promise.prototype;Hr.all=Promise.all;var Vr=a(function(){return!!Hr.all([1,2])});if(!Dr||!zr||!qr||Wr||!Gr||Vr){Promise=Fr;ne(S,"Promise",Fr)}if(Promise.all.length!==1){var Br=Promise.all;ne(Promise,"all",function all(e){return ce.Call(Br,this,arguments)})}if(Promise.race.length!==1){var Ur=Promise.race;ne(Promise,"race",function race(e){return ce.Call(Ur,this,arguments)})}if(Promise.resolve.length!==1){var $r=Promise.resolve;ne(Promise,"resolve",function resolve(e){return ce.Call($r,this,arguments)})}if(Promise.reject.length!==1){var Jr=Promise.reject;ne(Promise,"reject",function reject(e){return ce.Call(Jr,this,arguments)})}Mt(Promise,"all");Mt(Promise,"race");Mt(Promise,"resolve");Mt(Promise,"reject");Ce(Promise)}var Xr=function(e){var t=n(p(e,function(e,t){e[t]=true;return e},{}));return e.join(":")===t.join(":")};var Kr=Xr(["z","a","bb"]);var Zr=Xr(["z",1,"a","3",2]);if(s){var Yr=function fastkey(e,t){if(!t&&!Kr){return null}if(se(e)){return"^"+ce.ToString(e)}else if(typeof e==="string"){return"$"+e}else if(typeof e==="number"){if(!Zr){return"n"+e}return e}else if(typeof e==="boolean"){return"b"+e}return null};var Qr=function emptyObject(){return Object.create?Object.create(null):{}};var en=function addIterableToMap(e,n,o){if(r(o)||re.string(o)){l(o,function(e){if(!ce.TypeIsObject(e)){throw new TypeError("Iterator value "+e+" is not an entry object")}n.set(e[0],e[1])})}else if(o instanceof e){t(e.prototype.forEach,o,function(e,t){n.set(t,e)})}else{var i,a;if(!se(o)){a=n.set;if(!ce.IsCallable(a)){throw new TypeError("bad map")}i=ce.GetIterator(o)}if(typeof i!=="undefined"){while(true){var u=ce.IteratorStep(i);if(u===false){break}var f=u.value;try{if(!ce.TypeIsObject(f)){throw new TypeError("Iterator value "+f+" is not an entry object")}t(a,n,f[0],f[1])}catch(s){ce.IteratorClose(i,true);throw s}}}}};var tn=function addIterableToSet(e,n,o){if(r(o)||re.string(o)){l(o,function(e){n.add(e)})}else if(o instanceof e){t(e.prototype.forEach,o,function(e){n.add(e)})}else{var i,a;if(!se(o)){a=n.add;if(!ce.IsCallable(a)){throw new TypeError("bad set")}i=ce.GetIterator(o)}if(typeof i!=="undefined"){while(true){var u=ce.IteratorStep(i);if(u===false){break}var f=u.value;try{t(a,n,f)}catch(s){ce.IteratorClose(i,true);throw s}}}}};var rn={Map:function(){var e={};var r=function MapEntry(e,t){this.key=e;this.value=t;this.next=null;this.prev=null};r.prototype.isRemoved=function isRemoved(){return this.key===e};var n=function isMap(e){return!!e._es6map};var o=function requireMapSlot(e,t){if(!ce.TypeIsObject(e)||!n(e)){throw new TypeError("Method Map.prototype."+t+" called on incompatible receiver "+ce.ToString(e))}};var i=function MapIterator(e,t){o(e,"[[MapIterator]]");this.head=e._head;this.i=this.head;this.kind=t};i.prototype={isMapIterator:true,next:function next(){if(!this.isMapIterator){throw new TypeError("Not a MapIterator")}var e=this.i;var t=this.kind;var r=this.head;if(typeof this.i==="undefined"){return Ke()}while(e.isRemoved()&&e!==r){e=e.prev}var n;while(e.next!==r){e=e.next;if(!e.isRemoved()){if(t==="key"){n=e.key}else if(t==="value"){n=e.value}else{n=[e.key,e.value]}this.i=e;return Ke(n)}}this.i=void 0;return Ke()}};Me(i.prototype);var a;var u=function Map(){if(!(this instanceof Map)){throw new TypeError('Constructor Map requires "new"')}if(this&&this._es6map){throw new TypeError("Bad construction")}var e=Ae(this,Map,a,{_es6map:true,_head:null,_map:G?new G:null,_size:0,_storage:Qr()});var t=new r(null,null);t.next=t.prev=t;e._head=t;if(arguments.length>0){en(Map,e,arguments[0])}return e};a=u.prototype;m.getter(a,"size",function(){if(typeof this._size==="undefined"){throw new TypeError("size method called on incompatible Map")}return this._size});b(a,{get:function get(e){o(this,"get");var t;var r=Yr(e,true);if(r!==null){t=this._storage[r];if(t){return t.value}else{return}}if(this._map){t=V.call(this._map,e);if(t){return t.value}else{return}}var n=this._head;var i=n;while((i=i.next)!==n){if(ce.SameValueZero(i.key,e)){return i.value}}},has:function has(e){o(this,"has");var t=Yr(e,true);if(t!==null){return typeof this._storage[t]!=="undefined"}if(this._map){return B.call(this._map,e)}var r=this._head;var n=r;while((n=n.next)!==r){if(ce.SameValueZero(n.key,e)){return true}}return false},set:function set(e,t){o(this,"set");var n=this._head;var i=n;var a;var u=Yr(e,true);if(u!==null){if(typeof this._storage[u]!=="undefined"){this._storage[u].value=t;return this}else{a=this._storage[u]=new r(e,t);i=n.prev}}else if(this._map){if(B.call(this._map,e)){V.call(this._map,e).value=t}else{a=new r(e,t);U.call(this._map,e,a);i=n.prev}}while((i=i.next)!==n){if(ce.SameValueZero(i.key,e)){i.value=t;return this}}a=a||new r(e,t);if(ce.SameValue(-0,e)){a.key=+0}a.next=this._head;a.prev=this._head.prev;a.prev.next=a;a.next.prev=a;this._size+=1;return this},"delete":function(t){o(this,"delete");var r=this._head;var n=r;var i=Yr(t,true);if(i!==null){if(typeof this._storage[i]==="undefined"){return false}n=this._storage[i].prev;delete this._storage[i]}else if(this._map){if(!B.call(this._map,t)){return false}n=V.call(this._map,t).prev;H.call(this._map,t)}while((n=n.next)!==r){if(ce.SameValueZero(n.key,t)){n.key=e;n.value=e;n.prev.next=n.next;n.next.prev=n.prev;this._size-=1;return true}}return false},clear:function clear(){o(this,"clear");this._map=G?new G:null;this._size=0;this._storage=Qr();var t=this._head;var r=t;var n=r.next;while((r=n)!==t){r.key=e;r.value=e;n=r.next;r.next=r.prev=t}t.next=t.prev=t},keys:function keys(){o(this,"keys");return new i(this,"key")},values:function values(){o(this,"values");return new i(this,"value")},entries:function entries(){o(this,"entries");return new i(this,"key+value")},forEach:function forEach(e){o(this,"forEach");var r=arguments.length>1?arguments[1]:null;var n=this.entries();for(var i=n.next();!i.done;i=n.next()){if(r){t(e,r,i.value[1],i.value[0],this)}else{e(i.value[1],i.value[0],this)}}}});Me(a,a.entries);return u}(),Set:function(){var e=function isSet(e){return e._es6set&&typeof e._storage!=="undefined"};var r=function requireSetSlot(t,r){if(!ce.TypeIsObject(t)||!e(t)){throw new TypeError("Set.prototype."+r+" called on incompatible receiver "+ce.ToString(t))}};var o;var i=function Set(){if(!(this instanceof Set)){throw new TypeError('Constructor Set requires "new"')}if(this&&this._es6set){throw new TypeError("Bad construction")}var e=Ae(this,Set,o,{_es6set:true,"[[SetData]]":null,_storage:Qr()});if(!e._es6set){throw new TypeError("bad set")}if(arguments.length>0){tn(Set,e,arguments[0])}return e};o=i.prototype;var a=function(e){var t=e;if(t==="^null"){return null}else if(t==="^undefined"){return void 0}else{var r=t.charAt(0);if(r==="$"){return C(t,1)}else if(r==="n"){return+C(t,1)}else if(r==="b"){return t==="btrue"}}return+t};var u=function ensureMap(e){if(!e["[[SetData]]"]){var t=new rn.Map;e["[[SetData]]"]=t;l(n(e._storage),function(e){var r=a(e);t.set(r,r)});e["[[SetData]]"]=t}e._storage=null};m.getter(i.prototype,"size",function(){r(this,"size");if(this._storage){return n(this._storage).length}u(this);return this["[[SetData]]"].size});b(i.prototype,{has:function has(e){r(this,"has");var t;if(this._storage&&(t=Yr(e))!==null){return!!this._storage[t]}u(this);return this["[[SetData]]"].has(e)},add:function add(e){r(this,"add");var t;if(this._storage&&(t=Yr(e))!==null){this._storage[t]=true;return this}u(this);this["[[SetData]]"].set(e,e);return this},"delete":function(e){r(this,"delete");var t;if(this._storage&&(t=Yr(e))!==null){var n=z(this._storage,t);return delete this._storage[t]&&n}u(this);return this["[[SetData]]"]["delete"](e)},clear:function clear(){r(this,"clear");if(this._storage){this._storage=Qr()}if(this["[[SetData]]"]){this["[[SetData]]"].clear()}},values:function values(){r(this,"values");u(this);return new f(this["[[SetData]]"].values())},entries:function entries(){r(this,"entries");u(this);return new f(this["[[SetData]]"].entries())},forEach:function forEach(e){r(this,"forEach");var n=arguments.length>1?arguments[1]:null;var o=this;u(o);this["[[SetData]]"].forEach(function(r,i){if(n){t(e,n,i,i,o)}else{e(i,i,o)}})}});h(i.prototype,"keys",i.prototype.values,true);Me(i.prototype,i.prototype.values);var f=function SetIterator(e){this.it=e};f.prototype={isSetIterator:true,next:function next(){if(!this.isSetIterator){throw new TypeError("Not a SetIterator")}return this.it.next()}};Me(f.prototype);return i}()};var nn=S.Set&&!Set.prototype["delete"]&&Set.prototype.remove&&Set.prototype.items&&Set.prototype.map&&Array.isArray((new Set).keys);if(nn){S.Set=rn.Set}if(S.Map||S.Set){var on=a(function(){return new Map([[1,2]]).get(1)===2});if(!on){S.Map=function Map(){if(!(this instanceof Map)){throw new TypeError('Constructor Map requires "new"')}var e=new G;if(arguments.length>0){en(Map,e,arguments[0])}delete e.constructor;Object.setPrototypeOf(e,S.Map.prototype);return e};S.Map.prototype=O(G.prototype);h(S.Map.prototype,"constructor",S.Map,true);m.preserveToString(S.Map,G)}var an=new Map;var un=function(){var e=new Map([[1,0],[2,0],[3,0],[4,0]]);e.set(-0,e);return e.get(0)===e&&e.get(-0)===e&&e.has(0)&&e.has(-0)}();var fn=an.set(1,2)===an;if(!un||!fn){ne(Map.prototype,"set",function set(e,r){t(U,this,e===0?0:e,r);return this})}if(!un){b(Map.prototype,{get:function get(e){return t(V,this,e===0?0:e)},has:function has(e){return t(B,this,e===0?0:e)}},true);m.preserveToString(Map.prototype.get,V);m.preserveToString(Map.prototype.has,B)}var sn=new Set;var cn=Set.prototype["delete"]&&Set.prototype.add&&Set.prototype.has&&function(e){e["delete"](0);e.add(-0);return!e.has(0)}(sn);var ln=sn.add(1)===sn;if(!cn||!ln){var pn=Set.prototype.add;Set.prototype.add=function add(e){t(pn,this,e===0?0:e);return this};m.preserveToString(Set.prototype.add,pn)}if(!cn){var vn=Set.prototype.has;Set.prototype.has=function has(e){return t(vn,this,e===0?0:e)};m.preserveToString(Set.prototype.has,vn);var yn=Set.prototype["delete"];Set.prototype["delete"]=function SetDelete(e){return t(yn,this,e===0?0:e)};m.preserveToString(Set.prototype["delete"],yn)}var hn=w(S.Map,function(e){var t=new e([]);t.set(42,42);return t instanceof e});var bn=Object.setPrototypeOf&&!hn;var gn=function(){try{return!(S.Map()instanceof S.Map)}catch(e){return e instanceof TypeError}}();if(S.Map.length!==0||bn||!gn){S.Map=function Map(){if(!(this instanceof Map)){throw new TypeError('Constructor Map requires "new"')}var e=new G;if(arguments.length>0){en(Map,e,arguments[0])}delete e.constructor;Object.setPrototypeOf(e,Map.prototype);return e};S.Map.prototype=G.prototype;h(S.Map.prototype,"constructor",S.Map,true);m.preserveToString(S.Map,G)}var dn=w(S.Set,function(e){var t=new e([]);t.add(42,42);return t instanceof e});var mn=Object.setPrototypeOf&&!dn;var On=function(){try{return!(S.Set()instanceof S.Set)}catch(e){return e instanceof TypeError}}();if(S.Set.length!==0||mn||!On){var wn=S.Set;S.Set=function Set(){if(!(this instanceof Set)){throw new TypeError('Constructor Set requires "new"')}var e=new wn;if(arguments.length>0){tn(Set,e,arguments[0])}delete e.constructor;Object.setPrototypeOf(e,Set.prototype);return e};S.Set.prototype=wn.prototype;h(S.Set.prototype,"constructor",S.Set,true);m.preserveToString(S.Set,wn)}var jn=new S.Map;var Sn=!a(function(){return jn.keys().next().done});if(typeof S.Map.prototype.clear!=="function"||(new S.Set).size!==0||jn.size!==0||typeof S.Map.prototype.keys!=="function"||typeof S.Set.prototype.keys!=="function"||typeof S.Map.prototype.forEach!=="function"||typeof S.Set.prototype.forEach!=="function"||u(S.Map)||u(S.Set)||typeof jn.keys().next!=="function"||Sn||!hn){b(S,{Map:rn.Map,Set:rn.Set},true)}if(S.Set.prototype.keys!==S.Set.prototype.values){h(S.Set.prototype,"keys",S.Set.prototype.values,true)}Me(Object.getPrototypeOf((new S.Map).keys()));Me(Object.getPrototypeOf((new S.Set).keys()));if(c&&S.Set.prototype.has.name!=="has"){var Tn=S.Set.prototype.has;ne(S.Set.prototype,"has",function has(e){return t(Tn,this,e)})}}b(S,rn);Ce(S.Map);Ce(S.Set)}var In=function throwUnlessTargetIsObject(e){if(!ce.TypeIsObject(e)){throw new TypeError("target must be an object")}};var En={apply:function apply(){return ce.Call(ce.Call,null,arguments)},construct:function construct(e,t){if(!ce.IsConstructor(e)){throw new TypeError("First argument must be a constructor.")}var r=arguments.length>2?arguments[2]:e;if(!ce.IsConstructor(r)){throw new TypeError("new.target must be a constructor.")}return ce.Construct(e,t,r,"internal")},deleteProperty:function deleteProperty(e,t){In(e);if(s){var r=Object.getOwnPropertyDescriptor(e,t);if(r&&!r.configurable){return false}}return delete e[t]},has:function has(e,t){In(e);return t in e}};if(Object.getOwnPropertyNames){Object.assign(En,{ownKeys:function ownKeys(e){In(e);var t=Object.getOwnPropertyNames(e);if(ce.IsCallable(Object.getOwnPropertySymbols)){x(t,Object.getOwnPropertySymbols(e))}return t}})}var Pn=function ConvertExceptionToBoolean(e){return!i(e)};if(Object.preventExtensions){Object.assign(En,{isExtensible:function isExtensible(e){In(e);return Object.isExtensible(e)},preventExtensions:function preventExtensions(e){In(e);return Pn(function(){return Object.preventExtensions(e)})}})}if(s){var Cn=function get(e,t,r){var n=Object.getOwnPropertyDescriptor(e,t);if(!n){var o=Object.getPrototypeOf(e);if(o===null){return void 0}return Cn(o,t,r)}if("value"in n){return n.value}if(n.get){return ce.Call(n.get,r)}return void 0};var Mn=function set(e,r,n,o){var i=Object.getOwnPropertyDescriptor(e,r);if(!i){var a=Object.getPrototypeOf(e);if(a!==null){return Mn(a,r,n,o)}i={value:void 0,writable:true,enumerable:true,configurable:true}}if("value"in i){if(!i.writable){return false}if(!ce.TypeIsObject(o)){return false}var u=Object.getOwnPropertyDescriptor(o,r);if(u){return ae.defineProperty(o,r,{value:n})}else{return ae.defineProperty(o,r,{value:n,writable:true,enumerable:true,configurable:true})}}if(i.set){t(i.set,o,n);return true}return false};Object.assign(En,{defineProperty:function defineProperty(e,t,r){In(e);return Pn(function(){return Object.defineProperty(e,t,r)})},getOwnPropertyDescriptor:function getOwnPropertyDescriptor(e,t){In(e);return Object.getOwnPropertyDescriptor(e,t)},get:function get(e,t){In(e);var r=arguments.length>2?arguments[2]:e;return Cn(e,t,r)},set:function set(e,t,r){In(e);var n=arguments.length>3?arguments[3]:e;return Mn(e,t,r,n)}})}if(Object.getPrototypeOf){var xn=Object.getPrototypeOf;En.getPrototypeOf=function getPrototypeOf(e){In(e);return xn(e)}}if(Object.setPrototypeOf&&En.getPrototypeOf){var Nn=function(e,t){var r=t;while(r){if(e===r){return true}r=En.getPrototypeOf(r)}return false};Object.assign(En,{setPrototypeOf:function setPrototypeOf(e,t){In(e);if(t!==null&&!ce.TypeIsObject(t)){throw new TypeError("proto must be an object or null")}if(t===ae.getPrototypeOf(e)){return true}if(ae.isExtensible&&!ae.isExtensible(e)){return false}if(Nn(e,t)){return false}Object.setPrototypeOf(e,t);return true}})}var An=function(e,t){if(!ce.IsCallable(S.Reflect[e])){h(S.Reflect,e,t)}else{var r=a(function(){S.Reflect[e](1);S.Reflect[e](NaN);S.Reflect[e](true);return true});if(r){ne(S.Reflect,e,t)}}};Object.keys(En).forEach(function(e){An(e,En[e])});var Rn=S.Reflect.getPrototypeOf;if(c&&Rn&&Rn.name!=="getPrototypeOf"){ne(S.Reflect,"getPrototypeOf",function getPrototypeOf(e){return t(Rn,S.Reflect,e)})}if(S.Reflect.setPrototypeOf){if(a(function(){S.Reflect.setPrototypeOf(1,{});return true})){ne(S.Reflect,"setPrototypeOf",En.setPrototypeOf)}}if(S.Reflect.defineProperty){if(!a(function(){var e=!S.Reflect.defineProperty(1,"test",{value:1});var t=typeof Object.preventExtensions!=="function"||!S.Reflect.defineProperty(Object.preventExtensions({}),"test",{});return e&&t})){ne(S.Reflect,"defineProperty",En.defineProperty)}}if(S.Reflect.construct){if(!a(function(){var e=function F(){};return S.Reflect.construct(function(){},[],e)instanceof e})){ne(S.Reflect,"construct",En.construct)}}if(String(new Date(NaN))!=="Invalid Date"){var _n=Date.prototype.toString;var kn=function toString(){var e=+this;if(e!==e){return"Invalid Date"}return ce.Call(_n,this)};ne(Date.prototype,"toString",kn)}var Ln={anchor:function anchor(e){return ce.CreateHTML(this,"a","name",e)},big:function big(){return ce.CreateHTML(this,"big","","")},blink:function blink(){return ce.CreateHTML(this,"blink","","")},bold:function bold(){return ce.CreateHTML(this,"b","","")},fixed:function fixed(){return ce.CreateHTML(this,"tt","","")},fontcolor:function fontcolor(e){return ce.CreateHTML(this,"font","color",e)},fontsize:function fontsize(e){return ce.CreateHTML(this,"font","size",e)},italics:function italics(){return ce.CreateHTML(this,"i","","")},link:function link(e){return ce.CreateHTML(this,"a","href",e)},small:function small(){return ce.CreateHTML(this,"small","","")},strike:function strike(){return ce.CreateHTML(this,"strike","","")},sub:function sub(){return ce.CreateHTML(this,"sub","","")},sup:function sub(){return ce.CreateHTML(this,"sup","","")}};l(Object.keys(Ln),function(e){var r=String.prototype[e];var n=false;if(ce.IsCallable(r)){var o=t(r,"",' " ');var i=P([],o.match(/"/g)).length;n=o!==o.toLowerCase()||i>2}else{n=true}if(n){ne(String.prototype,e,Ln[e])}});var Fn=function(){if(!oe){return false}var e=typeof JSON==="object"&&typeof JSON.stringify==="function"?JSON.stringify:null;if(!e){return false}if(typeof e($())!=="undefined"){return true}if(e([$()])!=="[null]"){return true}var t={a:$()};t[$()]=true;if(e(t)!=="{}"){return true}return false}();var Dn=a(function(){if(!oe){return true}return JSON.stringify(Object($()))==="{}"&&JSON.stringify([Object($())])==="[{}]"});if(Fn||!Dn){var zn=JSON.stringify;ne(JSON,"stringify",function stringify(e){if(typeof e==="symbol"){return}var n;if(arguments.length>1){n=arguments[1]}var o=[e];if(!r(n)){var i=ce.IsCallable(n)?n:null;var a=function(e,r){var n=i?t(i,this,e,r):r;if(typeof n!=="symbol"){if(re.symbol(n)){return Nt({})(n)}else{return n}}};o.push(a)}else{o.push(n)}if(arguments.length>2){o.push(arguments[2])}return zn.apply(this,o)})}return S});
/*! jQuery v3.7.1 | (c) OpenJS Foundation and other contributors | jquery.org/license */
!function(e,t){"use strict";"object"==typeof module&&"object"==typeof module.exports?module.exports=e.document?t(e,!0):function(e){if(!e.document)throw new Error("jQuery requires a window with a document");return t(e)}:t(e)}("undefined"!=typeof window?window:this,function(ie,e){"use strict";var oe=[],r=Object.getPrototypeOf,ae=oe.slice,g=oe.flat?function(e){return oe.flat.call(e)}:function(e){return oe.concat.apply([],e)},s=oe.push,se=oe.indexOf,n={},i=n.toString,ue=n.hasOwnProperty,o=ue.toString,a=o.call(Object),le={},v=function(e){return"function"==typeof e&&"number"!=typeof e.nodeType&&"function"!=typeof e.item},y=function(e){return null!=e&&e===e.window},C=ie.document,u={type:!0,src:!0,nonce:!0,noModule:!0};function m(e,t,n){var r,i,o=(n=n||C).createElement("script");if(o.text=e,t)for(r in u)(i=t[r]||t.getAttribute&&t.getAttribute(r))&&o.setAttribute(r,i);n.head.appendChild(o).parentNode.removeChild(o)}function x(e){return null==e?e+"":"object"==typeof e||"function"==typeof e?n[i.call(e)]||"object":typeof e}var t="3.7.1",l=/HTML$/i,ce=function(e,t){return new ce.fn.init(e,t)};function c(e){var t=!!e&&"length"in e&&e.length,n=x(e);return!v(e)&&!y(e)&&("array"===n||0===t||"number"==typeof t&&0<t&&t-1 in e)}function fe(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()}ce.fn=ce.prototype={jquery:t,constructor:ce,length:0,toArray:function(){return ae.call(this)},get:function(e){return null==e?ae.call(this):e<0?this[e+this.length]:this[e]},pushStack:function(e){var t=ce.merge(this.constructor(),e);return t.prevObject=this,t},each:function(e){return ce.each(this,e)},map:function(n){return this.pushStack(ce.map(this,function(e,t){return n.call(e,t,e)}))},slice:function(){return this.pushStack(ae.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},even:function(){return this.pushStack(ce.grep(this,function(e,t){return(t+1)%2}))},odd:function(){return this.pushStack(ce.grep(this,function(e,t){return t%2}))},eq:function(e){var t=this.length,n=+e+(e<0?t:0);return this.pushStack(0<=n&&n<t?[this[n]]:[])},end:function(){return this.prevObject||this.constructor()},push:s,sort:oe.sort,splice:oe.splice},ce.extend=ce.fn.extend=function(){var e,t,n,r,i,o,a=arguments[0]||{},s=1,u=arguments.length,l=!1;for("boolean"==typeof a&&(l=a,a=arguments[s]||{},s++),"object"==typeof a||v(a)||(a={}),s===u&&(a=this,s--);s<u;s++)if(null!=(e=arguments[s]))for(t in e)r=e[t],"__proto__"!==t&&a!==r&&(l&&r&&(ce.isPlainObject(r)||(i=Array.isArray(r)))?(n=a[t],o=i&&!Array.isArray(n)?[]:i||ce.isPlainObject(n)?n:{},i=!1,a[t]=ce.extend(l,o,r)):void 0!==r&&(a[t]=r));return a},ce.extend({expando:"jQuery"+(t+Math.random()).replace(/\D/g,""),isReady:!0,error:function(e){throw new Error(e)},noop:function(){},isPlainObject:function(e){var t,n;return!(!e||"[object Object]"!==i.call(e))&&(!(t=r(e))||"function"==typeof(n=ue.call(t,"constructor")&&t.constructor)&&o.call(n)===a)},isEmptyObject:function(e){var t;for(t in e)return!1;return!0},globalEval:function(e,t,n){m(e,{nonce:t&&t.nonce},n)},each:function(e,t){var n,r=0;if(c(e)){for(n=e.length;r<n;r++)if(!1===t.call(e[r],r,e[r]))break}else for(r in e)if(!1===t.call(e[r],r,e[r]))break;return e},text:function(e){var t,n="",r=0,i=e.nodeType;if(!i)while(t=e[r++])n+=ce.text(t);return 1===i||11===i?e.textContent:9===i?e.documentElement.textContent:3===i||4===i?e.nodeValue:n},makeArray:function(e,t){var n=t||[];return null!=e&&(c(Object(e))?ce.merge(n,"string"==typeof e?[e]:e):s.call(n,e)),n},inArray:function(e,t,n){return null==t?-1:se.call(t,e,n)},isXMLDoc:function(e){var t=e&&e.namespaceURI,n=e&&(e.ownerDocument||e).documentElement;return!l.test(t||n&&n.nodeName||"HTML")},merge:function(e,t){for(var n=+t.length,r=0,i=e.length;r<n;r++)e[i++]=t[r];return e.length=i,e},grep:function(e,t,n){for(var r=[],i=0,o=e.length,a=!n;i<o;i++)!t(e[i],i)!==a&&r.push(e[i]);return r},map:function(e,t,n){var r,i,o=0,a=[];if(c(e))for(r=e.length;o<r;o++)null!=(i=t(e[o],o,n))&&a.push(i);else for(o in e)null!=(i=t(e[o],o,n))&&a.push(i);return g(a)},guid:1,support:le}),"function"==typeof Symbol&&(ce.fn[Symbol.iterator]=oe[Symbol.iterator]),ce.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),function(e,t){n["[object "+t+"]"]=t.toLowerCase()});var pe=oe.pop,de=oe.sort,he=oe.splice,ge="[\\x20\\t\\r\\n\\f]",ve=new RegExp("^"+ge+"+|((?:^|[^\\\\])(?:\\\\.)*)"+ge+"+$","g");ce.contains=function(e,t){var n=t&&t.parentNode;return e===n||!(!n||1!==n.nodeType||!(e.contains?e.contains(n):e.compareDocumentPosition&&16&e.compareDocumentPosition(n)))};var f=/([\0-\x1f\x7f]|^-?\d)|^-$|[^\x80-\uFFFF\w-]/g;function p(e,t){return t?"\0"===e?"\ufffd":e.slice(0,-1)+"\\"+e.charCodeAt(e.length-1).toString(16)+" ":"\\"+e}ce.escapeSelector=function(e){return(e+"").replace(f,p)};var ye=C,me=s;!function(){var e,b,w,o,a,T,r,C,d,i,k=me,S=ce.expando,E=0,n=0,s=W(),c=W(),u=W(),h=W(),l=function(e,t){return e===t&&(a=!0),0},f="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",t="(?:\\\\[\\da-fA-F]{1,6}"+ge+"?|\\\\[^\\r\\n\\f]|[\\w-]|[^\0-\\x7f])+",p="\\["+ge+"*("+t+")(?:"+ge+"*([*^$|!~]?=)"+ge+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+t+"))|)"+ge+"*\\]",g=":("+t+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+p+")*)|.*)\\)|)",v=new RegExp(ge+"+","g"),y=new RegExp("^"+ge+"*,"+ge+"*"),m=new RegExp("^"+ge+"*([>+~]|"+ge+")"+ge+"*"),x=new RegExp(ge+"|>"),j=new RegExp(g),A=new RegExp("^"+t+"$"),D={ID:new RegExp("^#("+t+")"),CLASS:new RegExp("^\\.("+t+")"),TAG:new RegExp("^("+t+"|[*])"),ATTR:new RegExp("^"+p),PSEUDO:new RegExp("^"+g),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+ge+"*(even|odd|(([+-]|)(\\d*)n|)"+ge+"*(?:([+-]|)"+ge+"*(\\d+)|))"+ge+"*\\)|)","i"),bool:new RegExp("^(?:"+f+")$","i"),needsContext:new RegExp("^"+ge+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+ge+"*((?:-\\d)?\\d*)"+ge+"*\\)|)(?=[^-]|$)","i")},N=/^(?:input|select|textarea|button)$/i,q=/^h\d$/i,L=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,H=/[+~]/,O=new RegExp("\\\\[\\da-fA-F]{1,6}"+ge+"?|\\\\([^\\r\\n\\f])","g"),P=function(e,t){var n="0x"+e.slice(1)-65536;return t||(n<0?String.fromCharCode(n+65536):String.fromCharCode(n>>10|55296,1023&n|56320))},M=function(){V()},R=J(function(e){return!0===e.disabled&&fe(e,"fieldset")},{dir:"parentNode",next:"legend"});try{k.apply(oe=ae.call(ye.childNodes),ye.childNodes),oe[ye.childNodes.length].nodeType}catch(e){k={apply:function(e,t){me.apply(e,ae.call(t))},call:function(e){me.apply(e,ae.call(arguments,1))}}}function I(t,e,n,r){var i,o,a,s,u,l,c,f=e&&e.ownerDocument,p=e?e.nodeType:9;if(n=n||[],"string"!=typeof t||!t||1!==p&&9!==p&&11!==p)return n;if(!r&&(V(e),e=e||T,C)){if(11!==p&&(u=L.exec(t)))if(i=u[1]){if(9===p){if(!(a=e.getElementById(i)))return n;if(a.id===i)return k.call(n,a),n}else if(f&&(a=f.getElementById(i))&&I.contains(e,a)&&a.id===i)return k.call(n,a),n}else{if(u[2])return k.apply(n,e.getElementsByTagName(t)),n;if((i=u[3])&&e.getElementsByClassName)return k.apply(n,e.getElementsByClassName(i)),n}if(!(h[t+" "]||d&&d.test(t))){if(c=t,f=e,1===p&&(x.test(t)||m.test(t))){(f=H.test(t)&&U(e.parentNode)||e)==e&&le.scope||((s=e.getAttribute("id"))?s=ce.escapeSelector(s):e.setAttribute("id",s=S)),o=(l=Y(t)).length;while(o--)l[o]=(s?"#"+s:":scope")+" "+Q(l[o]);c=l.join(",")}try{return k.apply(n,f.querySelectorAll(c)),n}catch(e){h(t,!0)}finally{s===S&&e.removeAttribute("id")}}}return re(t.replace(ve,"$1"),e,n,r)}function W(){var r=[];return function e(t,n){return r.push(t+" ")>b.cacheLength&&delete e[r.shift()],e[t+" "]=n}}function F(e){return e[S]=!0,e}function $(e){var t=T.createElement("fieldset");try{return!!e(t)}catch(e){return!1}finally{t.parentNode&&t.parentNode.removeChild(t),t=null}}function B(t){return function(e){return fe(e,"input")&&e.type===t}}function _(t){return function(e){return(fe(e,"input")||fe(e,"button"))&&e.type===t}}function z(t){return function(e){return"form"in e?e.parentNode&&!1===e.disabled?"label"in e?"label"in e.parentNode?e.parentNode.disabled===t:e.disabled===t:e.isDisabled===t||e.isDisabled!==!t&&R(e)===t:e.disabled===t:"label"in e&&e.disabled===t}}function X(a){return F(function(o){return o=+o,F(function(e,t){var n,r=a([],e.length,o),i=r.length;while(i--)e[n=r[i]]&&(e[n]=!(t[n]=e[n]))})})}function U(e){return e&&"undefined"!=typeof e.getElementsByTagName&&e}function V(e){var t,n=e?e.ownerDocument||e:ye;return n!=T&&9===n.nodeType&&n.documentElement&&(r=(T=n).documentElement,C=!ce.isXMLDoc(T),i=r.matches||r.webkitMatchesSelector||r.msMatchesSelector,r.msMatchesSelector&&ye!=T&&(t=T.defaultView)&&t.top!==t&&t.addEventListener("unload",M),le.getById=$(function(e){return r.appendChild(e).id=ce.expando,!T.getElementsByName||!T.getElementsByName(ce.expando).length}),le.disconnectedMatch=$(function(e){return i.call(e,"*")}),le.scope=$(function(){return T.querySelectorAll(":scope")}),le.cssHas=$(function(){try{return T.querySelector(":has(*,:jqfake)"),!1}catch(e){return!0}}),le.getById?(b.filter.ID=function(e){var t=e.replace(O,P);return function(e){return e.getAttribute("id")===t}},b.find.ID=function(e,t){if("undefined"!=typeof t.getElementById&&C){var n=t.getElementById(e);return n?[n]:[]}}):(b.filter.ID=function(e){var n=e.replace(O,P);return function(e){var t="undefined"!=typeof e.getAttributeNode&&e.getAttributeNode("id");return t&&t.value===n}},b.find.ID=function(e,t){if("undefined"!=typeof t.getElementById&&C){var n,r,i,o=t.getElementById(e);if(o){if((n=o.getAttributeNode("id"))&&n.value===e)return[o];i=t.getElementsByName(e),r=0;while(o=i[r++])if((n=o.getAttributeNode("id"))&&n.value===e)return[o]}return[]}}),b.find.TAG=function(e,t){return"undefined"!=typeof t.getElementsByTagName?t.getElementsByTagName(e):t.querySelectorAll(e)},b.find.CLASS=function(e,t){if("undefined"!=typeof t.getElementsByClassName&&C)return t.getElementsByClassName(e)},d=[],$(function(e){var t;r.appendChild(e).innerHTML="<a id='"+S+"' href='' disabled='disabled'></a><select id='"+S+"-\r\\' disabled='disabled'><option selected=''></option></select>",e.querySelectorAll("[selected]").length||d.push("\\["+ge+"*(?:value|"+f+")"),e.querySelectorAll("[id~="+S+"-]").length||d.push("~="),e.querySelectorAll("a#"+S+"+*").length||d.push(".#.+[+~]"),e.querySelectorAll(":checked").length||d.push(":checked"),(t=T.createElement("input")).setAttribute("type","hidden"),e.appendChild(t).setAttribute("name","D"),r.appendChild(e).disabled=!0,2!==e.querySelectorAll(":disabled").length&&d.push(":enabled",":disabled"),(t=T.createElement("input")).setAttribute("name",""),e.appendChild(t),e.querySelectorAll("[name='']").length||d.push("\\["+ge+"*name"+ge+"*="+ge+"*(?:''|\"\")")}),le.cssHas||d.push(":has"),d=d.length&&new RegExp(d.join("|")),l=function(e,t){if(e===t)return a=!0,0;var n=!e.compareDocumentPosition-!t.compareDocumentPosition;return n||(1&(n=(e.ownerDocument||e)==(t.ownerDocument||t)?e.compareDocumentPosition(t):1)||!le.sortDetached&&t.compareDocumentPosition(e)===n?e===T||e.ownerDocument==ye&&I.contains(ye,e)?-1:t===T||t.ownerDocument==ye&&I.contains(ye,t)?1:o?se.call(o,e)-se.call(o,t):0:4&n?-1:1)}),T}for(e in I.matches=function(e,t){return I(e,null,null,t)},I.matchesSelector=function(e,t){if(V(e),C&&!h[t+" "]&&(!d||!d.test(t)))try{var n=i.call(e,t);if(n||le.disconnectedMatch||e.document&&11!==e.document.nodeType)return n}catch(e){h(t,!0)}return 0<I(t,T,null,[e]).length},I.contains=function(e,t){return(e.ownerDocument||e)!=T&&V(e),ce.contains(e,t)},I.attr=function(e,t){(e.ownerDocument||e)!=T&&V(e);var n=b.attrHandle[t.toLowerCase()],r=n&&ue.call(b.attrHandle,t.toLowerCase())?n(e,t,!C):void 0;return void 0!==r?r:e.getAttribute(t)},I.error=function(e){throw new Error("Syntax error, unrecognized expression: "+e)},ce.uniqueSort=function(e){var t,n=[],r=0,i=0;if(a=!le.sortStable,o=!le.sortStable&&ae.call(e,0),de.call(e,l),a){while(t=e[i++])t===e[i]&&(r=n.push(i));while(r--)he.call(e,n[r],1)}return o=null,e},ce.fn.uniqueSort=function(){return this.pushStack(ce.uniqueSort(ae.apply(this)))},(b=ce.expr={cacheLength:50,createPseudo:F,match:D,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace(O,P),e[3]=(e[3]||e[4]||e[5]||"").replace(O,P),"~="===e[2]&&(e[3]=" "+e[3]+" "),e.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),"nth"===e[1].slice(0,3)?(e[3]||I.error(e[0]),e[4]=+(e[4]?e[5]+(e[6]||1):2*("even"===e[3]||"odd"===e[3])),e[5]=+(e[7]+e[8]||"odd"===e[3])):e[3]&&I.error(e[0]),e},PSEUDO:function(e){var t,n=!e[6]&&e[2];return D.CHILD.test(e[0])?null:(e[3]?e[2]=e[4]||e[5]||"":n&&j.test(n)&&(t=Y(n,!0))&&(t=n.indexOf(")",n.length-t)-n.length)&&(e[0]=e[0].slice(0,t),e[2]=n.slice(0,t)),e.slice(0,3))}},filter:{TAG:function(e){var t=e.replace(O,P).toLowerCase();return"*"===e?function(){return!0}:function(e){return fe(e,t)}},CLASS:function(e){var t=s[e+" "];return t||(t=new RegExp("(^|"+ge+")"+e+"("+ge+"|$)"))&&s(e,function(e){return t.test("string"==typeof e.className&&e.className||"undefined"!=typeof e.getAttribute&&e.getAttribute("class")||"")})},ATTR:function(n,r,i){return function(e){var t=I.attr(e,n);return null==t?"!="===r:!r||(t+="","="===r?t===i:"!="===r?t!==i:"^="===r?i&&0===t.indexOf(i):"*="===r?i&&-1<t.indexOf(i):"$="===r?i&&t.slice(-i.length)===i:"~="===r?-1<(" "+t.replace(v," ")+" ").indexOf(i):"|="===r&&(t===i||t.slice(0,i.length+1)===i+"-"))}},CHILD:function(d,e,t,h,g){var v="nth"!==d.slice(0,3),y="last"!==d.slice(-4),m="of-type"===e;return 1===h&&0===g?function(e){return!!e.parentNode}:function(e,t,n){var r,i,o,a,s,u=v!==y?"nextSibling":"previousSibling",l=e.parentNode,c=m&&e.nodeName.toLowerCase(),f=!n&&!m,p=!1;if(l){if(v){while(u){o=e;while(o=o[u])if(m?fe(o,c):1===o.nodeType)return!1;s=u="only"===d&&!s&&"nextSibling"}return!0}if(s=[y?l.firstChild:l.lastChild],y&&f){p=(a=(r=(i=l[S]||(l[S]={}))[d]||[])[0]===E&&r[1])&&r[2],o=a&&l.childNodes[a];while(o=++a&&o&&o[u]||(p=a=0)||s.pop())if(1===o.nodeType&&++p&&o===e){i[d]=[E,a,p];break}}else if(f&&(p=a=(r=(i=e[S]||(e[S]={}))[d]||[])[0]===E&&r[1]),!1===p)while(o=++a&&o&&o[u]||(p=a=0)||s.pop())if((m?fe(o,c):1===o.nodeType)&&++p&&(f&&((i=o[S]||(o[S]={}))[d]=[E,p]),o===e))break;return(p-=g)===h||p%h==0&&0<=p/h}}},PSEUDO:function(e,o){var t,a=b.pseudos[e]||b.setFilters[e.toLowerCase()]||I.error("unsupported pseudo: "+e);return a[S]?a(o):1<a.length?(t=[e,e,"",o],b.setFilters.hasOwnProperty(e.toLowerCase())?F(function(e,t){var n,r=a(e,o),i=r.length;while(i--)e[n=se.call(e,r[i])]=!(t[n]=r[i])}):function(e){return a(e,0,t)}):a}},pseudos:{not:F(function(e){var r=[],i=[],s=ne(e.replace(ve,"$1"));return s[S]?F(function(e,t,n,r){var i,o=s(e,null,r,[]),a=e.length;while(a--)(i=o[a])&&(e[a]=!(t[a]=i))}):function(e,t,n){return r[0]=e,s(r,null,n,i),r[0]=null,!i.pop()}}),has:F(function(t){return function(e){return 0<I(t,e).length}}),contains:F(function(t){return t=t.replace(O,P),function(e){return-1<(e.textContent||ce.text(e)).indexOf(t)}}),lang:F(function(n){return A.test(n||"")||I.error("unsupported lang: "+n),n=n.replace(O,P).toLowerCase(),function(e){var t;do{if(t=C?e.lang:e.getAttribute("xml:lang")||e.getAttribute("lang"))return(t=t.toLowerCase())===n||0===t.indexOf(n+"-")}while((e=e.parentNode)&&1===e.nodeType);return!1}}),target:function(e){var t=ie.location&&ie.location.hash;return t&&t.slice(1)===e.id},root:function(e){return e===r},focus:function(e){return e===function(){try{return T.activeElement}catch(e){}}()&&T.hasFocus()&&!!(e.type||e.href||~e.tabIndex)},enabled:z(!1),disabled:z(!0),checked:function(e){return fe(e,"input")&&!!e.checked||fe(e,"option")&&!!e.selected},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,!0===e.selected},empty:function(e){for(e=e.firstChild;e;e=e.nextSibling)if(e.nodeType<6)return!1;return!0},parent:function(e){return!b.pseudos.empty(e)},header:function(e){return q.test(e.nodeName)},input:function(e){return N.test(e.nodeName)},button:function(e){return fe(e,"input")&&"button"===e.type||fe(e,"button")},text:function(e){var t;return fe(e,"input")&&"text"===e.type&&(null==(t=e.getAttribute("type"))||"text"===t.toLowerCase())},first:X(function(){return[0]}),last:X(function(e,t){return[t-1]}),eq:X(function(e,t,n){return[n<0?n+t:n]}),even:X(function(e,t){for(var n=0;n<t;n+=2)e.push(n);return e}),odd:X(function(e,t){for(var n=1;n<t;n+=2)e.push(n);return e}),lt:X(function(e,t,n){var r;for(r=n<0?n+t:t<n?t:n;0<=--r;)e.push(r);return e}),gt:X(function(e,t,n){for(var r=n<0?n+t:n;++r<t;)e.push(r);return e})}}).pseudos.nth=b.pseudos.eq,{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})b.pseudos[e]=B(e);for(e in{submit:!0,reset:!0})b.pseudos[e]=_(e);function G(){}function Y(e,t){var n,r,i,o,a,s,u,l=c[e+" "];if(l)return t?0:l.slice(0);a=e,s=[],u=b.preFilter;while(a){for(o in n&&!(r=y.exec(a))||(r&&(a=a.slice(r[0].length)||a),s.push(i=[])),n=!1,(r=m.exec(a))&&(n=r.shift(),i.push({value:n,type:r[0].replace(ve," ")}),a=a.slice(n.length)),b.filter)!(r=D[o].exec(a))||u[o]&&!(r=u[o](r))||(n=r.shift(),i.push({value:n,type:o,matches:r}),a=a.slice(n.length));if(!n)break}return t?a.length:a?I.error(e):c(e,s).slice(0)}function Q(e){for(var t=0,n=e.length,r="";t<n;t++)r+=e[t].value;return r}function J(a,e,t){var s=e.dir,u=e.next,l=u||s,c=t&&"parentNode"===l,f=n++;return e.first?function(e,t,n){while(e=e[s])if(1===e.nodeType||c)return a(e,t,n);return!1}:function(e,t,n){var r,i,o=[E,f];if(n){while(e=e[s])if((1===e.nodeType||c)&&a(e,t,n))return!0}else while(e=e[s])if(1===e.nodeType||c)if(i=e[S]||(e[S]={}),u&&fe(e,u))e=e[s]||e;else{if((r=i[l])&&r[0]===E&&r[1]===f)return o[2]=r[2];if((i[l]=o)[2]=a(e,t,n))return!0}return!1}}function K(i){return 1<i.length?function(e,t,n){var r=i.length;while(r--)if(!i[r](e,t,n))return!1;return!0}:i[0]}function Z(e,t,n,r,i){for(var o,a=[],s=0,u=e.length,l=null!=t;s<u;s++)(o=e[s])&&(n&&!n(o,r,i)||(a.push(o),l&&t.push(s)));return a}function ee(d,h,g,v,y,e){return v&&!v[S]&&(v=ee(v)),y&&!y[S]&&(y=ee(y,e)),F(function(e,t,n,r){var i,o,a,s,u=[],l=[],c=t.length,f=e||function(e,t,n){for(var r=0,i=t.length;r<i;r++)I(e,t[r],n);return n}(h||"*",n.nodeType?[n]:n,[]),p=!d||!e&&h?f:Z(f,u,d,n,r);if(g?g(p,s=y||(e?d:c||v)?[]:t,n,r):s=p,v){i=Z(s,l),v(i,[],n,r),o=i.length;while(o--)(a=i[o])&&(s[l[o]]=!(p[l[o]]=a))}if(e){if(y||d){if(y){i=[],o=s.length;while(o--)(a=s[o])&&i.push(p[o]=a);y(null,s=[],i,r)}o=s.length;while(o--)(a=s[o])&&-1<(i=y?se.call(e,a):u[o])&&(e[i]=!(t[i]=a))}}else s=Z(s===t?s.splice(c,s.length):s),y?y(null,t,s,r):k.apply(t,s)})}function te(e){for(var i,t,n,r=e.length,o=b.relative[e[0].type],a=o||b.relative[" "],s=o?1:0,u=J(function(e){return e===i},a,!0),l=J(function(e){return-1<se.call(i,e)},a,!0),c=[function(e,t,n){var r=!o&&(n||t!=w)||((i=t).nodeType?u(e,t,n):l(e,t,n));return i=null,r}];s<r;s++)if(t=b.relative[e[s].type])c=[J(K(c),t)];else{if((t=b.filter[e[s].type].apply(null,e[s].matches))[S]){for(n=++s;n<r;n++)if(b.relative[e[n].type])break;return ee(1<s&&K(c),1<s&&Q(e.slice(0,s-1).concat({value:" "===e[s-2].type?"*":""})).replace(ve,"$1"),t,s<n&&te(e.slice(s,n)),n<r&&te(e=e.slice(n)),n<r&&Q(e))}c.push(t)}return K(c)}function ne(e,t){var n,v,y,m,x,r,i=[],o=[],a=u[e+" "];if(!a){t||(t=Y(e)),n=t.length;while(n--)(a=te(t[n]))[S]?i.push(a):o.push(a);(a=u(e,(v=o,m=0<(y=i).length,x=0<v.length,r=function(e,t,n,r,i){var o,a,s,u=0,l="0",c=e&&[],f=[],p=w,d=e||x&&b.find.TAG("*",i),h=E+=null==p?1:Math.random()||.1,g=d.length;for(i&&(w=t==T||t||i);l!==g&&null!=(o=d[l]);l++){if(x&&o){a=0,t||o.ownerDocument==T||(V(o),n=!C);while(s=v[a++])if(s(o,t||T,n)){k.call(r,o);break}i&&(E=h)}m&&((o=!s&&o)&&u--,e&&c.push(o))}if(u+=l,m&&l!==u){a=0;while(s=y[a++])s(c,f,t,n);if(e){if(0<u)while(l--)c[l]||f[l]||(f[l]=pe.call(r));f=Z(f)}k.apply(r,f),i&&!e&&0<f.length&&1<u+y.length&&ce.uniqueSort(r)}return i&&(E=h,w=p),c},m?F(r):r))).selector=e}return a}function re(e,t,n,r){var i,o,a,s,u,l="function"==typeof e&&e,c=!r&&Y(e=l.selector||e);if(n=n||[],1===c.length){if(2<(o=c[0]=c[0].slice(0)).length&&"ID"===(a=o[0]).type&&9===t.nodeType&&C&&b.relative[o[1].type]){if(!(t=(b.find.ID(a.matches[0].replace(O,P),t)||[])[0]))return n;l&&(t=t.parentNode),e=e.slice(o.shift().value.length)}i=D.needsContext.test(e)?0:o.length;while(i--){if(a=o[i],b.relative[s=a.type])break;if((u=b.find[s])&&(r=u(a.matches[0].replace(O,P),H.test(o[0].type)&&U(t.parentNode)||t))){if(o.splice(i,1),!(e=r.length&&Q(o)))return k.apply(n,r),n;break}}}return(l||ne(e,c))(r,t,!C,n,!t||H.test(e)&&U(t.parentNode)||t),n}G.prototype=b.filters=b.pseudos,b.setFilters=new G,le.sortStable=S.split("").sort(l).join("")===S,V(),le.sortDetached=$(function(e){return 1&e.compareDocumentPosition(T.createElement("fieldset"))}),ce.find=I,ce.expr[":"]=ce.expr.pseudos,ce.unique=ce.uniqueSort,I.compile=ne,I.select=re,I.setDocument=V,I.tokenize=Y,I.escape=ce.escapeSelector,I.getText=ce.text,I.isXML=ce.isXMLDoc,I.selectors=ce.expr,I.support=ce.support,I.uniqueSort=ce.uniqueSort}();var d=function(e,t,n){var r=[],i=void 0!==n;while((e=e[t])&&9!==e.nodeType)if(1===e.nodeType){if(i&&ce(e).is(n))break;r.push(e)}return r},h=function(e,t){for(var n=[];e;e=e.nextSibling)1===e.nodeType&&e!==t&&n.push(e);return n},b=ce.expr.match.needsContext,w=/^<([a-z][^\/\0>:\x20\t\r\n\f]*)[\x20\t\r\n\f]*\/?>(?:<\/\1>|)$/i;function T(e,n,r){return v(n)?ce.grep(e,function(e,t){return!!n.call(e,t,e)!==r}):n.nodeType?ce.grep(e,function(e){return e===n!==r}):"string"!=typeof n?ce.grep(e,function(e){return-1<se.call(n,e)!==r}):ce.filter(n,e,r)}ce.filter=function(e,t,n){var r=t[0];return n&&(e=":not("+e+")"),1===t.length&&1===r.nodeType?ce.find.matchesSelector(r,e)?[r]:[]:ce.find.matches(e,ce.grep(t,function(e){return 1===e.nodeType}))},ce.fn.extend({find:function(e){var t,n,r=this.length,i=this;if("string"!=typeof e)return this.pushStack(ce(e).filter(function(){for(t=0;t<r;t++)if(ce.contains(i[t],this))return!0}));for(n=this.pushStack([]),t=0;t<r;t++)ce.find(e,i[t],n);return 1<r?ce.uniqueSort(n):n},filter:function(e){return this.pushStack(T(this,e||[],!1))},not:function(e){return this.pushStack(T(this,e||[],!0))},is:function(e){return!!T(this,"string"==typeof e&&b.test(e)?ce(e):e||[],!1).length}});var k,S=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]+))$/;(ce.fn.init=function(e,t,n){var r,i;if(!e)return this;if(n=n||k,"string"==typeof e){if(!(r="<"===e[0]&&">"===e[e.length-1]&&3<=e.length?[null,e,null]:S.exec(e))||!r[1]&&t)return!t||t.jquery?(t||n).find(e):this.constructor(t).find(e);if(r[1]){if(t=t instanceof ce?t[0]:t,ce.merge(this,ce.parseHTML(r[1],t&&t.nodeType?t.ownerDocument||t:C,!0)),w.test(r[1])&&ce.isPlainObject(t))for(r in t)v(this[r])?this[r](t[r]):this.attr(r,t[r]);return this}return(i=C.getElementById(r[2]))&&(this[0]=i,this.length=1),this}return e.nodeType?(this[0]=e,this.length=1,this):v(e)?void 0!==n.ready?n.ready(e):e(ce):ce.makeArray(e,this)}).prototype=ce.fn,k=ce(C);var E=/^(?:parents|prev(?:Until|All))/,j={children:!0,contents:!0,next:!0,prev:!0};function A(e,t){while((e=e[t])&&1!==e.nodeType);return e}ce.fn.extend({has:function(e){var t=ce(e,this),n=t.length;return this.filter(function(){for(var e=0;e<n;e++)if(ce.contains(this,t[e]))return!0})},closest:function(e,t){var n,r=0,i=this.length,o=[],a="string"!=typeof e&&ce(e);if(!b.test(e))for(;r<i;r++)for(n=this[r];n&&n!==t;n=n.parentNode)if(n.nodeType<11&&(a?-1<a.index(n):1===n.nodeType&&ce.find.matchesSelector(n,e))){o.push(n);break}return this.pushStack(1<o.length?ce.uniqueSort(o):o)},index:function(e){return e?"string"==typeof e?se.call(ce(e),this[0]):se.call(this,e.jquery?e[0]:e):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(e,t){return this.pushStack(ce.uniqueSort(ce.merge(this.get(),ce(e,t))))},addBack:function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}}),ce.each({parent:function(e){var t=e.parentNode;return t&&11!==t.nodeType?t:null},parents:function(e){return d(e,"parentNode")},parentsUntil:function(e,t,n){return d(e,"parentNode",n)},next:function(e){return A(e,"nextSibling")},prev:function(e){return A(e,"previousSibling")},nextAll:function(e){return d(e,"nextSibling")},prevAll:function(e){return d(e,"previousSibling")},nextUntil:function(e,t,n){return d(e,"nextSibling",n)},prevUntil:function(e,t,n){return d(e,"previousSibling",n)},siblings:function(e){return h((e.parentNode||{}).firstChild,e)},children:function(e){return h(e.firstChild)},contents:function(e){return null!=e.contentDocument&&r(e.contentDocument)?e.contentDocument:(fe(e,"template")&&(e=e.content||e),ce.merge([],e.childNodes))}},function(r,i){ce.fn[r]=function(e,t){var n=ce.map(this,i,e);return"Until"!==r.slice(-5)&&(t=e),t&&"string"==typeof t&&(n=ce.filter(t,n)),1<this.length&&(j[r]||ce.uniqueSort(n),E.test(r)&&n.reverse()),this.pushStack(n)}});var D=/[^\x20\t\r\n\f]+/g;function N(e){return e}function q(e){throw e}function L(e,t,n,r){var i;try{e&&v(i=e.promise)?i.call(e).done(t).fail(n):e&&v(i=e.then)?i.call(e,t,n):t.apply(void 0,[e].slice(r))}catch(e){n.apply(void 0,[e])}}ce.Callbacks=function(r){var e,n;r="string"==typeof r?(e=r,n={},ce.each(e.match(D)||[],function(e,t){n[t]=!0}),n):ce.extend({},r);var i,t,o,a,s=[],u=[],l=-1,c=function(){for(a=a||r.once,o=i=!0;u.length;l=-1){t=u.shift();while(++l<s.length)!1===s[l].apply(t[0],t[1])&&r.stopOnFalse&&(l=s.length,t=!1)}r.memory||(t=!1),i=!1,a&&(s=t?[]:"")},f={add:function(){return s&&(t&&!i&&(l=s.length-1,u.push(t)),function n(e){ce.each(e,function(e,t){v(t)?r.unique&&f.has(t)||s.push(t):t&&t.length&&"string"!==x(t)&&n(t)})}(arguments),t&&!i&&c()),this},remove:function(){return ce.each(arguments,function(e,t){var n;while(-1<(n=ce.inArray(t,s,n)))s.splice(n,1),n<=l&&l--}),this},has:function(e){return e?-1<ce.inArray(e,s):0<s.length},empty:function(){return s&&(s=[]),this},disable:function(){return a=u=[],s=t="",this},disabled:function(){return!s},lock:function(){return a=u=[],t||i||(s=t=""),this},locked:function(){return!!a},fireWith:function(e,t){return a||(t=[e,(t=t||[]).slice?t.slice():t],u.push(t),i||c()),this},fire:function(){return f.fireWith(this,arguments),this},fired:function(){return!!o}};return f},ce.extend({Deferred:function(e){var o=[["notify","progress",ce.Callbacks("memory"),ce.Callbacks("memory"),2],["resolve","done",ce.Callbacks("once memory"),ce.Callbacks("once memory"),0,"resolved"],["reject","fail",ce.Callbacks("once memory"),ce.Callbacks("once memory"),1,"rejected"]],i="pending",a={state:function(){return i},always:function(){return s.done(arguments).fail(arguments),this},"catch":function(e){return a.then(null,e)},pipe:function(){var i=arguments;return ce.Deferred(function(r){ce.each(o,function(e,t){var n=v(i[t[4]])&&i[t[4]];s[t[1]](function(){var e=n&&n.apply(this,arguments);e&&v(e.promise)?e.promise().progress(r.notify).done(r.resolve).fail(r.reject):r[t[0]+"With"](this,n?[e]:arguments)})}),i=null}).promise()},then:function(t,n,r){var u=0;function l(i,o,a,s){return function(){var n=this,r=arguments,e=function(){var e,t;if(!(i<u)){if((e=a.apply(n,r))===o.promise())throw new TypeError("Thenable self-resolution");t=e&&("object"==typeof e||"function"==typeof e)&&e.then,v(t)?s?t.call(e,l(u,o,N,s),l(u,o,q,s)):(u++,t.call(e,l(u,o,N,s),l(u,o,q,s),l(u,o,N,o.notifyWith))):(a!==N&&(n=void 0,r=[e]),(s||o.resolveWith)(n,r))}},t=s?e:function(){try{e()}catch(e){ce.Deferred.exceptionHook&&ce.Deferred.exceptionHook(e,t.error),u<=i+1&&(a!==q&&(n=void 0,r=[e]),o.rejectWith(n,r))}};i?t():(ce.Deferred.getErrorHook?t.error=ce.Deferred.getErrorHook():ce.Deferred.getStackHook&&(t.error=ce.Deferred.getStackHook()),ie.setTimeout(t))}}return ce.Deferred(function(e){o[0][3].add(l(0,e,v(r)?r:N,e.notifyWith)),o[1][3].add(l(0,e,v(t)?t:N)),o[2][3].add(l(0,e,v(n)?n:q))}).promise()},promise:function(e){return null!=e?ce.extend(e,a):a}},s={};return ce.each(o,function(e,t){var n=t[2],r=t[5];a[t[1]]=n.add,r&&n.add(function(){i=r},o[3-e][2].disable,o[3-e][3].disable,o[0][2].lock,o[0][3].lock),n.add(t[3].fire),s[t[0]]=function(){return s[t[0]+"With"](this===s?void 0:this,arguments),this},s[t[0]+"With"]=n.fireWith}),a.promise(s),e&&e.call(s,s),s},when:function(e){var n=arguments.length,t=n,r=Array(t),i=ae.call(arguments),o=ce.Deferred(),a=function(t){return function(e){r[t]=this,i[t]=1<arguments.length?ae.call(arguments):e,--n||o.resolveWith(r,i)}};if(n<=1&&(L(e,o.done(a(t)).resolve,o.reject,!n),"pending"===o.state()||v(i[t]&&i[t].then)))return o.then();while(t--)L(i[t],a(t),o.reject);return o.promise()}});var H=/^(Eval|Internal|Range|Reference|Syntax|Type|URI)Error$/;ce.Deferred.exceptionHook=function(e,t){ie.console&&ie.console.warn&&e&&H.test(e.name)&&ie.console.warn("jQuery.Deferred exception: "+e.message,e.stack,t)},ce.readyException=function(e){ie.setTimeout(function(){throw e})};var O=ce.Deferred();function P(){C.removeEventListener("DOMContentLoaded",P),ie.removeEventListener("load",P),ce.ready()}ce.fn.ready=function(e){return O.then(e)["catch"](function(e){ce.readyException(e)}),this},ce.extend({isReady:!1,readyWait:1,ready:function(e){(!0===e?--ce.readyWait:ce.isReady)||(ce.isReady=!0)!==e&&0<--ce.readyWait||O.resolveWith(C,[ce])}}),ce.ready.then=O.then,"complete"===C.readyState||"loading"!==C.readyState&&!C.documentElement.doScroll?ie.setTimeout(ce.ready):(C.addEventListener("DOMContentLoaded",P),ie.addEventListener("load",P));var M=function(e,t,n,r,i,o,a){var s=0,u=e.length,l=null==n;if("object"===x(n))for(s in i=!0,n)M(e,t,s,n[s],!0,o,a);else if(void 0!==r&&(i=!0,v(r)||(a=!0),l&&(a?(t.call(e,r),t=null):(l=t,t=function(e,t,n){return l.call(ce(e),n)})),t))for(;s<u;s++)t(e[s],n,a?r:r.call(e[s],s,t(e[s],n)));return i?e:l?t.call(e):u?t(e[0],n):o},R=/^-ms-/,I=/-([a-z])/g;function W(e,t){return t.toUpperCase()}function F(e){return e.replace(R,"ms-").replace(I,W)}var $=function(e){return 1===e.nodeType||9===e.nodeType||!+e.nodeType};function B(){this.expando=ce.expando+B.uid++}B.uid=1,B.prototype={cache:function(e){var t=e[this.expando];return t||(t={},$(e)&&(e.nodeType?e[this.expando]=t:Object.defineProperty(e,this.expando,{value:t,configurable:!0}))),t},set:function(e,t,n){var r,i=this.cache(e);if("string"==typeof t)i[F(t)]=n;else for(r in t)i[F(r)]=t[r];return i},get:function(e,t){return void 0===t?this.cache(e):e[this.expando]&&e[this.expando][F(t)]},access:function(e,t,n){return void 0===t||t&&"string"==typeof t&&void 0===n?this.get(e,t):(this.set(e,t,n),void 0!==n?n:t)},remove:function(e,t){var n,r=e[this.expando];if(void 0!==r){if(void 0!==t){n=(t=Array.isArray(t)?t.map(F):(t=F(t))in r?[t]:t.match(D)||[]).length;while(n--)delete r[t[n]]}(void 0===t||ce.isEmptyObject(r))&&(e.nodeType?e[this.expando]=void 0:delete e[this.expando])}},hasData:function(e){var t=e[this.expando];return void 0!==t&&!ce.isEmptyObject(t)}};var _=new B,z=new B,X=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,U=/[A-Z]/g;function V(e,t,n){var r,i;if(void 0===n&&1===e.nodeType)if(r="data-"+t.replace(U,"-$&").toLowerCase(),"string"==typeof(n=e.getAttribute(r))){try{n="true"===(i=n)||"false"!==i&&("null"===i?null:i===+i+""?+i:X.test(i)?JSON.parse(i):i)}catch(e){}z.set(e,t,n)}else n=void 0;return n}ce.extend({hasData:function(e){return z.hasData(e)||_.hasData(e)},data:function(e,t,n){return z.access(e,t,n)},removeData:function(e,t){z.remove(e,t)},_data:function(e,t,n){return _.access(e,t,n)},_removeData:function(e,t){_.remove(e,t)}}),ce.fn.extend({data:function(n,e){var t,r,i,o=this[0],a=o&&o.attributes;if(void 0===n){if(this.length&&(i=z.get(o),1===o.nodeType&&!_.get(o,"hasDataAttrs"))){t=a.length;while(t--)a[t]&&0===(r=a[t].name).indexOf("data-")&&(r=F(r.slice(5)),V(o,r,i[r]));_.set(o,"hasDataAttrs",!0)}return i}return"object"==typeof n?this.each(function(){z.set(this,n)}):M(this,function(e){var t;if(o&&void 0===e)return void 0!==(t=z.get(o,n))?t:void 0!==(t=V(o,n))?t:void 0;this.each(function(){z.set(this,n,e)})},null,e,1<arguments.length,null,!0)},removeData:function(e){return this.each(function(){z.remove(this,e)})}}),ce.extend({queue:function(e,t,n){var r;if(e)return t=(t||"fx")+"queue",r=_.get(e,t),n&&(!r||Array.isArray(n)?r=_.access(e,t,ce.makeArray(n)):r.push(n)),r||[]},dequeue:function(e,t){t=t||"fx";var n=ce.queue(e,t),r=n.length,i=n.shift(),o=ce._queueHooks(e,t);"inprogress"===i&&(i=n.shift(),r--),i&&("fx"===t&&n.unshift("inprogress"),delete o.stop,i.call(e,function(){ce.dequeue(e,t)},o)),!r&&o&&o.empty.fire()},_queueHooks:function(e,t){var n=t+"queueHooks";return _.get(e,n)||_.access(e,n,{empty:ce.Callbacks("once memory").add(function(){_.remove(e,[t+"queue",n])})})}}),ce.fn.extend({queue:function(t,n){var e=2;return"string"!=typeof t&&(n=t,t="fx",e--),arguments.length<e?ce.queue(this[0],t):void 0===n?this:this.each(function(){var e=ce.queue(this,t,n);ce._queueHooks(this,t),"fx"===t&&"inprogress"!==e[0]&&ce.dequeue(this,t)})},dequeue:function(e){return this.each(function(){ce.dequeue(this,e)})},clearQueue:function(e){return this.queue(e||"fx",[])},promise:function(e,t){var n,r=1,i=ce.Deferred(),o=this,a=this.length,s=function(){--r||i.resolveWith(o,[o])};"string"!=typeof e&&(t=e,e=void 0),e=e||"fx";while(a--)(n=_.get(o[a],e+"queueHooks"))&&n.empty&&(r++,n.empty.add(s));return s(),i.promise(t)}});var G=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,Y=new RegExp("^(?:([+-])=|)("+G+")([a-z%]*)$","i"),Q=["Top","Right","Bottom","Left"],J=C.documentElement,K=function(e){return ce.contains(e.ownerDocument,e)},Z={composed:!0};J.getRootNode&&(K=function(e){return ce.contains(e.ownerDocument,e)||e.getRootNode(Z)===e.ownerDocument});var ee=function(e,t){return"none"===(e=t||e).style.display||""===e.style.display&&K(e)&&"none"===ce.css(e,"display")};function te(e,t,n,r){var i,o,a=20,s=r?function(){return r.cur()}:function(){return ce.css(e,t,"")},u=s(),l=n&&n[3]||(ce.cssNumber[t]?"":"px"),c=e.nodeType&&(ce.cssNumber[t]||"px"!==l&&+u)&&Y.exec(ce.css(e,t));if(c&&c[3]!==l){u/=2,l=l||c[3],c=+u||1;while(a--)ce.style(e,t,c+l),(1-o)*(1-(o=s()/u||.5))<=0&&(a=0),c/=o;c*=2,ce.style(e,t,c+l),n=n||[]}return n&&(c=+c||+u||0,i=n[1]?c+(n[1]+1)*n[2]:+n[2],r&&(r.unit=l,r.start=c,r.end=i)),i}var ne={};function re(e,t){for(var n,r,i,o,a,s,u,l=[],c=0,f=e.length;c<f;c++)(r=e[c]).style&&(n=r.style.display,t?("none"===n&&(l[c]=_.get(r,"display")||null,l[c]||(r.style.display="")),""===r.style.display&&ee(r)&&(l[c]=(u=a=o=void 0,a=(i=r).ownerDocument,s=i.nodeName,(u=ne[s])||(o=a.body.appendChild(a.createElement(s)),u=ce.css(o,"display"),o.parentNode.removeChild(o),"none"===u&&(u="block"),ne[s]=u)))):"none"!==n&&(l[c]="none",_.set(r,"display",n)));for(c=0;c<f;c++)null!=l[c]&&(e[c].style.display=l[c]);return e}ce.fn.extend({show:function(){return re(this,!0)},hide:function(){return re(this)},toggle:function(e){return"boolean"==typeof e?e?this.show():this.hide():this.each(function(){ee(this)?ce(this).show():ce(this).hide()})}});var xe,be,we=/^(?:checkbox|radio)$/i,Te=/<([a-z][^\/\0>\x20\t\r\n\f]*)/i,Ce=/^$|^module$|\/(?:java|ecma)script/i;xe=C.createDocumentFragment().appendChild(C.createElement("div")),(be=C.createElement("input")).setAttribute("type","radio"),be.setAttribute("checked","checked"),be.setAttribute("name","t"),xe.appendChild(be),le.checkClone=xe.cloneNode(!0).cloneNode(!0).lastChild.checked,xe.innerHTML="<textarea>x</textarea>",le.noCloneChecked=!!xe.cloneNode(!0).lastChild.defaultValue,xe.innerHTML="<option></option>",le.option=!!xe.lastChild;var ke={thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};function Se(e,t){var n;return n="undefined"!=typeof e.getElementsByTagName?e.getElementsByTagName(t||"*"):"undefined"!=typeof e.querySelectorAll?e.querySelectorAll(t||"*"):[],void 0===t||t&&fe(e,t)?ce.merge([e],n):n}function Ee(e,t){for(var n=0,r=e.length;n<r;n++)_.set(e[n],"globalEval",!t||_.get(t[n],"globalEval"))}ke.tbody=ke.tfoot=ke.colgroup=ke.caption=ke.thead,ke.th=ke.td,le.option||(ke.optgroup=ke.option=[1,"<select multiple='multiple'>","</select>"]);var je=/<|&#?\w+;/;function Ae(e,t,n,r,i){for(var o,a,s,u,l,c,f=t.createDocumentFragment(),p=[],d=0,h=e.length;d<h;d++)if((o=e[d])||0===o)if("object"===x(o))ce.merge(p,o.nodeType?[o]:o);else if(je.test(o)){a=a||f.appendChild(t.createElement("div")),s=(Te.exec(o)||["",""])[1].toLowerCase(),u=ke[s]||ke._default,a.innerHTML=u[1]+ce.htmlPrefilter(o)+u[2],c=u[0];while(c--)a=a.lastChild;ce.merge(p,a.childNodes),(a=f.firstChild).textContent=""}else p.push(t.createTextNode(o));f.textContent="",d=0;while(o=p[d++])if(r&&-1<ce.inArray(o,r))i&&i.push(o);else if(l=K(o),a=Se(f.appendChild(o),"script"),l&&Ee(a),n){c=0;while(o=a[c++])Ce.test(o.type||"")&&n.push(o)}return f}var De=/^([^.]*)(?:\.(.+)|)/;function Ne(){return!0}function qe(){return!1}function Le(e,t,n,r,i,o){var a,s;if("object"==typeof t){for(s in"string"!=typeof n&&(r=r||n,n=void 0),t)Le(e,s,n,r,t[s],o);return e}if(null==r&&null==i?(i=n,r=n=void 0):null==i&&("string"==typeof n?(i=r,r=void 0):(i=r,r=n,n=void 0)),!1===i)i=qe;else if(!i)return e;return 1===o&&(a=i,(i=function(e){return ce().off(e),a.apply(this,arguments)}).guid=a.guid||(a.guid=ce.guid++)),e.each(function(){ce.event.add(this,t,i,r,n)})}function He(e,r,t){t?(_.set(e,r,!1),ce.event.add(e,r,{namespace:!1,handler:function(e){var t,n=_.get(this,r);if(1&e.isTrigger&&this[r]){if(n)(ce.event.special[r]||{}).delegateType&&e.stopPropagation();else if(n=ae.call(arguments),_.set(this,r,n),this[r](),t=_.get(this,r),_.set(this,r,!1),n!==t)return e.stopImmediatePropagation(),e.preventDefault(),t}else n&&(_.set(this,r,ce.event.trigger(n[0],n.slice(1),this)),e.stopPropagation(),e.isImmediatePropagationStopped=Ne)}})):void 0===_.get(e,r)&&ce.event.add(e,r,Ne)}ce.event={global:{},add:function(t,e,n,r,i){var o,a,s,u,l,c,f,p,d,h,g,v=_.get(t);if($(t)){n.handler&&(n=(o=n).handler,i=o.selector),i&&ce.find.matchesSelector(J,i),n.guid||(n.guid=ce.guid++),(u=v.events)||(u=v.events=Object.create(null)),(a=v.handle)||(a=v.handle=function(e){return"undefined"!=typeof ce&&ce.event.triggered!==e.type?ce.event.dispatch.apply(t,arguments):void 0}),l=(e=(e||"").match(D)||[""]).length;while(l--)d=g=(s=De.exec(e[l])||[])[1],h=(s[2]||"").split(".").sort(),d&&(f=ce.event.special[d]||{},d=(i?f.delegateType:f.bindType)||d,f=ce.event.special[d]||{},c=ce.extend({type:d,origType:g,data:r,handler:n,guid:n.guid,selector:i,needsContext:i&&ce.expr.match.needsContext.test(i),namespace:h.join(".")},o),(p=u[d])||((p=u[d]=[]).delegateCount=0,f.setup&&!1!==f.setup.call(t,r,h,a)||t.addEventListener&&t.addEventListener(d,a)),f.add&&(f.add.call(t,c),c.handler.guid||(c.handler.guid=n.guid)),i?p.splice(p.delegateCount++,0,c):p.push(c),ce.event.global[d]=!0)}},remove:function(e,t,n,r,i){var o,a,s,u,l,c,f,p,d,h,g,v=_.hasData(e)&&_.get(e);if(v&&(u=v.events)){l=(t=(t||"").match(D)||[""]).length;while(l--)if(d=g=(s=De.exec(t[l])||[])[1],h=(s[2]||"").split(".").sort(),d){f=ce.event.special[d]||{},p=u[d=(r?f.delegateType:f.bindType)||d]||[],s=s[2]&&new RegExp("(^|\\.)"+h.join("\\.(?:.*\\.|)")+"(\\.|$)"),a=o=p.length;while(o--)c=p[o],!i&&g!==c.origType||n&&n.guid!==c.guid||s&&!s.test(c.namespace)||r&&r!==c.selector&&("**"!==r||!c.selector)||(p.splice(o,1),c.selector&&p.delegateCount--,f.remove&&f.remove.call(e,c));a&&!p.length&&(f.teardown&&!1!==f.teardown.call(e,h,v.handle)||ce.removeEvent(e,d,v.handle),delete u[d])}else for(d in u)ce.event.remove(e,d+t[l],n,r,!0);ce.isEmptyObject(u)&&_.remove(e,"handle events")}},dispatch:function(e){var t,n,r,i,o,a,s=new Array(arguments.length),u=ce.event.fix(e),l=(_.get(this,"events")||Object.create(null))[u.type]||[],c=ce.event.special[u.type]||{};for(s[0]=u,t=1;t<arguments.length;t++)s[t]=arguments[t];if(u.delegateTarget=this,!c.preDispatch||!1!==c.preDispatch.call(this,u)){a=ce.event.handlers.call(this,u,l),t=0;while((i=a[t++])&&!u.isPropagationStopped()){u.currentTarget=i.elem,n=0;while((o=i.handlers[n++])&&!u.isImmediatePropagationStopped())u.rnamespace&&!1!==o.namespace&&!u.rnamespace.test(o.namespace)||(u.handleObj=o,u.data=o.data,void 0!==(r=((ce.event.special[o.origType]||{}).handle||o.handler).apply(i.elem,s))&&!1===(u.result=r)&&(u.preventDefault(),u.stopPropagation()))}return c.postDispatch&&c.postDispatch.call(this,u),u.result}},handlers:function(e,t){var n,r,i,o,a,s=[],u=t.delegateCount,l=e.target;if(u&&l.nodeType&&!("click"===e.type&&1<=e.button))for(;l!==this;l=l.parentNode||this)if(1===l.nodeType&&("click"!==e.type||!0!==l.disabled)){for(o=[],a={},n=0;n<u;n++)void 0===a[i=(r=t[n]).selector+" "]&&(a[i]=r.needsContext?-1<ce(i,this).index(l):ce.find(i,this,null,[l]).length),a[i]&&o.push(r);o.length&&s.push({elem:l,handlers:o})}return l=this,u<t.length&&s.push({elem:l,handlers:t.slice(u)}),s},addProp:function(t,e){Object.defineProperty(ce.Event.prototype,t,{enumerable:!0,configurable:!0,get:v(e)?function(){if(this.originalEvent)return e(this.originalEvent)}:function(){if(this.originalEvent)return this.originalEvent[t]},set:function(e){Object.defineProperty(this,t,{enumerable:!0,configurable:!0,writable:!0,value:e})}})},fix:function(e){return e[ce.expando]?e:new ce.Event(e)},special:{load:{noBubble:!0},click:{setup:function(e){var t=this||e;return we.test(t.type)&&t.click&&fe(t,"input")&&He(t,"click",!0),!1},trigger:function(e){var t=this||e;return we.test(t.type)&&t.click&&fe(t,"input")&&He(t,"click"),!0},_default:function(e){var t=e.target;return we.test(t.type)&&t.click&&fe(t,"input")&&_.get(t,"click")||fe(t,"a")}},beforeunload:{postDispatch:function(e){void 0!==e.result&&e.originalEvent&&(e.originalEvent.returnValue=e.result)}}}},ce.removeEvent=function(e,t,n){e.removeEventListener&&e.removeEventListener(t,n)},ce.Event=function(e,t){if(!(this instanceof ce.Event))return new ce.Event(e,t);e&&e.type?(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented||void 0===e.defaultPrevented&&!1===e.returnValue?Ne:qe,this.target=e.target&&3===e.target.nodeType?e.target.parentNode:e.target,this.currentTarget=e.currentTarget,this.relatedTarget=e.relatedTarget):this.type=e,t&&ce.extend(this,t),this.timeStamp=e&&e.timeStamp||Date.now(),this[ce.expando]=!0},ce.Event.prototype={constructor:ce.Event,isDefaultPrevented:qe,isPropagationStopped:qe,isImmediatePropagationStopped:qe,isSimulated:!1,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=Ne,e&&!this.isSimulated&&e.preventDefault()},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=Ne,e&&!this.isSimulated&&e.stopPropagation()},stopImmediatePropagation:function(){var e=this.originalEvent;this.isImmediatePropagationStopped=Ne,e&&!this.isSimulated&&e.stopImmediatePropagation(),this.stopPropagation()}},ce.each({altKey:!0,bubbles:!0,cancelable:!0,changedTouches:!0,ctrlKey:!0,detail:!0,eventPhase:!0,metaKey:!0,pageX:!0,pageY:!0,shiftKey:!0,view:!0,"char":!0,code:!0,charCode:!0,key:!0,keyCode:!0,button:!0,buttons:!0,clientX:!0,clientY:!0,offsetX:!0,offsetY:!0,pointerId:!0,pointerType:!0,screenX:!0,screenY:!0,targetTouches:!0,toElement:!0,touches:!0,which:!0},ce.event.addProp),ce.each({focus:"focusin",blur:"focusout"},function(r,i){function o(e){if(C.documentMode){var t=_.get(this,"handle"),n=ce.event.fix(e);n.type="focusin"===e.type?"focus":"blur",n.isSimulated=!0,t(e),n.target===n.currentTarget&&t(n)}else ce.event.simulate(i,e.target,ce.event.fix(e))}ce.event.special[r]={setup:function(){var e;if(He(this,r,!0),!C.documentMode)return!1;(e=_.get(this,i))||this.addEventListener(i,o),_.set(this,i,(e||0)+1)},trigger:function(){return He(this,r),!0},teardown:function(){var e;if(!C.documentMode)return!1;(e=_.get(this,i)-1)?_.set(this,i,e):(this.removeEventListener(i,o),_.remove(this,i))},_default:function(e){return _.get(e.target,r)},delegateType:i},ce.event.special[i]={setup:function(){var e=this.ownerDocument||this.document||this,t=C.documentMode?this:e,n=_.get(t,i);n||(C.documentMode?this.addEventListener(i,o):e.addEventListener(r,o,!0)),_.set(t,i,(n||0)+1)},teardown:function(){var e=this.ownerDocument||this.document||this,t=C.documentMode?this:e,n=_.get(t,i)-1;n?_.set(t,i,n):(C.documentMode?this.removeEventListener(i,o):e.removeEventListener(r,o,!0),_.remove(t,i))}}}),ce.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(e,i){ce.event.special[e]={delegateType:i,bindType:i,handle:function(e){var t,n=e.relatedTarget,r=e.handleObj;return n&&(n===this||ce.contains(this,n))||(e.type=r.origType,t=r.handler.apply(this,arguments),e.type=i),t}}}),ce.fn.extend({on:function(e,t,n,r){return Le(this,e,t,n,r)},one:function(e,t,n,r){return Le(this,e,t,n,r,1)},off:function(e,t,n){var r,i;if(e&&e.preventDefault&&e.handleObj)return r=e.handleObj,ce(e.delegateTarget).off(r.namespace?r.origType+"."+r.namespace:r.origType,r.selector,r.handler),this;if("object"==typeof e){for(i in e)this.off(i,t,e[i]);return this}return!1!==t&&"function"!=typeof t||(n=t,t=void 0),!1===n&&(n=qe),this.each(function(){ce.event.remove(this,e,n,t)})}});var Oe=/<script|<style|<link/i,Pe=/checked\s*(?:[^=]|=\s*.checked.)/i,Me=/^\s*<!\[CDATA\[|\]\]>\s*$/g;function Re(e,t){return fe(e,"table")&&fe(11!==t.nodeType?t:t.firstChild,"tr")&&ce(e).children("tbody")[0]||e}function Ie(e){return e.type=(null!==e.getAttribute("type"))+"/"+e.type,e}function We(e){return"true/"===(e.type||"").slice(0,5)?e.type=e.type.slice(5):e.removeAttribute("type"),e}function Fe(e,t){var n,r,i,o,a,s;if(1===t.nodeType){if(_.hasData(e)&&(s=_.get(e).events))for(i in _.remove(t,"handle events"),s)for(n=0,r=s[i].length;n<r;n++)ce.event.add(t,i,s[i][n]);z.hasData(e)&&(o=z.access(e),a=ce.extend({},o),z.set(t,a))}}function $e(n,r,i,o){r=g(r);var e,t,a,s,u,l,c=0,f=n.length,p=f-1,d=r[0],h=v(d);if(h||1<f&&"string"==typeof d&&!le.checkClone&&Pe.test(d))return n.each(function(e){var t=n.eq(e);h&&(r[0]=d.call(this,e,t.html())),$e(t,r,i,o)});if(f&&(t=(e=Ae(r,n[0].ownerDocument,!1,n,o)).firstChild,1===e.childNodes.length&&(e=t),t||o)){for(s=(a=ce.map(Se(e,"script"),Ie)).length;c<f;c++)u=e,c!==p&&(u=ce.clone(u,!0,!0),s&&ce.merge(a,Se(u,"script"))),i.call(n[c],u,c);if(s)for(l=a[a.length-1].ownerDocument,ce.map(a,We),c=0;c<s;c++)u=a[c],Ce.test(u.type||"")&&!_.access(u,"globalEval")&&ce.contains(l,u)&&(u.src&&"module"!==(u.type||"").toLowerCase()?ce._evalUrl&&!u.noModule&&ce._evalUrl(u.src,{nonce:u.nonce||u.getAttribute("nonce")},l):m(u.textContent.replace(Me,""),u,l))}return n}function Be(e,t,n){for(var r,i=t?ce.filter(t,e):e,o=0;null!=(r=i[o]);o++)n||1!==r.nodeType||ce.cleanData(Se(r)),r.parentNode&&(n&&K(r)&&Ee(Se(r,"script")),r.parentNode.removeChild(r));return e}ce.extend({htmlPrefilter:function(e){return e},clone:function(e,t,n){var r,i,o,a,s,u,l,c=e.cloneNode(!0),f=K(e);if(!(le.noCloneChecked||1!==e.nodeType&&11!==e.nodeType||ce.isXMLDoc(e)))for(a=Se(c),r=0,i=(o=Se(e)).length;r<i;r++)s=o[r],u=a[r],void 0,"input"===(l=u.nodeName.toLowerCase())&&we.test(s.type)?u.checked=s.checked:"input"!==l&&"textarea"!==l||(u.defaultValue=s.defaultValue);if(t)if(n)for(o=o||Se(e),a=a||Se(c),r=0,i=o.length;r<i;r++)Fe(o[r],a[r]);else Fe(e,c);return 0<(a=Se(c,"script")).length&&Ee(a,!f&&Se(e,"script")),c},cleanData:function(e){for(var t,n,r,i=ce.event.special,o=0;void 0!==(n=e[o]);o++)if($(n)){if(t=n[_.expando]){if(t.events)for(r in t.events)i[r]?ce.event.remove(n,r):ce.removeEvent(n,r,t.handle);n[_.expando]=void 0}n[z.expando]&&(n[z.expando]=void 0)}}}),ce.fn.extend({detach:function(e){return Be(this,e,!0)},remove:function(e){return Be(this,e)},text:function(e){return M(this,function(e){return void 0===e?ce.text(this):this.empty().each(function(){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||(this.textContent=e)})},null,e,arguments.length)},append:function(){return $e(this,arguments,function(e){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||Re(this,e).appendChild(e)})},prepend:function(){return $e(this,arguments,function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var t=Re(this,e);t.insertBefore(e,t.firstChild)}})},before:function(){return $e(this,arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this)})},after:function(){return $e(this,arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this.nextSibling)})},empty:function(){for(var e,t=0;null!=(e=this[t]);t++)1===e.nodeType&&(ce.cleanData(Se(e,!1)),e.textContent="");return this},clone:function(e,t){return e=null!=e&&e,t=null==t?e:t,this.map(function(){return ce.clone(this,e,t)})},html:function(e){return M(this,function(e){var t=this[0]||{},n=0,r=this.length;if(void 0===e&&1===t.nodeType)return t.innerHTML;if("string"==typeof e&&!Oe.test(e)&&!ke[(Te.exec(e)||["",""])[1].toLowerCase()]){e=ce.htmlPrefilter(e);try{for(;n<r;n++)1===(t=this[n]||{}).nodeType&&(ce.cleanData(Se(t,!1)),t.innerHTML=e);t=0}catch(e){}}t&&this.empty().append(e)},null,e,arguments.length)},replaceWith:function(){var n=[];return $e(this,arguments,function(e){var t=this.parentNode;ce.inArray(this,n)<0&&(ce.cleanData(Se(this)),t&&t.replaceChild(e,this))},n)}}),ce.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(e,a){ce.fn[e]=function(e){for(var t,n=[],r=ce(e),i=r.length-1,o=0;o<=i;o++)t=o===i?this:this.clone(!0),ce(r[o])[a](t),s.apply(n,t.get());return this.pushStack(n)}});var _e=new RegExp("^("+G+")(?!px)[a-z%]+$","i"),ze=/^--/,Xe=function(e){var t=e.ownerDocument.defaultView;return t&&t.opener||(t=ie),t.getComputedStyle(e)},Ue=function(e,t,n){var r,i,o={};for(i in t)o[i]=e.style[i],e.style[i]=t[i];for(i in r=n.call(e),t)e.style[i]=o[i];return r},Ve=new RegExp(Q.join("|"),"i");function Ge(e,t,n){var r,i,o,a,s=ze.test(t),u=e.style;return(n=n||Xe(e))&&(a=n.getPropertyValue(t)||n[t],s&&a&&(a=a.replace(ve,"$1")||void 0),""!==a||K(e)||(a=ce.style(e,t)),!le.pixelBoxStyles()&&_e.test(a)&&Ve.test(t)&&(r=u.width,i=u.minWidth,o=u.maxWidth,u.minWidth=u.maxWidth=u.width=a,a=n.width,u.width=r,u.minWidth=i,u.maxWidth=o)),void 0!==a?a+"":a}function Ye(e,t){return{get:function(){if(!e())return(this.get=t).apply(this,arguments);delete this.get}}}!function(){function e(){if(l){u.style.cssText="position:absolute;left:-11111px;width:60px;margin-top:1px;padding:0;border:0",l.style.cssText="position:relative;display:block;box-sizing:border-box;overflow:scroll;margin:auto;border:1px;padding:1px;width:60%;top:1%",J.appendChild(u).appendChild(l);var e=ie.getComputedStyle(l);n="1%"!==e.top,s=12===t(e.marginLeft),l.style.right="60%",o=36===t(e.right),r=36===t(e.width),l.style.position="absolute",i=12===t(l.offsetWidth/3),J.removeChild(u),l=null}}function t(e){return Math.round(parseFloat(e))}var n,r,i,o,a,s,u=C.createElement("div"),l=C.createElement("div");l.style&&(l.style.backgroundClip="content-box",l.cloneNode(!0).style.backgroundClip="",le.clearCloneStyle="content-box"===l.style.backgroundClip,ce.extend(le,{boxSizingReliable:function(){return e(),r},pixelBoxStyles:function(){return e(),o},pixelPosition:function(){return e(),n},reliableMarginLeft:function(){return e(),s},scrollboxSize:function(){return e(),i},reliableTrDimensions:function(){var e,t,n,r;return null==a&&(e=C.createElement("table"),t=C.createElement("tr"),n=C.createElement("div"),e.style.cssText="position:absolute;left:-11111px;border-collapse:separate",t.style.cssText="box-sizing:content-box;border:1px solid",t.style.height="1px",n.style.height="9px",n.style.display="block",J.appendChild(e).appendChild(t).appendChild(n),r=ie.getComputedStyle(t),a=parseInt(r.height,10)+parseInt(r.borderTopWidth,10)+parseInt(r.borderBottomWidth,10)===t.offsetHeight,J.removeChild(e)),a}}))}();var Qe=["Webkit","Moz","ms"],Je=C.createElement("div").style,Ke={};function Ze(e){var t=ce.cssProps[e]||Ke[e];return t||(e in Je?e:Ke[e]=function(e){var t=e[0].toUpperCase()+e.slice(1),n=Qe.length;while(n--)if((e=Qe[n]+t)in Je)return e}(e)||e)}var et=/^(none|table(?!-c[ea]).+)/,tt={position:"absolute",visibility:"hidden",display:"block"},nt={letterSpacing:"0",fontWeight:"400"};function rt(e,t,n){var r=Y.exec(t);return r?Math.max(0,r[2]-(n||0))+(r[3]||"px"):t}function it(e,t,n,r,i,o){var a="width"===t?1:0,s=0,u=0,l=0;if(n===(r?"border":"content"))return 0;for(;a<4;a+=2)"margin"===n&&(l+=ce.css(e,n+Q[a],!0,i)),r?("content"===n&&(u-=ce.css(e,"padding"+Q[a],!0,i)),"margin"!==n&&(u-=ce.css(e,"border"+Q[a]+"Width",!0,i))):(u+=ce.css(e,"padding"+Q[a],!0,i),"padding"!==n?u+=ce.css(e,"border"+Q[a]+"Width",!0,i):s+=ce.css(e,"border"+Q[a]+"Width",!0,i));return!r&&0<=o&&(u+=Math.max(0,Math.ceil(e["offset"+t[0].toUpperCase()+t.slice(1)]-o-u-s-.5))||0),u+l}function ot(e,t,n){var r=Xe(e),i=(!le.boxSizingReliable()||n)&&"border-box"===ce.css(e,"boxSizing",!1,r),o=i,a=Ge(e,t,r),s="offset"+t[0].toUpperCase()+t.slice(1);if(_e.test(a)){if(!n)return a;a="auto"}return(!le.boxSizingReliable()&&i||!le.reliableTrDimensions()&&fe(e,"tr")||"auto"===a||!parseFloat(a)&&"inline"===ce.css(e,"display",!1,r))&&e.getClientRects().length&&(i="border-box"===ce.css(e,"boxSizing",!1,r),(o=s in e)&&(a=e[s])),(a=parseFloat(a)||0)+it(e,t,n||(i?"border":"content"),o,r,a)+"px"}function at(e,t,n,r,i){return new at.prototype.init(e,t,n,r,i)}ce.extend({cssHooks:{opacity:{get:function(e,t){if(t){var n=Ge(e,"opacity");return""===n?"1":n}}}},cssNumber:{animationIterationCount:!0,aspectRatio:!0,borderImageSlice:!0,columnCount:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,gridArea:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnStart:!0,gridRow:!0,gridRowEnd:!0,gridRowStart:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,scale:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeMiterlimit:!0,strokeOpacity:!0},cssProps:{},style:function(e,t,n,r){if(e&&3!==e.nodeType&&8!==e.nodeType&&e.style){var i,o,a,s=F(t),u=ze.test(t),l=e.style;if(u||(t=Ze(s)),a=ce.cssHooks[t]||ce.cssHooks[s],void 0===n)return a&&"get"in a&&void 0!==(i=a.get(e,!1,r))?i:l[t];"string"===(o=typeof n)&&(i=Y.exec(n))&&i[1]&&(n=te(e,t,i),o="number"),null!=n&&n==n&&("number"!==o||u||(n+=i&&i[3]||(ce.cssNumber[s]?"":"px")),le.clearCloneStyle||""!==n||0!==t.indexOf("background")||(l[t]="inherit"),a&&"set"in a&&void 0===(n=a.set(e,n,r))||(u?l.setProperty(t,n):l[t]=n))}},css:function(e,t,n,r){var i,o,a,s=F(t);return ze.test(t)||(t=Ze(s)),(a=ce.cssHooks[t]||ce.cssHooks[s])&&"get"in a&&(i=a.get(e,!0,n)),void 0===i&&(i=Ge(e,t,r)),"normal"===i&&t in nt&&(i=nt[t]),""===n||n?(o=parseFloat(i),!0===n||isFinite(o)?o||0:i):i}}),ce.each(["height","width"],function(e,u){ce.cssHooks[u]={get:function(e,t,n){if(t)return!et.test(ce.css(e,"display"))||e.getClientRects().length&&e.getBoundingClientRect().width?ot(e,u,n):Ue(e,tt,function(){return ot(e,u,n)})},set:function(e,t,n){var r,i=Xe(e),o=!le.scrollboxSize()&&"absolute"===i.position,a=(o||n)&&"border-box"===ce.css(e,"boxSizing",!1,i),s=n?it(e,u,n,a,i):0;return a&&o&&(s-=Math.ceil(e["offset"+u[0].toUpperCase()+u.slice(1)]-parseFloat(i[u])-it(e,u,"border",!1,i)-.5)),s&&(r=Y.exec(t))&&"px"!==(r[3]||"px")&&(e.style[u]=t,t=ce.css(e,u)),rt(0,t,s)}}}),ce.cssHooks.marginLeft=Ye(le.reliableMarginLeft,function(e,t){if(t)return(parseFloat(Ge(e,"marginLeft"))||e.getBoundingClientRect().left-Ue(e,{marginLeft:0},function(){return e.getBoundingClientRect().left}))+"px"}),ce.each({margin:"",padding:"",border:"Width"},function(i,o){ce.cssHooks[i+o]={expand:function(e){for(var t=0,n={},r="string"==typeof e?e.split(" "):[e];t<4;t++)n[i+Q[t]+o]=r[t]||r[t-2]||r[0];return n}},"margin"!==i&&(ce.cssHooks[i+o].set=rt)}),ce.fn.extend({css:function(e,t){return M(this,function(e,t,n){var r,i,o={},a=0;if(Array.isArray(t)){for(r=Xe(e),i=t.length;a<i;a++)o[t[a]]=ce.css(e,t[a],!1,r);return o}return void 0!==n?ce.style(e,t,n):ce.css(e,t)},e,t,1<arguments.length)}}),((ce.Tween=at).prototype={constructor:at,init:function(e,t,n,r,i,o){this.elem=e,this.prop=n,this.easing=i||ce.easing._default,this.options=t,this.start=this.now=this.cur(),this.end=r,this.unit=o||(ce.cssNumber[n]?"":"px")},cur:function(){var e=at.propHooks[this.prop];return e&&e.get?e.get(this):at.propHooks._default.get(this)},run:function(e){var t,n=at.propHooks[this.prop];return this.options.duration?this.pos=t=ce.easing[this.easing](e,this.options.duration*e,0,1,this.options.duration):this.pos=t=e,this.now=(this.end-this.start)*t+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),n&&n.set?n.set(this):at.propHooks._default.set(this),this}}).init.prototype=at.prototype,(at.propHooks={_default:{get:function(e){var t;return 1!==e.elem.nodeType||null!=e.elem[e.prop]&&null==e.elem.style[e.prop]?e.elem[e.prop]:(t=ce.css(e.elem,e.prop,""))&&"auto"!==t?t:0},set:function(e){ce.fx.step[e.prop]?ce.fx.step[e.prop](e):1!==e.elem.nodeType||!ce.cssHooks[e.prop]&&null==e.elem.style[Ze(e.prop)]?e.elem[e.prop]=e.now:ce.style(e.elem,e.prop,e.now+e.unit)}}}).scrollTop=at.propHooks.scrollLeft={set:function(e){e.elem.nodeType&&e.elem.parentNode&&(e.elem[e.prop]=e.now)}},ce.easing={linear:function(e){return e},swing:function(e){return.5-Math.cos(e*Math.PI)/2},_default:"swing"},ce.fx=at.prototype.init,ce.fx.step={};var st,ut,lt,ct,ft=/^(?:toggle|show|hide)$/,pt=/queueHooks$/;function dt(){ut&&(!1===C.hidden&&ie.requestAnimationFrame?ie.requestAnimationFrame(dt):ie.setTimeout(dt,ce.fx.interval),ce.fx.tick())}function ht(){return ie.setTimeout(function(){st=void 0}),st=Date.now()}function gt(e,t){var n,r=0,i={height:e};for(t=t?1:0;r<4;r+=2-t)i["margin"+(n=Q[r])]=i["padding"+n]=e;return t&&(i.opacity=i.width=e),i}function vt(e,t,n){for(var r,i=(yt.tweeners[t]||[]).concat(yt.tweeners["*"]),o=0,a=i.length;o<a;o++)if(r=i[o].call(n,t,e))return r}function yt(o,e,t){var n,a,r=0,i=yt.prefilters.length,s=ce.Deferred().always(function(){delete u.elem}),u=function(){if(a)return!1;for(var e=st||ht(),t=Math.max(0,l.startTime+l.duration-e),n=1-(t/l.duration||0),r=0,i=l.tweens.length;r<i;r++)l.tweens[r].run(n);return s.notifyWith(o,[l,n,t]),n<1&&i?t:(i||s.notifyWith(o,[l,1,0]),s.resolveWith(o,[l]),!1)},l=s.promise({elem:o,props:ce.extend({},e),opts:ce.extend(!0,{specialEasing:{},easing:ce.easing._default},t),originalProperties:e,originalOptions:t,startTime:st||ht(),duration:t.duration,tweens:[],createTween:function(e,t){var n=ce.Tween(o,l.opts,e,t,l.opts.specialEasing[e]||l.opts.easing);return l.tweens.push(n),n},stop:function(e){var t=0,n=e?l.tweens.length:0;if(a)return this;for(a=!0;t<n;t++)l.tweens[t].run(1);return e?(s.notifyWith(o,[l,1,0]),s.resolveWith(o,[l,e])):s.rejectWith(o,[l,e]),this}}),c=l.props;for(!function(e,t){var n,r,i,o,a;for(n in e)if(i=t[r=F(n)],o=e[n],Array.isArray(o)&&(i=o[1],o=e[n]=o[0]),n!==r&&(e[r]=o,delete e[n]),(a=ce.cssHooks[r])&&"expand"in a)for(n in o=a.expand(o),delete e[r],o)n in e||(e[n]=o[n],t[n]=i);else t[r]=i}(c,l.opts.specialEasing);r<i;r++)if(n=yt.prefilters[r].call(l,o,c,l.opts))return v(n.stop)&&(ce._queueHooks(l.elem,l.opts.queue).stop=n.stop.bind(n)),n;return ce.map(c,vt,l),v(l.opts.start)&&l.opts.start.call(o,l),l.progress(l.opts.progress).done(l.opts.done,l.opts.complete).fail(l.opts.fail).always(l.opts.always),ce.fx.timer(ce.extend(u,{elem:o,anim:l,queue:l.opts.queue})),l}ce.Animation=ce.extend(yt,{tweeners:{"*":[function(e,t){var n=this.createTween(e,t);return te(n.elem,e,Y.exec(t),n),n}]},tweener:function(e,t){v(e)?(t=e,e=["*"]):e=e.match(D);for(var n,r=0,i=e.length;r<i;r++)n=e[r],yt.tweeners[n]=yt.tweeners[n]||[],yt.tweeners[n].unshift(t)},prefilters:[function(e,t,n){var r,i,o,a,s,u,l,c,f="width"in t||"height"in t,p=this,d={},h=e.style,g=e.nodeType&&ee(e),v=_.get(e,"fxshow");for(r in n.queue||(null==(a=ce._queueHooks(e,"fx")).unqueued&&(a.unqueued=0,s=a.empty.fire,a.empty.fire=function(){a.unqueued||s()}),a.unqueued++,p.always(function(){p.always(function(){a.unqueued--,ce.queue(e,"fx").length||a.empty.fire()})})),t)if(i=t[r],ft.test(i)){if(delete t[r],o=o||"toggle"===i,i===(g?"hide":"show")){if("show"!==i||!v||void 0===v[r])continue;g=!0}d[r]=v&&v[r]||ce.style(e,r)}if((u=!ce.isEmptyObject(t))||!ce.isEmptyObject(d))for(r in f&&1===e.nodeType&&(n.overflow=[h.overflow,h.overflowX,h.overflowY],null==(l=v&&v.display)&&(l=_.get(e,"display")),"none"===(c=ce.css(e,"display"))&&(l?c=l:(re([e],!0),l=e.style.display||l,c=ce.css(e,"display"),re([e]))),("inline"===c||"inline-block"===c&&null!=l)&&"none"===ce.css(e,"float")&&(u||(p.done(function(){h.display=l}),null==l&&(c=h.display,l="none"===c?"":c)),h.display="inline-block")),n.overflow&&(h.overflow="hidden",p.always(function(){h.overflow=n.overflow[0],h.overflowX=n.overflow[1],h.overflowY=n.overflow[2]})),u=!1,d)u||(v?"hidden"in v&&(g=v.hidden):v=_.access(e,"fxshow",{display:l}),o&&(v.hidden=!g),g&&re([e],!0),p.done(function(){for(r in g||re([e]),_.remove(e,"fxshow"),d)ce.style(e,r,d[r])})),u=vt(g?v[r]:0,r,p),r in v||(v[r]=u.start,g&&(u.end=u.start,u.start=0))}],prefilter:function(e,t){t?yt.prefilters.unshift(e):yt.prefilters.push(e)}}),ce.speed=function(e,t,n){var r=e&&"object"==typeof e?ce.extend({},e):{complete:n||!n&&t||v(e)&&e,duration:e,easing:n&&t||t&&!v(t)&&t};return ce.fx.off?r.duration=0:"number"!=typeof r.duration&&(r.duration in ce.fx.speeds?r.duration=ce.fx.speeds[r.duration]:r.duration=ce.fx.speeds._default),null!=r.queue&&!0!==r.queue||(r.queue="fx"),r.old=r.complete,r.complete=function(){v(r.old)&&r.old.call(this),r.queue&&ce.dequeue(this,r.queue)},r},ce.fn.extend({fadeTo:function(e,t,n,r){return this.filter(ee).css("opacity",0).show().end().animate({opacity:t},e,n,r)},animate:function(t,e,n,r){var i=ce.isEmptyObject(t),o=ce.speed(e,n,r),a=function(){var e=yt(this,ce.extend({},t),o);(i||_.get(this,"finish"))&&e.stop(!0)};return a.finish=a,i||!1===o.queue?this.each(a):this.queue(o.queue,a)},stop:function(i,e,o){var a=function(e){var t=e.stop;delete e.stop,t(o)};return"string"!=typeof i&&(o=e,e=i,i=void 0),e&&this.queue(i||"fx",[]),this.each(function(){var e=!0,t=null!=i&&i+"queueHooks",n=ce.timers,r=_.get(this);if(t)r[t]&&r[t].stop&&a(r[t]);else for(t in r)r[t]&&r[t].stop&&pt.test(t)&&a(r[t]);for(t=n.length;t--;)n[t].elem!==this||null!=i&&n[t].queue!==i||(n[t].anim.stop(o),e=!1,n.splice(t,1));!e&&o||ce.dequeue(this,i)})},finish:function(a){return!1!==a&&(a=a||"fx"),this.each(function(){var e,t=_.get(this),n=t[a+"queue"],r=t[a+"queueHooks"],i=ce.timers,o=n?n.length:0;for(t.finish=!0,ce.queue(this,a,[]),r&&r.stop&&r.stop.call(this,!0),e=i.length;e--;)i[e].elem===this&&i[e].queue===a&&(i[e].anim.stop(!0),i.splice(e,1));for(e=0;e<o;e++)n[e]&&n[e].finish&&n[e].finish.call(this);delete t.finish})}}),ce.each(["toggle","show","hide"],function(e,r){var i=ce.fn[r];ce.fn[r]=function(e,t,n){return null==e||"boolean"==typeof e?i.apply(this,arguments):this.animate(gt(r,!0),e,t,n)}}),ce.each({slideDown:gt("show"),slideUp:gt("hide"),slideToggle:gt("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(e,r){ce.fn[e]=function(e,t,n){return this.animate(r,e,t,n)}}),ce.timers=[],ce.fx.tick=function(){var e,t=0,n=ce.timers;for(st=Date.now();t<n.length;t++)(e=n[t])()||n[t]!==e||n.splice(t--,1);n.length||ce.fx.stop(),st=void 0},ce.fx.timer=function(e){ce.timers.push(e),ce.fx.start()},ce.fx.interval=13,ce.fx.start=function(){ut||(ut=!0,dt())},ce.fx.stop=function(){ut=null},ce.fx.speeds={slow:600,fast:200,_default:400},ce.fn.delay=function(r,e){return r=ce.fx&&ce.fx.speeds[r]||r,e=e||"fx",this.queue(e,function(e,t){var n=ie.setTimeout(e,r);t.stop=function(){ie.clearTimeout(n)}})},lt=C.createElement("input"),ct=C.createElement("select").appendChild(C.createElement("option")),lt.type="checkbox",le.checkOn=""!==lt.value,le.optSelected=ct.selected,(lt=C.createElement("input")).value="t",lt.type="radio",le.radioValue="t"===lt.value;var mt,xt=ce.expr.attrHandle;ce.fn.extend({attr:function(e,t){return M(this,ce.attr,e,t,1<arguments.length)},removeAttr:function(e){return this.each(function(){ce.removeAttr(this,e)})}}),ce.extend({attr:function(e,t,n){var r,i,o=e.nodeType;if(3!==o&&8!==o&&2!==o)return"undefined"==typeof e.getAttribute?ce.prop(e,t,n):(1===o&&ce.isXMLDoc(e)||(i=ce.attrHooks[t.toLowerCase()]||(ce.expr.match.bool.test(t)?mt:void 0)),void 0!==n?null===n?void ce.removeAttr(e,t):i&&"set"in i&&void 0!==(r=i.set(e,n,t))?r:(e.setAttribute(t,n+""),n):i&&"get"in i&&null!==(r=i.get(e,t))?r:null==(r=ce.find.attr(e,t))?void 0:r)},attrHooks:{type:{set:function(e,t){if(!le.radioValue&&"radio"===t&&fe(e,"input")){var n=e.value;return e.setAttribute("type",t),n&&(e.value=n),t}}}},removeAttr:function(e,t){var n,r=0,i=t&&t.match(D);if(i&&1===e.nodeType)while(n=i[r++])e.removeAttribute(n)}}),mt={set:function(e,t,n){return!1===t?ce.removeAttr(e,n):e.setAttribute(n,n),n}},ce.each(ce.expr.match.bool.source.match(/\w+/g),function(e,t){var a=xt[t]||ce.find.attr;xt[t]=function(e,t,n){var r,i,o=t.toLowerCase();return n||(i=xt[o],xt[o]=r,r=null!=a(e,t,n)?o:null,xt[o]=i),r}});var bt=/^(?:input|select|textarea|button)$/i,wt=/^(?:a|area)$/i;function Tt(e){return(e.match(D)||[]).join(" ")}function Ct(e){return e.getAttribute&&e.getAttribute("class")||""}function kt(e){return Array.isArray(e)?e:"string"==typeof e&&e.match(D)||[]}ce.fn.extend({prop:function(e,t){return M(this,ce.prop,e,t,1<arguments.length)},removeProp:function(e){return this.each(function(){delete this[ce.propFix[e]||e]})}}),ce.extend({prop:function(e,t,n){var r,i,o=e.nodeType;if(3!==o&&8!==o&&2!==o)return 1===o&&ce.isXMLDoc(e)||(t=ce.propFix[t]||t,i=ce.propHooks[t]),void 0!==n?i&&"set"in i&&void 0!==(r=i.set(e,n,t))?r:e[t]=n:i&&"get"in i&&null!==(r=i.get(e,t))?r:e[t]},propHooks:{tabIndex:{get:function(e){var t=ce.find.attr(e,"tabindex");return t?parseInt(t,10):bt.test(e.nodeName)||wt.test(e.nodeName)&&e.href?0:-1}}},propFix:{"for":"htmlFor","class":"className"}}),le.optSelected||(ce.propHooks.selected={get:function(e){var t=e.parentNode;return t&&t.parentNode&&t.parentNode.selectedIndex,null},set:function(e){var t=e.parentNode;t&&(t.selectedIndex,t.parentNode&&t.parentNode.selectedIndex)}}),ce.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){ce.propFix[this.toLowerCase()]=this}),ce.fn.extend({addClass:function(t){var e,n,r,i,o,a;return v(t)?this.each(function(e){ce(this).addClass(t.call(this,e,Ct(this)))}):(e=kt(t)).length?this.each(function(){if(r=Ct(this),n=1===this.nodeType&&" "+Tt(r)+" "){for(o=0;o<e.length;o++)i=e[o],n.indexOf(" "+i+" ")<0&&(n+=i+" ");a=Tt(n),r!==a&&this.setAttribute("class",a)}}):this},removeClass:function(t){var e,n,r,i,o,a;return v(t)?this.each(function(e){ce(this).removeClass(t.call(this,e,Ct(this)))}):arguments.length?(e=kt(t)).length?this.each(function(){if(r=Ct(this),n=1===this.nodeType&&" "+Tt(r)+" "){for(o=0;o<e.length;o++){i=e[o];while(-1<n.indexOf(" "+i+" "))n=n.replace(" "+i+" "," ")}a=Tt(n),r!==a&&this.setAttribute("class",a)}}):this:this.attr("class","")},toggleClass:function(t,n){var e,r,i,o,a=typeof t,s="string"===a||Array.isArray(t);return v(t)?this.each(function(e){ce(this).toggleClass(t.call(this,e,Ct(this),n),n)}):"boolean"==typeof n&&s?n?this.addClass(t):this.removeClass(t):(e=kt(t),this.each(function(){if(s)for(o=ce(this),i=0;i<e.length;i++)r=e[i],o.hasClass(r)?o.removeClass(r):o.addClass(r);else void 0!==t&&"boolean"!==a||((r=Ct(this))&&_.set(this,"__className__",r),this.setAttribute&&this.setAttribute("class",r||!1===t?"":_.get(this,"__className__")||""))}))},hasClass:function(e){var t,n,r=0;t=" "+e+" ";while(n=this[r++])if(1===n.nodeType&&-1<(" "+Tt(Ct(n))+" ").indexOf(t))return!0;return!1}});var St=/\r/g;ce.fn.extend({val:function(n){var r,e,i,t=this[0];return arguments.length?(i=v(n),this.each(function(e){var t;1===this.nodeType&&(null==(t=i?n.call(this,e,ce(this).val()):n)?t="":"number"==typeof t?t+="":Array.isArray(t)&&(t=ce.map(t,function(e){return null==e?"":e+""})),(r=ce.valHooks[this.type]||ce.valHooks[this.nodeName.toLowerCase()])&&"set"in r&&void 0!==r.set(this,t,"value")||(this.value=t))})):t?(r=ce.valHooks[t.type]||ce.valHooks[t.nodeName.toLowerCase()])&&"get"in r&&void 0!==(e=r.get(t,"value"))?e:"string"==typeof(e=t.value)?e.replace(St,""):null==e?"":e:void 0}}),ce.extend({valHooks:{option:{get:function(e){var t=ce.find.attr(e,"value");return null!=t?t:Tt(ce.text(e))}},select:{get:function(e){var t,n,r,i=e.options,o=e.selectedIndex,a="select-one"===e.type,s=a?null:[],u=a?o+1:i.length;for(r=o<0?u:a?o:0;r<u;r++)if(((n=i[r]).selected||r===o)&&!n.disabled&&(!n.parentNode.disabled||!fe(n.parentNode,"optgroup"))){if(t=ce(n).val(),a)return t;s.push(t)}return s},set:function(e,t){var n,r,i=e.options,o=ce.makeArray(t),a=i.length;while(a--)((r=i[a]).selected=-1<ce.inArray(ce.valHooks.option.get(r),o))&&(n=!0);return n||(e.selectedIndex=-1),o}}}}),ce.each(["radio","checkbox"],function(){ce.valHooks[this]={set:function(e,t){if(Array.isArray(t))return e.checked=-1<ce.inArray(ce(e).val(),t)}},le.checkOn||(ce.valHooks[this].get=function(e){return null===e.getAttribute("value")?"on":e.value})});var Et=ie.location,jt={guid:Date.now()},At=/\?/;ce.parseXML=function(e){var t,n;if(!e||"string"!=typeof e)return null;try{t=(new ie.DOMParser).parseFromString(e,"text/xml")}catch(e){}return n=t&&t.getElementsByTagName("parsererror")[0],t&&!n||ce.error("Invalid XML: "+(n?ce.map(n.childNodes,function(e){return e.textContent}).join("\n"):e)),t};var Dt=/^(?:focusinfocus|focusoutblur)$/,Nt=function(e){e.stopPropagation()};ce.extend(ce.event,{trigger:function(e,t,n,r){var i,o,a,s,u,l,c,f,p=[n||C],d=ue.call(e,"type")?e.type:e,h=ue.call(e,"namespace")?e.namespace.split("."):[];if(o=f=a=n=n||C,3!==n.nodeType&&8!==n.nodeType&&!Dt.test(d+ce.event.triggered)&&(-1<d.indexOf(".")&&(d=(h=d.split(".")).shift(),h.sort()),u=d.indexOf(":")<0&&"on"+d,(e=e[ce.expando]?e:new ce.Event(d,"object"==typeof e&&e)).isTrigger=r?2:3,e.namespace=h.join("."),e.rnamespace=e.namespace?new RegExp("(^|\\.)"+h.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,e.result=void 0,e.target||(e.target=n),t=null==t?[e]:ce.makeArray(t,[e]),c=ce.event.special[d]||{},r||!c.trigger||!1!==c.trigger.apply(n,t))){if(!r&&!c.noBubble&&!y(n)){for(s=c.delegateType||d,Dt.test(s+d)||(o=o.parentNode);o;o=o.parentNode)p.push(o),a=o;a===(n.ownerDocument||C)&&p.push(a.defaultView||a.parentWindow||ie)}i=0;while((o=p[i++])&&!e.isPropagationStopped())f=o,e.type=1<i?s:c.bindType||d,(l=(_.get(o,"events")||Object.create(null))[e.type]&&_.get(o,"handle"))&&l.apply(o,t),(l=u&&o[u])&&l.apply&&$(o)&&(e.result=l.apply(o,t),!1===e.result&&e.preventDefault());return e.type=d,r||e.isDefaultPrevented()||c._default&&!1!==c._default.apply(p.pop(),t)||!$(n)||u&&v(n[d])&&!y(n)&&((a=n[u])&&(n[u]=null),ce.event.triggered=d,e.isPropagationStopped()&&f.addEventListener(d,Nt),n[d](),e.isPropagationStopped()&&f.removeEventListener(d,Nt),ce.event.triggered=void 0,a&&(n[u]=a)),e.result}},simulate:function(e,t,n){var r=ce.extend(new ce.Event,n,{type:e,isSimulated:!0});ce.event.trigger(r,null,t)}}),ce.fn.extend({trigger:function(e,t){return this.each(function(){ce.event.trigger(e,t,this)})},triggerHandler:function(e,t){var n=this[0];if(n)return ce.event.trigger(e,t,n,!0)}});var qt=/\[\]$/,Lt=/\r?\n/g,Ht=/^(?:submit|button|image|reset|file)$/i,Ot=/^(?:input|select|textarea|keygen)/i;function Pt(n,e,r,i){var t;if(Array.isArray(e))ce.each(e,function(e,t){r||qt.test(n)?i(n,t):Pt(n+"["+("object"==typeof t&&null!=t?e:"")+"]",t,r,i)});else if(r||"object"!==x(e))i(n,e);else for(t in e)Pt(n+"["+t+"]",e[t],r,i)}ce.param=function(e,t){var n,r=[],i=function(e,t){var n=v(t)?t():t;r[r.length]=encodeURIComponent(e)+"="+encodeURIComponent(null==n?"":n)};if(null==e)return"";if(Array.isArray(e)||e.jquery&&!ce.isPlainObject(e))ce.each(e,function(){i(this.name,this.value)});else for(n in e)Pt(n,e[n],t,i);return r.join("&")},ce.fn.extend({serialize:function(){return ce.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var e=ce.prop(this,"elements");return e?ce.makeArray(e):this}).filter(function(){var e=this.type;return this.name&&!ce(this).is(":disabled")&&Ot.test(this.nodeName)&&!Ht.test(e)&&(this.checked||!we.test(e))}).map(function(e,t){var n=ce(this).val();return null==n?null:Array.isArray(n)?ce.map(n,function(e){return{name:t.name,value:e.replace(Lt,"\r\n")}}):{name:t.name,value:n.replace(Lt,"\r\n")}}).get()}});var Mt=/%20/g,Rt=/#.*$/,It=/([?&])_=[^&]*/,Wt=/^(.*?):[ \t]*([^\r\n]*)$/gm,Ft=/^(?:GET|HEAD)$/,$t=/^\/\//,Bt={},_t={},zt="*/".concat("*"),Xt=C.createElement("a");function Ut(o){return function(e,t){"string"!=typeof e&&(t=e,e="*");var n,r=0,i=e.toLowerCase().match(D)||[];if(v(t))while(n=i[r++])"+"===n[0]?(n=n.slice(1)||"*",(o[n]=o[n]||[]).unshift(t)):(o[n]=o[n]||[]).push(t)}}function Vt(t,i,o,a){var s={},u=t===_t;function l(e){var r;return s[e]=!0,ce.each(t[e]||[],function(e,t){var n=t(i,o,a);return"string"!=typeof n||u||s[n]?u?!(r=n):void 0:(i.dataTypes.unshift(n),l(n),!1)}),r}return l(i.dataTypes[0])||!s["*"]&&l("*")}function Gt(e,t){var n,r,i=ce.ajaxSettings.flatOptions||{};for(n in t)void 0!==t[n]&&((i[n]?e:r||(r={}))[n]=t[n]);return r&&ce.extend(!0,e,r),e}Xt.href=Et.href,ce.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:Et.href,type:"GET",isLocal:/^(?:about|app|app-storage|.+-extension|file|res|widget):$/.test(Et.protocol),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":zt,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":JSON.parse,"text xml":ce.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(e,t){return t?Gt(Gt(e,ce.ajaxSettings),t):Gt(ce.ajaxSettings,e)},ajaxPrefilter:Ut(Bt),ajaxTransport:Ut(_t),ajax:function(e,t){"object"==typeof e&&(t=e,e=void 0),t=t||{};var c,f,p,n,d,r,h,g,i,o,v=ce.ajaxSetup({},t),y=v.context||v,m=v.context&&(y.nodeType||y.jquery)?ce(y):ce.event,x=ce.Deferred(),b=ce.Callbacks("once memory"),w=v.statusCode||{},a={},s={},u="canceled",T={readyState:0,getResponseHeader:function(e){var t;if(h){if(!n){n={};while(t=Wt.exec(p))n[t[1].toLowerCase()+" "]=(n[t[1].toLowerCase()+" "]||[]).concat(t[2])}t=n[e.toLowerCase()+" "]}return null==t?null:t.join(", ")},getAllResponseHeaders:function(){return h?p:null},setRequestHeader:function(e,t){return null==h&&(e=s[e.toLowerCase()]=s[e.toLowerCase()]||e,a[e]=t),this},overrideMimeType:function(e){return null==h&&(v.mimeType=e),this},statusCode:function(e){var t;if(e)if(h)T.always(e[T.status]);else for(t in e)w[t]=[w[t],e[t]];return this},abort:function(e){var t=e||u;return c&&c.abort(t),l(0,t),this}};if(x.promise(T),v.url=((e||v.url||Et.href)+"").replace($t,Et.protocol+"//"),v.type=t.method||t.type||v.method||v.type,v.dataTypes=(v.dataType||"*").toLowerCase().match(D)||[""],null==v.crossDomain){r=C.createElement("a");try{r.href=v.url,r.href=r.href,v.crossDomain=Xt.protocol+"//"+Xt.host!=r.protocol+"//"+r.host}catch(e){v.crossDomain=!0}}if(v.data&&v.processData&&"string"!=typeof v.data&&(v.data=ce.param(v.data,v.traditional)),Vt(Bt,v,t,T),h)return T;for(i in(g=ce.event&&v.global)&&0==ce.active++&&ce.event.trigger("ajaxStart"),v.type=v.type.toUpperCase(),v.hasContent=!Ft.test(v.type),f=v.url.replace(Rt,""),v.hasContent?v.data&&v.processData&&0===(v.contentType||"").indexOf("application/x-www-form-urlencoded")&&(v.data=v.data.replace(Mt,"+")):(o=v.url.slice(f.length),v.data&&(v.processData||"string"==typeof v.data)&&(f+=(At.test(f)?"&":"?")+v.data,delete v.data),!1===v.cache&&(f=f.replace(It,"$1"),o=(At.test(f)?"&":"?")+"_="+jt.guid+++o),v.url=f+o),v.ifModified&&(ce.lastModified[f]&&T.setRequestHeader("If-Modified-Since",ce.lastModified[f]),ce.etag[f]&&T.setRequestHeader("If-None-Match",ce.etag[f])),(v.data&&v.hasContent&&!1!==v.contentType||t.contentType)&&T.setRequestHeader("Content-Type",v.contentType),T.setRequestHeader("Accept",v.dataTypes[0]&&v.accepts[v.dataTypes[0]]?v.accepts[v.dataTypes[0]]+("*"!==v.dataTypes[0]?", "+zt+"; q=0.01":""):v.accepts["*"]),v.headers)T.setRequestHeader(i,v.headers[i]);if(v.beforeSend&&(!1===v.beforeSend.call(y,T,v)||h))return T.abort();if(u="abort",b.add(v.complete),T.done(v.success),T.fail(v.error),c=Vt(_t,v,t,T)){if(T.readyState=1,g&&m.trigger("ajaxSend",[T,v]),h)return T;v.async&&0<v.timeout&&(d=ie.setTimeout(function(){T.abort("timeout")},v.timeout));try{h=!1,c.send(a,l)}catch(e){if(h)throw e;l(-1,e)}}else l(-1,"No Transport");function l(e,t,n,r){var i,o,a,s,u,l=t;h||(h=!0,d&&ie.clearTimeout(d),c=void 0,p=r||"",T.readyState=0<e?4:0,i=200<=e&&e<300||304===e,n&&(s=function(e,t,n){var r,i,o,a,s=e.contents,u=e.dataTypes;while("*"===u[0])u.shift(),void 0===r&&(r=e.mimeType||t.getResponseHeader("Content-Type"));if(r)for(i in s)if(s[i]&&s[i].test(r)){u.unshift(i);break}if(u[0]in n)o=u[0];else{for(i in n){if(!u[0]||e.converters[i+" "+u[0]]){o=i;break}a||(a=i)}o=o||a}if(o)return o!==u[0]&&u.unshift(o),n[o]}(v,T,n)),!i&&-1<ce.inArray("script",v.dataTypes)&&ce.inArray("json",v.dataTypes)<0&&(v.converters["text script"]=function(){}),s=function(e,t,n,r){var i,o,a,s,u,l={},c=e.dataTypes.slice();if(c[1])for(a in e.converters)l[a.toLowerCase()]=e.converters[a];o=c.shift();while(o)if(e.responseFields[o]&&(n[e.responseFields[o]]=t),!u&&r&&e.dataFilter&&(t=e.dataFilter(t,e.dataType)),u=o,o=c.shift())if("*"===o)o=u;else if("*"!==u&&u!==o){if(!(a=l[u+" "+o]||l["* "+o]))for(i in l)if((s=i.split(" "))[1]===o&&(a=l[u+" "+s[0]]||l["* "+s[0]])){!0===a?a=l[i]:!0!==l[i]&&(o=s[0],c.unshift(s[1]));break}if(!0!==a)if(a&&e["throws"])t=a(t);else try{t=a(t)}catch(e){return{state:"parsererror",error:a?e:"No conversion from "+u+" to "+o}}}return{state:"success",data:t}}(v,s,T,i),i?(v.ifModified&&((u=T.getResponseHeader("Last-Modified"))&&(ce.lastModified[f]=u),(u=T.getResponseHeader("etag"))&&(ce.etag[f]=u)),204===e||"HEAD"===v.type?l="nocontent":304===e?l="notmodified":(l=s.state,o=s.data,i=!(a=s.error))):(a=l,!e&&l||(l="error",e<0&&(e=0))),T.status=e,T.statusText=(t||l)+"",i?x.resolveWith(y,[o,l,T]):x.rejectWith(y,[T,l,a]),T.statusCode(w),w=void 0,g&&m.trigger(i?"ajaxSuccess":"ajaxError",[T,v,i?o:a]),b.fireWith(y,[T,l]),g&&(m.trigger("ajaxComplete",[T,v]),--ce.active||ce.event.trigger("ajaxStop")))}return T},getJSON:function(e,t,n){return ce.get(e,t,n,"json")},getScript:function(e,t){return ce.get(e,void 0,t,"script")}}),ce.each(["get","post"],function(e,i){ce[i]=function(e,t,n,r){return v(t)&&(r=r||n,n=t,t=void 0),ce.ajax(ce.extend({url:e,type:i,dataType:r,data:t,success:n},ce.isPlainObject(e)&&e))}}),ce.ajaxPrefilter(function(e){var t;for(t in e.headers)"content-type"===t.toLowerCase()&&(e.contentType=e.headers[t]||"")}),ce._evalUrl=function(e,t,n){return ce.ajax({url:e,type:"GET",dataType:"script",cache:!0,async:!1,global:!1,converters:{"text script":function(){}},dataFilter:function(e){ce.globalEval(e,t,n)}})},ce.fn.extend({wrapAll:function(e){var t;return this[0]&&(v(e)&&(e=e.call(this[0])),t=ce(e,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&t.insertBefore(this[0]),t.map(function(){var e=this;while(e.firstElementChild)e=e.firstElementChild;return e}).append(this)),this},wrapInner:function(n){return v(n)?this.each(function(e){ce(this).wrapInner(n.call(this,e))}):this.each(function(){var e=ce(this),t=e.contents();t.length?t.wrapAll(n):e.append(n)})},wrap:function(t){var n=v(t);return this.each(function(e){ce(this).wrapAll(n?t.call(this,e):t)})},unwrap:function(e){return this.parent(e).not("body").each(function(){ce(this).replaceWith(this.childNodes)}),this}}),ce.expr.pseudos.hidden=function(e){return!ce.expr.pseudos.visible(e)},ce.expr.pseudos.visible=function(e){return!!(e.offsetWidth||e.offsetHeight||e.getClientRects().length)},ce.ajaxSettings.xhr=function(){try{return new ie.XMLHttpRequest}catch(e){}};var Yt={0:200,1223:204},Qt=ce.ajaxSettings.xhr();le.cors=!!Qt&&"withCredentials"in Qt,le.ajax=Qt=!!Qt,ce.ajaxTransport(function(i){var o,a;if(le.cors||Qt&&!i.crossDomain)return{send:function(e,t){var n,r=i.xhr();if(r.open(i.type,i.url,i.async,i.username,i.password),i.xhrFields)for(n in i.xhrFields)r[n]=i.xhrFields[n];for(n in i.mimeType&&r.overrideMimeType&&r.overrideMimeType(i.mimeType),i.crossDomain||e["X-Requested-With"]||(e["X-Requested-With"]="XMLHttpRequest"),e)r.setRequestHeader(n,e[n]);o=function(e){return function(){o&&(o=a=r.onload=r.onerror=r.onabort=r.ontimeout=r.onreadystatechange=null,"abort"===e?r.abort():"error"===e?"number"!=typeof r.status?t(0,"error"):t(r.status,r.statusText):t(Yt[r.status]||r.status,r.statusText,"text"!==(r.responseType||"text")||"string"!=typeof r.responseText?{binary:r.response}:{text:r.responseText},r.getAllResponseHeaders()))}},r.onload=o(),a=r.onerror=r.ontimeout=o("error"),void 0!==r.onabort?r.onabort=a:r.onreadystatechange=function(){4===r.readyState&&ie.setTimeout(function(){o&&a()})},o=o("abort");try{r.send(i.hasContent&&i.data||null)}catch(e){if(o)throw e}},abort:function(){o&&o()}}}),ce.ajaxPrefilter(function(e){e.crossDomain&&(e.contents.script=!1)}),ce.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(e){return ce.globalEval(e),e}}}),ce.ajaxPrefilter("script",function(e){void 0===e.cache&&(e.cache=!1),e.crossDomain&&(e.type="GET")}),ce.ajaxTransport("script",function(n){var r,i;if(n.crossDomain||n.scriptAttrs)return{send:function(e,t){r=ce("<script>").attr(n.scriptAttrs||{}).prop({charset:n.scriptCharset,src:n.url}).on("load error",i=function(e){r.remove(),i=null,e&&t("error"===e.type?404:200,e.type)}),C.head.appendChild(r[0])},abort:function(){i&&i()}}});var Jt,Kt=[],Zt=/(=)\?(?=&|$)|\?\?/;ce.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var e=Kt.pop()||ce.expando+"_"+jt.guid++;return this[e]=!0,e}}),ce.ajaxPrefilter("json jsonp",function(e,t,n){var r,i,o,a=!1!==e.jsonp&&(Zt.test(e.url)?"url":"string"==typeof e.data&&0===(e.contentType||"").indexOf("application/x-www-form-urlencoded")&&Zt.test(e.data)&&"data");if(a||"jsonp"===e.dataTypes[0])return r=e.jsonpCallback=v(e.jsonpCallback)?e.jsonpCallback():e.jsonpCallback,a?e[a]=e[a].replace(Zt,"$1"+r):!1!==e.jsonp&&(e.url+=(At.test(e.url)?"&":"?")+e.jsonp+"="+r),e.converters["script json"]=function(){return o||ce.error(r+" was not called"),o[0]},e.dataTypes[0]="json",i=ie[r],ie[r]=function(){o=arguments},n.always(function(){void 0===i?ce(ie).removeProp(r):ie[r]=i,e[r]&&(e.jsonpCallback=t.jsonpCallback,Kt.push(r)),o&&v(i)&&i(o[0]),o=i=void 0}),"script"}),le.createHTMLDocument=((Jt=C.implementation.createHTMLDocument("").body).innerHTML="<form></form><form></form>",2===Jt.childNodes.length),ce.parseHTML=function(e,t,n){return"string"!=typeof e?[]:("boolean"==typeof t&&(n=t,t=!1),t||(le.createHTMLDocument?((r=(t=C.implementation.createHTMLDocument("")).createElement("base")).href=C.location.href,t.head.appendChild(r)):t=C),o=!n&&[],(i=w.exec(e))?[t.createElement(i[1])]:(i=Ae([e],t,o),o&&o.length&&ce(o).remove(),ce.merge([],i.childNodes)));var r,i,o},ce.fn.load=function(e,t,n){var r,i,o,a=this,s=e.indexOf(" ");return-1<s&&(r=Tt(e.slice(s)),e=e.slice(0,s)),v(t)?(n=t,t=void 0):t&&"object"==typeof t&&(i="POST"),0<a.length&&ce.ajax({url:e,type:i||"GET",dataType:"html",data:t}).done(function(e){o=arguments,a.html(r?ce("<div>").append(ce.parseHTML(e)).find(r):e)}).always(n&&function(e,t){a.each(function(){n.apply(this,o||[e.responseText,t,e])})}),this},ce.expr.pseudos.animated=function(t){return ce.grep(ce.timers,function(e){return t===e.elem}).length},ce.offset={setOffset:function(e,t,n){var r,i,o,a,s,u,l=ce.css(e,"position"),c=ce(e),f={};"static"===l&&(e.style.position="relative"),s=c.offset(),o=ce.css(e,"top"),u=ce.css(e,"left"),("absolute"===l||"fixed"===l)&&-1<(o+u).indexOf("auto")?(a=(r=c.position()).top,i=r.left):(a=parseFloat(o)||0,i=parseFloat(u)||0),v(t)&&(t=t.call(e,n,ce.extend({},s))),null!=t.top&&(f.top=t.top-s.top+a),null!=t.left&&(f.left=t.left-s.left+i),"using"in t?t.using.call(e,f):c.css(f)}},ce.fn.extend({offset:function(t){if(arguments.length)return void 0===t?this:this.each(function(e){ce.offset.setOffset(this,t,e)});var e,n,r=this[0];return r?r.getClientRects().length?(e=r.getBoundingClientRect(),n=r.ownerDocument.defaultView,{top:e.top+n.pageYOffset,left:e.left+n.pageXOffset}):{top:0,left:0}:void 0},position:function(){if(this[0]){var e,t,n,r=this[0],i={top:0,left:0};if("fixed"===ce.css(r,"position"))t=r.getBoundingClientRect();else{t=this.offset(),n=r.ownerDocument,e=r.offsetParent||n.documentElement;while(e&&(e===n.body||e===n.documentElement)&&"static"===ce.css(e,"position"))e=e.parentNode;e&&e!==r&&1===e.nodeType&&((i=ce(e).offset()).top+=ce.css(e,"borderTopWidth",!0),i.left+=ce.css(e,"borderLeftWidth",!0))}return{top:t.top-i.top-ce.css(r,"marginTop",!0),left:t.left-i.left-ce.css(r,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){var e=this.offsetParent;while(e&&"static"===ce.css(e,"position"))e=e.offsetParent;return e||J})}}),ce.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(t,i){var o="pageYOffset"===i;ce.fn[t]=function(e){return M(this,function(e,t,n){var r;if(y(e)?r=e:9===e.nodeType&&(r=e.defaultView),void 0===n)return r?r[i]:e[t];r?r.scrollTo(o?r.pageXOffset:n,o?n:r.pageYOffset):e[t]=n},t,e,arguments.length)}}),ce.each(["top","left"],function(e,n){ce.cssHooks[n]=Ye(le.pixelPosition,function(e,t){if(t)return t=Ge(e,n),_e.test(t)?ce(e).position()[n]+"px":t})}),ce.each({Height:"height",Width:"width"},function(a,s){ce.each({padding:"inner"+a,content:s,"":"outer"+a},function(r,o){ce.fn[o]=function(e,t){var n=arguments.length&&(r||"boolean"!=typeof e),i=r||(!0===e||!0===t?"margin":"border");return M(this,function(e,t,n){var r;return y(e)?0===o.indexOf("outer")?e["inner"+a]:e.document.documentElement["client"+a]:9===e.nodeType?(r=e.documentElement,Math.max(e.body["scroll"+a],r["scroll"+a],e.body["offset"+a],r["offset"+a],r["client"+a])):void 0===n?ce.css(e,t,i):ce.style(e,t,n,i)},s,n?e:void 0,n)}})}),ce.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(e,t){ce.fn[t]=function(e){return this.on(t,e)}}),ce.fn.extend({bind:function(e,t,n){return this.on(e,null,t,n)},unbind:function(e,t){return this.off(e,null,t)},delegate:function(e,t,n,r){return this.on(t,e,n,r)},undelegate:function(e,t,n){return 1===arguments.length?this.off(e,"**"):this.off(t,e||"**",n)},hover:function(e,t){return this.on("mouseenter",e).on("mouseleave",t||e)}}),ce.each("blur focus focusin focusout resize scroll click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup contextmenu".split(" "),function(e,n){ce.fn[n]=function(e,t){return 0<arguments.length?this.on(n,null,e,t):this.trigger(n)}});var en=/^[\s\uFEFF\xA0]+|([^\s\uFEFF\xA0])[\s\uFEFF\xA0]+$/g;ce.proxy=function(e,t){var n,r,i;if("string"==typeof t&&(n=e[t],t=e,e=n),v(e))return r=ae.call(arguments,2),(i=function(){return e.apply(t||this,r.concat(ae.call(arguments)))}).guid=e.guid=e.guid||ce.guid++,i},ce.holdReady=function(e){e?ce.readyWait++:ce.ready(!0)},ce.isArray=Array.isArray,ce.parseJSON=JSON.parse,ce.nodeName=fe,ce.isFunction=v,ce.isWindow=y,ce.camelCase=F,ce.type=x,ce.now=Date.now,ce.isNumeric=function(e){var t=ce.type(e);return("number"===t||"string"===t)&&!isNaN(e-parseFloat(e))},ce.trim=function(e){return null==e?"":(e+"").replace(en,"$1")},"function"==typeof define&&define.amd&&define("jquery",[],function(){return ce});var tn=ie.jQuery,nn=ie.$;return ce.noConflict=function(e){return ie.$===ce&&(ie.$=nn),e&&ie.jQuery===ce&&(ie.jQuery=tn),ce},"undefined"==typeof e&&(ie.jQuery=ie.$=ce),ce});
/*
 * jQuery throttle / debounce - v1.1 - 3/7/2010
 * http://benalman.com/projects/jquery-throttle-debounce-plugin/
 * 
 * Copyright (c) 2010 "Cowboy" Ben Alman
 * Dual licensed under the MIT and GPL licenses.
 * http://benalman.com/about/license/
 */
(function(b,c){var $=b.jQuery||b.Cowboy||(b.Cowboy={}),a;$.throttle=a=function(e,f,j,i){var h,d=0;if(typeof f!=="boolean"){i=j;j=f;f=c}function g(){var o=this,m=+new Date()-d,n=arguments;function l(){d=+new Date();j.apply(o,n)}function k(){h=c}if(i&&!h){l()}h&&clearTimeout(h);if(i===c&&m>e){l()}else{if(f!==true){h=setTimeout(i?k:l,i===c?e-m:e)}}}if($.guid){g.guid=j.guid=j.guid||$.guid++}return g};$.debounce=function(d,e,f){return f===c?a(d,e,false):a(d,f,e!==false)}})(this);
/*!
 * imagesLoaded PACKAGED v4.1.4
 * JavaScript is all like "You images are done yet or what?"
 * MIT License
 */
!function(e,t){"function"==typeof define&&define.amd?define("ev-emitter/ev-emitter",t):"object"==typeof module&&module.exports?module.exports=t():e.EvEmitter=t()}("undefined"!=typeof window?window:this,function(){function e(){}var t=e.prototype;return t.on=function(e,t){if(e&&t){var i=this._events=this._events||{},n=i[e]=i[e]||[];return n.indexOf(t)==-1&&n.push(t),this}},t.once=function(e,t){if(e&&t){this.on(e,t);var i=this._onceEvents=this._onceEvents||{},n=i[e]=i[e]||{};return n[t]=!0,this}},t.off=function(e,t){var i=this._events&&this._events[e];if(i&&i.length){var n=i.indexOf(t);return n!=-1&&i.splice(n,1),this}},t.emitEvent=function(e,t){var i=this._events&&this._events[e];if(i&&i.length){i=i.slice(0),t=t||[];for(var n=this._onceEvents&&this._onceEvents[e],o=0;o<i.length;o++){var r=i[o],s=n&&n[r];s&&(this.off(e,r),delete n[r]),r.apply(this,t)}return this}},t.allOff=function(){delete this._events,delete this._onceEvents},e}),function(e,t){"use strict";"function"==typeof define&&define.amd?define(["ev-emitter/ev-emitter"],function(i){return t(e,i)}):"object"==typeof module&&module.exports?module.exports=t(e,require("ev-emitter")):e.imagesLoaded=t(e,e.EvEmitter)}("undefined"!=typeof window?window:this,function(e,t){function i(e,t){for(var i in t)e[i]=t[i];return e}function n(e){if(Array.isArray(e))return e;var t="object"==typeof e&&"number"==typeof e.length;return t?d.call(e):[e]}function o(e,t,r){if(!(this instanceof o))return new o(e,t,r);var s=e;return"string"==typeof e&&(s=document.querySelectorAll(e)),s?(this.elements=n(s),this.options=i({},this.options),"function"==typeof t?r=t:i(this.options,t),r&&this.on("always",r),this.getImages(),h&&(this.jqDeferred=new h.Deferred),void setTimeout(this.check.bind(this))):void a.error("Bad element for imagesLoaded "+(s||e))}function r(e){this.img=e}function s(e,t){this.url=e,this.element=t,this.img=new Image}var h=e.jQuery,a=e.console,d=Array.prototype.slice;o.prototype=Object.create(t.prototype),o.prototype.options={},o.prototype.getImages=function(){this.images=[],this.elements.forEach(this.addElementImages,this)},o.prototype.addElementImages=function(e){"IMG"==e.nodeName&&this.addImage(e),this.options.background===!0&&this.addElementBackgroundImages(e);var t=e.nodeType;if(t&&u[t]){for(var i=e.querySelectorAll("img"),n=0;n<i.length;n++){var o=i[n];this.addImage(o)}if("string"==typeof this.options.background){var r=e.querySelectorAll(this.options.background);for(n=0;n<r.length;n++){var s=r[n];this.addElementBackgroundImages(s)}}}};var u={1:!0,9:!0,11:!0};return o.prototype.addElementBackgroundImages=function(e){var t=getComputedStyle(e);if(t)for(var i=/url\((['"])?(.*?)\1\)/gi,n=i.exec(t.backgroundImage);null!==n;){var o=n&&n[2];o&&this.addBackground(o,e),n=i.exec(t.backgroundImage)}},o.prototype.addImage=function(e){var t=new r(e);this.images.push(t)},o.prototype.addBackground=function(e,t){var i=new s(e,t);this.images.push(i)},o.prototype.check=function(){function e(e,i,n){setTimeout(function(){t.progress(e,i,n)})}var t=this;return this.progressedCount=0,this.hasAnyBroken=!1,this.images.length?void this.images.forEach(function(t){t.once("progress",e),t.check()}):void this.complete()},o.prototype.progress=function(e,t,i){this.progressedCount++,this.hasAnyBroken=this.hasAnyBroken||!e.isLoaded,this.emitEvent("progress",[this,e,t]),this.jqDeferred&&this.jqDeferred.notify&&this.jqDeferred.notify(this,e),this.progressedCount==this.images.length&&this.complete(),this.options.debug&&a&&a.log("progress: "+i,e,t)},o.prototype.complete=function(){var e=this.hasAnyBroken?"fail":"done";if(this.isComplete=!0,this.emitEvent(e,[this]),this.emitEvent("always",[this]),this.jqDeferred){var t=this.hasAnyBroken?"reject":"resolve";this.jqDeferred[t](this)}},r.prototype=Object.create(t.prototype),r.prototype.check=function(){var e=this.getIsImageComplete();return e?void this.confirm(0!==this.img.naturalWidth,"naturalWidth"):(this.proxyImage=new Image,this.proxyImage.addEventListener("load",this),this.proxyImage.addEventListener("error",this),this.img.addEventListener("load",this),this.img.addEventListener("error",this),void(this.proxyImage.src=this.img.src))},r.prototype.getIsImageComplete=function(){return this.img.complete&&this.img.naturalWidth},r.prototype.confirm=function(e,t){this.isLoaded=e,this.emitEvent("progress",[this,this.img,t])},r.prototype.handleEvent=function(e){var t="on"+e.type;this[t]&&this[t](e)},r.prototype.onload=function(){this.confirm(!0,"onload"),this.unbindEvents()},r.prototype.onerror=function(){this.confirm(!1,"onerror"),this.unbindEvents()},r.prototype.unbindEvents=function(){this.proxyImage.removeEventListener("load",this),this.proxyImage.removeEventListener("error",this),this.img.removeEventListener("load",this),this.img.removeEventListener("error",this)},s.prototype=Object.create(r.prototype),s.prototype.check=function(){this.img.addEventListener("load",this),this.img.addEventListener("error",this),this.img.src=this.url;var e=this.getIsImageComplete();e&&(this.confirm(0!==this.img.naturalWidth,"naturalWidth"),this.unbindEvents())},s.prototype.unbindEvents=function(){this.img.removeEventListener("load",this),this.img.removeEventListener("error",this)},s.prototype.confirm=function(e,t){this.isLoaded=e,this.emitEvent("progress",[this,this.element,t])},o.makeJQueryPlugin=function(t){t=t||e.jQuery,t&&(h=t,h.fn.imagesLoaded=function(e,t){var i=new o(this,e,t);return i.jqDeferred.promise(h(this))})},o.makeJQueryPlugin(),o});
/*! lz-string.min.js v1.5.0 | (c) 2023 Pieroxy | MIT license */
var LZString=function(){var r=String.fromCharCode,o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+-$",e={};function t(r,o){if(!e[r]){e[r]={};for(var n=0;n<r.length;n++)e[r][r.charAt(n)]=n}return e[r][o]}var i={compressToBase64:function(r){if(null==r)return"";var n=i._compress(r,6,function(r){return o.charAt(r)});switch(n.length%4){default:case 0:return n;case 1:return n+"===";case 2:return n+"==";case 3:return n+"="}},decompressFromBase64:function(r){return null==r?"":""==r?null:i._decompress(r.length,32,function(n){return t(o,r.charAt(n))})},compressToUTF16:function(o){return null==o?"":i._compress(o,15,function(o){return r(o+32)})+" "},decompressFromUTF16:function(r){return null==r?"":""==r?null:i._decompress(r.length,16384,function(o){return r.charCodeAt(o)-32})},compressToUint8Array:function(r){for(var o=i.compress(r),n=new Uint8Array(2*o.length),e=0,t=o.length;e<t;e++){var s=o.charCodeAt(e);n[2*e]=s>>>8,n[2*e+1]=s%256}return n},decompressFromUint8Array:function(o){if(null==o)return i.decompress(o);for(var n=new Array(o.length/2),e=0,t=n.length;e<t;e++)n[e]=256*o[2*e]+o[2*e+1];var s=[];return n.forEach(function(o){s.push(r(o))}),i.decompress(s.join(""))},compressToEncodedURIComponent:function(r){return null==r?"":i._compress(r,6,function(r){return n.charAt(r)})},decompressFromEncodedURIComponent:function(r){return null==r?"":""==r?null:(r=r.replace(/ /g,"+"),i._decompress(r.length,32,function(o){return t(n,r.charAt(o))}))},compress:function(o){return i._compress(o,16,function(o){return r(o)})},_compress:function(r,o,n){if(null==r)return"";var e,t,i,s={},u={},a="",p="",c="",l=2,f=3,h=2,d=[],m=0,v=0;for(i=0;i<r.length;i+=1)if(a=r.charAt(i),Object.prototype.hasOwnProperty.call(s,a)||(s[a]=f++,u[a]=!0),p=c+a,Object.prototype.hasOwnProperty.call(s,p))c=p;else{if(Object.prototype.hasOwnProperty.call(u,c)){if(c.charCodeAt(0)<256){for(e=0;e<h;e++)m<<=1,v==o-1?(v=0,d.push(n(m)),m=0):v++;for(t=c.charCodeAt(0),e=0;e<8;e++)m=m<<1|1&t,v==o-1?(v=0,d.push(n(m)),m=0):v++,t>>=1}else{for(t=1,e=0;e<h;e++)m=m<<1|t,v==o-1?(v=0,d.push(n(m)),m=0):v++,t=0;for(t=c.charCodeAt(0),e=0;e<16;e++)m=m<<1|1&t,v==o-1?(v=0,d.push(n(m)),m=0):v++,t>>=1}0==--l&&(l=Math.pow(2,h),h++),delete u[c]}else for(t=s[c],e=0;e<h;e++)m=m<<1|1&t,v==o-1?(v=0,d.push(n(m)),m=0):v++,t>>=1;0==--l&&(l=Math.pow(2,h),h++),s[p]=f++,c=String(a)}if(""!==c){if(Object.prototype.hasOwnProperty.call(u,c)){if(c.charCodeAt(0)<256){for(e=0;e<h;e++)m<<=1,v==o-1?(v=0,d.push(n(m)),m=0):v++;for(t=c.charCodeAt(0),e=0;e<8;e++)m=m<<1|1&t,v==o-1?(v=0,d.push(n(m)),m=0):v++,t>>=1}else{for(t=1,e=0;e<h;e++)m=m<<1|t,v==o-1?(v=0,d.push(n(m)),m=0):v++,t=0;for(t=c.charCodeAt(0),e=0;e<16;e++)m=m<<1|1&t,v==o-1?(v=0,d.push(n(m)),m=0):v++,t>>=1}0==--l&&(l=Math.pow(2,h),h++),delete u[c]}else for(t=s[c],e=0;e<h;e++)m=m<<1|1&t,v==o-1?(v=0,d.push(n(m)),m=0):v++,t>>=1;0==--l&&(l=Math.pow(2,h),h++)}for(t=2,e=0;e<h;e++)m=m<<1|1&t,v==o-1?(v=0,d.push(n(m)),m=0):v++,t>>=1;for(;;){if(m<<=1,v==o-1){d.push(n(m));break}v++}return d.join("")},decompress:function(r){return null==r?"":""==r?null:i._decompress(r.length,32768,function(o){return r.charCodeAt(o)})},_decompress:function(o,n,e){var t,i,s,u,a,p,c,l=[],f=4,h=4,d=3,m="",v=[],g={val:e(0),position:n,index:1};for(t=0;t<3;t+=1)l[t]=t;for(s=0,a=Math.pow(2,2),p=1;p!=a;)u=g.val&g.position,g.position>>=1,0==g.position&&(g.position=n,g.val=e(g.index++)),s|=(u>0?1:0)*p,p<<=1;switch(s){case 0:for(s=0,a=Math.pow(2,8),p=1;p!=a;)u=g.val&g.position,g.position>>=1,0==g.position&&(g.position=n,g.val=e(g.index++)),s|=(u>0?1:0)*p,p<<=1;c=r(s);break;case 1:for(s=0,a=Math.pow(2,16),p=1;p!=a;)u=g.val&g.position,g.position>>=1,0==g.position&&(g.position=n,g.val=e(g.index++)),s|=(u>0?1:0)*p,p<<=1;c=r(s);break;case 2:return""}for(l[3]=c,i=c,v.push(c);;){if(g.index>o)return"";for(s=0,a=Math.pow(2,d),p=1;p!=a;)u=g.val&g.position,g.position>>=1,0==g.position&&(g.position=n,g.val=e(g.index++)),s|=(u>0?1:0)*p,p<<=1;switch(c=s){case 0:for(s=0,a=Math.pow(2,8),p=1;p!=a;)u=g.val&g.position,g.position>>=1,0==g.position&&(g.position=n,g.val=e(g.index++)),s|=(u>0?1:0)*p,p<<=1;l[h++]=r(s),c=h-1,f--;break;case 1:for(s=0,a=Math.pow(2,16),p=1;p!=a;)u=g.val&g.position,g.position>>=1,0==g.position&&(g.position=n,g.val=e(g.index++)),s|=(u>0?1:0)*p,p<<=1;l[h++]=r(s),c=h-1,f--;break;case 2:return v.join("")}if(0==f&&(f=Math.pow(2,d),d++),l[c])m=l[c];else{if(c!==h)return null;m=i+i.charAt(0)}v.push(m),l[h++]=i+m.charAt(0),i=m,0==--f&&(f=Math.pow(2,d),d++)}}};return i}();"function"==typeof define&&define.amd?define(function(){return LZString}):"undefined"!=typeof module&&null!=module?module.exports=LZString:"undefined"!=typeof angular&&null!=angular&&angular.module("LZString",[]).factory("LZString",function(){return LZString});
/*! @source http://purl.eligrey.com/github/FileSaver.js/blob/master/dist/FileSaver.js */
(function(a,b){if("function"==typeof define&&define.amd)define([],b);else if("undefined"!=typeof exports)b();else{b(),a.FileSaver={exports:{}}.exports}})(this,function(){"use strict";function b(a,b){return"undefined"==typeof b?b={autoBom:!1}:"object"!=typeof b&&(console.warn("Deprecated: Expected third argument to be a object"),b={autoBom:!b}),b.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(a.type)?new Blob(["\uFEFF",a],{type:a.type}):a}function c(a,b,c){var d=new XMLHttpRequest;d.open("GET",a),d.responseType="blob",d.onload=function(){g(d.response,b,c)},d.onerror=function(){console.error("could not download file")},d.send()}function d(a){var b=new XMLHttpRequest;b.open("HEAD",a,!1);try{b.send()}catch(a){}return 200<=b.status&&299>=b.status}function e(a){try{a.dispatchEvent(new MouseEvent("click"))}catch(c){var b=document.createEvent("MouseEvents");b.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),a.dispatchEvent(b)}}var f="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof global&&global.global===global?global:void 0,a=/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),g=f.saveAs||("object"!=typeof window||window!==f?function(){}:"download"in HTMLAnchorElement.prototype&&!a?function(b,g,h){var i=f.URL||f.webkitURL,j=document.createElement("a");g=g||b.name||"download",j.download=g,j.rel="noopener","string"==typeof b?(j.href=b,j.origin===location.origin?e(j):d(j.href)?c(b,g,h):e(j,j.target="_blank")):(j.href=i.createObjectURL(b),setTimeout(function(){i.revokeObjectURL(j.href)},4E4),setTimeout(function(){e(j)},0))}:"msSaveOrOpenBlob"in navigator?function(f,g,h){if(g=g||f.name||"download","string"!=typeof f)navigator.msSaveOrOpenBlob(b(f,h),g);else if(d(f))c(f,g,h);else{var i=document.createElement("a");i.href=f,i.target="_blank",setTimeout(function(){e(i)})}}:function(b,d,e,g){if(g=g||open("","_blank"),g&&(g.document.title=g.document.body.innerText="downloading..."),"string"==typeof b)return c(b,d,e);var h="application/octet-stream"===b.type,i=/constructor/i.test(f.HTMLElement)||f.safari,j=/CriOS\/[\d]+/.test(navigator.userAgent);if((j||h&&i||a)&&"undefined"!=typeof FileReader){var k=new FileReader;k.onloadend=function(){var a=k.result;a=j?a:a.replace(/^data:[^;]*;/,"data:attachment/file;"),g?g.location.href=a:location=a,g=null},k.readAsDataURL(b)}else{var l=f.URL||f.webkitURL,m=l.createObjectURL(b);g?g.location=m:location.href=m,g=null,setTimeout(function(){l.revokeObjectURL(m)},4E4)}});f.saveAs=g.saveAs=g,"undefined"!=typeof module&&(module.exports=g)});
/*! seedrandom.js v3.0.5 | Copyright 2019 David Bau. | MIT license */
!function(f,a,c){var s,l=256,p="random",d=c.pow(l,6),g=c.pow(2,52),y=2*g,h=l-1;function n(n,t,r){function e(){for(var n=u.g(6),t=d,r=0;n<g;)n=(n+r)*l,t*=l,r=u.g(1);for(;y<=n;)n/=2,t/=2,r>>>=1;return(n+r)/t}var o=[],i=j(function n(t,r){var e,o=[],i=typeof t;if(r&&"object"==i)for(e in t)try{o.push(n(t[e],r-1))}catch(n){}return o.length?o:"string"==i?t:t+"\0"}((t=1==t?{entropy:!0}:t||{}).entropy?[n,S(a)]:null==n?function(){try{var n;return s&&(n=s.randomBytes)?n=n(l):(n=new Uint8Array(l),(f.crypto||f.msCrypto).getRandomValues(n)),S(n)}catch(n){var t=f.navigator,r=t&&t.plugins;return[+new Date,f,r,f.screen,S(a)]}}():n,3),o),u=new m(o);return e.int32=function(){return 0|u.g(4)},e.quick=function(){return u.g(4)/4294967296},e.double=e,j(S(u.S),a),(t.pass||r||function(n,t,r,e){return e&&(e.S&&v(e,u),n.state=function(){return v(u,{})}),r?(c[p]=n,t):n})(e,i,"global"in t?t.global:this==c,t.state)}function m(n){var t,r=n.length,u=this,e=0,o=u.i=u.j=0,i=u.S=[];for(r||(n=[r++]);e<l;)i[e]=e++;for(e=0;e<l;e++)i[e]=i[o=h&o+n[e%r]+(t=i[e])],i[o]=t;(u.g=function(n){for(var t,r=0,e=u.i,o=u.j,i=u.S;n--;)t=i[e=h&e+1],r=r*l+i[h&(i[e]=i[o=h&o+t])+(i[o]=t)];return u.i=e,u.j=o,r})(l)}function v(n,t){return t.i=n.i,t.j=n.j,t.S=n.S.slice(),t}function j(n,t){for(var r,e=n+"",o=0;o<e.length;)t[h&o]=h&(r^=19*t[h&o])+e.charCodeAt(o++);return S(t)}function S(n){return String.fromCharCode.apply(0,n)}if(j(c.random(),a),"object"==typeof module&&module.exports){module.exports=n;try{s=require("crypto")}catch(n){}}else"function"==typeof define&&define.amd?define(function(){return n}):c["seed"+p]=n}("undefined"!=typeof self?self:this,[],Math);
/*! console_hack.js | (c) 2015 Thomas Michael Edwards | Licensed under SugarCube's Simple BSD license */
!function(){for(var methods=["assert","clear","count","debug","dir","dirxml","error","exception","group","groupCollapsed","groupEnd","info","log","markTimeline","profile","profileEnd","table","time","timeEnd","timeline","timelineEnd","timeStamp","trace","warn"],length=methods.length,noop=function(){},console=window.console=window.console||{};length--;){var method=methods[length];console[method]||(console[method]=noop)}}();
}else{document.documentElement.setAttribute("data-init", "lacking");}
</script>
<style id="style-normalize" type="text/css">/*! normalize.css v3.0.3 | MIT License | github.com/necolas/normalize.css */html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}body{margin:0}article,aside,details,figcaption,figure,footer,header,hgroup,main,menu,nav,section,summary{display:block}audio,canvas,progress,video{display:inline-block;vertical-align:baseline}audio:not([controls]){display:none;height:0}[hidden],template{display:none}a{background-color:transparent}a:active,a:hover{outline:0}abbr[title]{border-bottom:1px dotted}b,strong{font-weight:700}dfn{font-style:italic}h1{font-size:2em;margin:.67em 0}mark{background:#ff0;color:#000}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sup{top:-.5em}sub{bottom:-.25em}img{border:0}svg:not(:root){overflow:hidden}figure{margin:1em 40px}hr{box-sizing:content-box;height:0}pre{overflow:auto}code,kbd,pre,samp{font-family:monospace,monospace;font-size:1em}button,input,optgroup,select,textarea{color:inherit;font:inherit;margin:0}button{overflow:visible}button,select{text-transform:none}button,html input[type=button],input[type=reset],input[type=submit]{-webkit-appearance:button;cursor:pointer}button[disabled],html input[disabled]{cursor:default}button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}input{line-height:normal}input[type=checkbox],input[type=radio]{box-sizing:border-box;padding:0}input[type=number]::-webkit-inner-spin-button,input[type=number]::-webkit-outer-spin-button{height:auto}input[type=search]{-webkit-appearance:textfield;box-sizing:content-box}input[type=search]::-webkit-search-cancel-button,input[type=search]::-webkit-search-decoration{-webkit-appearance:none}fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}legend{border:0;padding:0}textarea{overflow:auto}optgroup{font-weight:700}table{border-collapse:collapse;border-spacing:0}td,th{padding:0}</style>
<style id="style-init-screen" type="text/css">@-webkit-keyframes init-loading-spin{0%{-webkit-transform:rotate(0);transform:rotate(0)}100%{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}@-o-keyframes init-loading-spin{0%{-o-transform:rotate(0);transform:rotate(0)}100%{-o-transform:rotate(360deg);transform:rotate(360deg)}}@keyframes init-loading-spin{0%{-webkit-transform:rotate(0);-o-transform:rotate(0);transform:rotate(0)}100%{-webkit-transform:rotate(360deg);-o-transform:rotate(360deg);transform:rotate(360deg)}}#init-screen{display:none;z-index:500000;position:fixed;top:0;left:0;height:100%;width:100%;font:28px/1 Helmet,Freesans,sans-serif;font-weight:700;color:#eee;background-color:#111;text-align:center}#init-screen>div{display:none;position:relative;margin:0 auto;max-width:1136px;top:25%}html[data-init=lacking] #init-screen,html[data-init=loading] #init-screen,html[data-init=no-js] #init-screen{display:block}html[data-init=lacking] #init-lacking,html[data-init=no-js] #init-no-js{display:block;padding:0 1em}html[data-init=no-js] #init-no-js{color:red}html[data-init=loading] #init-loading{-webkit-animation:init-loading-spin 2s linear infinite;-o-animation:init-loading-spin 2s linear infinite;animation:init-loading-spin 2s linear infinite;border:12px solid transparent;border-bottom-color:#7f7f7f;border-radius:50%;border-top-color:#7f7f7f;display:block;height:100px;width:100px}html[data-init=loading] #init-loading>div{text-indent:16128px;overflow:hidden;white-space:nowrap}html[data-init=loading] #story,html[data-init=loading] #ui-bar{display:none!important}</style>
<style id="style-font-icons" type="text/css">@font-face{font-family:sc-icons;font-display:block;src:url("data:application/octet-stream;base64,d09GRgABAAAAAFRoAAsAAAAAVBwAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAABPUy8yAAABCAAAAGAAAABgD1IUnWNtYXAAAAFoAAACdAAAAnQzsxFSZ2FzcAAAA9wAAAAIAAAACAAAABBnbHlmAAAD5AAASzgAAEs4ynuL3WhlYWQAAE8cAAAANgAAADYc3WiNaGhlYQAAT1QAAAAkAAAAJAiCBP1obXR4AABPeAAAAfAAAAHwyjAFu2xvY2EAAFFoAAAA+gAAAPpXLER0bWF4cAAAUmQAAAAgAAAAIACEAIVuYW1lAABShAAAAcIAAAHCiTu08nBvc3QAAFRIAAAAIAAAACAAAwAAAAMDyQGQAAUAAAKZAswAAACPApkCzAAAAesAMwEJAAAAAAAAAAAAAAAAAAAAARAAAAAAAAAAAAAAAAAAAAAAQAAA+CoDgP+AAIADgACAAAAAAQAAAAAAAAAAAAAAIAAAAAAAAwAAAAMAAAAcAAEAAwAAABwAAwABAAAAHAAEAlgAAACSAIAABgASAAEAIPAC8AXwDvAR8BPwFfAZ8CPwKPAu8E7wWvBe8GPwaPBq8G7wcfB48InwjfCT8JzwoPDC8MfwyfDQ8Nrw5/Dr8P7xDvEQ8SfxOvE+8ULxRPFG8UrxUvGG8YjxkfGr8d3x4PH48gXyRPKL8o3y6vLt8vHy+fMe813zgvQQ9Vr1b/V09cD2qfeM99n4Kv/9//8AAAAAACDwAvAE8AzwEPAT8BXwGfAj8CbwLvBI8FDwXvBg8GXwavBu8HDwd/CJ8I3wk/Cc8KDwwfDH8Mnw0PDX8Ofw6/D+8Q3xEPEn8TfxPvFB8UTxRvFK8VDxhfGI8ZHxq/Hd8eDx+PIE8kDyi/KN8ury7fLx8vnzHvNd84H0EPVa9W31dPXA9qn3jPfZ+Cn//f//AAH/4xACEAEP+w/6D/kP+A/1D+wP6g/lD8wPyw/ID8cPxg/FD8IPwQ+8D6wPqQ+kD5wPmQ95D3UPdA9uD2gPXA9ZD0cPOQ84DyIPEw8QDw4PDQ8MDwkPBA7SDtEOyQ6wDn8OfQ5mDlsOIQ3bDdoNfg18DXkNcg1ODRAM7QxgCxcLBQsBCrYJzgjsCKAIUQADAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAH//wAPAAEAAAAAAAAAAAACAAA3OQEAAAAAAQAAAAAAAAAAAAIAADc5AQAAAAABAAAAAAAAAAAAAgAANzkBAAAAAAIAAP+OA/IDgAArAEcAACUWFA8BBiIvAS4BPQEOASMiJy4BJyY1NDc+ATc2MzIXHgEXFhUUBgczMhYXJTI3PgE3NjU0Jy4BJyYjIgcOAQcGFRQXHgEXFgPyDg45DigOxwcHNYNIVkxMcSAhISBxTExWVkxMcSAhLykhCRIH/nU1Ly5GFBQUFEYuLzU1Ly5GFBQUFEYuLwsOKA45Dg7HBxIJISkvISBxTExWVkxMcSAhISBxTExWSIM1BwcOFBRGLi81NS8uRhQUFBRGLi81NS8uRhQUAAAAAAEAEv/TA+4DNQAjAAABFhceAQcGBwEGIicBJicmNjc2NzY3NhYXFh8BNzY3PgEXFhcDnS8YGQUUFCr+fRM1Ev59KxMUBRkYLyoxMWUvMCYnJyYwL2UxMikDAyg2NnI3Nyz+cBMTAZAsNzdyNjYoIw8OCBYWJykpJxYWCA4PIwAAAQA8/4cERANcABgAAAE2MhcTBR4BDwETFgYnJQUGJjcTJyY2NyUCBxFQEYMBJCgYHNQyB0Ej/vv++yNBBzLUHBknASQDXCQk/vgrBksczv7dKC4SiooSLigBI84cSwYrAAAAAAEADwARA/EC7wAVAAAlASY0PwE2Mh8BATYyHwEWFAcBBiInAVz+sw8PSA8rD+AB4A8rD0gPD/2zDyoPEQFNDyoPSQ8P4AHgDw9JDyoP/bMPDwAAAAEAEgAyAq4CzgAjAAABFxYUDwEGIi8BBwYiLwEmND8BJyY0PwE2Mh8BNzYyHwEWFAcB5ckSEi0SNBPIyBM0Ei0SEsnJEhItEjQTyMgTNBItEhIBgMgTNBItEhLJyRISLRI0E8jIEzQSLRISyckSEi0SNBMAAwAA/44D8gOAACMAUABsAAABFRQGKwEVFAYrASImPQEjIiY9ATQ2OwE1NDY7ATIWHQEzMhYBBwYiLwEuAT0BDgEjIicuAScmNTQ3PgE3NjMyFx4BFxYVFAYHMzIWHwEWFAcBNCcuAScmIyIHDgEHBhUUFx4BFxYzMjc+ATc2AmAOCnAOCkAKDnAKDg4KcA4KQAoOcAoOAZI5DicOyAcHNYNIVkxMcSAhISBxTExWVkxMcSAhLykhCRIHxw4O/r4VFkkyMjg4MjFKFhUVFkkyMjg4MjFKFhUCAEAKDnAKDg4KcA4KQAoOcAoODgpwDv29OQ4OxwcSCSEpLyEgcUxMVlZMTHEgISEgcUxMVkiDNQcHxw4oDgIZODIxShYVFRZJMjI4ODIxShYVFRZJMjIAAAMAAP+OA/IDgAAPADwAWAAAARUUBiMhIiY9ATQ2MyEyFgEHBiIvAS4BPQEOASMiJy4BJyY1NDc+ATc2MzIXHgEXFhUUBgczMhYfARYUBwE0Jy4BJyYjIgcOAQcGFRQXHgEXFjMyNz4BNzYCYA4K/rAKDg4KAVAKDgGSOQ4nDsgHBzWDSFZMTHEgISEgcUxMVlZMTHEgIS8pIQkSB8cODv6+FRZJMjI4ODIxShYVFRZJMjI4ODIxShYVAgBACg4OCkAKDg79vTkODscHEgkhKS8hIHFMTFZWTExxICEhIHFMTFZIgzUHB8cOKA4CGTgyMUoWFRUWSTIyODgyMUoWFRUWSTIyAAAAAAIAEP+QA/ADgAA+AE4AAAEWFx4BFxYVFAcOAQcGIyInLgEnJjU0Nz4BNzY3NhYfARYGBw4BFRQXHgEXFjMyNz4BNzY1NCYnLgE/AT4BFwMUBisBIiY1ETQ2OwEyFhUDIC8nJjYPDycnhlpaZ2ZbWocoJw8ONyYmMBEqCx8JBw8+ShoaWz49RkU9PVwbGkdBDwcJHwsqEdAcFEAUHBwUQBQcAxQiLCxnOjs+Z1pahycnJyeGWltmPzo6aCwsIgwJEzgQIwsujVNFPT1cGhsaGlw9PkdOjjALIxA4EwkM/lwUHBwUAeAUHBwUAAAAAgAm/5wD2gNkAFMAXwAAAR4BBw4BBw4BLwEOAQcVFAYHBiInLgE9AS4BJwcGJicuAScmNj8BJjQ3Jy4BNz4BNz4BHwE+ATc1NDY3PgEXHgEdAR4BFzc2FhceARcWBg8BFhQHBTI2NTQmIyIGFRQWA88HBgIRNyUGEQdVGz4hCgk0bzcICyE+GlYHEQUlOBECBgdWBwdWBwYCETglBREHVRs+IQsING83CAshPhtVBxEFJTgRAgYHVQYG/oZCXl5CQl5eAQkFDwk1YCgGAwUxFyQLYwgNAgwMAg0IYwskFzEFAwYoYDUJDwQyIkcjMQQQCDZfKAcCBDEXIwxiCQ0CCwEMAg0JYgwjFzEEAgYpXzYIDwUxI0YjWl5CQl5eQkJeAAAAAAIAAP/ABIADQAAjAFcAAAE+ATMyFhcBERQGIyciJjU4ATE1NCYrASIGHQEUBiMHIiY1ESUeARUUBg8BDgEjIiYnAS4BIyIGBwEOASMiJi8BLgE1NDY3AT4BMzIWHwE1NDY7ATIWFRECMQMIBAQIAwFxEw3gDRMTDYANExMN4A0TA7cEBQMCMwQJBgQIA/4pAwgEBAgD/ikDCAQGCQQzAgMFBAH6DCARESAMsw4KcAoOAlcDAwMD/tH+uA0TARIOvw0TEw2/DhIBEw0BSGEDCgYECAM+BAUDAwGDAwMDA/59AwMFBD4DCAUFCgMBoQoMDAqTkQoODgr+6wAAAAQAAP+ABAADgAAWAC0AOQBFAAABMzIWFREzMhYHAQYiJwEmNjsBETQ2MwEVFAYjISImPQE0NjMhFxYyPwEhMhYVBzQmIyIGFRQWMzI2NzQmIyIGFRQWMzI2AbCgFByvGxQS/s8LIAv+zxMVGrAcFAJQHBT8YBQcHBQBJWIfVB9iASUUHPgXERAYFxEQGIAXERAYFxEQGAOAHBT+sDET/s8LCwExEzEBUBQc/RDgFBwcFOAUHGIeHmIcFLAQGBcREBgXERAYFxEQGBcAAAIAAP+AA4ADgAAgACkAAAEyFhURFAYjISImNRE0NjsBNTQ3PgE3NjMyFx4BFxYdASM1NCYjIgYdAQMgKDg4KP1AKDg4KDAYGFI4Nz8/NzhSGBigVDw8VAHAOCj+gCg4OCgBgCg4kD83OFIYGBgYUjg3P5CQPFRUPJAAAAABAAAADgIAAvIAEQAAATYWFREUBi8BIyImNRE0NjsBAa4WPDsXsswUHBwUzALyFhgg/WAgGBayHBQBIBQcAAAAAgAAAAwDAALwABEAKgAAATYWFREUBi8BIyImNRE0NjsBBR4BFRQGBwYmJyY2Nz4BNTQmJy4BNz4BFwGuFzs7F7LMFBwcFMwBqCsxMSsRJgoJCxEUFhYUEQsJCiYRAvAWGCD9YCAYFrIcFAEgFBwmGFIwMFIYCQsREiYJCyUWFiULCSYSEQsJAAQAAP+oBIADWAARADoAWwB0AAABNhYVERQGLwEjIiY1ETQ2OwEBFhceARcWFRQHDgEHBgcGJicmNjc2Nz4BNzY1NCcuAScmJy4BNz4BFxMUBw4BBwYHBiYnJjY3PgE1NCYnLgE3PgEXFhceARcWFSUeARUUBgcGJicmNjc+ATU0JicuATc+ARcBrhc7OxeyzBQcHBTMAoU8Ly9CEhEREkIvLzwSJwoLCBExKCc2Dw4ODzYnKDERCAsLJxE/DAstHyApEiYKCggRPENDPBEICgsnECkgHy0LDP7kKzExKxEmCgkLERQWFhQRCwkKJhEC8hYYIP1gIBgWshwUASAUHAEYJzQ0ekRER0dERHo0NCcLCRARJwsgKytlODk7Ozk4ZSsrIAsnEREIC/4oMC0tUCMiGQwLDxEnCyZ7RkZ7JgsnERAJCxkiI1AtLTCaGFIwMFIYCQsREiYJCyUWFiULCSYSEQsJAAAAAAEAAP+AAwADgAAKAAAXETQ2MyEyFhURJQA4KAJAKDj+gIADoCg4OCj8YOAAAQCA/8ADAANAABkAABcRNDY7ATIWFREBNhYVERQGJwERFAYrASImgA4KYAoOAYcfSkof/nkOCmAKDigDUAoODgr+nwFqGiIp/QApIhoBaP6hCg4OAAAAAAEAAAAABAADAAAkAAA3ETQ2OwEyFhURATYWFREBNhYVERQGJwERFAYnAREUBisBIiY1AA4KUAoOAVcfSgFXH0pKH/6pSh/+qQ4KUAoOGALQCg4OCv7QATkaIin++AE5GiIp/YApIhoBNv77KSIaATb+0woODgoAAAIAFwAPBAAC8QALABcAABMmNDcBNhYVERQGJxMmNDcBNhYVERQGJxcXFwGAH0pKH4AXFwGAH0pKHwFPEzwTAUAaIin9gCkiGgFAEzwTAUAaIin9gCkiGgABAAD/jQNRA3MACwAAARYUBwEGJjURNDYXA1EvL/1AMGFmKwHTHG4c/mAcNzgDQD8tGQAAAgAA/8IDgANCAA8AHwAABSMiJjURNDY7ATIWFREUBiUUBisBIiY1ETQ2OwEyFhUBIMAoODgowCg4OAI4OCjAKDg4KMAoOD44KALAKDg4KP1AKDhgKDg4KALAKDg4KAAAAQAA/8ADgANAAA8AAAEyFhURFAYjISImNRE0NjMDICg4OCj9QCg4OCgDQDgo/UAoODgoAsAoOAACAAAADwPpAvEACwAXAAABFhQHAQYmNRE0NhcDFhQHAQYmNRE0NhcD6RcX/oAfSkofgBcX/oAfSkofAbETPBP+wBoiKQKAKSIa/sATPBP+wBoiKQKAKSIaAAAAAAEAAAAABAADAAAjAAABERQGKwEiJjURAQYmNREBBiY1ETQ2FwERNDYXARE0NjsBMhYEAA4KUAoO/qkfSv6pH0pKHwFXSh8BVw4KUAoOAuj9MAoODgoBMP7HGiIpAQj+xxoiKQKAKSIa/skBBikiGv7JAS4KDg4AAAEAgP/AAwADQAAZAAABERQGKwEiJjURAQYmNRE0NhcBETQ2OwEyFgMADgpgCg7+eR9KSh8Bhw4KYAoOAyj8sAoODgoBYf6WGiIpAwApIhr+mAFfCg4OAAACAAD/wAOAAyEADwAcAAAlFRQGIyEiJj0BNDYzITIWJSImNwE2MhcBFgYjIQOAJRv9ABslJRsDABsl/OA+MyoBYB1UHQFgKjM+/UCAgBslJRuAGyUlZXMuAYAfH/6ALnMAAAAAAQBF/9kCOwMnABUAABMBNjIfARYUBwkBFhQPAQYiJwEmNDdFAYUOKA4tDg7+zAE0Dg4tDigO/nsODgGiAYUODi4OJw/+y/7LDycOLg4OAYUOKA4AAQBF/9kCOwMnABUAAAkBBiIvASY0NwkBJjQ/ATYyFwEWFAcCO/57DigOLQ4OATT+zA4OLQ4oDgGFDg4BXv57Dg4uDicPATUBNQ8nDi4ODv57DigOAAAAAAIAEP+QA/ADcAAbAD8AAAEyFx4BFxYVFAcOAQcGIyInLgEnJjU0Nz4BNzYBNTQmKwE1NCYrASIGHQEjIgYdARQWOwEVFBY7ATI2PQEzMjYCAGdaWocnJycnh1paZ2daWocnJycnh1paAYcOCrgOCnAKDrgKDg4KuA4KcAoOuAoOA3AnJ4daWmdnWlqHJycnJ4daWmdnWlqHJyf92HAKDrgKDg4KuA4KcAoOuAoODgq4DgAAAAIAEP+QA/ADcAAbACsAAAEyFx4BFxYVFAcOAQcGIyInLgEnJjU0Nz4BNzYDITI2PQE0JiMhIgYdARQWAgBnWlqHJycnJ4daWmdnWlqHJycnJ4daWqECEAoODgr98AoODgNwJyeHWlpnZ1pahycnJyeHWlpnZ1pahycn/cAOCnAKDg4KcAoOAAACABD/kAPwA3AAGwBAAAABMhceARcWFRQHDgEHBiMiJy4BJyY1NDc+ATc2ASc3NjQvASYiDwEnJiIPAQYUHwEHBhQfARYyPwEXFjI/ATY0JwIAZ1pahycnJyeHWlpnZ1pahycnJyeHWloBWoODBwdPBxQHgoIHFAdPBweDgwcHTwcUB4KCBxQHTwcHA3AnJ4daWmdnWlqHJycnJ4daWmdnWlqHJyf9joKCBxQHTwcHg4MHB08HFAeCggcUB08HB4ODBwdPBxQHAAIAEP+QA/ADcAAbADEAAAEUBw4BBwYjIicuAScmNTQ3PgE3NjMyFx4BFxYJATY0LwEmIgcBJyYiDwEGFB8BFjI3A/AnJ4daWmdnWlqHJycnJ4daWmdnWlqHJyf91wFwCQkuCRsJ/tSMCRsJLgkJ0AoaCgGAZ1pahycnJyeHWlpnZ1pahycnJyeHWlr+kgFwChoKLQkJ/tSMCQktChoK0AkJAAAAAwAQ/5AD8ANwABsASQBVAAABFAcOAQcGIyInLgEnJjU0Nz4BNzYzMhceARcWJSIGBwYWHwEWNjc+ATMyFhUUBgcOAR0BFBY7ATI2PQE0Nz4BNzY1NCcuAScmIwMiBhUUFjMyNjU0JgPwJyeHWlpnZ1pahycnJyeHWlpnZ1pahycn/h1RbykFAwhFCBMGGy8pHzwiHyNKDgpwCg4aGj4aGhQVQiopKw0mNjYmJjY2AYBnWlqHJycnJ4daWmdnWlqHJycnJ4daWuVCPgcTBjUGAwgiJSQeFh0REzw+CAoODgoDFQ4PKCEgOiwlJTcPEP4QNiYmNjYmJjYAAAAAAwAQ/5AD8ANwABsAJwBGAAABMhceARcWFRQHDgEHBiMiJy4BJyY1NDc+ATc2FyIGFRQWMzI2NTQmEzU0JisBNTQmKwEiBh0BFBY7ARUjIgYdARQWOwEyNgIAZ1pahycnJyeHWlpnZ1pahycnJyeHWlpnIzExIyMxMU0OChgOCoAKDg4KGBgKDg4KsAoOA3AnJ4daWmdnWlqHJycnJ4daWmdnWlqHJyfcMSMjMTEjIzH+BDAKDsgKDg4KMAoOgA4KMAoODgAAAAADABD/kAPwA3AAGwArADsAAAEyFx4BFxYVFAcOAQcGIyInLgEnJjU0Nz4BNzYFJicuAQcGBwE2NzYmJyYnARYXHgE3NjcBBgcGFhcWFwIAZ1pahycnJyeHWlpnZ1pahycnJyeHWloBazE8PH4+PTUCASUQEQoaGzH9+DE8PH4+PTX9/yUQEQoaGzEDcCcnh1paZ2daWocnJycnh1paZ2daWocnJ+wxGxoKERAl/f81PT5+PDwx/fgxGxoKERAlAgE1PT5+PDwxAAEADv/ZA4ADJwAeAAAlBwYiJwEmNDcBNjIfARYUDwEhMhYdARQGIyEXFhQHAgMsDigO/nsODgGFDigOLA4P8QI/FBwcFP3B8Q8OBi0ODgGFDigOAYUODi0OKA7mHBRAFBzmDigOAAAAAQAA/9kDcgMnAB4AAAE3NjIXARYUBwEGIi8BJjQ/ASEiJj0BNDYzIScmNDcBfSwOKA4BhQ4O/nsOKA4sDg/x/cEUHBwUAj/xDw4C+i0ODv57DigO/nsODi0OKA7mHBRAFBzmDigOAAABABn/wANmAzIAHgAAEycmNDcBNjIXARYUDwEGIi8BERQGKwEiJjURBwYiJ0YtDg4BhQ4oDgGEDw8sDikO5RwUQBQc5g4oDgE9LA4oDgGFDg7+ew4nDi0OD/H9wRQcHBQCP/EPDgAAAAEAGf/OA2cDQAAeAAABFxYUBwEGIicBJjQ/ATYyHwERNDY7ATIWFRE3NjIXAzotDg7+ew4oDv57Dg4tDigO5hwUQBQc5g4oDgHDLA4oDv57Dg4BhQ4oDiwOD/ECPxQcHBT9wfEPDgAABAAA/8ADgANAABQAKQA+AFMAABM1NDY7ATIWHQEUBisBFRQGKwEiJgE0NjsBMhYdARQGKwEiJj0BIyImNQEyFh0BFAYrASImPQE0NjsBNTQ2MwEUBisBIiY9ATQ2OwEyFh0BMzIWFQAcFPgKDg4KqA4KUAoOAkAOCvgUHA4KUAoOqAoOASgKDhwU+AoODgqoDgr+KA4K+BQcDgpQCg6oCg4CGPgUHA4KUAoOqAoODgEaCg4cFPgKDg4KqA4K/igOCvgUHA4KUAoOqAoO/tgKDhwU+AoODgqoDgoAAAQAAP/AA4ADQAAUACkAPgBTAAABIyImPQE0NjsBMhYdATMyFh0BFAYlFAYrASImPQE0NjsBNTQ2OwEyFhURFAYrASImPQEjIiY9ATQ2OwEyFhUFFAYrASImPQE0NjsBMhYdARQGKwEDaPgUHA4KUAoOqAoODv3OHBT4Cg4OCqgOClAKDg4KUAoOqAoODgr4FBwBgA4KUAoOHBT4Cg4OCqgCABwU+AoODgqoDgpQCg4wFBwOClAKDqgKDg4K/LAKDg4KqA4KUAoOHBT4Cg4OCvgUHA4KUAoOAAEAAP/AA4ADQAAjAAABMhYdARQGIyERFAYrASImNREhIiY9ATQ2MyERNDY7ATIWFREDQBslJRv+4CUbQBsl/uAbJSUbASAlG0AbJQHgJRtAGyX+4BslJRsBICUbQBslASAbJSUb/uAAAQAAASADgAHgAA8AAAEyFh0BFAYjISImPQE0NjMDQBslJRv9ABslJRsB4CUbQBslJRtAGyUAAAADABD/kAPwA3AAGwAnADcAAAEUBw4BBwYjIicuAScmNTQ3PgE3NjMyFx4BFxYFIgYVFBYzMjY1NCYDEx4BOwEyNjcTNiYrASIGA/AnJ4daWmdnWlqHJycnJ4daWmdnWlqHJyf+ECY2NiYmNjZ9DgEOCWIJDgEOAQ4LfgsOAYBnWlqHJycnJ4daWmdnWlqHJycnJ4daWss2JiY2NiYmNgFL/vAKDQ0KARAKDw8AAwAAAAAEgAMAACgASQBlAAABHgEVFAYHBgcOAQcGIyInLgEnJicuATU0Njc2Nz4BNzYzMhceARcWFwE4ATEyNz4BNzY1MTQnLgEnJiMiBw4BBwYVFBceARcWMxE4ATEyFhUUBiMiJjU0NjceATMyNjU0Jic+ATMEeQMEBAMpOzuTVlVcXFVWkzs7KQMEBAMpOzuTVlVcXFVWkzs7Kf3HPDQ1ThYXFxZONTQ8PDQ1ThYXFxZONTQ8UHBwUE9wAwQLHRAoOAoJDBoNAZ0GDwgIDwZQQUFeGRoaGV5BQVAGDwgIDwZQQUFeGRoaGV5BQVD+wxcWTjU0PDw0NU4WFxcWTjU0PDw0NU4WFwHgcFBPcHBPDRoMCQo4KBAdCwQEAAAAAwAA/4AFAAOAAB8ATwB0AAAlMjY3Fw4BIyInLgEnJicuATU0Njc+ATcXFhceARcWMwUeARUUBg8BDgEjIiYnAS4BNTQ2PwE+ATMyFh8BPgEzMhceARcWFx4BFRQGBw4BByc+ATU4ATE0Jy4BJyYjMSIGBxc+ATU0Jic+ATMyFhUcARUUBgcCgA0aDWgmTihcVVaTOzspAwQEAw8mFNIEGBhNMjI5AnQFBwQDJwQOBwYKBPtnBQcEAycEDgcGCgT+QpVQXFVWkzs7KQMEBAMeUjKTDQ8XFk41NDw0XSWTAQIKCQ0bDU9vBgRgAwJQCgsaGV5BQVAGDwgIDwYeNxqiODAxSBQVdAUNBwYKBDMFBwQDA40FDQcGCgQzBQcEA8QjKBoZXkFBUAYPCAgPBjtnKnEbPSA8NDVOFhcjH3IFCgUQHQsEBG9OAQEBEB0OAAAAAwAN/4AEcwNQAAsAFwAnAAAlFgYjISImNwE2MhcDIgYVFBYzMjY1NCYDEx4BOwEyNjcTNiYrASIGBHMcODf8QDc4HAHgHG8bUyY2NiYmNjZ9DgEOCWIJDgEOAQ4LfgsOEDBgYDADQDAw/Ww2JiY2NiYmNgFL/vAKDQ0KARAKDw8AAAAAAQAZAIUDZwJ7ABUAAAkBFhQPAQYiJwkBBiIvASY0NwE2MhcB4gGFDg4uDicP/sv+yw8nDi4ODgGFDigOAnv+ew4oDi0ODgE0/swODi0OKA4BhQ4OAAAAAAEAGQCFA2cCewAVAAAlASY0PwE2MhcJATYyHwEWFAcBBiInAZ7+ew4OLg4nDwE1ATUPJw4uDg7+ew4oDoUBhQ4oDi0ODv7MATQODi0OKA7+ew4OAAEAPP+IAkADgAAPAAABEQUGJjcTJyY2NyUTPgEzAkD++yNBBzLUHBknASSDCCARA4D8kYkTLycBI84cSwYrAQgSEgAAAQAA/4kDAAOAAC0AAAEeARUUBiMhFRQGDwEGIi8BLgE9ASEiJjU0Nj8BIyImPQE0NjMhMhYdARQGKwECVEhkHBT+8AEBMAQUBDABAf7wFBxjSRhUFBwcFAIgFBwcFFQB0yF1TRQc0AIEAWAJCWABBALQHBRMdiHtHBRgFBwcFGAUHAAABAAA/4AEAAN1ABYAMAA8AEgAACUjIiY1ESMiJjcBNjIXARYGKwERFAYjJRUUBiMhIiY9ATQ2MyEVFBY7ATI2PQEhMhYHNCYjIgYVFBYzMjY3NCYjIgYVFBYzMjYCUKAUHK8bFBIBMQsgCwExExUbrxwUAbAcFPxgFBwcFAEQQi6gLkIBEBQc+BcREBgXERAYgBcREBgXERAYgBwUAVAxEwExCwv+zxMx/rAUHBDgFBwcFOAUHBAuQkIuEBzEEBgXERAYFxEQGBcREBgXAAAAAAEAAP+AA4ADgAAwAAABMhYVERQGIyEiJjURNDY7ATU0Nz4BNzYzMhceARcWHQEUBisBIiY9ATQmBw4BHQEhAyAoODgo/UAoODgoMBgXUzc3Pz84N1MYGBwUQBQcVTw8UwHwAYA4KP7AKDg4KAFAKDjNPzg4UxgZGBdTODc/IBQcHBQgPFUBAVU8zgAABAAAAAAEgAMAAA8AJAAwADwAAAEVFAYjISImPQE0NjMhMhYnITgBMSIGBxM+ATMhMhYXEy4BIzEHIgYVFBYzMjY1NCYjIgYVFBYzMjY1NCYEgDgo/EAoODgoA8AoOGD8QBEeD8IMKhkCGhkqDMIPHxBgGyUlGxslJdsbJSUbGyUlASDAKDg4KMAoODh4BgYBIRQXFxT+3wYGwCUbGyUlGxslJRsbJSUbGyUAAAIAFv+WA+oDagA+AH0AAAEWFxYUBwYHMAYxBwYHBiInJicmJyY0NzY/ATYWFx4BFxYGDwEOARcWMj8BNjQnLgEnLgE1JjY/AT4BFx4BFwEWFxYUBwYPAQYmJy4BJyY2PwE+AScmIg8BBhQXHgEXHgEVFgYPAQ4BJy4BJyYnJjQ3NjcwNjE3Njc2MhcWFwKNLRYWFhYsAYYtODh1ODgsLRYWFhYtSg8nAQEJCQMEBhsqAioqeCuGKioFCwUGBwELDSoIGAkLFQkBGi0WFhYWLUoPJwEBCQkDBAYbKgIqKngrhioqBQsFBgcBCw0qCBgJCxUJLRYWFhYsAYYtODh1ODgsAg0tODh0ODgsAYYtFhYWFi0sODh1ODgtSg8PFRs1GggSBxoqdysrKoYrdyoGCAMEDgcQIAwqCAIGCBEKARosODh1ODgtSg8PFRs1GggSBxoqdysrKoYrdyoGCAMEDgcQIAwqCAIGCBEKLTg4dDg4LAGGLRYWFhYtAAAAAQAA/8AFAANAADcAAAEWFx4BFxYVFAcOAQcGIyEiJy4BJyY1NDc+ATc2NzwBNTQ3PgE3NjMyFx4BFxYXPgEzMhYVFAYHBDMsJSY3DxAUFEYuLzX9IDw0NU4WFw4PMyMjKhkZVzo7QiwqKUcdHhQXNh5PcQcGAbsJFxdCKiouNS8uRhQUFxZONTQ8LysrRxobDwQIBEI7OlcZGQwLKh4dJA8RcU8SIxAAAwAA/8ADgANAABMAHwA0AAABHgEVERQGIyEiJjURNDYzITIWFwMyNjU0JiMiBhUUFhM0Ji8BLgEjISIGHQEUFjMhMjY9AQNkDQ84KP1AKDg4KAIYFCMN/DVLSzU1S0v1BAMHAwkF/jcKDg4KAdAKDgJ8DSMU/egoODgoAsAoOA8N/RxLNTVLSzU1SwJhBQkDBwMEDgrQCg4OCskAAwAA//gDgAMIAA8AHwAvAAATIiY9ATQ2MyEyFh0BFAYjASImPQE0NjMhMhYdARQGIwEiJj0BNDYzITIWHQEUBiMgDRMTDQNADRMTDfzADRMTDQNADRMTDfzADRMTDQNADRMTDQJ4Ew1QDRMTDVANE/7AEw1QDRMTDVANE/7AEw1QDRMTDVANEwAAAAAFAAD/gAQAA4AABwAPABcALQAxAAABLwE/AR8BBwUvAT8BHwEHAR8BDwEvATcTFhQHAQ4BIyImLwEmNDcBPgEzMhYXAzcnBwHAIEBAICBAQP7ANWtrNTVrawKLNWtrNTVra8ITE/0qCRgMDRcKqRMTAtYJGAwNFwp1rWatAsBAICBAQCAgwGs1NWtrNTX+lWs1NWtrNTUB7xM1E/0qCgkJCqkTNRMC1goJCQr+fK1mrQAAAAABACIAugJdAgAADAAAEyEyFgcBBiInASY2Mz8CAhsUE/7/DCEL/v4TFRsCADET/v4LCwECEzEAAAEAIgDAAl4CBgALAAAlISImNwE2MhcBFgYCQf3+GxUTAQILIgsBAhMVwDETAQILC/7+EzEAAAAAAQA6AGIBgAKeAAwAAAERFAYnASY0NwE2FhUBgDET/v4LCwECEzECgf3+GxUTAQILIgsBAhMVGwABAAAAYgFGAp4ADAAANxE0NhcBFhQHAQYmNQAxEwECCwv+/hMxfwICGxUT/v4LIgv+/hMVGwAAAAEAAP+AAnkDgAAZAAABMhYHAQ4BIyImNxMjIiY3Ez4BMyEyFgcDMwJQHBsO/qAGFwwXHQVc7RYcAkADGxIBIBgcBlXnAkAwGP2gCw0kFwGFIRUB4BIYJhb+/AAAAwAA/4ACwAOAABIANABKAAAXNSEVFAYPAQ4BKwEiJi8BLgE1AzQ3PgE3NjMyFx4BFxYVFAYHDgEHHAExITA0NS4BJy4BNSUyNjU0JiMiBw4BBwYVFBYzMjY1NDbAAUAGBSIJHBB8EBwJIgUGwBoaXkBATUlAQV8cHC4pGUEP/sAPQRkpLgFgDRMTDS4pKT0REhMNDRNeDU1NCRIIMw0QEA0zCBIJAi1GP0BhHR0bHGBAQElDdi8caTEBAQEBMWkcL3ZDoBMNDRMSET0pKS4NExMNQl4AAAAAAgAA/8ADgANAAA8AMwAAATIWFREUBiMhIiY1ETQ2MwE1NCYrATU0JisBIgYdASMiBh0BFBY7ARUUFjsBMjY9ATMyNgMgKDg4KP1AKDg4KAKADgq4DgpwCg64Cg4OCrgOCnAKDrgKDgNAOCj9QCg4OCgCwCg4/ghwCg64Cg4OCrgOCnAKDrgKDg4KuA4AAAAAAgAA/8AEAANAACAAQQAAATIWFREUBiMhIiY1ETQ3PgE3NjsBMhYdARQGKwEiBh0BITIWFREUBiMhIiY1ETQ3PgE3NjsBMhYdARQGKwEiBh0BA6AoODgo/wAoOBkZVzo7QhAUHBwUEDVL/mAoODgo/wAoOBkZVzo7QhAUHBwUEDVLAYA4KP8AKDg4KAHgQjs6VxkZHBRgFBxLNYA4KP8AKDg4KAHgQjs6VxkZHBRgFBxLNYAAAgAA/8AEAANAACAAQQAAATIWFREUBw4BBwYrASImPQE0NjsBMjY9ASMiJjURNDYzITIWFREUBw4BBwYrASImPQE0NjsBMjY9ASMiJjURNDYzA6AoOBkZVzo7QhAUHBwUEDVLoCg4OCj+wCg4GRlXOjtCEBQcHBQQNUugKDg4KANAOCj+IEI7OlcZGRwUYBQcSzWAOCgBACg4OCj+IEI7OlcZGRwUYBQcSzWAOCgBACg4AAAABwAA/4AEAAOAAAsAFwAjAC8AOwBHAFMAAAEUBiMiJjU0NjMyFgMyFhUUBiMiJjU0NgEyFhUUBiMiJjU0NgUUBiMiJjU0NjMyFhcyFhUUBiMiJjU0NiEyFhUUBiMiJjU0NgEyFhUUBiMiJjU0NgJgOCgoODgoKDhgKDg4KCg4OAHIKDg4KCg4OP1IOCgoODgoKDgaKDg4KCg4OAJ0KDg4KCg4OP3cKDg4KCg4OAMgKDg4KCg4OPz4OCgoODgoKDgBoDgoKDg4KCg4YCg4OCgoODjuOCgoODgoKDg4KCg4OCgoOAJMOCgoODgoKDgAAAAAAwAO/44D8gNyACUATABcAAAlFhQPAQYHBiInJicmJyY0NzY/ATYyHwEWFA8BBhQXFjI/ATYyFwMnJjQ/ATY3NjIXFhcWFxYUBwYPAQYiLwEmND8BNjQnJiIPAQYiJwEGIicBJjQ/ATYyFwEWFAcCYAcHWS04OHU4OCwtFhYWFi1ZBxQHTwcHWSoqKngqWQcUByJPBwdZLTg4dTg4LC0WFhYWLVkHFAdPBwdZKioqeCpZBxQHAdYOKA78jQ4OLQ4oDgNzDg5UBxQHWS0WFhYWLSw4OHU4OC1ZBwdPBxQHWSp4KioqWQcHAbpPBxQHWS0WFhYWLSw4OHU4OC1ZBwdPBxQHWSp4KioqWQcH/TEODgNzDigOLQ4O/I0OKA4AAAAAAgAQ/5AD8ANwABsAMQAABSInLgEnJjU0Nz4BNzYzMhceARcWFRQHDgEHBgkBFjI/ATY0LwE3NjQvASYiBwEGFBcCAGdaWocnJycnh1paZ2daWocnJycnh1pa/rUBDw4oDiIODsvLDg4iDigO/vEODnAnJ4daWmdnWlqHJycnJ4daWmdnWlqHJycBzv7xDg4iDigOy8sOKA4iDg7+8Q4oDgAAAAACABD/kAPwA3AAGwAxAAABMhceARcWFRQHDgEHBiMiJy4BJyY1NDc+ATc2CQEmIg8BBhQfAQcGFB8BFjI3ATY0JwIAZ1pahycnJyeHWlpnZ1pahycnJyeHWloBS/7xDigOIg4Oy8sODiIOKA4BDw4OA3AnJ4daWmdnWlqHJycnJ4daWmdnWlqHJyf+MgEPDg4iDigOy8sOKA4iDg4BDw4oDgAAAAIAEP+QA/ADcAAbADEAABM0Nz4BNzYzMhceARcWFRQHDgEHBiMiJy4BJyYJAQYUHwEWMj8BFxYyPwE2NCcBJiIHECcnh1paZ2daWocnJycnh1paZ2daWocnJwHO/vEODiIOKA7Lyw4oDiIODv7xDigOAYBnWlqHJycnJ4daWmdnWlqHJycnJ4daWgFL/vEOKA4iDg7Lyw4OIg4oDgEPDg4AAAAAAgAQ/5AD8ANwABsAMQAAARQHDgEHBiMiJy4BJyY1NDc+ATc2MzIXHgEXFgkBNjQvASYiDwEnJiIPAQYUFwEWMjcD8Ccnh1paZ2daWocnJycnh1paZ2daWocnJ/4yAQ8ODiIOKA7Lyw4oDiIODgEPDigOAYBnWlqHJycnJ4daWmdnWlqHJycnJ4daWv61AQ8OKA4iDg7Lyw4OIg4oDv7xDg4AAAACAAD/gAOAA4AAMAA+AAABMhYVERQGIyEiJjURNDY7ATU0Nz4BNzYzMhceARcWHQEUBisBIiY9ATQmBw4BHQEhATU0JiMiBh0BFBYzMjYDICg4OCj9QCg4OCgwGBdTNzc/Pzg3UxgYHBRAFBxVPDxTAfD+8C8hIS8vISEvAYA4KP7AKDg4KAFAKDjNPzg4UxgZGBdTODc/IBQcHBQgPFUBAVU8zv7QYCEvLyFgIS8vAAMAEADwA/ACEAALABcAIwAAARQGIyImNTQ2MzIWNzIWFRQGIyImNTQ2ITIWFRQGIyImNTQ2ApBUPDxUVDw8VNA8VFQ8PFRU/Xw8VFQ8PFRUAYA8VFQ8PFRUVFQ8PFRUPDxUVDw8VFQ8PFQAAAMAMP+QAVADcAALABcAIwAAEzIWFRQGIyImNTQ2JzQ2MzIWFRQGIyImETQ2MzIWFRQGIyImwDxUVDw8VFRUVDw8VFQ8PFRUPDxUVDw8VAIQVDw8VFQ8PFTQPFRUPDxUVP18PFRUPDxUVAAAAAIAEP+QA/ADcAAbACcAAAEyFx4BFxYVFAcOAQcGIyInLgEnJjU0Nz4BNzYBNjQnJSYGFREUFjcCAGdaWocnJycnh1paZ2daWocnJycnh1paAU4ZGf6gFzAwFwNwJyeHWlpnZ1pahycnJyeHWlpnZ1pahycn/eAOOA7WDRsc/mAcGw0AAAIAAP/AA4ADQAAPAB8AAAEyFhURFAYjISImNRE0NjMTITI2PQE0JiMhIgYdARQWAyAoODgo/UAoODgoWAIQCg4OCv3wCg4OA0A4KP1AKDg4KALAKDj98A4KcAoODgpwCg4AAAACAAD/wAOAA0AADwAlAAAFISImNRE0NjMhMhYVERQGJQE2NC8BJiIHAScmIg8BBhQfARYyNwMg/UAoODgoAsAoODj+PwFwCQkuCRsJ/tSMCRsJLgkJ0AoaCkA4KALAKDg4KP1AKDjEAXAJGwkuCQn+1IwJCS4JGwnQCQkAAgAA/8ADgANAAA8AGwAAAREUBiMhIiY1ETQ2MyEyFgEXFjI/ATYmIyEiBgOAOCj9QCg4OCgCwCg4/Tn2BxQH9gsMEP4UEAwC4P1AKDg4KALAKDg4/r/2Bwf2Cx4eAAAAAgAA/8ADgANAAA8AHAAANxE0NjMhMhYVERQGIyEiJgEnJiIPAQYWMyEyNicAOCgCwCg4OCj9QCg4Asf2BxQH9gsMEAHsEAwLIALAKDg4KP1AKDg4AUH2Bwf2Cx4eCwAAAgAA/8ADgANAAA8AHAAAEyEyFhURFAYjISImNRE0NgE3NjQvASYGFREUFjdgAsAoODgo/UAoODgBQfYHB/YLHh4LA0A4KP1AKDg4KALAKDj9OfYHFAf2CwwQ/hQQDAsAAwAT/5MD7QNtAAsAMwBPAAABMhYVFAYjIiY1NDYFFhQPARcWBi8BBwYiLwEHBiY/AScmND8BJyY2HwE3NjIfATc2Fg8BAzY3NjQnJicmJyYiBwYHBgcGFBcWFxYXFjI3NgIAT3FxT09xcQI8ExS9QwceFcleCisJX8kUHgdDvhMTvkMHHhTJXwoqCl/JFB4HQ3olExMTEyUlMC9iLzAlJRMTExMlJTAvYi8wAkBxT09xcU9PcaEKKgpfyRQeB0O+ExO+QwceFMlfCioKX8kUHgdDvhMTvkMHHhXI/s0lMC9iLzAlJRMTExMlJTAvYi8wJSUTExMTAAABADb/gAPEA4AALAAABSInLgEnJjU0Nz4BNzYzMhYXHgEHBgcOAQcGFRQXHgEXFjc2FgcGBw4BBwYjAjZqXV2LKCkpKItdXWoYLxcQBg8vJSY0Dg8oKIRWVl0QEgskLC1lODg8gCgpi11dampdXosoKAQFAyEIGyUmWjM0Nl5QUG0YGBEDHA0tIyMxDQ0AAAACAAD/kwQAA4AASgBZAAABDgErARUUBgcXFhQHBiIvAQ4BIxE0JisBIgYVESImJwcGIicmND8BLgE9ASMiJicmNjsBNScmNDc2Mh8BITc2MhcWFA8BFTMyFgcBMhceARcWFSE0Nz4BNzYEAAEmGm8ODXgTExI2Em4lXDQOCjAKDjRcJW4SNhITE3gNDm8aJgEBJhtwXRMTEjYSbgHKbhI2EhMTXXAbJgH+Ai4pKT0REv5AEhE9KSkBPhokICE9HHkSNhITE20eIgHoCg4OCv4YIh5tExMSNhJ5HD0hICQaGyd1XhI2EhMTbW0TExI2El51JxsCQhIRPSkpLi4pKT0REgAAAAIAAP/AA4ADQAAPABwAAAUhIiY1ETQ2MyEyFhURFAYBBwYUHwEWNjURNCYHAyD9QCg4OCgCwCg4OP6/9gcH9gseHgtAOCgCwCg4OCj9QCg4Asf2BxQH9gsMEAHsEAwLAAUAAABABQACwAAKABQAXgBoAIIAAAEXIzc+ATEzMBYXATIWFREUBiMhEQU1NCYrATU0JisBIgYdASMiBh0BFBY7AQ4BBy4BJy4BDwIOARceARcOAQcOAR8BHgE3PgE3HgEXFjY/ATYmJy4BJz4BNzMyNjUlNDYzIREhIiY1NwYWOwEyNj8BMxceATsBMjYnAy4BKwEiBgcBMBZMFgULAQoFA6AUHBwU/dACAA4KgA4KIAoOgAoODgrlCh4UChIHBhIIDw0JBAYJFQwMGg4JBQUQBRQIEyQQESMTCRMFEAUFCA0bDB8sChcKDvtgHBQCMP3QFBx2BA4NLQgNAhN4EwINCC4MDgRzAg0HQQgNAgGoS0sSMDASARgcFP3gFBwCgPAgCg4gCg4OCiAOCiAKDhUsFQoVCggEBQgIBRUIDRoNCRIJBRMIHAkFBQwZDQ0ZDAUFCRwIEwUIEwkiRyMOCsAUHP2AHBRwDBQKB0BABwoUDAFSBwkJBwABAED/wAOAA0AAKgAAARUUBisBERQGKwEiJjURIxEUBisBIiY9ASMiJy4BJyY1NDc+ATc2MyEyFgOAEw1gEw1ADRNAEw1ADRNAQjs6VxkZGRlXOjtCAeANEwMgQA0T/SANExMNAuD9IA0TEw3gGRlXOjtCQjs6VxkZEwAAAQAA/4ADgAOAADYAAAEyFhUUBiMiJjU4ATE0NjcnDgEjIiY1NDYzMhYXNy4BNTQ2MzIWFRQGIyImJwceARUUBgcXPgECwFBwcFBQcAIDzRk9IlBwcFAiPRnNAwJwUFBwcFAiPRnNAwICA80ZPQEAcFBQcHBQCxUKgBQWcFBQcBYUgAoVC1BwcFBQcBYUgAoVCwsVCoAUFgACAAD/gAOAA4AAHQAoAAABMhYdARQGIyEiJj0BNDY7ATc+ATsBOAExMhYfATMBAyEDDgEjISImJwNgDRMTDfzADRMTDfATBhYO5Q4XBhPw/QoqAwAqAzcm/hQmNwMDQBMNQA0TEw1ADRMlDA8PDCX8mgKm/VomNDQmAAAAAwAAAAAEgAMAAB0AOQBQAAABMhceARcWFRQHDgEHBiMhIicuAScmNTQ3PgE3NjMBFBceARcWMzI3PgE3NjU0Jy4BJyYjIgcOAQcGATI3PgE3NjU0Jy4BJyYrARYXFhQHBgcDAFBFRmkeHh4eaUZFUP6AUEVGaR4eHh5pRkVQ/wAUFEYuLzU1Ly5GFBQUFEYuLzU1Ly5GFBQCgDUvLkYUFBQURi4vNWIxGRgYGTEDAB4eaUZFUFBFRmkeHh4eaUZFUFBFRmkeHv6ANS8uRhQUFBRGLi81NS8uRhQUFBRGLi/+yxQURi4vNTUvLkYUFDdCQopCQjcAAAACAAAAAASAAwAAHQA5AAABMhceARcWFRQHDgEHBiMhIicuAScmNTQ3PgE3NjMBMjc+ATc2NTQnLgEnJiMiBw4BBwYVFBceARcWAwBPRkZpHh4eHmlGRVD+gE9GRmkeHh4eaUZFUAGANS8uRhQUFBRGLi81NS8uRhQUFBRGLi8DAB4eaUZFUE9GRmkeHh4eaUZFUE9GRmkeHv2AFBRGLi81NS8uRhQUFBRGLi81NS8uRhQUAAADAAAAQAUAAsAABwAhACUAAAEhESE1MzUjEzIWHQEzMhYVERQGKwEVFAYjISImNRE0NjMFESERBED8QAPAQEAgKDgQFBwcFBA4KPwAKDg4KAOg/MACQP6AgIABADgoIBwU/uAUHCAoODgoAcAoOMD/AAEAAAMAAABABQACwAAHACEAJQAAASERITUzNSMTMhYdATMyFhURFAYrARUUBiMhIiY1ETQ2MwURIREEQPxAA8BAQCAoOBAUHBwUEDgo/AAoODgoAuD9gAJA/oCAgAEAOCggHBT+4BQcICg4OCgBwCg4wP8AAQAAAwAAAEAFAALAAAcAIQAlAAABIREhNTM1IxMyFh0BMzIWFREUBisBFRQGIyEiJjURNDYzBREhEQRA/EADwEBAICg4EBQcHBQQOCj8ACg4OCgCIP5AAkD+gICAAQA4KCAcFP7gFBwgKDg4KAHAKDjA/wABAAADAAAAQAUAAsAABwAhACUAAAEhESE1MzUjEzIWHQEzMhYVERQGKwEVFAYjISImNRE0NjMFESERBED8QAPAQEAgKDgQFBwcFBA4KPwAKDg4KAFg/wACQP6AgIABADgoIBwU/uAUHCAoODgoAcAoOMD/AAEAAAIAAABABQACwAAHACEAAAEhESE1MzUjEzIWHQEzMhYVERQGKwEVFAYjISImNRE0NjMEQPxAA8BAQCAoOBAUHBwUEDgo/AAoODgoAkD+gICAAQA4KCAcFP7gFBwgKDg4KAHAKDgAAAAAAwAQ/5AD8ANwABsAKwA7AAABMhceARcWFRQHDgEHBiMiJy4BJyY1NDc+ATc2ExE0JisBIgYVERQWOwEyNjcRNCYrASIGFREUFjsBMjYCAGdaWocnJycnh1paZ2daWocnJycnh1paRxMNYA0TEw1gDRPgEw1gDRMTDWANEwNwJyeHWlpnZ1pahycnJyeHWlpnZ1pahycn/XABQA0TEw3+wA0TEw0BQA0TEw3+wA0TEwACABD/kAPwA3AAGwArAAABMhceARcWFRQHDgEHBiMiJy4BJyY1NDc+ATc2ARE0JiMhIgYVERQWMyEyNgIAZ1pahycnJyeHWlpnZ1pahycnJyeHWloBJxMN/sANExMNAUANEwNwJyeHWlpnZ1pahycnJyeHWlpnZ1pahycn/XABQA0TEw3+wA0TEwAAAAEAEP+QA/ADcABEAAABMhceARcWFRQHDgEHBiMiJy4BJyYnLgE/ATYyFx4BMzI3PgE3Njc2Jy4BJyYHDgEHFxYGIyEiJjURNDYfATY3PgE3NjMB/2daW4cnJycnh1paZzAtLlQmJiEIAQhPBxMHLnE+Rj0+WhoaAQEbG10+PkVAdC5TFxkg/vQUHDsXRyInJ1YvLzIDcCcnh1paZ2daWocnJwkJIRcYHgcUCE8HBigrGxpbPTxESD4+XBoaAQEuLFMXOxwUAQwgGRdHHxoZJAkKAAAABQAA/4ADgAOAAAkAFwAlADMAUQAAFxEhERQGIyEiJgERFBYzMjY1ETQmIyIGBxEUFjMyNjURNCYjIgYHERQWMzI2NRE0JiMiBgEyFh0BFAYjISImPQE0NjsBNz4BOwE4ATEyFh8BM0ADADgo/cAoOAIgEw0NExMNDRPAEw0NExMNDRPAEw0NExMNDRMCgA0TEw38wA0TEw3wEwYWDuUOFwYT8CACoP1gKDg4Aij+QA0TEw0BwA0TEw3+QA0TEw0BwA0TEw3+QA0TEw0BwA0TEwFTEw1ADRMTDUANEyUMDw8MJQAAAgAQ/5AD8ANwACsAWAAAAS4BIyIHDgEHBgcOASsBIiY3Njc+ATc2MzIXHgEXFhc3NhYVERQGIyEiJjcFITIWDwEeATMyNz4BNzY3PgE7ATIWBwYHDgEHBiMiJy4BJyYnBwYmNRE0NjMC5S53QDo1NVYfHw4CDQhzCw4CECwsgVJRWzIvL1cnJyJHFzscFP70IBkX/a4BDCAZF1Mud0A6NTVWHx8OAg0IcwsOAhAsLIFSUVsyLy9XJyciRxc7HBQCdSwvExNDLy44CAoRC1dJSmwfHwkKJBkZIEcXGSD+9BQcOxfyOxdTLC8TE0MvLjgIChELV0lKbB8fCQokGRkgRxcZIAEMFBwAAQAQ/5AD8ANwAEQAAAEyFx4BFxYXNzYWFREUBiMhIiY/AS4BJyYHDgEHBhcWFx4BFxYzMjY3NjIfARYGBwYHDgEHBiMiJy4BJyY1NDc+ATc2MwIBMi8vVicnIkcXOxwU/vQgGRdTLnRART4+XRsbAQEaGlo+PUY+cS4HEwdPCAEIISYmVC4tMGdaWocnJycnh1taZwNwCgkkGRofRxcZIP70FBw7F1MsLgEBGhpcPj5IRDw9WxobKygGB08IFAceGBchCQknJ4daWmdnWlqHJycAAAABAAD/wAOAA0AASAAAJRUUBiM4ATEjIiY/AScHFxYGKwEiJjU4ATE1NDYfATcnBwYmPQE0NjM4ATEzMhYPARc3JyY2OwEyFhU4ATEVFAYvAQcXNzYWFQOAHBTgIBkXSNbWSBcZIOAUHDsXSNfXSBc7HBTgIBkXSNbWSBcZIOAUHDsXSNfXSBc70OAUHDsXSNfXSBc7HBTgIBkXSNbXSRcZIOAUHDsXSNfXSBc7HBTgIBkXSNbXSRcZIAAAAAIAAP+ABAADgAAeADoAAAEyFhURFAYjISImNRE0NjMhMhYdARQGIyERITU0NjMTMhYVERQGLwEBDgEjIiYvAS4BNTQ2NwEnJjYzA2ANEzgo/UAoODgoAUANExMN/uACgBMNsBQcOxdH/hgGEgoKEQctBwcHBwHnRxcZIAEAEw3/ACg4OCgCwCg4Ew1ADRP9gOANEwKAHBT/ACAYFkf+GQcHBwctBxEKChIGAehHFzsAAgAA/8AFAANAADcATQAAARYXHgEXFhUUBw4BBwYjISInLgEnJjU0Nz4BNzY3PAE1NDc+ATc2MzIXHgEXFhc+ATMyFhUUBgcFNiYrATU0JisBIgYdASMiBh8BFjI3BDMsJSY3DxAUFEYuLzX9IDw0NU4WFw4PMyMjKhkZVzo7QiwqKUcdHhQXNh5PcQcG/vYQERWDEw1gDRODFREQ0goaCgG7CRcXQioqLjUvLkYUFBcWTjU0PC8rK0caGw8ECARCOzpXGRkMCyoeHSQPEXFPEiMQshAn4A0TEw3gJxDSCgoAAAAAAgAA/8AFAANAADcATgAAARYXHgEXFhUUBw4BBwYjISInLgEnJjU0Nz4BNzY3PAE1NDc+ATc2MzIXHgEXFhc+ATMyFhUUBgcFMjYvASYiDwEGFjsBFRQWOwEyNj0BMwQzLCUmNw8QFBRGLi81/SA8NDVOFhcODzMjIyoZGVc6O0IsKilHHR4UFzYeT3EHBv7gFREQ0goaCtIQERWDEw1gDRODAbsJFxdCKiouNS8uRhQUFxZONTQ8LysrRxobDwQIBEI7OlcZGQwLKh4dJA8RcU8SIxB7JxDSCgrSECfgDRMTDeAAAgAA/8AEAANAAA8ANAAAATIWFREUBiMhIiY1ETQ2MwEnNzY0LwEmIg8BJyYiDwEGFB8BBwYUHwEWMj8BFxYyPwE2NCcDoCg4OCj8wCg4OCgCmYaGBwdRBxUHhYUHFQdRBweGhgcHUQcVB4WFBxUHUQcHA0A4KP1AKDg4KALAKDj9u4WFBxUHUQcHhoYHB1EHFQeFhQcVB1EHB4aGBwdRBxUHAAACABMAAAUAAwAAFAA5AAABMhYVERQGIyEiJicBJjQ3AT4BMyEDJzc2NC8BJiIPAScmIg8BBhQfAQcGFB8BFjI/ARcWMj8BNjQnBIA1S0s1/RsaLxL+0xMTAS0RLxoC5ql8fAkJLgkbCXx8CRsJLgkJfX0JCS4JGwl8fAkbCS4JCQMASzX+ADVLExIBLhI2EgEtEhT+BHx8CRsJLgkJfX0JCS4JGwl8fAkbCS4JCXx8CQkuCRsJAAAAAwAA/4ADAAOAABEAJwAyAAABFBYzIREUBiMhIiY1ETQ2MyETNiYrATU0JisBIgYdASMiBh8BFjI3AR4BHQEhETMyFhcBwBwUARAcFP1gFBwcFAGQmQ8QFoITDUANE4IWEA/BChwKAVoHB/8ADAoRBwJwFBz9cBQcHBQDoBQc/UkPKKANExMNoCgPvwoKAqQHEQoMAQAHBwADAAD/gAR2A4AACgAaADYAAAEVIREzMhYfAR4BARYUDwEGJj0BIzUzNTQ2FwUUFjMhERQGIyEiJjURNDYzIREUFjMhESEiBhUDAP8ADAoRB8QHBwF2Cgq/ECeAgCcQ/ckTDQFgHBT9YBQcHBQBkBwUARD+oA0TAowMAQAHB8QHEf6CChwKwQ8QFoKAghYQD/kNE/7wFBwcFAOgFBz+8BQc/wATDQAAAAADAAD/gAQAA4AACQAUADcAABMzFSMiJj0BNDYBHgEdASERMzIWFwMUFjMhERQGIyEiJjURIRUUFj8BNjQvASYGHQEhETQ2MyERIODgDRMTA98HB/8ADAoRB24cFAEQHBT9YBQcAQAnEL8KCr8PKP8AHBQBkAFAgBMNQA0TAW4HEQoMAQAHB/7+FBz9cBQcHBQBEIIWEA/BChwKwQ8QFoICEBQc/vAAAAADAAD/gAMAA4AAEQAoADMAAAEUFjMhERQGIyEiJjURNDYzIRMyNi8BJiIPAQYWOwEVFBY7ATI2PQEzEx4BHQEhETMyFhcBwBwUARAcFP1gFBwcFAGQghYQD8EKHArBDxAWghMNQA0TgrAHB/8ADAoRBwJwFBz9cBQcHBQDoBQc/UAoD78KCr8PKKANExMNoAHuBxEKDAEABwcAAAACABP/gAQdA4AAIQAoAAABHgEPARMWBiMiJiclBQ4BIyImNxMnJjY3JRM+ATMyFhcTEzclJxEXAwP5Jxkc1DIFKRwHDwf++v76Bw8IHCgFMtQcGScBJYMIIBERIAmCMqX+6Xz5MAIpBksczv7dHywEA4qJBAQsHwEjzhxLBisBCBISEhL++P7foCn8/YWCARQAAAAAAgAAAA4D9wLyABEANQAAATYWFREUBi8BIyImNRE0NjsBBRcWFA8BBiIvAQcGIi8BJjQ/AScmND8BNjIfATc2Mh8BFhQHAa4XOzsXsswUHBwUzAKfXAkJLgoaCltbChoKLgkJXFwJCS4KGgpbWwoaCi4JCQLyFhgg/WAgGBayHBQBIBQcwFsKGgouCQlcXAkJLgoaCltbChoKLgkJXFwJCS4KGgoAAAAABAAJ/4kD9wN3ABYALABCAFgAAAEyFh0BFAYvAQcGIi8BJjQ/AScmNjsBNyImPQE0Nh8BNzYyHwEWFA8BFxYGIwMXFhQPAQYiLwEHBiY9ATQ2OwEyFgcBNhYdARQGKwEiJj8BJyY0PwE2Mh8BAZAUHDsXPscJGwkzCQnHQhcZIODgFBw7Fz7HCRsJMwkJx0IXGSAgxwkJMwkbCcc+FzscFOAgGRf9/Bc7HBTgIBkXQscJCTMJGwnHAUAcFOAgGRdCxwkJMwkbCcc+FzuAHBTgIBkXQscJCTMJGwnHPhc7/vDHCRsJMwkJx0IXGSDgFBw7FwIEFhgg4BQcOxc+xwkaCjMJCccAAAAABAAA/5YD9wOAABUANABAAEwAACUWFA8BBiIvAS4BNycjAzcFFRc2FhcnIgYHJyY2Nz4BFx4BDwEfATc2FhcWBgcOAQcnLgEjBwYWFwcGIicmNDcBAzI2NTQmIyIGFRQWA+oWFmkWPhbqIg4U1XzAgAEA1SpeI2kMGQykASgrOJJHDggKlReHlQobAxImNxQsGCceTSvPCAYM+CVqJiUlATHWFBwcFBQcHGkWPhZpFhbqI14q1QEAgMB81RQOImsDA6Q5bCs3JhIDGwqViBaVCggNR5M4Ex0LJx4gpCBAHfglJSZqJQEx/kUcFBQcHBQUHAAAAAMAAP+AA4ADgAAKACMAQQAAFwMhAw4BIyEiJicTBhY7ARUUFjsBMjY9ATMyNi8BLgEjIgYHATIWHQEUBiMhIiY9ATQ2OwE3PgE7ATgBMTIWHwEzaioDACoDNyb+FCY3A40PEBVzEw1ADRNzFREQsgULBwcLBQG3DRMTDfzADRMTDfATBhYO5Q4XBhPwJgKm/VomNDQmAWAQKuANExMN4CoQvAUFBQUBShMNQA0TEw1ADRMlDA8PDCUAAAAAAwAA/4ADgAOAAAkAIgBAAAAXESERFAYjISImEwYWOwEVFBY7ATI2PQEzMjYvAS4BIyIGBwEyFh0BFAYjISImPQE0NjsBNz4BOwE4ATEyFh8BM0ADADgo/cAoOLcPEBVzEw1ADRNzFREQsgULBwcLBQG3DRMTDfzADRMTDfATBhYO5Q4XBhPwIAKg/WAoODgBghAq4A0TEw3gKhC8BQUFBQFKEw1ADRMTDUANEyUMDw8MJQAAAQAAAAEAAII1aM1fDzz1AAsEAAAAAADcXxJIAAAAANxfEkgAAP+ABQADgAAAAAgAAgAAAAAAAAABAAADgP+AAAAFAAAAAAAFAAABAAAAAAAAAAAAAAAAAAAAfAQAAAAAAAAAAAAAAAAAAAAEAAAABAAAEgSAADwEAAAPAsAAEgQAAAAEAAAABAAAEAQAACYEgAAABAAAAAOAAAACAAAAAwAAAASAAAADAAAAA4AAgAQAAAAEAAAXA4AAAAOAAAADgAAABAAAAAQAAAADgACAA4AAAAKAAEUCgABFBAAAEAQAABAEAAAQBAAAEAQAABAEAAAQBAAAEAOAAA4DgAAAA4AAGQOAABkDgAAAA4AAAAOAAAADgAAABAAAEASAAAAFAAAABIAADQOAABkDgAAZBIAAPAMAAAAEAAAAA4AAAASAAAAEAAAWBQAAAAOAAAADgAAABAAAAAKAACICgAAiAYAAOgGAAAACgAAAAsAAAAOAAAAEAAAABAAAAAQAAAAEAAAOBAAAEAQAABAEAAAQBAAAEAOAAAAEAAAQAYAAMAQAABADgAAAA4AAAAOAAAADgAAAA4AAAAQAABMEAAA2BAAAAAOAAAAFAAAAA4AAQAOAAAADgAAABIAAAASAAAAFAAAABQAAAAUAAAAFAAAABQAAAAQAABAEAAAQBAAAEAOAAAAEAAAQBAAAEAOAAAAEAAAABQAAAAUAAAAEAAAABQAAEwMAAAAEgAAABAAAAAMAAAAEMAATBAAAAAQAAAkEAAAAA4AAAAOAAAAAAAAAAAoAFAAeAIoAygD8ASYBYAH4AnwC8gOEBAIEaASmBMYFCgW+BdQGAAY8BmgGggayBs4G/Ac4B2QHlgfAB+wIRgiKCO4JQAm+CiIKhgq6Cu4LIgtWC8QMMAxkDIAM1g1mDg4OUA58DqYOyA8KD3IPuBAOEMwRIBFuEbQSDhIqEkYSYhJ+EqwTGBNgE7oUFBSMFRwVbhXAFhIWZBa8FvIXKBdqF5wX2hgKGDoYahjmGS4ZsBngGpwa2hsmG2Qb4Bw6HHQcrhzoHSIdVh2uHfQeXh7QH1QfviAcIHQg5iFYIaoiBiJSIqYi+iNII5Ij5iRqJOQlQiWcAAAAAQAAAHwAgwAHAAAAAAACAAAAAAAAAAAAAAAAAAAAAAAAAA4ArgABAAAAAAABAAwAAAABAAAAAAACAAcAjQABAAAAAAADAAwARQABAAAAAAAEAAwAogABAAAAAAAFAAsAJAABAAAAAAAGAAwAaQABAAAAAAAKABoAxgADAAEECQABABgADAADAAEECQACAA4AlAADAAEECQADABgAUQADAAEECQAEABgArgADAAEECQAFABYALwADAAEECQAGABgAdQADAAEECQAKADQA4HNjLWljb25zLTkwMABzAGMALQBpAGMAbwBuAHMALQA5ADAAMFZlcnNpb24gMS4wAFYAZQByAHMAaQBvAG4AIAAxAC4AMHNjLWljb25zLTkwMABzAGMALQBpAGMAbwBuAHMALQA5ADAAMHNjLWljb25zLTkwMABzAGMALQBpAGMAbwBuAHMALQA5ADAAMFJlZ3VsYXIAUgBlAGcAdQBsAGEAcnNjLWljb25zLTkwMABzAGMALQBpAGMAbwBuAHMALQA5ADAAMEZvbnQgZ2VuZXJhdGVkIGJ5IEljb01vb24uAEYAbwBuAHQAIABnAGUAbgBlAHIAYQB0AGUAZAAgAGIAeQAgAEkAYwBvAE0AbwBvAG4ALgAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA=") format("woff")}</style>
<style id="style-font-emoji" type="text/css">@font-face{font-family:color-emoji;src:local("Twemoji Mozilla"),local("Apple Color Emoji"),local("Segoe UI Emoji"),local("Segoe UI Symbol"),local("Noto Color Emoji"),local("EmojiOne Color"),local("Android Emoji")}</style>
<style id="style-core" type="text/css">#store-area,tw-storydata{display:none!important;z-index:0}::-webkit-scrollbar{height:8px;width:8px}::-webkit-scrollbar-corner,::-webkit-scrollbar-track{background-color:#111}::-webkit-scrollbar-thumb{background-color:#333;border:1px solid #111}*{scrollbar-color:#333 #111;scrollbar-width:thin}:-webkit-full-screen{height:100%;width:100%}:-ms-fullscreen{height:100%;width:100%}:fullscreen{height:100%;width:100%}body::-ms-backdrop{background:0 0}:focus{outline:thin dotted}:disabled{cursor:not-allowed!important}html{font-family:-apple-system,system-ui,BlinkMacSystemFont,"Segoe UI",Roboto,Oxygen-Sans,Cantarell,Ubuntu,"Helvetica Neue",Helvetica,Arial,sans-serif,color-emoji;font-size:16px;line-height:1}body{color:#eee;background-color:#111;overflow:auto}a{cursor:pointer;color:#68d;text-decoration:none;-webkit-transition-duration:.2s;-o-transition-duration:.2s;transition-duration:.2s}a:hover,html[data-outlines] a:focus{color:#8af;text-decoration:underline}a.link-broken{color:#c22}a.link-broken:hover,html[data-outlines] a.link-broken:focus{color:#e44}a[disabled],span.link-disabled{color:#aaa;text-decoration:none}a.link-internal{-webkit-touch-callout:none}area{cursor:pointer}button{cursor:pointer;color:#eee;background-color:#35a;border:1px solid #57c;line-height:normal;padding:.4em;-webkit-transition-duration:.2s;-o-transition-duration:.2s;transition-duration:.2s;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}button:hover,html[data-outlines] button:focus{background-color:#57c;border-color:#79e}button:disabled{background-color:#444;border:1px solid #666}code,kbd,pre,samp,var{font-family:SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Lucida Console","Courier New",Courier,monospace,monospace}pre{overflow:auto}input,select,textarea{color:#eee;background-color:transparent;border:1px solid #444;padding:.4em}select{padding:.34em .4em}input[type=text]{min-width:18em}textarea{min-width:30em;resize:vertical}input[type=checkbox],input[type=file],input[type=radio],select{cursor:pointer}input[type=range]{-webkit-appearance:none;min-height:1.2em}input[type=range]:focus{outline:0}input[type=range]::-webkit-slider-runnable-track{background:#222;border:1px solid #444;border-radius:0;cursor:pointer;height:10px;width:100%}input[type=range]::-webkit-slider-thumb{-webkit-appearance:none;background:#35a;border:1px solid #57c;border-radius:0;cursor:pointer;height:18px;margin-top:-5px;width:33px}input[type=range]:focus::-webkit-slider-runnable-track{background:#222}input[type=range]::-moz-range-track{background:#222;border:1px solid #444;border-radius:0;cursor:pointer;height:10px;width:100%}input[type=range]::-moz-range-thumb{background:#35a;border:1px solid #57c;border-radius:0;cursor:pointer;height:18px;width:33px}input[type=range]::-ms-track{background:0 0;border-color:transparent;color:transparent;cursor:pointer;height:10px;width:calc(100% - 1px)}input[type=range]::-ms-fill-lower{background:#222;border:1px solid #444;border-radius:0}input[type=range]::-ms-fill-upper{background:#222;border:1px solid #444;border-radius:0}input[type=range]::-ms-thumb{background:#35a;border:1px solid #57c;border-radius:0;cursor:pointer;height:16px;width:33px}html[data-outlines] input:focus,html[data-outlines] select:focus,html[data-outlines] textarea:focus,input:hover,select:hover,textarea:hover{background-color:#333;border-color:#eee}input:disabled,select:disabled,textarea:disabled{color:#333;background-color:transparent;border-color:#111}hr{display:block;height:1px;border:none;border-top:1px solid #eee;margin:1em 0;padding:0}audio,canvas,progress,video{max-width:100%;vertical-align:middle}.no-transition{-webkit-transition:none!important;-o-transition:none!important;transition:none!important}.error-view{background-color:#511;border-left:.5em solid #c22;display:inline-block;margin:.1em;max-width:100%;padding:0 .25em;position:relative}.error-view>.error-toggle{background-color:transparent;border:none;line-height:inherit;left:0;padding:0;position:absolute;top:0;width:1.75em}.error-view>.error-toggle:hover,html[data-outlines] .error-view>.error-toggle:focus{background-color:transparent}.error-view>.error{display:inline-block;margin-left:.25em}.error-view>.error-toggle+.error{margin-left:1.5em}.error-view>.error-source[hidden]{display:none}.error-view>.error-source:not([hidden]){background-color:rgba(0,0,0,.2);display:block;margin:0 0 .25em;overflow-x:auto;padding:.25em}.highlight,.marked{color:#ff0;font-weight:700;font-style:italic}.nobr{white-space:nowrap}.error-view>.error-toggle::before,.error-view>.error::before,[data-icon-after]::after,[data-icon-before]::before,[data-icon]::before,a.link-external::after{font-family:sc-icons!important;font-style:normal;font-weight:400;font-variant:normal;line-height:1;speak:never;text-rendering:auto;text-transform:none;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}[data-icon]::before{content:attr(data-icon)}[data-icon-before]::before{content:attr(data-icon-before);margin-right:.35em}[data-icon-after]::after{content:attr(data-icon-after);margin-left:.35em}.error-view>.error-toggle::before{content:"\f0da"}.error-view>.error-toggle.enabled::before{content:"\f0d7"}.error-view>.error::before{content:"\f071";margin-right:.35em}a.link-external::after{content:"\f35d";margin-left:.25em}</style>
<style id="style-core-display" type="text/css">#story{z-index:10;margin:2.5em}@media screen and (max-width:1136px){#story{margin-right:1.5em}}#passages{max-width:54em;margin:0 auto}</style>
<style id="style-core-passage" type="text/css">.passage{line-height:1.75;text-align:left;-webkit-transition:opacity .4s ease-in;-o-transition:opacity .4s ease-in;transition:opacity .4s ease-in}.passage-in{opacity:0}.passage ol,.passage ul{margin-left:.5em;padding-left:1.5em}.passage table{margin:1em 0;border-collapse:collapse;font-size:100%}.passage caption,.passage td,.passage th,.passage tr{padding:3px}@media (prefers-reduced-motion:reduce){.passage{-webkit-transition:opacity 0s;-o-transition:opacity 0s;transition:opacity 0s}}</style>
<style id="style-core-macro" type="text/css">@-webkit-keyframes cursor-blink{0%{opacity:1}50%{opacity:0}100%{opacity:1}}@-o-keyframes cursor-blink{0%{opacity:1}50%{opacity:0}100%{opacity:1}}@keyframes cursor-blink{0%{opacity:1}50%{opacity:0}100%{opacity:1}}.macro-append-insert,.macro-linkappend-insert,.macro-linkprepend-insert,.macro-linkreplace-insert,.macro-prepend-insert,.macro-repeat-insert,.macro-replace-insert,.macro-timed-insert{-webkit-transition:opacity .4s ease-in;-o-transition:opacity .4s ease-in;transition:opacity .4s ease-in}.macro-append-in,.macro-linkappend-in,.macro-linkprepend-in,.macro-linkreplace-in,.macro-prepend-in,.macro-repeat-in,.macro-replace-in,.macro-timed-in{opacity:0}.macro-type-cursor::after{-webkit-animation:cursor-blink 1s infinite;-o-animation:cursor-blink 1s infinite;animation:cursor-blink 1s infinite;content:"\2590";opacity:1}</style>
<style id="style-ui-dialog" type="text/css">html[data-dialog] body{overflow:hidden}#ui-overlay{background-color:#000;height:200%;left:-50%;opacity:0;position:fixed;top:-50%;-webkit-transition:visibility .2s step-end,opacity .2s ease-in;-o-transition:visibility .2s step-end,opacity .2s ease-in;transition:visibility .2s step-end,opacity .2s ease-in;visibility:hidden;width:200%;z-index:100000}#ui-overlay.open{opacity:.8;-webkit-transition:visibility 0s;-o-transition:visibility 0s;transition:visibility 0s;visibility:visible}#ui-dialog{display:none;margin:0;max-width:66em;opacity:0;padding:0;position:fixed;top:50px;z-index:100100}#ui-dialog.open{display:block;opacity:1;-webkit-transition:opacity .2s ease-in;-o-transition:opacity .2s ease-in;transition:opacity .2s ease-in}#ui-dialog>*{-webkit-box-sizing:border-box;box-sizing:border-box}#ui-dialog-titlebar{background-color:#444;min-height:24px;position:relative}#ui-dialog-title{font-size:1.5em;margin:0;padding:.2em 3.5em .2em .5em;text-align:center;text-transform:uppercase}#ui-dialog-close{background-color:transparent;border:1px solid transparent;cursor:pointer;display:block;font-size:120%;height:92%;margin:0;padding:0;position:absolute;right:0;top:0;-webkit-transition-duration:.2s;-o-transition-duration:.2s;transition-duration:.2s;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;white-space:nowrap;width:3.6em;font-family:sc-icons!important;font-style:normal;font-weight:400;font-variant:normal;line-height:1;speak:never;text-rendering:auto;text-transform:none;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}#ui-dialog-close:hover{background-color:#b44;border-color:#d66}#ui-dialog-body{background-color:#111;border:1px solid #444;height:calc(100% - 2.1em);line-height:1.5;min-width:300px;overflow:auto;padding:1em;text-align:left}#ui-dialog-body>:first-child{margin-top:0}#ui-dialog-body hr{background-color:#444}#ui-dialog-body ul.buttons{margin:0;padding:0;list-style:none}#ui-dialog-body ul.buttons li{display:inline-block;margin:0;padding:.4em .4em 0 0}#ui-dialog-body ul.buttons>li+li>button{margin-left:1em}@media (prefers-reduced-motion:reduce){#ui-overlay{-webkit-transition:opacity 0s;-o-transition:opacity 0s;transition:opacity 0s}#ui-overlay.open{-webkit-transition:opacity 0s;-o-transition:opacity 0s;transition:opacity 0s}#ui-dialog.open{-webkit-transition:opacity 0s;-o-transition:opacity 0s;transition:opacity 0s}}</style>
<style id="style-ui-dialog-saves" type="text/css">#ui-dialog-body.saves{padding:0 0 1px}#ui-dialog-body.saves>:not(:first-child){border-top:1px solid #444}#ui-dialog-body.saves>h2{background-color:#222;font-size:inherit;margin:0;padding:.1em 0 .1em .4em}#ui-dialog-body.saves table{border-spacing:0;width:100%}#ui-dialog-body.saves tr:not(:first-child){border-top:1px solid #444}#ui-dialog-body.saves td{padding:.33em}#ui-dialog-body.saves td:first-child{display:none!important}#ui-dialog-body.saves td:nth-child(3){line-height:1.2;width:100%}#ui-dialog-body.saves td:last-child{text-align:right}#ui-dialog-body.saves .empty{color:#999;speak:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}#ui-dialog-body.saves .details{font-size:75%;margin-left:.25em}#ui-dialog-body.saves #saves-list button{color:#eee;background-color:transparent;border:1px solid #444;height:2.237em;width:2.237em}#ui-dialog-body.saves #saves-list button:disabled{color:#444;border-color:#444}#ui-dialog-body.saves #saves-list button:not(:disabled):hover{background-color:#222;border-color:#ddd}#ui-dialog-body.saves #saves-list button.delete:not(:disabled),#ui-dialog-body.saves button[id=saves-clear]:not(:disabled){background-color:#911;border-color:#b33}#ui-dialog-body.saves #saves-list button.delete:not(:disabled):hover,#ui-dialog-body.saves button[id=saves-clear]:not(:disabled):hover{background-color:#b33;border-color:#d55}#ui-dialog-body.saves #saves-list button.load:not(:disabled){background-color:#161;border-color:#383}#ui-dialog-body.saves #saves-list button.load:not(:disabled):hover{background-color:#383;border-color:#5a5}#ui-dialog-body.saves .buttons li{padding:.4em}#ui-dialog-body.saves .buttons>li+li>button{margin-left:.2em}#ui-dialog-body.saves .buttons.slots>li:last-child{float:right}#ui-dialog-body.saves #saves-list button::before,#ui-dialog-body.saves .buttons button::before{font-family:sc-icons!important;font-style:normal;font-weight:400;font-variant:normal;line-height:1;speak:never;text-rendering:auto;text-transform:none;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}#ui-dialog-body.saves .buttons button::before{margin-right:.35em}#ui-dialog-body.saves button.delete::before{content:"\f2ed"}#ui-dialog-body.saves button.delete:disabled::before{content:"\f1f8"}#ui-dialog-body.saves button.load::before{content:"\f04b"}#ui-dialog-body.saves button.save::before{content:"\f0c7"}#ui-dialog-body.saves button[id=saves-export]::before{content:"\f56e"}#ui-dialog-body.saves button[id=saves-import]::before{content:"\f56f"}#ui-dialog-body.saves button[id=saves-clear]::before{content:"\f2ed"}#ui-dialog-body.saves button[id=saves-clear]:disabled::before{content:"\f1f8"}#ui-dialog-body.saves button[id=saves-disk-save]::before{content:"\f56d"}#ui-dialog-body.saves button[id=saves-disk-load]::before{content:"\f574"}</style>
<style id="style-ui-dialog-settings" type="text/css">#ui-dialog-body.settings [id|=setting-body]>div:first-child{display:table;width:100%}#ui-dialog-body.settings [id|=setting-label]{display:table-cell;padding:.4em 2em .4em 0}#ui-dialog-body.settings [id|=setting-label]+div{display:table-cell;min-width:8em;text-align:right;vertical-align:middle;white-space:nowrap}#ui-dialog-body.settings div[id|=header-body]{margin:1em 0}#ui-dialog-body.settings div[id|=header-body]:first-child{margin-top:0}#ui-dialog-body.settings div[id|=header-body]:not(:first-child){border-top:1px solid #444;padding-top:1em}#ui-dialog-body.settings div[id|=header-body]>*{margin:0}#ui-dialog-body.settings h2[id|=header-heading]{font-size:1.375em}#ui-dialog-body.settings p[id|=header-desc],#ui-dialog-body.settings p[id|=setting-desc]{font-size:87.5%;margin:0 0 0 .5em}#ui-dialog-body.settings div[id|=setting-body]+div[id|=setting-body]{margin:1em 0}#ui-dialog-body.settings [id|=setting-control]{white-space:nowrap}#ui-dialog-body.settings button[id|=setting-control]{color:#eee;background-color:transparent;border:1px solid #444;padding:.4em}#ui-dialog-body.settings button[id|=setting-control]:hover{background-color:#333;border-color:#eee}#ui-dialog-body.settings button[id|=setting-control].enabled{background-color:#282;border-color:#4a4}#ui-dialog-body.settings button[id|=setting-control].enabled:hover{background-color:#4a4;border-color:#6c6}#ui-dialog-body.settings input[type=range][id|=setting-control]{max-width:35vw}#ui-dialog-body.settings span[id|=setting-input]{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}#ui-dialog-body.settings button[id|=setting-control].enabled::after,#ui-dialog-body.settings button[id|=setting-control]::after{font-family:sc-icons!important;font-style:normal;font-weight:400;font-variant:normal;line-height:1;speak:never;text-rendering:auto;text-transform:none;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;margin-left:.35em}#ui-dialog-body.settings button[id|=setting-control]::after{content:"\f204"}#ui-dialog-body.settings button[id|=setting-control].enabled::after{content:"\f205"}</style>
<style id="style-ui-dialog-legacy" type="text/css">#ui-dialog-body.list{padding:0}#ui-dialog-body.list ul{margin:0;padding:0;list-style:none;border:1px solid transparent}#ui-dialog-body.list li{margin:0}#ui-dialog-body.list li:not(:first-child){border-top:1px solid #444}#ui-dialog-body.list li a{display:block;padding:.25em .75em;border:1px solid transparent;color:#eee;text-decoration:none}#ui-dialog-body.list li a:hover{background-color:#333;border-color:#eee}#ui-dialog-body.list a{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}</style>
<style id="style-ui-bar" type="text/css">#story{margin-left:20em;-webkit-transition:margin-left .2s ease-in;-o-transition:margin-left .2s ease-in;transition:margin-left .2s ease-in}#ui-bar.stowed~#story{margin-left:4.5em}@media screen and (max-width:1136px){#story{margin-left:19em}#ui-bar.stowed~#story{margin-left:3.5em}}@media screen and (max-width:768px){#story{margin-left:3.5em}}#ui-bar{background-color:#222;border-right:1px solid #444;height:100%;left:0;margin:0;padding:0;position:fixed;text-align:center;top:0;-webkit-transition:left .2s ease-in;-o-transition:left .2s ease-in;transition:left .2s ease-in;width:17.5em;z-index:50}#ui-bar.stowed{left:-15.5em}#ui-bar-tray{position:absolute;top:.2em;left:0;right:0}#ui-bar-body{height:calc(100% - 2.5em);line-height:1.5;margin:2.5em 0;overflow:auto;padding:0 1.5em}#ui-bar.stowed #ui-bar-body,#ui-bar.stowed #ui-bar-history{visibility:hidden;-webkit-transition:visibility .2s step-end;-o-transition:visibility .2s step-end;transition:visibility .2s step-end}#ui-bar a{text-decoration:none}#ui-bar hr{border-color:#444}#ui-bar-tray button{color:#eee;background-color:transparent;border:1px solid #444}#ui-bar-tray button:hover{background-color:#444;border-color:#eee}#ui-bar-tray button:disabled{color:#444;background-color:transparent;border-color:#444}button#ui-bar-toggle{border-right:none;position:absolute;right:0;top:0}#ui-bar-history{margin:0 auto}#ui-bar-history button:not(:first-child){margin-left:1.2em}#ui-bar-body>:not(:first-child){margin-top:2em}#story-title{margin:0;font-size:162.5%}#story-author{margin-top:2em;font-weight:700}#menu ul{margin:1em 0 0;padding:0;list-style:none;border:1px solid #444}#menu ul:empty{display:none}#menu li{margin:0}#menu li:not(:first-child){border-top:1px solid #444}#menu li a{display:block;padding:.25em .75em;border:1px solid transparent;color:#eee;text-transform:uppercase}#menu li a:hover{background-color:#444;border-color:#eee}#menu a,#ui-bar-tray button{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}#menu-core li[id|=menu-item] a::before,#ui-bar-tray button::before{font-family:sc-icons!important;font-style:normal;font-weight:400;font-variant:normal;line-height:1;speak:never;text-rendering:auto;text-transform:none;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}#ui-bar-tray button::before{display:block;font-size:1.1em;width:1em}#ui-bar-toggle::before{content:"\f053"}#ui-bar.stowed #ui-bar-toggle::before{content:"\f054"}#ui-bar-tray #history-backward::before{content:"\f060"}#ui-bar-tray #history-jumpto::before{content:"\f0e7"}#ui-bar-tray #history-forward::before{content:"\f061"}#menu-item-continue a::before,#menu-item-restart a::before,#menu-item-saves a::before,#menu-item-settings a::before,#menu-item-share a::before{margin-right:.35em}#menu-item-continue a::before{content:"\f04b"}#menu-item-saves a::before{content:"\f0c7"}#menu-item-settings a::before{content:"\f013"}#menu-item-restart a::before{content:"\f011"}#menu-item-share a::before{content:"\f1e0"}@media (prefers-reduced-motion:reduce){#story{-webkit-transition:margin-left 0s;-o-transition:margin-left 0s;transition:margin-left 0s}#ui-bar{-webkit-transition:left 0s;-o-transition:left 0s;transition:left 0s}}</style>
<style id="style-ui-debug-bar" type="text/css">#debug-bar{background-color:#222;border-left:1px solid #444;border-top:1px solid #444;bottom:0;margin:0;max-height:95%;max-width:66em;min-width:300px;padding:.5em;position:fixed;right:0;z-index:99900}#debug-bar>div:not([id])+div{margin-top:.5em}#debug-bar>div>label{margin-right:.5em}#debug-bar>div>input[type=text]{min-width:8em;width:14em}#debug-bar>div>select{width:22em}#debug-bar-toggle{color:#eee;background-color:#222;border:1px solid #444;height:calc(100% + 1px);left:calc(-2em - 1px);position:absolute;top:-1px;width:2em}#debug-bar-toggle:hover{background-color:#333;border-color:#eee}#debug-bar-hint{bottom:.75em;font-size:4.5em;opacity:.33;pointer-events:none;position:fixed;right:.6em;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;white-space:nowrap}#debug-bar-watch{background-color:#222;border-left:1px solid #444;border-top:1px solid #444;bottom:calc(100% + 1px);font-size:.9em;left:-1px;max-height:280%;max-height:calc(95vh - 100%);position:absolute;overflow-x:hidden;overflow-y:scroll;right:0;z-index:99800}#debug-bar-watch[hidden]{display:none}#debug-bar-watch div{color:#999;font-style:italic;margin:1em auto;text-align:center}#debug-bar-watch table{width:100%}#debug-bar-watch tr:nth-child(2n){background-color:rgba(127,127,127,.15)}#debug-bar-watch td{padding:.2em 0}#debug-bar-watch td:first-child+td{padding:.2em .3em .2em .1em}#debug-bar-watch .watch-delete{background-color:transparent;border:none;color:#c00}#debug-bar-watch-all,#debug-bar-watch-clear{margin-left:.5em}#debug-bar-views-toggle,#debug-bar-watch-toggle{color:#eee;background-color:transparent;border:1px solid #444;margin-right:1em;padding:.4em}#debug-bar-views-toggle:hover,#debug-bar-watch-toggle:hover{background-color:#333;border-color:#eee}#debug-bar-watch:not([hidden])~div #debug-bar-watch-toggle,html[data-debug-view] #debug-bar-views-toggle{background-color:#282;border-color:#4a4}#debug-bar-watch:not([hidden])~div #debug-bar-watch-toggle:hover,html[data-debug-view] #debug-bar-views-toggle:hover{background-color:#4a4;border-color:#6c6}#debug-bar-hint::after,#debug-bar-passage-play::before,#debug-bar-toggle::before,#debug-bar-views-toggle::after,#debug-bar-watch .watch-delete::before,#debug-bar-watch-add::before,#debug-bar-watch-all::before,#debug-bar-watch-clear::before,#debug-bar-watch-toggle::after{font-family:sc-icons!important;font-style:normal;font-weight:400;font-variant:normal;line-height:1;speak:never;text-rendering:auto;text-transform:none;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}#debug-bar-toggle::before{content:"\f188"}#debug-bar-hint::after{content:"\f188\202f\f061"}#debug-bar-watch .watch-delete::before{content:"\f00d"}#debug-bar-watch-add::before{content:"\f067"}#debug-bar-watch-all::before{content:"\f0d0"}#debug-bar-watch-clear::before{content:"\f2ed"}#debug-bar-views-toggle::after,#debug-bar-watch-toggle::after{content:"\f204";margin-left:.35em}#debug-bar-watch:not([hidden])~div #debug-bar-watch-toggle::after,html[data-debug-view] #debug-bar-views-toggle::after{content:"\f205"}#debug-bar-passage-play::before{content:"\f04b"}</style>
<style id="style-ui-debug-views" type="text/css">html[data-debug-view] .debug{padding:.25em;background-color:#234}html[data-debug-view] .debug[title]{cursor:help}html[data-debug-view] .debug.block{display:inline-block;vertical-align:middle}html[data-debug-view] .debug.invalid{text-decoration:line-through}html[data-debug-view] .debug.hidden,html[data-debug-view] .debug.hidden .debug{background-color:#555}html:not([data-debug-view]) .debug.hidden{display:none}html[data-debug-view] .debug[data-name][data-type].nonvoid::after,html[data-debug-view] .debug[data-name][data-type]::before{background-color:rgba(0,0,0,.25);font-family:monospace,monospace;white-space:pre}html[data-debug-view] .debug[data-name][data-type]::before{content:attr(data-name)}html[data-debug-view] .debug[data-name][data-type|=macro]::before{content:"<<" attr(data-name) ">>"}html[data-debug-view] .debug[data-name][data-type|=macro].nonvoid::after{content:"<</" attr(data-name) ">>"}html[data-debug-view] .debug[data-name][data-type|=html]::before{content:"<" attr(data-name) ">"}html[data-debug-view] .debug[data-name][data-type|=html].nonvoid::after{content:"</" attr(data-name) ">"}html[data-debug-view] .debug[data-name][data-type]:not(:empty)::before{margin-right:.25em}html[data-debug-view] .debug[data-name][data-type].nonvoid:not(:empty)::after{margin-left:.25em}html[data-debug-view] .debug[data-name][data-type|=special],html[data-debug-view] .debug[data-name][data-type|=special]::before{display:block}</style>
</head>
<body>
	<div id="init-screen">
		<div id="init-no-js"><noscript>JavaScript must be enabled to play.</noscript></div>
		<div id="init-lacking"><p>Browser lacks capabilities required to play.</p><p>Upgrade or switch to another browser.</p></div>
		<div id="init-loading"><div>Loading&hellip;</div></div>
	</div>
	<tw-storydata name="NEVERLAND" startnode="99" creator="Twine" creator-version="2.9.1" format="SugarCube" format-version="2.37.0" ifid="E3246A24-2795-43D2-81E3-83C900F0F7B9" options="" tags="" zoom="0.6" hidden><style role="stylesheet" id="twine-user-stylesheet" type="text/twine-css">@import url('https://static.zeoseven.com/cn/240/main/result.css');
@import url('https://static.zeoseven.com/cn/237/main/result.css');
@import url('https://static.zeoseven.com/cn/166/main/result.css');

/************************* 整体 *************************/
:root {
    /* 文字颜色 */
    --fontcolor-dark: #5C4F43;/*棕色 */
    --fontcolor-light: #FAF5F0;/*白 */
    --fontcolor-gold:#D4A34C;/*铂金 */
    --fontcolor-brightgold:#FFAA00;/*亮金 */
    --fontcolor-lightgold:#FFF3B9;/*淡金 */
    --fontcolor-blue:#4E84BA;/*蓝 */

    /* 背景颜色 */
    --background-dark: #B6A990 ;/*深棕 */
    --background-light: #FAF9F8  ;/*白 */
    --background-smoke:#777;/*灰 */
    --background-gray:#CDCDD0;/*中灰 */
    --background-grayblue:#A7BBC3;/*灰蓝 */
    --background-goldengray:#F2ECE6;/*金灰 */
    --background-khaki:#D6C8B8;/*卡其 */
  
    /* 圆角设置 */
    --radius-max:100px;
    --radius-intense:12px;
    --radius-moderate:8px;
    --radius-subtle: 0.5rem;

}
      /* 字体 */
body {
font-weight: 500;
font-size: 14.5px;
 overflow: auto;
}
#textc{
  font-size: 13.8px;
}
@font-face {
    font-family: "2"; 
    src: url("fonts/KaiseiTokumin-Regular-2.ttf");
}
@font-face {
    font-family: "手写"; 
    src: url("fonts/YaoSuiXinShouXieTi-2.ttf");
}
@font-face {
    font-family: "4"; 
    src: url("fonts/Mamelon-3-Hi-Regular-2.ttf");
}
@font-face {
    font-family: "卡通"; 
    src: url("fonts/PangMenZhengDaoXiXianTi-2.ttf");
}
.passage {
  font-family: "XiangcuiDazijitiW15";}
.tw-title {
  font-family:Luminari, fantasy;}
.write{
  font-family: "手写";
  font-size: 18px;}
hr {
    margin:0.1em auto;
}
/*文本框*/
input, select, textarea {
    padding: 0.2em 0.8em;
    color:var(--fontcolor-highlight) ;
    background:var(--background-gray);
    border-radius:var(--radius-subtle);
    border: transparent;
}
select:hover {
    background-color:var(--fontcolor-deep1);
    border: transparent;
}
/* 错误提示 */
.error-view {
	background-color: #eaa;
	border-left-color: #d77;
}
    /* 滚动条 */
*{  scrollbar-width: none; }
    /* 界面边距*/
#menu ul {
        margin: 0 0 0; }
#menu-item-restart {
        display: none; }
#story {
        margin-top: 0.5em; }
#ui-bar-body>:not(:first-child) {
    margin-top: 0em;
}
#story-title {
    margin: 0.5em;
    font-size: 162.5%;
}
    /*-----表格----*/
table {
      border: 1px solid #D6C8B8;
        padding:  2px 2px 2px 2px;
    }
    /*-----图片----*/
.pic {
    border: 3px solid var(--background-goldengray);
      border-radius: 12px;, 0);  }
.picr {
border: 3px solid var(--background-goldengray);
  border-radius: 50%; }
    /*-----进度条----*/
#ui-bar meter::-webkit-meter-optimum-value {
      background: rgb(255,185, 0);
    }
#ui-bar meter::-webkit-meter-suboptimum-value {
      background: #BA3030;
    }

#right-ui-bar meter::-webkit-meter-optimum-value {
      background: #BA3030;
    }

/* link 目前只有弹窗里的有点击动画 body无*/
.passage a.link-internal { 
    	z-index:5;
    border: 1.5px solid ;
	text-decoration:none;
	padding: 2px 15px 6px 15px;
	text-align: center;
	border-radius:var(--radius-max);
    line-height: 2rem;
}  
.passage a.link-internal:hover { 
	text-decoration:none; 
    box-shadow:0px 0px 10px var(--background-light);    
    transform: scale(1.1);
}
/* button */
.passage button {
    padding: 10px 12px;
    border: 1.5px solid;
    border-radius: 12px;
            backface-visibility: hidden;
            box-sizing: border-box;
            display: inline-block;
            font-family: Circular,Helvetica,sans-serif;
            font-size: 1rem;
            font-weight: 700;
            letter-spacing: -.01em;
            line-height: 1.3;
            position: relative;
            text-align: center;
            text-decoration: none;
   transition: 0.2s ease-in-out;
            user-select: none;
            -webkit-user-select: none;
            touch-action: manipulation;
}
.passage button:not(:disabled):hover:active {
transform: scale(.90);
}

/* -------------弹窗------------ */
/* 弹窗整体 */
#ui-dialog { 
	display: none;
    overflow: auto;
    min-width: 35em;
    max-width: 35em;
	z-index: 100100;
	position: fixed;
	top: 5rem;
}
#ui-dialog > * {
	box-sizing: border-box;
}
/* 弹窗标题 */
#ui-dialog-titlebar {
    top: 0.8em;
    max-width: max-content;
    position: relative;
    padding: 0px 10px;
    border-radius: var(--radius-max);
      	z-index:500;
}
#ui-dialog-title {
    padding:10px;
	font-size: 20px;
	text-align: center;
	text-transform: uppercase;
}
/* 弹窗关闭键(不显示) */
#ui-dialog-close {
    display:none;
	position: absolute;
	right:0;
	top: 0;
	white-space: nowrap;
	cursor: pointer;
	font-size: 120%;
	margin: 0;
	padding: 0;
	width: 3.6em;
	height: 100%;
	border: transparent;
	transition-duration: 200ms;
}
#ui-dialog-close:hover {
    color:#E2818A;
    background-color:transparent; 
    border: transparent;
}
/* 弹窗内 */
#ui-dialog-body {
	height: calc(100% - 3rem); 
   min-height:20vh;
 max-height:80vh;
    border-radius:var(--radius-intense);
	border: transparent;
	text-align: left;
	line-height: 1.5;
	padding: 20px;
}
#ui-dialog-body a {
   color:var(--background-gold);
  background-color:transparent;
  	text-decoration:none;
}
#ui-dialog-body a:hover {
  background-color:transparent;
   text-shadow:0px 0px 10px var(--background-goldengray);    
}
#ui-dialog-body ul.buttons {
    padding: 0;
  background: none;
    list-style: none;
    text-align: center;
    margin-bottom: 2em;
    margin-top: 0em;
border-radius:var(--radius-subtle);
}
#ui-dialog-body button {
    display:inline-block;
    padding:2px 10px;
    margin: 0;
	text-decoration:none;
	text-align: center;  
	border-radius:var(--radius-moderate); 
    box-sizing: border-box;
   transition: all .2s;
            user-select: none;
            -webkit-user-select: none;
            touch-action: manipulation;
}
#ui-dialog-body button:hover {
	text-decoration:none;
	text-align: center;  
	border-radius:var(--radius-moderate);  
    box-shadow:0px 0px 10px var(--background-gray);    
}
#ui-dialog-body button:not(:disabled):hover:active {
transform: scale(.90);
}
#ui-dialog-body > *:first-child {
	margin-top: 0;
}
/* 存档弹窗 */
#ui-dialog-body.saves {
    overflow: auto;
  padding: 20px 15px;
}
#ui-dialog-body.saves h2 {
    background-color: transparent;
}
#ui-dialog-body.saves #saves-list {
    color: var(--fontcolor-gold);;
  background-color: #FFFFFF;
        border-top-right-radius:var(--radius-subtle);
        border-top-left-radius:var(--radius-subtle);
}
#ui-dialog-body.saves #saves-list button {
    color: var(--fontcolor-lavender);
    background-color: var(--background-grey);
    border: 1px solid var(--fontcolor-lavender);
    border-radius:var(--radius-subtle);
    height: 2.237em;
    width: 2.237em;
}
#ui-dialog-body.saves #saves-list button.save:hover {
    color: #343B3F;
    background-color: var(--background-lavender);
    border: 1px solid #343B3F;
    border-radius:var(--radius-subtle);
    height: 2.237em;
    width: 2.237em;
}
#ui-dialog-body.saves #saves-list button.load:not(:disabled) {
    color: #E7E7E7;
    background-color: var(--background-lavender);
    border: transparent;
    height: 2.237em;
    width: 2.237em;
}
#ui-dialog-body.saves #saves-list button.load:not(:disabled):hover {
    color: var(--fontcolor-lavender);
    background-color:#343B3F;
    transform: scale(1.2);
}
#ui-dialog-body.saves #saves-list button.delete:not(:disabled), #ui-dialog-body.saves button[id=saves-clear]:not(:disabled) {
    color: #E5E8DC;
    background-color:#E66648;
    border: transparent;
}
#ui-dialog-body.saves #saves-list button.delete:not(:disabled):hover, #ui-dialog-body.saves button[id=saves-clear]:not(:disabled):hover {
    color:#BA3030;
    background-color:#460202;
    border: transparent;
    transform: scale(1.1);
}
#ui-dialog-body.saves .buttons.slots>li:last-child {
    float: unset;
}
/* 弹窗切换 */
.title-buttons {
  display: flex;
  color:var(--fontcolor-grey);
  gap: 10px;
  height: 100%; 
  justify-content: center;
}
.popup-button {
  background-color: var(--background-khaki);
  padding: 0.5em;
  cursor: pointer;
  color: var(--fontcolor-dark);
  text-align: center;
  height: 100%;
  font-size: 15px;
  border: transparent;
  border-radius:var(--radius-moderate);
}
.popup-button:hover {
  background: var(--background-dark);
  color: var(--fontcolor-light);
}
.popup-button:not(.active) {
}
.popup-button.active {
  border: transparent;
  color:var(--fontcolor-gold);
  background-color: var(--background-light);
}
/**对话选择容器**/
.choice-container {
  opacity: 0;
     transition: 0.5s ease-in-out;
}
.typewriter {
  opacity: 0;
     transition: 0.5s ease-in-out;
}
.typewriter.typing {
  opacity: 1;
       transition: 0.5s ease-in-out;
}
.cursor {
  display: inline-block;
  width: 2px;
  height: 1em;
  background-color: #fff;
  margin-left: 2px;
  animation: blink 1s step-end infinite;
     transition: 0.5s ease-in-out;
}
 
@keyframes blink {
  0%, 100% { opacity: 1; }
  50% { opacity: 0; }
}

/****************** 侧边栏 ******************/
/* 左侧边栏 */
#ui-bar.stowed {
    left: -15em;
}
#ui-bar{
  border-bottom-right-radius: 20px;
    border-top-right-radius: 20px;
    border: 1.5px solid #F5E4CE;
      font-family: "XiangcuiChaoxisongW15";
}
/* 按钮 */
#menu ul {
  	margin: 0px;
	padding: 0px;
	list-style:none;
    border:transparent;
}
#menu li {
	margin: 0px;
}
#menu li:not(:first-child) {
	border-top: transparent;
}
#menu li a {
    background-color: transparent;
	display: block;
    border: 0px solid transparent;
    border-radius:var(--radius-max); 
	text-transform: uppercase;
}
#menu li a:hover {
    border-radius:var(--radius-max); 
    box-shadow: 0px 0px 5px var(--background-dark);
    transform: scale(1.1);
}

/* 侧边栏收起和回退*/
#ui-bar-tray button::before {
      top: .5em;
    font-size: 1.2em;
}
#ui-bar-tray button {    
    border:none; 
    border-radius:var(--radius-subtle); 
    margin:0.2em;
    padding: 0.4rem;
}  
#ui-bar-tray button:hover {  
    border-radius:var(--radius-subtle); 
}
button#ui-bar-toggle {
    right: 0.3em;
}
#ui-bar-toggle::before {
    content: "\f0d9";
}
#ui-bar.stowed #ui-bar-toggle::before {
    content: "\f0da";
}
#ui-bar-history [id|="history"]:disabled {   
    border-radius:var(--radius-max);  
    display: none;  
}  
#ui-bar-history [id|="history"]:hover {   
  border-radius:var(--radius-subtle); }

/*左侧边栏收起时菜单栏 */
.portrait {
    width: 100%; 
    height: auto; 
}
#statebox {
    visibility: hidden;
    position: fixed;
    top: 5%;
    right: 0.28em;
}
#ui-bar.stowed #statebox {
    visibility: visible; /* 收缩时显示 */
    transition: visibility 200ms step-end;
}
.uibartext {
    display: flex;
    color:var(--fontcolor-highlight);
    background-color:var(--background-black);
    border: 2px solid;
    border-color:var(--fontcolor-highlight);
    border-radius: 0.3em;
    width:1.7rem;
    height:auto;
    margin: 0.2em auto;
    font-size:20px;
    font-weight: 900;
    writing-mode: vertical-rl;
    letter-spacing: 0.2rem;
    padding: 0.5rem 0;
}
.statetext {
    display: flex;
    justify-content: center;
    align-items: center;
    color:var(--fontcolor-white);
    background-color:var(--background-black);
    border: 2px solid;
    border-color:var(--fontcolor-white);
    border-radius: 0.3em;
    width:1.7rem;
    height:1.7rem;
    margin: 0.2em auto;
    font-size:20px;
    font-weight: 900;
}

/*右侧边栏*/
#right-ui-bar {
width: 17.5em;
  border-bottom-left-radius: 20px;
  border-top-left-radius: 20px;
  border: 1.5px solid #F5E4CE;
  font-family: "XiangcuiChaoxisongW15";
  text-align: center;
  position: fixed;
  z-index: 50;
  top: 0;
  right: 0;
  height: 100%;
  margin: 0;
  padding: 0;
  transition: right .2s ease-in;
}
#right-ui-bar-body {
	height: 90%;
	height: calc(100% - 2.5em);
	margin: 2.5em 0;
	padding: 0 1.5em;
}
#right-ui-bar-body {
	line-height: 1.5;
	overflow: auto;
}
#right-ui-bar button {
            box-sizing: border-box;
            font-size: 1rem;
            font-weight: 700;
            letter-spacing: -.01em;
            line-height: 1.3;
            position: relative;
            text-align: center;
            text-decoration: none;
            transition: all .2s;
            user-select: none;
            -webkit-user-select: none;
            touch-action: manipulation;
}
#right-ui-bar button:not(:disabled):hover:active {
transform: scale(.90);
}
#right-ui-bar a {
    display:inline-block;
	padding: 1px 10px 1px 8px;
    margin: 0;
	text-decoration:none;
	text-align: center;  
	border-radius:var(--radius-moderate); 
    box-sizing: border-box;
   transition: all .2s;
            user-select: none;
            -webkit-user-select: none;
            touch-action: manipulation;
}
#right-ui-bar a:hover {
	text-decoration:none;
	text-align: center;  
	border-radius:var(--radius-moderate);  
    box-shadow:0px 0px 10px var(--background-goldengray);    
}
#right-ui-bar a:not(:disabled):hover:active {
transform: scale(.90);
}
/*收起按钮*/
#right-ui-bar-tray {
	position: absolute;
	top: .2em;
	left: 0;
	right: 0;
}
#right-ui-bar-toggle {
	font-size: 1.2em;
	line-height: inherit;
	color: #eee;
	background-color: transparent;
	border: 1px solid #444;
  display: flex;
	position: absolute;
	top: 0;
	left: 0;
	border-left: none;
	padding: .3em .45em .25em;
	-webkit-user-select: none;
}
#right-ui-bar-toggle:before {
	font-style: normal; 
font-weight: 400; 
font-variant: normal; 
text-transform: none; 
line-height: 1; 
speak: none; 
  	content: "\e81d";
}
#right-ui-bar.stowed #right-ui-bar-toggle {
	padding: .3em .55em .25em .35em;
}
#right-ui-bar.stowed #right-ui-bar-toggle:before {
	content: "\e81e";
}
button#right-ui-bar-toggle {
    left: 0.3em;
}
/*间隔*/
#story {
	margin-right: 20em;
}
#right-ui-bar.stowed {
	right: -15em;
}
#right-ui-bar.stowed #right-ui-bar-body {
	visibility: hidden;
	-webkit-transition: visibility .2s step-end;
	-o-transition: visibility .2s step-end;
	transition: visibility .2s step-end;
}
#right-ui-bar.stowed~#story {
	margin-right: 4.5em;
}
.delayed {
    opacity: 0;
}
/************************* 配色 *************************/
/***************** 夜间版 ******************/
.night {
  color: #F5E4CE;
  background: linear-gradient(180deg, #00021C, #203159);
  height: 100vh;
  width:100vw;
  overflow:auto;
}

html.night body, body.night {
    color: #F5E4CE;
    background-color:rgba(255, 255, 255, 0); 
  width: 100vw; height: 100vh;
}
html.night body a, body.night a {
	color: #D4A34C;
}
html.night body a:hover, body.night a:hover {
	color: #B86200;
}

.night body #ui-bar, body.night #ui-bar {
  color: #F5E4CE;
  border: rgba( 168, 153, 136, 0.50 );  
     box-shadow: 0 8px 32px 0 rgba( 79, 73, 64, 0.6 );  
    backdrop-filter: blur( 4px ); 
     background: linear-gradient(180deg, rgba( 0, 1, 5, 0.85 ), rgba( 158, 147, 130, 0.50 ) 90%);
}
.night body #right-ui-bar, body.night #right-ui-bar {
     color: white;
  background: rgba( 0, 5, 23, 0.50 );  
    box-shadow: 0 8px 32px 0 rgba( 214, 200, 184, 0.4 );  
    backdrop-filter: blur( 4px ); 
}

/* 链接颜色*/
html.night body a, body.night a {
   border-color: var( --fontcolor-gold);
			color:var( --fontcolor-gold);
    z-index:5;
}
html.night body a:hover, body.night a:hover {
     color:var( --fontcolor-light);
    z-index:5;
}
/* 按钮颜色 */
html.night body #story, body.night #story {
  button {
    border-color: var( --fontcolor-gold);
			color:var( --fontcolor-gold);
}
  button:not(:disabled):hover {
		color:var( --fontcolor-light);
  }
}

/****************** 日间版 *******************/
/* 背景 */
html.bleached {
	color: #5C4F43;
	background-color: #FAF5F0;
   background-image:url('https://f2.toyhou.se/file/f2-toyhou-se/images/87542668_GbRSyCgZ9WYzDN1.png');
   background-size:cover;
background-repeat: no-repeat;
background-attachment: fixed;
}
/* 主界面 */
html.bleached body, body.bleached {
	color: #5C4F43;
    background-color:rgba(255, 255, 255, 0); 
  width: 100vw; height: 100vh;
}
/* 链接颜色*/
html.bleached body a, body.bleached a {
    border-color: rgba(255, 255, 255, 0); 
	color:var( --fontcolor-light);
   background-color:var(--background-dark);
}
html.bleached body a:hover, body.bleached a:hover {
     border-color:var(--background-dark);
		color:var( --fontcolor-gold);
    background-color:var(--background-light);
}
html.bleached body span.link-disabled, body.bleached span.link-disabled {
	color: #777;
}
/* 按钮颜色 */
/* 主体*/
html.bleached body #story, body.bleached #story {
  button {
    border-color: #8C7B6B;
      background-color:var(--fontcolor-dark);
			color:var( --fontcolor-light);
}
  button:not(:disabled):hover {
    color: #5C4F43  ;
    background:#E0D7CC;
  }
    button:not(:disabled):hover:after {
        border: 1.5px solid #8C7B6B;
        border-radius: 12px;
  }
}
/* 弹窗 */
html.bleached #ui-dialog-body button {
   border-color:var(--background-dark);
   color:var( --fontcolor-light);
   background-color:var(--background-dark);
}
html.bleached #ui-dialog-body button:hover {
     border-color:var(--fontcolor-gold);
     color:var(--fontcolor-gold);
   background-color:var(--background-light);
}

/* 文本框颜色 */
html.bleached body input, body.bleached input,
html.bleached body select, body.bleached select,
html.bleached body textarea, body.bleached textarea {
	color: #5C4F43;
	border-color: #ccc;
}
html.bleached body input:not(:disabled):focus, body.bleached input:not(:disabled):focus,
html.bleached body select:not(:disabled):focus, body.bleached select:not(:disabled):focus,
html.bleached body textarea:not(:disabled):focus, body.bleached textarea:not(:disabled):focus,
html.bleached body input:not(:disabled):hover, body.bleached input:not(:disabled):hover,
html.bleached body select:not(:disabled):hover, body.bleached select:not(:disabled):hover,
html.bleached body textarea:not(:disabled):hover, body.bleached textarea:not(:disabled):hover {
	background-color: #ddd;
	border-color: #111;
}
/* 分割线 */
html.bleached body hr, body.bleached hr {
    color:var(--fontcolor-dark);
}

html.bleached body pre, body.bleached pre,
html.bleached body code, body.bleached code {
    background-color: #d9d9d9;
}
html.bleached body pre.error-source, body.bleached pre.error-source,
html.bleached body .error-source code, body.bleached .error-source code {
	background-color: transparent;
}

html.bleached body .error-view > .error-source:not([hidden]), body.bleached .error-view > .error-source:not([hidden]) {
	background-color: rgba(255, 255, 255, 0.2);
}
/* 左侧边栏 */
html.bleached body #ui-bar, body.bleached #ui-bar {
  	border-bottom-right-radius: 24px;
    border-top-right-radius: 24px;
    box-shadow: 0 8px 20px 0 rgba(79, 73, 64, 0.2);
    backdrop-filter: blur(4px);
    background:rgba(205,191,176, 1);
   background-size:cover;
background-repeat: no-repeat;
background-attachment: fixed;
}
/* 左侧边栏收起和回退颜色*/
html.bleached body #ui-bar-toggle, body.bleached #ui-bar-toggle,
html.bleached body #ui-bar-history [id|="history"], body.bleached #ui-bar-history [id|="history"] {
    color:var(--fontcolor-dark);   
    background-color:rgba(255, 255, 255, 0);  
    border-color:rgba(255, 255, 255, 0);  
      max-width: 15em;  
}
html.bleached body #ui-bar-toggle:hover, body.bleached #ui-bar-toggle:hover,
html.bleached body #ui-bar-history [id|="history"]:hover, body.bleached #ui-bar-history [id|="history"]:hover {
    background-color:var(--background-light);   
    border-color:none;  
    color:var(--fontcolor-gold);   
      max-width: 15em;  
}
html.bleached body #ui-bar-history [id|="history"]:disabled, body.bleached #ui-bar-history [id|="history"]:disabled {
	color:transparent;
	background-color: transparent;
	border:none;
      max-width: 15em;  
}
/* 左侧边栏link*/
html.bleached body #menu li a, body.bleached #menu li a {
 color:var(--fontcolor-dark);
}
html.bleached body #menu li a:hover, body.bleached #menu li a:hover {
color:var(--fontcolor-light);
    background-color:var(--fontcolor-dark);
    box-shadow: 0px 0px 5px var(--background-dark);
}
/* 右侧边栏 */
html.bleached body #right-ui-bar, body.bleached #right-ui-bar {
    border: 1.5px solid #F5E4CE;
    font-family: "XiangcuiChaoxisongW15";
    box-shadow: 0 8px 20px 0 rgba(79, 73, 64, 0.2);
    backdrop-filter: blur(4px);
       background:rgba(205,191,176, 1);
}
html.bleached body #right-ui-bar-toggle, body.bleached #right-ui-bar-toggle {
	color: #5C4F43;
    background-color:rgba(255, 255, 255, 0);  
    border-color:rgba(255, 255, 255, 0);  
}
html.bleached body #right-ui-bar-toggle:hover, body.bleached #right-ui-bar-toggle:hover {
	color: #FAF5F0;
      background-color:rgba(255, 255, 255, 0);  
    border-color:rgba(255, 255, 255, 0);  
}
html.bleached body #right-ui-bar, body.bleached #right-ui-bar {
table, th, td {
    padding: 1px;
  border-collapse: separate;
  border: none;
        border-radius:var(--radius-max);
}
td:hover {background-color: #EDE3DE;}
}
/* 右侧边栏link */
html.bleached body #right-ui-bar a, body.bleached #right-ui-bar a {
 	color:var(--fontcolor-gold);
       background-color:var(--background-goldengray);
    border-color:transparent;
    border-radius:var(--radius-max);
}
html.bleached body  #right-ui-bar a:hover, body.bleached  #right-ui-bar a:hover {
 	color:var( --fontcolor-light);
       background-color:var(--background-dark);
    border-color: var(--background-dark);
}
html.bleached body #right-ui-bar ul, body.bleached #right-ui-bar ul {
    border-color:rgba(255, 255, 255, 0);  
      border-radius:var(--radius-moderate);
}
html.bleached body #right-ui-bar li:not(:first-child), body.bleached #right-ui-barli:not(:first-child) {
    border-color:rgba(255, 255, 255, 0);  
}
/* 右侧边栏按钮 */
html.bleached body #right-ui-bar button, body.bleached #right-ui-bar button {
    background-color:transparent;
    border-color:transparent;
      border-radius:var(--radius-moderate);
            box-sizing: border-box;
           	color:var( --fontcolor-dark);
}
html.bleached body #right-ui-bar button:not(:disabled):hover, body.bleached #right-ui-bar button:not(:disabled):hover {
            background-color:var(--background-light);
           	color:var( --fontcolor-gold);
}

/* 弹窗 */
/* 弹窗开启时背景 */
html.bleached body #ui-overlay, body.bleached #ui-overlay {
	background-color: var(--background-smoke);
     overflow: auto;
      backdrop-filter: blur(var(--blur-subtle));
}
/* 弹窗标题 */
html.bleached body #ui-dialog-titlebar, body.bleached #ui-dialog-titlebar {
	background-color:#D6C8B8;}
html.bleached body #ui-dialog-title, body.bleached #ui-dialog-title {
    color:var(--fontcolor-dark);
}
/* 弹窗关闭键 */
html.bleached body #ui-dialog-close, body.bleached #ui-dialog-close {
      color:var(--fontcolor-blood);
	background-color: transparent;}
/* 弹窗主体 */
html.bleached body #ui-dialog-body, body.bleached #ui-dialog-body {
         max-height:80vh;
      color:var(--fontcolor-dark);  
background-color: var(--background-light);
table {
  font-size: 1.2em;
  border: none;
    padding:  2px 2px 2px 2px;
  border-radius: 10px;
}
th{    border-radius: 10px; background-color: #EDE3DE;}
  td{border-bottom:1px solid #D6C8B8;}
a:hover {
    color: var(--fontcolor-gold);
    background-color:var(--fontcolor-light);
}
}

html.bleached body #ui-dialog-body hr, body.bleached #ui-dialog-body hr {
  background-color: #ccc;
}


/*列表对话框 */
html.bleached body #ui-dialog-body.list li:not(:first-child), body.bleached #ui-dialog-body.list li:not(:first-child) {
	border-top-color: #ccc;
}
html.bleached body #ui-dialog-body.list li a, body.bleached #ui-dialog-body.list li a {
	color: #111;
}
html.bleached body #ui-dialog-body.list li a:hover, body.bleached #ui-dialog-body.list li a:hover {
	background-color: #ddd;
	border-color: #111;
}

/* 存档界面 */
html.bleached body #ui-dialog-body.saves > *:not(:first-child), body.bleached #ui-dialog-body.saves > *:not(:first-child),
html.bleached body #ui-dialog-body.saves tr:not(:first-child), body.bleached #ui-dialog-body.saves tr:not(:first-child) {
  border: none;
}
html.bleached body #ui-dialog-body.saves .empty, body.bleached #ui-dialog-body.saves .empty {
	color: #777;
}

/* 设置弹窗 */
html.bleached body #ui-dialog-body.settings button[id|="setting-control"], body.bleached #ui-dialog-body.settings button[id|="setting-control"] {
	color: #111;
	border-color: #ccc;
}
html.bleached body #ui-dialog-body.settings button[id|="setting-control"]:hover, body.bleached #ui-dialog-body.settings button[id|="setting-control"]:hover {
	background-color: #ddd;
	border-color: #111;
}
html.bleached body #ui-dialog-body.settings button[id|="setting-control"].enabled, body.bleached #ui-dialog-body.settings button[id|="setting-control"].enabled {
	background-color:var(--fontcolor-gold);  
    color:var(--fontcolor-light);  
	border-color: var(--background-drak);  
}

/* Debug bar styling */
html.bleached body #debug-bar, body.bleached #debug-bar,
html.bleached body #debug-bar-toggle, body.bleached #debug-bar-toggle,
html.bleached body #debug-bar-watch, body.bleached #debug-bar-watch {
	background-color: #eee;
	border-color: #ccc;
}
html.bleached body #debug-bar-watch div, body.bleached #debug-bar-watch div {
	color: #777;
}
html.bleached body #debug-bar-toggle, body.bleached #debug-bar-toggle,
html.bleached body #debug-bar-watch-toggle, body.bleached #debug-bar-watch-toggle,
html.bleached body #debug-bar-views-toggle, body.bleached #debug-bar-views-toggle {
	color: #111;
	border-color: #ccc;
}
html.bleached body #debug-bar-toggle:hover, body.bleached #debug-bar-toggle:hover,
html.bleached body #debug-bar-watch-toggle:hover, body.bleached #debug-bar-watch-toggle:hover,
html.bleached body #debug-bar-views-toggle:hover, body.bleached #debug-bar-views-toggle:hover {
	background-color: #ddd;
	border-color: #111;
}
html.bleached body #debug-bar-watch:not([hidden]) ~ div #debug-bar-watch-toggle, body.bleached #debug-bar-watch:not([hidden]) ~ div #debug-bar-watch-toggle,
html.bleached body html[data-debug-view] #debug-bar-views-toggle, body.bleached html[data-debug-view] #debug-bar-views-toggle {
	background-color: #9e9;
	border-color: #7c7;
}
html.bleached body #debug-bar-watch:not([hidden]) ~ div #debug-bar-watch-toggle:hover, body.bleached #debug-bar-watch:not([hidden]) ~ div #debug-bar-watch-toggle:hover,
html.bleached body html[data-debug-view] #debug-bar-views-toggle:hover, body.bleached html[data-debug-view] #debug-bar-views-toggle:hover {
	background-color: #7c7;
	border-color: #5a5;
}

/* Debug view styling */
html.bleached body html:not([data-debug-view]) #debug-view-toggle, body.bleached html:not([data-debug-view]) #debug-view-toggle {
	color: #111;
	border-color: #ccc;
}
html.bleached body html:not([data-debug-view]) #debug-view-toggle:hover, body.bleached html:not([data-debug-view]) #debug-view-toggle:hover {
	background-color: #eee;
	border-color: #111;
}
html.bleached body html[data-debug-view] #debug-view-toggle, body.bleached html[data-debug-view] #debug-view-toggle {
	background-color: #9e9;
	border-color: #7c7;
}
html.bleached body html[data-debug-view] #debug-view-toggle:hover, body.bleached html[data-debug-view] #debug-view-toggle:hover {
	background-color: #7c7;
	border-color: #5a5;
}
html.bleached body html[data-debug-view] .debug, body.bleached html[data-debug-view] .debug {
	background-color: #dc9;
}
html.bleached body html[data-debug-view] .debug.hidden, body.bleached html[data-debug-view] .debug.hidden,
html.bleached body html[data-debug-view] .debug.hidden .debug, body.bleached html[data-debug-view] .debug.hidden .debug {
	background-color: #bbb;
}


/************************* 提示气泡*************************/
/*----深色----*/
.tooltip {
    position: relative;
    display: inline-block;
}
.tooltip .tooltiptext {
    visibility: hidden;
    width: 120px;
    background: #6E6C6A;
    color: #fff;
font-size: 12px;
    text-align: center;
    border-radius: 6px;
    padding: 5px 0;
    position: absolute;
    z-index: 1;
    bottom: 125%;
    left: 30%;
    margin-left: -55px;
    opacity: 0;
    transition: all .3s;
}
.tooltip .tooltiptext::after {
    content: "";
    position: absolute;
    top: 100%;
    left: 50%;
    margin-left: -5px;
    border-width: 5px;
    border-style: solid;
    border-color: #6E6C6A transparent transparent transparent;
}
.tooltip:hover .tooltiptext {
    visibility: visible;
    opacity: 1;
}
.tooltip:hover {
       color: #FFAA00;
}
/*----浅色----*/
.tip {
    position: relative;
    display: inline-block;
  color: #FFFFFF;
}
.tip .tiptext {
    visibility: hidden;
    width: 12em;
    background:var(--background-light);  
    color: #111;
font-size: 13px;
    text-align: left;
    border-radius: 12px;
  box-shadow: 0 8px 32px 0 rgba( 214, 200, 184, 0.4 ); 
    padding: 5px 5px;
    position: absolute;
    z-index: 1;
    bottom: 125%;
    left: 50%;
    margin-left: -6.4em;
    opacity: 0;
    transition: all .3s;
}
.tip .tiptext::after {
    content: "";
    position: absolute;
    top: 100%;
    left: 50%;
    margin-left: -5px;
    border-width: 5px;
    border-style: solid;
    border-color: #FFFFFF transparent transparent transparent;
}
.tip:hover .tiptext {
    visibility: visible;
    opacity: 1;
}
.tip:hover {
       color: #FFAA00;
}
/*---------*/

.item-grid {
    width: 100%;
      display: flex;
      justify-content: center;
       align-items: center;
  flex-direction: column;
}

.item-grid table {
width: 100%;
}

/************************* 小部件*************************/
/*-----seisi----*/
.seisi button {
    display:inline-block;
    padding:4px 10px;
    margin: 0;
	text-decoration:none;
	text-align: center;  
	border-radius:var(--radius-max); 
    box-sizing: border-box;
   transition: all .2s;
            user-select: none;
            -webkit-user-select: none;
            touch-action: manipulation;
  color:var( --fontcolor-dark);
       background-color:var(--background-light);
    border-color:var(--background-light);
    border-radius:var(--radius-moderate);
}
.seisi button:hover {
	text-decoration:none;
	text-align: center;  
	border-radius:var(--radius-moderate);  
    box-shadow:0px 0px 10px var(--background-gray);    
  color:var( --fontcolor-gold);
  	border-color: var( --fontcolor-gold);
  background-color:var(--background-light);
}
.seisi button:not(:disabled):hover:active {
transform: scale(.90);
}

/*-----翻页容器----*/
.page { color:var( --fontcolor-gold); 
position: absolute;
    width: 100%;
    height: 2%;
    bottom: 3%;
  left:-0.08%;
    display: grid;
    grid-template-columns: 1fr 3fr 1fr;
    justify-items: center;
}

/*-----醉酒效果----*/
#drunk { 	z-index:0;
top: 0%;
    left: 0%;
    position: absolute;
    width: 100vw;
    height: 100vh;
    background-color: rgba(255, 255, 255, 0);
}

/*-----双页模式----*/
.btr {
border: 2px solid #fff;
   border-radius: 50%; 
  background-color: #B7BA0D;}

.lefthalf {
    width: 50%;
    position: sticky;
    height: 100%;}
.righthalf {
height: 100%;
    width: 50%;
    position: sticky;
    left: 100%;
    bottom: 100%; }

@keyframes flicker {
  0% {
    opacity: 0;
  } 80% {
    opacity: 0.8;
  }
}
/*-----隐藏文字----*/
.hidden {    font-family: "Shanggu Sans VF"; color:rgba(255, 255, 255, 0); 
display: flex;  align-content: center; align-items: center; justify-content: center;}

/*-----qte----*/
#qte{
   text-align: center;
   position: absolute;
   width: 30px;
  height: 30px;
  border-radius: 50%; 
    top: 20%;
    left: 30%;
   bottom: 20%;
    right: 30%;
    display: flex;
    flex-wrap: wrap;
     border-radius: 50%;
   align-content: center;
align-items: center;
   animation: flicker 2s ease alternate infinite;
   z-index: 55;
     
 button {background-image:url('https://f2.toyhou.se/file/f2-toyhou-se/images/95983004_E8N0OB72EQHW3UQ.png');
   background-size: 95%;
    background-repeat: no-repeat;
    background-position: center;
background-color:rgba(0,0,0,0); border:none; color:rgba(0,0,0,0);}
   button:hover {
  border-radius: 50%; 
background-color:rgba(0,0,0,0); border:none; color:rgba(0,0,0,0);}
  button:not(:disabled):hover {background-image:url('https://f2.toyhou.se/file/f2-toyhou-se/images/95983004_E8N0OB72EQHW3UQ.png');
   background-size: 95%;
    background-repeat: no-repeat;
    background-position: center;
   border-radius: 50%; 
background-color:rgba(0,0,0,0); border:none; color:rgba(0,0,0,0);}
  }
   
   }

/*----纸条背景----*/
#clue {
  text-align: center;
	display: flex;
  justify-content: center;
  align-items: center;
position: static;
	max-width: 100%;
background-attachment: scroll, local;
  background-size: contain;
background-repeat: no-repeat;
  background-position: center;
}
/*下菜单栏*/
#npcbar {text-align: center;position: fixed;width: auto;max-height:2%;left: 47%;
        right: 47%;bottom:8%;border-radius: 8px;padding:.5em;line-height: 1.4;background: rgba(255, 255, 255, 0);}

#minisidebar { 
  z-index:10;
  display: flex;
    text-align: center;
    position: fixed;
    max-width: 70%;
    max-height: 6%;
    left: 30%;
    right: 30%;
  bottom: 0%; 
  border-top-left-radius: 8px;
  border-top-right-radius: 8px;
  padding:.5em;
  line-height: 1.4; 
  background: rgba( 194, 177, 157, 0 );
  color:#000;
  flex-direction: row;
    flex-wrap: wrap;
    align-content: center;
    justify-content: space-evenly;}

html.bleached body #minisidebar a, body.bleached #minisidebar a {
    border:1px solid var(--background-goldengray);
	color:var( --fontcolor-gold);
    background-color:var(--background-light);
}
html.bleached body  #minisidebar a:hover, body.bleached  #minisidebar a:hover {
	color:var( --background-goldengray);
    background-color:var(--fontcolor-dark);
   border:1px solid var(--background-goldengray);
}

/*----获得容器----*/
#obtain {
  display: flex;
   text-align: center;
  max-width: max-content;
	position: relative;
    padding: 3px 12px;
    border-radius:var(--radius-max);
   	margin:5px auto;
   border-color: rgba(255, 255, 255, 0); 
	color:var( --fontcolor-blue);
   background-color:var(--background-light);
}
/*----介绍文本框----*/
#idcard {
  display: flex;
   text-align: left;
  max-width: 100%;
	position: relative;
    padding: 4px 6px;
    border-radius:var(--radius-intense);
margin: 0;
  border:1px solid var(--background-dark);
	color:var( --fontcolor-gold);
   background-color:var(--background-goldengray);
  flex-direction: column;
   box-shadow: 0 4px 4px 0 rgba(79, 73, 64, 0.5);
    table, th, td {
    font-size: 0.9em;
	}
}
#chatextcard {font-family: "XiangcuiDazijitiW15";
  display: flex;
   text-align: left;
  max-width: 100%;
	position: relative;
    padding: 5px 10px;
    border-radius:var(--radius-intense);
margin: 0;
  border:1px solid var(--background-dark);
	color:var( --fontcolor-gold);
   background-color:var(--background-light);
  flex-direction: column;
}
 #chatextcard a {
 	color:var(--fontcolor-gold);
        text-align: center;
       background-color:var(--background-goldengray);
    border-color:transparent;
    border-radius:var(--radius-max);
}
 #chatextcard a:hover {
 	color:var( --fontcolor-light);
       background-color:var(--background-khaki);
    border-color: var(--background-dark);
}
 #textcard button {
      		letter-spacing: 2px;
}
 #textcard button:hover {	
  letter-spacing: 5px;
transition: 0.4s ease-in-out;
}

 #textcard {    font-family: "4"; 
   display: flex;
    text-align: left;
    max-width: 100%;
    position: relative;
    padding: 5px 10px;
    border-radius: var(--radius-intense);
    margin: 0;
    border: thick double #d8cbb4;
    color: #855500;
    background-color: #f8f0e7;
   flex-direction: column;}

/*----店铺列表----*/
.shopping-interface {
    max-width:100%;
    border:1px solid var(--fontcolor-gold);
    padding: 5px;
  	text-align: center; 
    border-radius:var(--radius-intense);
}
.shopping-interface h4 {
	text-align: center; 
    font-size:24px;
}
.shopping-interface p {
    color:var(--fontcolor-gold);
    background:var(--background-goldengray);
    border-radius: var(--radius-subtle);
    margin: 0.4rem;
    padding: 0.5rem;
    display: grid;
    text-align: center;
    grid-template-columns: 1fr 1fr 1fr;
}
.shopping-interface span > a {
    color: var(--fontcolor-white);
    background-color: var(--fontcolor-gold);
    border: 1px solid var(--fontcolor-gold);
    border-radius: var(--radius-subtle);
    padding: 2px 10px;
}
.shop {
    max-width:100%;
    border:1px solid #CDCDD0;
    padding: 5px;
    border-radius:var(--radius-intense);
}
.shop p {
    color:var(--fontcolor-gold);
    background:var(--background-goldengray);
    border-radius: var(--radius-subtle);
    margin:3px;
    padding: 5px;
    display: grid;
    text-align: center;
    grid-template-columns:1fr 1fr 1fr;
}
.have {
    max-width:100%;
    border:1px solid #CDCDD0;
    padding: 5px;
    border-radius: var(--radius-subtle);
}
.have p {
    color:var(--fontcolor-gold);
    background-color:#E5E8DC;
    border-radius: var(--radius-subtle);
    margin:3px;
    padding: 5px;
    display: grid;
    text-align: center;
    grid-template-columns:1fr 4fr;
}




/************************* 灵魂样式*************************/
#bluesoul
{
text-align: right;
position: fixed;
bottom: 5px; right: 5px;
background-image: url('https://f2.toyhou.se/file/f2-toyhou-se/images/87585981_lWvCX6JkKTNLriE.gif');
height: 9em;
width: 9em
background-size: contain;
background-repeat: no-repeat;
background-position: bottom 5px right 0px;
background-attachment: local;
pointer-events: none;
   z-index: 0;
}

#goldsoul
{
text-align: right;
position: fixed;
bottom: 5px; right: 5px;
background-image: url('https://f2.toyhou.se/file/f2-toyhou-se/images/87585974_rBFUaRFOHOWrde9.gif');
height: 9em;
width: 9em;
background-size: contain;
background-repeat: no-repeat;
background-position: bottom 5px right 0px;
background-attachment: local;
pointer-events: none;
 z-index: 0;
}

#redsoul
{
text-align: right;
position: fixed;
bottom: 5px; right: 5px;
background-image: url('https://f2.toyhou.se/file/f2-toyhou-se/images/87591260_qYB7GDJDBHUYGOf.gif');
height: 9em;
width: 9em;
background-size: contain;
background-repeat: no-repeat;
background-position: bottom 5px right 0px;
background-attachment: local;
pointer-events: none;
   z-index: 0;
}

#coldsoul
{
text-align: right;
position: fixed;
bottom: 5px; right: 5px;
background-image: url('https://f2.toyhou.se/file/f2-toyhou-se/images/87744795_Bz8JNjG7ve8vUQa.gif');
height: 9em;
width: 9em;
background-size: contain;
background-repeat: no-repeat;
background-position: bottom 5px right 0px;
background-attachment: local;
pointer-events: none;
}

#bloodsoul
{
text-align: right;
position: fixed;
bottom: 5px; right: 5px;
background-image: url('https://f2.toyhou.se/file/f2-toyhou-se/images/87745241_6bFqBKVK71HKtsU.gif');
height: 9em;
width: 9em;
background-size: contain;
background-repeat: no-repeat;
background-position: bottom 5px right 0px;
background-attachment: local;
pointer-events: none;
}

#solidsoul
{
text-align: right;
position: fixed;
bottom: 5px; right: 5px;
background-image: url('https://f2.toyhou.se/file/f2-toyhou-se/images/87754022_6tY2nteFxOwoIRo.gif');
height: 9em;
width: 9em;
background-size: contain;
background-repeat: no-repeat;
background-position: bottom 5px right 0px;
background-attachment: local;
pointer-events: none;
}

#fermentsoul
{
text-align: right;
position: fixed;
bottom: 5px; right: 5px;
background-image: url('https://f2.toyhou.se/file/f2-toyhou-se/images/87745528_PBNwDjFcoy25Z3a.gif');
height: 9em;
width: 9em;
background-size: contain;
background-repeat: no-repeat;
background-position: bottom 5px right 0px;
background-attachment: local;
pointer-events: none;
}

#hungersoul
{
text-align: right;
position: fixed;
bottom: 5px; right: 5px;
background-image: url('https://f2.toyhou.se/file/f2-toyhou-se/images/87751761_zknfwq2dBc0NFaH.gif');
height: 9em;
width: 9em;
background-size: contain;
background-repeat: no-repeat;
background-position: bottom 5px right 0px;
background-attachment: local;
pointer-events: none;
}

#lightlesssoul
{
text-align: right;
position: fixed;
bottom: 5px; right: 5px;
background-image: url('https://f2.toyhou.se/file/f2-toyhou-se/images/87754033_9bjxCPSG155CD59.gif');
height: 9em;
width: 9em;
background-size: contain;
background-repeat: no-repeat;
background-position: bottom 5px right 0px;
background-attachment: local;
pointer-events: none;
}
/*月亮*/
#moon {display: flex;
  justify-content: center;
  align-items: center;
  position: relative;border-radius: 50%; background: rgba( 0, 0, 0, 0, 1 );}


  /************************* 文字效果*************************/
/* 醉酒文字 */
.drunk {
	animation: drunkCam 10s infinite alternate;
	color: white;
}
@keyframes drunkCam {
	0%  { filter: blur(0px); text-shadow: 0 0 0 grey; }
	20% { filter: blur(1px); text-shadow: 8px 0 0 grey; }
	24% { filter: blur(0px); text-shadow: 0 0 0 grey; }
	26% { filter: blur(0px); text-shadow: 0 0 0 grey; }
	28% { filter: blur(1px); text-shadow: 10px 0 0 grey; }
	30% { filter: blur(0px); text-shadow: 0 0 0 grey; }
	60% { filter: blur(1px); text-shadow: 5px 0 0 grey; }
	62% { filter: blur(0px); text-shadow: 0 0 0 grey; }
	65% { filter: blur(2px); text-shadow: 8px 0 0 grey; }
	67% { filter: blur(0px); text-shadow: 0 0 0 grey; }
	80% { filter: blur(0px); text-shadow: 8px 0 0 grey; }
	85% { filter: blur(2px); text-shadow: 10px 0 0 grey; }
	88% { filter: blur(1px); text-shadow: 5px 0 0 grey; }
	90% { filter: blur(0px); text-shadow: 0 0 0 grey; }
}

/*字轮*/
#outerCircleText {
    color: #FFAA00;
    position: absolute;
    top: 0.6em;
    left: -0.6em;
    z-index: 3000;
    cursor: default;
}
#outerCircleText div {
    position: relative;
}
#outerCircleText div div {
    position: absolute;
    top: 0;
    left: 0;
    text-align: center;
}

/*左右晃*/
@-webkit-keyframes shudder {
	50% {
		-webkit-transform: translateX(0.2em);
		transform: translateX(0.2em)
	}
}
@keyframes shudder {
	50% {
		-webkit-transform: translateX(0.2em);
		transform: translateX(0.2em)
	}
}
.shudder {
	-webkit-animation: shudder linear 0.1s 0s infinite;
	animation: shudder linear 0.1s 0s infinite;
	display: inline-block;
}
/*上下晃*/
@-webkit-keyframes rumble {
	50% {
		-webkit-transform: translateY(-.2em);
		transform: translateY(-.2em)
	}
}
@keyframes rumble {
	50% {
		-webkit-transform: translateY(-.2em);
		transform: translateY(-.2em)
	}
}
.rumble {
	-webkit-animation: rumble linear 0.1s 0s infinite;
	animation: rumble linear 0.1s 0s infinite;
	display:inline-block;
}
/*浮雕*/
.emboss {
	text-shadow: 0.08em 0.08em 0em #FFF;
}
/*模糊*/
.blur {
	color: transparent;
	text-shadow: 0em 0em 0.08em #FFF;
}
.blurrier {
	color: transparent;
	text-shadow: 0em 0em 0.2em #FFF;
}
.blurrier::selection {
	background-color: transparent;
	color: transparent;
}
.blurrier::-moz-selection {
	background-color: transparent;
	color: transparent;
}
/*发光*/
.goodblur {
	color: transparent;
  display: flex;
	position: relative;
  padding: 0.6em;
  justify-content: center;
    flex-direction: row;
	text-shadow:
		0em    0em 0.02em rgba(255,170,0,0.75),
		-0.2em 0em 0.5em  rgba(255,170,0,0.6),
		0.2em  0em 0.5em  rgba(255,170,0,0.5);
}
.loveblur {
	color: transparent;
   display: flex;
	position: relative;
  justify-content: center;
    flex-direction: row;
	text-shadow:
		0em    0em 0.02em rgba(219,142,136,0.75),
		-0.2em 0em 0.5em  rgba(219,142,136,0.6),
		0.2em  0em 0.5em  rgba(219,142,136,0.5);
}
.traitblur {
	color: transparent;
  display: flex;
	position: relative;
  justify-content: center;
    flex-direction: row;
	text-shadow:
		0em    0em 0.02em rgba(147,189,98,0.75),
		-0.2em 0em 0.5em  rgba(147,189,98,0.6),
		0.2em  0em 0.5em  rgba(147,189,98,0.5);
}
.badblur {
	color: transparent;
  display: flex;
	position: relative;
  justify-content: center;
    flex-direction: row;
	text-shadow:
		0em    0em 0.02em rgba(186,48,48,0.75),
		-0.2em 0em 0.5em  rgba(186,48,48,0.6),
		0.2em  0em 0.5em  rgba(186,48,48,0.5);
}
.mirror {
	display: inline-block;
	transform: scaleX(-1);
	-webkit-transform: scaleX(-1);
}
.upside-down {
	display: inline-block;
	transform: scaleY(-1);
	-webkit-transform: scaleY(-1);
}

/*弹出*/
@-webkit-keyframes pulse {
	0%  { -webkit-transform: scale(0, 0); transform: scale(0, 0) }
	20% { -webkit-transform: scale(1.2, 1.2); transform: scale(1.2, 1.2) }
	40% { -webkit-transform: scale(0.9, 0.9); transform: scale(0.9, 0.9) }
	60% { -webkit-transform: scale(1.05, 1.05); transform: scale(1.05, 1.05) }
	80% { -webkit-transform: scale(0.925, 0.925); transform:scale(0.925, 0.925) }
	to  { -webkit-transform: scale(1, 1); transform: scale(1, 1) }
}
@keyframes pulse {
	0%  { -webkit-transform: scale(0, 0); transform: scale(0, 0) }
	20% { -webkit-transform: scale(1.2, 1.2); transform: scale(1.2, 1.2) }
	40% { -webkit-transform: scale(0.9, 0.9); transform: scale(0.9, 0.9) }
	60% { -webkit-transform: scale(1.05, 1.05); transform: scale(1.05, 1.05) }
	80% { -webkit-transform: scale(0.925, 0.925); transform: scale(0.925, 0.925) }
	to  { -webkit-transform: scale(1, 1); transform: scale(1, 1) }
}
.pulse {
	-webkit-animation: pulse 0.8s;
	animation: pulse 0.8s;
	display: inline-block;
}
/*字浪*/
.logo.is-animetion {
  margin-top: 0.1em;
}
.logo.is-animetion span {
  display: inline-block;
  animation: wave-text 1.8s ease-in-out infinite;
}
.logo.is-animetion {
  span:nth-of-type(1){ animation-delay: 0.0s; }
  span:nth-of-type(2){ animation-delay: 0.1s; }
  span:nth-of-type(3){ animation-delay: 0.2s; }
  span:nth-of-type(4){ animation-delay: 0.3s; }
  span:nth-of-type(5){ animation-delay: 0.4s; }
  span:nth-of-type(6){ animation-delay: 0.5s; }
  span:nth-of-type(7){ animation-delay: 0.6s; }
  span:nth-of-type(8){ animation-delay: 0.7s; }
  span:nth-of-type(9){ animation-delay: 0.8s; }
  span:nth-of-type(10){ animation-delay: 0.9s; }
  span:nth-of-type(11){ animation-delay: 1.0s; }
  span:nth-of-type(12){ animation-delay: 1.1s; }
  span:nth-of-type(13){ animation-delay: 1.2s; }
    span:nth-of-type(14){ animation-delay: 1.3s; }
  span:nth-of-type(15){ animation-delay: 1.4s; }
}
@keyframes wave-text{
  00%{
    transform: translateY(0em);
  }
  50%{
    transform: translateY(-0.3em);
  }
  100%{
    transform: translateY(0em);
  }
}
/*旋转*/
.circle {
       display: flex;
  justify-content: center;
  align-items: center;
  position: absolute;
}
.circle:hover {
    animation-name: rotate;
  animation-duration: 3s;
        animation-timing-function: ease-in-out;
      animation-iteration-count: infinite;
}
@keyframes rotate {
  0% {
    transform: rotate(0);
  }
  100% {
    transform: rotate(360deg);
  }
}

/************************* chapel功能*************************/
/* 通知弹窗, by chapel; for use with notify.js; v1.0.0 */
#notify{position:fixed;display:block;width:18em;right:-20em;top:2em;border-top-left-radius: 8px;border-bottom-left-radius: 8px;padding:.5em;box-shadow: 2px 2px 33px 8px rgba(0, 0, 0, 0.1);line-height: 1.4;background-color:#fff;color:#000;-webkit-transition:right .3s;-moz-transition:right .3s;-o-transition:right .3s;transition:right .3s; z-index: 51;}
#notify.open{right:0}

/*背包css, for SugarCube 2, by Chapel*/
ul.simple-inventory-list{margin:0 auto;padding:0}
.simple-inventory-listing{list-style:none;padding:.3rem .3rem .3rem 1rem;display:grid;grid-template-columns: 2fr 0.8fr 1fr 0.8fr 1fr;}
.simple-inventory-listing:nth-child(2n){background-color:#D6C8B8}.simple-inventory-listing>a,.simple-inventory-listing>span{display:inline-block}.all-listing.simple-inventory-listing{border-top:1px solid #fafafa;background-color:transparent}.drop-link{color:#e33}.drop-link:active,.drop-link:focus,.drop-link:hover{color:#f88}.simple-inventory-filter{text-align:right}.simple-inventory-filter input{display:inline-block}
/* End Simple Inventory */

/************************* 手机UI*************************/
@media screen and (max-width: 768px) {
  
html.bleached {
   background-image:url('https://f2.toyhou.se/file/f2-toyhou-se/images/91321153_arZ0HkPEdRV8w0j.png');
}
  
#ui-dialog {
    min-width: 80vw;
    max-width: 80vw;
}
  
  #npcbar {
text-align: center;
position: fixed
display: flex;
max-height:5%;
left: 40%;
right: 40%;bottom:9%;  justify-content: flex-start;
flex-basis: auto;
align-content: center;
flex-wrap: nowrap;
width: auto;
align-items: center;
border-radius: 8px;padding:.5em;line-height: 1;    background: rgba( 194, 177, 157, 0 );color:#fff;}

  #minisidebar {
        text-align: center;
        display: flex;
        padding: .2em;
        line-height: 0.8;
     font-size: 0.7rem;
        background: rgba(194, 177, 157, 0);
        color: #000;
        left: 8%;
        right: 5%;
        height: auto;
        width: auto;
    flex-direction: row;
flex-wrap: nowrap;
align-content: center;
justify-content: space-evenly;
align-items: center;
    }
  
#right-ui-bar.stowed~#story {
    margin-right: 2em;
}
 #ui-bar.stowed~#story {
        margin-left: 2em;}
#story {
    margin-top: 1em;}
  #right-ui-bar.stowed {
	right: -16.3em;
}
#ui-bar.stowed {
	left: -16.3em;
}
.sidemenu-overlay {
    opacity: 0;
    z-index: -10;
}
.sidemenu-overlay--open {
    background-color: rgba(255, 255, 255, .5);
    display: block;
    position: fixed;
    top: 0;
    right: 0;
    bottom: 0;
    left: 0;
    opacity: 1;
    transition: opacity .5s;
    z-index: 20;
}
    .achievements-filters {
        flex-direction: column;
        gap: 0.5rem;
    }
    .achievement {
        width: calc(100% - 4rem);
        right: 1rem;
    }
.achievements-content {
    width:100%;
    -webkit-overflow-scrolling: touch;  
    scroll-behavior: smooth;
}
  
  
}


/*星空背景*/
@keyframes particles {
  0% {
    transform: translateY(0px);
  }
  100% {
    transform: translateY(-2560px);
  }
}
.space{
  position: absolute;
   top: 0px;
  left:0;
}
.particle,
.particle::after {
  background: transparent;
}
.particle::after {
  position: absolute;
}
.particle:nth-child(1) {
  animation: particles 60s linear infinite;
}
.particle:nth-child(1), .particle:nth-child(1)::after {
  box-shadow: 0 0 white, 1342px 1684px white, 2505px 2293px white, 1873px 347px white, 2254px 1148px white, 664px 1217px white, 2124px 454px white, 64px 1088px white, 1361px 2294px white, 566px 1490px white, 405px 140px white, 786px 52px white, 856px 917px white, 942px 2278px white, 2549px 129px white, 913px 839px white, 808px 549px white, 171px 1717px white, 1934px 575px white, 601px 1577px white, 516px 1343px white, 1353px 2303px white, 787px 1996px white, 1256px 794px white, 544px 1644px white, 2147px 533px white, 1713px 2362px white, 2182px 1622px white, 1557px 689px white, 1036px 1736px white, 354px 2485px white, 1480px 135px white, 2493px 2179px white, 461px 517px white, 343px 708px white, 663px 1851px white, 189px 763px white, 416px 1249px white, 2319px 1880px white, 2024px 2270px white, 330px 583px white, 617px 637px white, 310px 2064px white, 669px 1185px white, 1729px 2133px white, 765px 162px white, 1579px 250px white, 142px 2455px white, 2224px 334px white, 1181px 1980px white, 402px 1139px white, 2245px 2163px white, 2154px 2269px white, 1980px 1569px white, 184px 1888px white, 2357px 1439px white, 1426px 575px white, 485px 1039px white, 987px 717px white, 2498px 1764px white, 2286px 73px white, 71px 400px white, 2330px 837px white, 2412px 1438px white, 256px 1503px white, 2517px 2463px white, 199px 2219px white, 951px 1428px white, 123px 1469px white, 1789px 285px white, 1995px 2128px white, 1609px 1652px white, 2035px 67px white, 1223px 1508px white, 1526px 2182px white, 2502px 1913px white, 2553px 253px white, 1850px 2503px white, 101px 2366px white, 1642px 2061px white, 448px 1968px white, 1336px 99px white, 1077px 446px white, 258px 1233px white, 1474px 430px white, 1667px 820px white, 1963px 661px white, 209px 2558px white, 722px 1656px white, 1260px 37px white, 390px 472px white, 2077px 1573px white, 2169px 2544px white, 971px 392px white, 464px 2092px white, 998px 226px white, 38px 2313px white, 898px 1267px white, 469px 576px white, 920px 1422px white, 293px 2018px white, 654px 2437px white, 1726px 1144px white, 2379px 1086px white, 598px 910px white, 854px 2246px white, 1368px 47px white, 1232px 1336px white, 760px 1079px white, 2216px 949px white, 1232px 1020px white, 1828px 971px white, 2284px 1014px white, 768px 1252px white, 631px 101px white, 1695px 1337px white, 342px 2137px white, 801px 714px white, 1717px 968px white, 1925px 722px white, 1171px 2458px white, 1872px 528px white, 2526px 1021px white, 1116px 1354px white, 2358px 958px white, 199px 1987px white, 1676px 1889px white, 1303px 193px white, 959px 1982px white, 1263px 1913px white, 1695px 297px white, 495px 1020px white, 2207px 64px white, 1719px 2526px white, 2125px 2156px white, 831px 371px white, 2481px 88px white, 2534px 1959px white, 149px 805px white, 181px 188px white, 2251px 642px white, 2216px 1937px white, 1783px 2236px white, 1227px 1600px white, 291px 2112px white, 2443px 573px white, 2307px 447px white, 2096px 1168px white, 2202px 560px white, 1566px 1862px white, 1523px 733px white, 1262px 337px white, 1165px 2396px white, 827px 2455px white, 1241px 1475px white, 631px 2240px white, 2129px 1418px white, 875px 1071px white, 1194px 1683px white, 1031px 1679px white, 1540px 1103px white, 1217px 191px white, 56px 1430px white, 2295px 2162px white, 806px 784px white, 99px 44px white, 2036px 1917px white, 851px 292px white, 311px 2552px white, 2144px 2537px white, 1558px 2325px white, 2170px 1924px white, 2400px 166px white, 1656px 2224px white, 1241px 1832px white, 328px 496px white, 1636px 2135px white, 1075px 1831px white, 2344px 550px white, 1872px 1176px white, 1245px 1508px white, 890px 1264px white, 1821px 1271px white, 2248px 534px white, 1430px 563px white, 235px 1195px white, 1938px 1533px white, 1936px 829px white, 412px 610px white, 1137px 505px white, 1771px 733px white, 702px 974px white, 2269px 1901px white, 2184px 506px white, 811px 2548px white, 104px 2066px white, 536px 2539px white, 2429px 1475px white, 70px 1224px white, 1238px 558px white, 1792px 1288px white, 1422px 2352px white, 1677px 1240px white, 2328px 112px white, 238px 984px white, 1023px 1792px white, 1727px 1777px white, 2349px 1251px white, 2111px 413px white, 1086px 1184px white, 1207px 54px white, 1766px 168px white, 644px 2328px white, 199px 2332px white, 1254px 2355px white, 274px 1789px white, 1518px 2496px white, 2491px 932px white, 436px 109px white, 1830px 1500px white, 1055px 1008px white, 378px 623px white, 2080px 2044px white, 260px 753px white, 2097px 1349px white, 2237px 197px white, 1834px 177px white, 2406px 791px white, 1723px 212px white, 916px 1407px white, 369px 2071px white, 734px 1914px white, 427px 1570px white, 196px 949px white, 192px 2404px white, 1101px 314px white, 1577px 2019px white, 774px 1939px white, 1656px 349px white, 109px 610px white, 528px 1799px white, 852px 726px white, 2416px 1988px white, 1034px 1162px white, 2119px 1063px white, 42px 715px white, 2194px 2495px white, 333px 774px white, 1176px 1382px white, 983px 2240px white, 31px 2498px white, 1516px 1556px white, 1908px 1475px white, 595px 1820px white, 210px 656px white, 547px 2451px white, 2228px 1029px white, 2513px 2250px white, 1583px 1582px white, 1844px 545px white, 1871px 418px white, 968px 2254px white, 466px 1154px white, 727px 2240px white, 720px 2005px white, 1968px 1398px white, 1111px 2009px white, 654px 2148px white, 1003px 1361px white, 1971px 1393px white, 2531px 2443px white, 912px 1604px white, 323px 1664px white, 2447px 933px white, 560px 2422px white, 2004px 194px white, 669px 995px white, 1199px 1685px white, 602px 43px white, 988px 1270px white, 535px 1029px white, 2371px 1127px white, 372px 1223px white, 2549px 2151px white, 484px 2279px white, 1346px 916px white, 375px 1444px white, 1262px 1391px white, 2158px 2478px white, 1254px 792px white, 867px 520px white, 2144px 2376px white, 1477px 1021px white, 2539px 1958px white, 2017px 702px white, 201px 1943px white, 1573px 776px white, 14px 2265px white, 2139px 1291px white, 621px 1641px white, 299px 2154px white, 433px 2250px white, 1037px 243px white, 2094px 801px white, 118px 990px white, 1843px 878px white, 2500px 1279px white, 2097px 2246px white, 2045px 70px white, 1274px 1480px white, 962px 674px white, 2497px 160px white, 2516px 278px white, 841px 2050px white, 1120px 944px white, 1638px 678px white, 2511px 1637px white, 1727px 1365px white, 2100px 1619px white, 506px 52px white, 442px 817px white, 1753px 2557px white, 1751px 2237px white, 2084px 707px white, 739px 2293px white, 2528px 294px white, 1805px 316px white, 477px 2105px white, 369px 2487px white, 1876px 826px white, 470px 1586px white, 158px 1472px white, 380px 2479px white, 1024px 1628px white, 585px 1707px white, 840px 1241px white, 2052px 963px white, 2390px 94px white, 660px 1875px white, 1020px 633px white, 409px 355px white, 1089px 1012px white, 583px 899px white, 388px 1072px white, 69px 1752px white, 1852px 1136px white, 721px 722px white, 1551px 2204px white, 111px 2475px white, 1070px 1954px white, 96px 2096px white, 466px 1253px white, 664px 360px white, 143px 1121px white, 1793px 1301px white, 647px 187px white, 2049px 2237px white, 596px 819px white, 1412px 2200px white, 272px 185px white, 1087px 2200px white, 1185px 342px white, 2317px 330px white, 19px 86px white, 909px 2226px white, 2083px 760px white, 2428px 1626px white, 2507px 913px white, 1718px 864px white, 1175px 402px white, 559px 131px white, 1839px 1285px white, 2346px 1739px white, 1798px 1369px white, 2268px 1537px white, 458px 614px white, 2383px 1267px white, 927px 2163px white, 1604px 2036px white, 260px 2543px white, 1953px 804px white, 1010px 940px white, 1126px 648px white, 2174px 1776px white, 1901px 1051px white, 1988px 298px white, 863px 1934px white, 799px 2337px white, 790px 1913px white, 2346px 728px white, 1392px 5px white, 1682px 401px white, 613px 1686px white, 1019px 1687px white, 81px 2125px white, 2475px 2015px white, 311px 2026px white, 1593px 2480px white, 716px 425px white, 1416px 1336px white, 2080px 2159px white, 1705px 1623px white, 183px 838px white, 1392px 1479px white, 2064px 2422px white, 2099px 231px white, 1308px 2185px white, 590px 570px white, 721px 2445px white, 666px 310px white, 1609px 2425px white, 1441px 1210px white, 1775px 2272px white, 17px 1774px white, 2511px 1116px white, 590px 2143px white, 1324px 1163px white, 81px 1626px white, 167px 183px white, 460px 154px white, 1929px 430px white, 1163px 1506px white, 728px 2305px white, 1326px 2446px white, 326px 2265px white, 2448px 2471px white, 1062px 1677px white, 807px 2062px white, 1607px 1126px white, 728px 790px white, 488px 2245px white, 1706px 641px white, 1702px 1882px white, 1089px 2437px white, 2150px 254px white, 557px 1550px white, 1883px 1975px white, 1427px 1389px white, 1707px 1879px white, 1373px 747px white, 1269px 1217px white, 217px 1863px white, 2268px 392px white, 942px 1534px white, 2038px 2289px white, 2032px 602px white, 1744px 760px white, 2261px 684px white, 1259px 1758px white, 1727px 2066px white, 599px 891px white, 611px 1947px white, 1494px 2054px white, 675px 10px white, 1593px 1689px white, 1327px 640px white, 2068px 1621px white, 705px 614px white, 1846px 1130px white, 125px 1257px white, 2502px 2472px white, 200px 1563px white, 1524px 641px white, 2351px 778px white, 1454px 2063px white, 990px 2274px white, 1912px 744px white, 2121px 726px white, 2100px 1575px white, 417px 1580px white, 1116px 614px white, 1788px 1726px white, 1296px 2088px white, 1523px 2091px white, 1252px 2447px white, 1864px 1559px white, 1471px 1072px white, 1778px 822px white, 1916px 534px white, 2010px 722px white, 1840px 869px white, 644px 1617px white, 2249px 2039px white, 2229px 1928px white, 1888px 420px white, 685px 933px white, 1107px 701px white, 1876px 1835px white, 721px 2532px white, 1935px 2244px white, 983px 1340px white, 39px 706px white, 2337px 97px white, 2552px 245px white, 1272px 2428px white, 179px 1828px white, 1913px 1568px white, 210px 47px white, 2293px 863px white, 254px 724px white, 1470px 1359px white, 332px 1491px white, 2311px 301px white, 1480px 2560px white, 251px 96px white, 1619px 2176px white, 2469px 1038px white, 1793px 2288px white, 284px 1904px white, 850px 841px white, 1688px 1752px white, 192px 919px white, 472px 480px white, 121px 107px white, 1653px 1482px white, 109px 2009px white, 74px 731px white, 315px 947px white, 64px 834px white, 957px 2170px white, 326px 2239px white, 95px 1971px white, 1174px 1616px white, 780px 152px white, 1588px 404px white, 68px 2540px white, 749px 78px white, 236px 2351px white, 477px 1650px white, 440px 822px white, 1205px 2141px white, 586px 403px white, 952px 90px white, 795px 1203px white, 2084px 999px white, 637px 1108px white, 1793px 33px white, 2340px 1486px white, 211px 2310px white, 2483px 2089px white, 2267px 1470px white, 438px 2247px white, 209px 1777px white, 2397px 2294px white, 2164px 100px white, 2px 2558px white, 79px 1504px white, 181px 1658px white, 1608px 2105px white, 765px 650px white, 2382px 2354px white, 1688px 2285px white, 1479px 155px white, 636px 2552px white, 618px 1633px white, 1930px 108px white, 566px 2165px white, 1961px 1007px white, 2497px 2245px white, 735px 1855px white, 2235px 2203px white, 1189px 1026px white, 467px 2363px white, 2079px 2464px white, 1699px 2156px white, 452px 318px white, 978px 1095px white, 2001px 148px white, 2474px 1317px white, 1983px 2216px white, 2060px 1258px white, 1359px 265px white, 2088px 1280px white, 2314px 1661px white, 1579px 21px white, 171px 1309px white, 294px 2236px white, 925px 1064px white, 2269px 1629px white, 11px 358px white, 808px 385px white, 1816px 128px white, 477px 309px white, 1993px 2126px white, 1256px 2095px white, 1395px 1265px white, 944px 2399px white, 2345px 2496px white, 1359px 1856px white, 1628px 1581px white, 1477px 777px white, 1562px 1422px white, 264px 693px white, 2244px 21px white, 1372px 854px white, 1615px 1537px white, 1504px 2371px white, 1465px 1518px white, 1315px 1782px white, 590px 996px white, 1911px 391px white;
  width: 1px;
  height: 1px;
}
.particle:nth-child(2) {
  animation: particles 120s linear infinite;
}
.particle:nth-child(2), .particle:nth-child(2)::after {
  box-shadow: 0 0 white, 1408px 312px white, 297px 1760px white, 601px 1087px white, 634px 240px white, 1746px 678px white, 1697px 37px white, 214px 902px white, 877px 39px white, 1569px 4px white, 401px 184px white, 1025px 1134px white, 1080px 1306px white, 499px 337px white, 1508px 2232px white, 2204px 1556px white, 586px 1879px white, 344px 863px white, 1204px 471px white, 673px 1248px white, 573px 1832px white, 1845px 259px white, 559px 1055px white, 1680px 902px white, 2311px 1833px white, 736px 1025px white, 1390px 1116px white, 2450px 1794px white, 1897px 2148px white, 770px 1959px white, 2023px 2365px white, 991px 1423px white, 1590px 585px white, 1854px 1021px white, 691px 2464px white, 552px 471px white, 418px 2471px white, 1623px 40px white, 662px 199px white, 1837px 635px white, 2016px 1020px white, 2142px 2041px white, 44px 868px white, 271px 656px white, 2248px 1267px white, 2027px 31px white, 204px 1675px white, 620px 147px white, 1894px 821px white, 2105px 1353px white, 2237px 1282px white, 375px 766px white, 379px 2135px white, 2321px 78px white, 91px 2160px white, 8px 909px white, 2547px 1557px white, 542px 1439px white, 2264px 50px white, 555px 521px white, 2071px 815px white, 2296px 221px white, 73px 2523px white, 2391px 213px white, 2290px 405px white, 1594px 1130px white, 141px 2397px white, 1402px 829px white, 2264px 238px white, 1401px 2455px white, 1390px 1994px white, 954px 620px white, 581px 1433px white, 857px 1481px white, 672px 2066px white, 423px 1928px white, 2244px 1606px white, 2297px 2053px white, 1195px 433px white, 1260px 257px white, 260px 56px white, 498px 548px white, 2142px 334px white, 2454px 7px white, 1312px 327px white, 1663px 214px white, 1239px 1430px white, 1118px 589px white, 682px 1513px white, 2264px 1314px white, 1342px 685px white, 1896px 1059px white, 79px 1580px white, 2027px 371px white, 1864px 2199px white, 854px 1791px white, 312px 1262px white, 1521px 1532px white, 308px 2540px white, 2433px 1124px white, 2291px 25px white, 740px 63px white, 2022px 2349px white, 2164px 393px white, 1911px 1363px white, 719px 434px white, 493px 288px white, 2442px 9px white, 134px 1429px white, 828px 2081px white, 1133px 1356px white, 249px 2361px white, 1839px 1029px white, 570px 1160px white, 325px 429px white, 2522px 225px white, 373px 1763px white, 541px 856px white, 189px 2319px white, 1035px 823px white, 65px 1417px white, 2520px 2410px white, 111px 323px white, 460px 1308px white, 2153px 495px white, 733px 87px white, 1523px 2059px white, 2465px 393px white, 2480px 2181px white, 2244px 1716px white, 454px 664px white, 1914px 1365px white, 1648px 1518px white, 966px 1235px white, 2053px 677px white, 1082px 1209px white, 1995px 1355px white, 1222px 781px white, 2463px 54px white, 607px 580px white, 1109px 1434px white, 1363px 1496px white, 1709px 423px white, 1655px 193px white, 692px 2461px white, 930px 28px white, 659px 1425px white, 1689px 299px white, 1134px 1220px white, 776px 2488px white, 1332px 927px white, 1809px 44px white, 208px 1681px white, 1812px 909px white, 202px 356px white, 294px 1502px white, 2155px 2437px white, 2137px 228px white, 92px 144px white, 253px 844px white, 2488px 82px white, 1704px 2512px white, 1047px 1459px white, 425px 1071px white, 2170px 2036px white, 13px 374px white, 288px 2127px white, 1914px 1622px white, 1980px 967px white, 1960px 2268px white, 2269px 1563px white, 2134px 767px white, 1817px 2369px white, 1458px 229px white, 1976px 654px white, 956px 537px white, 1342px 1321px white, 2251px 1093px white, 218px 2282px white, 1340px 1587px white, 173px 1701px white, 1449px 1377px white, 1350px 416px white, 1527px 1167px white, 1135px 784px white, 2006px 1526px white, 864px 2195px white, 2464px 2346px white, 913px 896px white, 1642px 626px white, 782px 367px white, 593px 2423px white, 1005px 1391px white, 2162px 1849px white, 1299px 1735px white, 2393px 74px white, 2472px 439px white, 946px 2430px white, 1432px 1628px white, 2010px 293px white, 1265px 136px white;
  width: 2px;
  height: 2px;
}
.particle:nth-child(3) {
  animation: particles 180s linear infinite;
}
.particle:nth-child(3), .particle:nth-child(3)::after {
  box-shadow: 0 0 white, 1950px 1915px white, 1695px 1684px white, 2549px 2211px white, 1567px 2334px white, 281px 1415px white, 432px 691px white, 1194px 676px white, 702px 1964px white, 44px 74px white, 1838px 289px white, 601px 1949px white, 1143px 72px white, 433px 529px white, 2480px 1098px white, 1190px 2387px white, 461px 515px white, 1282px 2055px white, 2107px 1097px white, 2271px 197px white, 525px 911px white, 1221px 1892px white, 1524px 1301px white, 1756px 1372px white, 1329px 1691px white, 2403px 346px white, 2078px 2155px white, 1034px 877px white, 336px 860px white, 287px 1930px white, 665px 346px white, 1406px 1827px white, 722px 601px white, 511px 1331px white, 645px 1626px white, 546px 1571px white, 13px 1430px white, 1963px 902px white, 1390px 2025px white, 939px 822px white, 2032px 1384px white, 2232px 2083px white, 1316px 1716px white, 2008px 803px white, 1994px 1929px white, 1651px 1624px white, 382px 1911px white, 162px 2560px white, 2010px 933px white, 1231px 2043px white, 1214px 346px white, 318px 2198px white, 1310px 312px white, 1232px 255px white, 1291px 1857px white, 1536px 1849px white, 743px 360px white, 994px 1004px white, 2334px 2389px white, 229px 273px white, 469px 2081px white, 287px 2417px white, 655px 1945px white, 1477px 809px white, 1520px 11px white, 1946px 672px white, 1556px 1986px white, 758px 1600px white, 377px 2366px white, 1896px 1352px white, 696px 2092px white, 2141px 2186px white, 2524px 365px white, 854px 1519px white, 1250px 2363px white, 1621px 2506px white, 1510px 228px white, 2383px 1892px white, 674px 1680px white, 1611px 1101px white, 685px 2173px white, 1510px 1272px white, 1896px 1004px white, 592px 672px white, 671px 52px white, 886px 1304px white, 1718px 95px white, 1806px 1008px white, 1307px 2310px white, 788px 362px white, 2111px 2122px white, 1383px 1051px white, 791px 668px white, 1738px 990px white, 1265px 700px white, 398px 627px white, 1893px 27px white, 2294px 1015px white, 1884px 2362px white, 2394px 853px white, 471px 1695px white;
  width: 3px;
  height: 3px;
}
.particle:nth-child(4) {
  animation: particles 400s linear infinite;
}
.particle:nth-child(4), .particle:nth-child(4)::after {
  box-shadow: 0 0 white, 2306px 1814px white, 2198px 2221px white, 318px 416px white, 1424px 2140px white, 1374px 148px white, 160px 2552px white, 2190px 195px white, 831px 378px white, 1657px 1385px white, 1071px 119px white, 2523px 1038px white, 822px 620px white, 693px 1173px white, 1787px 2323px white, 2173px 1572px white, 652px 1936px white, 1535px 1950px white, 13px 1123px white, 131px 902px white, 2391px 1668px white, 2072px 2272px white, 494px 1569px white, 1216px 367px white, 90px 2091px white, 87px 209px white, 474px 1276px white, 1175px 1510px white, 959px 1909px white, 176px 472px white, 2193px 449px white, 682px 2002px white, 1622px 1473px white, 1538px 2554px white, 1434px 1814px white, 1093px 2545px white, 2432px 2511px white, 208px 1655px white, 970px 1542px white, 51px 1252px white, 20px 1435px white, 1899px 841px white, 1029px 1467px white, 1608px 754px white, 1230px 2105px white, 856px 1716px white, 516px 1044px white, 1451px 146px white, 1227px 1459px white, 2541px 1087px white, 2369px 576px white, 1729px 2480px white, 1806px 1445px white, 2528px 268px white, 2442px 1866px white, 150px 858px white, 2489px 2298px white, 35px 551px white, 763px 1043px white, 2142px 1307px white, 811px 1100px white, 436px 681px white, 2291px 2018px white, 2241px 1456px white, 1308px 2538px white, 1932px 1619px white, 2536px 1940px white, 346px 1870px white, 1456px 197px white, 2400px 2235px white, 958px 1487px white, 575px 2457px white, 2326px 1034px white, 285px 990px white, 844px 2160px white, 2246px 2080px white, 42px 1826px white, 1675px 236px white, 1660px 701px white, 2238px 2298px white, 9px 1229px white, 2292px 1540px white, 1565px 1922px white, 774px 1623px white, 116px 2189px white, 332px 1720px white, 1853px 93px white, 946px 1409px white, 1150px 115px white, 1525px 2301px white, 525px 1428px white, 1371px 1852px white, 686px 352px white, 55px 555px white, 1218px 2290px white, 152px 1548px white, 1610px 649px white, 2012px 442px white, 2472px 804px white, 1224px 912px white, 2250px 1799px white, 1934px 36px white, 1468px 2055px white, 2159px 1989px white, 2506px 1825px white, 1104px 69px white, 1743px 89px white, 2150px 2179px white, 307px 2387px white, 1008px 2463px white, 1391px 1881px white, 371px 76px white, 671px 959px white, 1582px 1905px white, 479px 2150px white, 1047px 486px white, 774px 379px white, 1651px 832px white, 1880px 811px white, 1052px 1787px white, 1213px 1534px white, 2058px 174px white, 184px 291px white, 1243px 1457px white, 2515px 319px white, 2346px 755px white, 2099px 2438px white, 2009px 1586px white, 2057px 644px white, 1270px 1346px white, 1270px 2305px white, 1838px 1088px white, 733px 1083px white, 112px 141px white, 175px 1858px white, 478px 2342px white, 1711px 1594px white, 386px 997px white, 1011px 470px white, 2111px 1677px white, 2181px 603px white, 2478px 1593px white, 602px 1887px white, 1628px 342px white, 2013px 2120px white, 2163px 2097px white, 2084px 1479px white, 1599px 331px white, 2070px 1890px white, 205px 1107px white, 1080px 463px white, 1004px 1306px white, 453px 1603px white, 87px 2445px white, 1822px 671px white, 118px 2280px white, 2046px 216px white, 347px 1551px white, 2479px 1540px white, 1699px 504px white, 1538px 1752px white, 2028px 1272px white, 1140px 1204px white, 973px 1016px white, 1689px 2104px white, 1417px 144px white, 859px 2151px white, 294px 1434px white, 855px 672px white, 3px 2303px white, 397px 1582px white, 1292px 1115px white, 2488px 1356px white, 1229px 643px white, 595px 2528px white, 995px 617px white, 990px 339px white, 2113px 585px white, 1649px 111px white, 1343px 1969px white, 573px 337px white, 2386px 564px white, 2005px 1502px white, 905px 1835px white, 2189px 1420px white, 1902px 2529px white, 1685px 1220px white, 976px 2541px white, 1495px 644px white, 1869px 1950px white, 2310px 1699px white, 206px 1411px white, 816px 1432px white, 408px 2499px white, 1659px 256px white, 1477px 986px white, 280px 672px white, 1194px 1375px white, 1201px 2019px white, 965px 1100px white, 995px 889px white, 948px 2180px white, 478px 1533px white, 1771px 48px white, 2113px 1880px white, 335px 2322px white, 1681px 2180px white, 1134px 1980px white, 2177px 936px white, 906px 1030px white, 950px 511px white, 832px 537px white, 1565px 1719px white, 2193px 1708px white, 1344px 1774px white, 1566px 209px white, 635px 600px white, 793px 548px white, 1313px 1331px white, 2401px 1016px white, 56px 1562px white, 1182px 1782px white, 2539px 513px white, 1732px 83px white, 1734px 2471px white, 1569px 2156px white, 1424px 258px white, 1828px 243px white, 2312px 2524px white, 1811px 582px white, 2279px 1950px white, 1303px 2473px white, 1167px 1768px white, 1784px 1204px white, 2177px 417px white, 154px 364px white, 1520px 310px white, 2064px 1141px white, 2223px 1277px white, 2394px 2112px white, 1646px 507px white, 2432px 1314px white, 969px 410px white, 508px 2040px white, 498px 2159px white, 1120px 2191px white, 1291px 63px white, 1346px 118px white, 2358px 2012px white, 1743px 2292px white, 1034px 170px white, 1261px 83px white, 2070px 289px white, 2224px 382px white, 2177px 1874px white, 1355px 212px white, 1482px 598px white, 873px 2479px white, 1427px 1331px white, 2312px 1451px white, 1465px 2396px white, 1963px 78px white, 340px 908px white, 1959px 1746px white, 819px 471px white, 2421px 1928px white, 1708px 2399px white, 779px 171px white, 1566px 1089px white, 2186px 906px white, 5px 1062px white, 1150px 602px white, 399px 2480px white, 1243px 2281px white, 865px 539px white, 1284px 1945px white, 433px 275px white, 655px 2137px white, 574px 1856px white, 752px 1359px white, 1901px 247px white, 1363px 555px white, 1px 2124px white, 1961px 597px white, 1049px 1660px white, 709px 533px white, 1632px 1877px white, 2377px 1109px white, 1654px 1261px white, 659px 1072px white, 980px 471px white, 2527px 1278px white, 230px 1272px white, 513px 1844px white, 1943px 793px white, 1629px 1699px white, 2509px 1537px white, 2450px 800px white, 2217px 2165px white, 718px 1828px white, 811px 2114px white, 2047px 2378px white, 413px 1962px white, 1138px 1355px white, 1571px 2337px white, 1568px 1485px white, 353px 2369px white, 365px 1533px white, 126px 1680px white, 802px 2557px white, 1674px 382px white, 1855px 2128px white, 847px 1800px white, 2028px 1910px white, 1909px 789px white, 1639px 1521px white, 1943px 429px white, 2374px 517px white, 1203px 2036px white, 1290px 2361px white, 1639px 1095px white, 1167px 1043px white, 1618px 2028px white, 423px 530px white, 2500px 1939px white, 1832px 1100px white, 318px 2493px white, 1764px 2460px white, 2495px 1439px white, 518px 1961px white, 199px 2174px white, 1295px 964px white, 1055px 2406px white, 1173px 1721px white, 2428px 337px white, 1218px 1075px white, 107px 893px white, 457px 213px white, 1766px 97px white, 2040px 1661px white, 1171px 433px white, 1819px 2120px white, 1586px 2168px white, 584px 2135px white, 215px 1094px white, 147px 1557px white, 1039px 395px white, 1949px 247px white, 653px 1879px white, 2436px 1651px white, 126px 1659px white, 1337px 2533px white, 1864px 463px white, 1372px 2500px white, 2036px 754px white, 2252px 538px white, 2379px 2210px white, 1646px 1996px white, 1288px 1406px white, 702px 1186px white, 2552px 1697px white, 2198px 1014px white, 1019px 2062px white, 1138px 1407px white, 277px 1259px white, 1859px 827px white, 620px 1285px white, 2063px 269px white, 2375px 915px white, 1463px 1355px white, 2122px 262px white, 2403px 1955px white, 1981px 2226px white, 1388px 428px white, 987px 2215px white, 919px 2072px white, 604px 2094px white, 145px 1582px white, 1500px 2440px white, 511px 1159px white, 1119px 173px white, 766px 1617px white, 666px 2166px white, 1583px 1371px white, 1809px 1943px white, 589px 1547px white, 724px 259px white, 1282px 1525px white, 1229px 626px white, 350px 2300px white, 757px 47px white, 1426px 114px white, 749px 499px white, 952px 1522px white, 1299px 2072px white, 1686px 1088px white, 2195px 1616px white, 1219px 2007px white, 165px 2235px white, 2135px 2259px white, 359px 1520px white;
  width: 2px;
  height: 2px;
}

/************************* 成就样式 *************************/
/* 动画样式 */
@keyframes fadeScale {
    from {
        opacity: 0;
        transform: translateY(10px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}
@keyframes achievementSlideIn {
    from {
        transform: translateX(100%);
        opacity: 0;
    }
    to {
        transform: translateX(0);
        opacity: 1;
    }
}
#show-achievements {
    display: block;
    position: relative;
    width: 100%;
    margin: 0.5rem auto;
    padding: 0.2rem;
    background: var(--background-gray);
    border-radius:var(--radius-max);
    cursor: pointer;
    transition: transform 0.2s ease, background-color 0.2s ease;
    will-change: transform;
}
#show-achievements:hover {
    color:var(--fontcolor-highlight);
    transform: scale(1.1) translateY(-3px);
    box-shadow: 0px 4px 10px var(--background-gray);
}
.achievements-content {
    padding: 0em;
    width: 100%;
  overflow: auto;
    height: calc(70vh - 1rem);
    max-height: calc(70vh - 1rem);
    border-radius:var(--radius-subtle);
    position: relative;
}
.achievements-filters {
    display: flex;
    gap: 1em;
    margin-bottom: 1em;
    padding: 0.5em;
}
.achievements-filters select {
    flex: 1;
    padding: 0.75rem 2rem 0.75rem 0.75rem;
    background: var(--background-gray);
    color: var(--fontcolor-dark);
    border-radius:var(--radius-subtle);
    font-size: 0.9rem;
    cursor: pointer;
    appearance: none;
    background-repeat: no-repeat;
    background-position: right 0.75rem center;
    background-size: 1rem;
    transition: background-color 0.2s ease;
}
.achievements-filters select:hover {
    color: var(--fontcolor-gold);
    background-color: var(--background-dark);
}
.achievement-item {
    position: relative;
    display: flex;
    align-items: center;
   gap: 0.875em;
    padding: 0.5em;
    margin: 0.4em;
  background-color: #f1f0ea;
    border: 1px solid var(--background-goldengray);
    border-radius:var(--radius-subtle);
    transition: transform 0.2s ease;
    will-change: transform, opacity;
    opacity: 0;
    transform: translateY(10px);
}
.achievement-item:hover {
    transform: translateY(-5px);
}
.achievement-item.show {
    opacity: 1;
}
.achievement-item.unlocked-current {
    background: rgba(255, 255, 255, 0.3);
}
.achievement-item.unlocked-other {
    opacity: 0.9;
}
.achievement-item.locked {
    opacity: 0.5;
}
.achievement-icon {
    flex-shrink: 0;
    width: 2.5rem;
    height: 2.5rem;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 1.25rem;
    color: var(--fontcolor-deep1);
    background: #ffffff;
    border-radius:var(--radius-subtle);
}
.achievement-icon-image {
    width: 100%;
    height: 100%;
    object-fit: contain;
    border-radius: var(--radius-subtle);
}
.achievement-title {
    color: #9e8341;
    font-weight: 800;
    margin-bottom: 0.5rem;
}
.achievement-description {
    color: #DA9F18;
    font-size: 0.8rem;
    line-height: 1.4;
}
.achievement {
    display: flex;
    align-items: center;
    gap: 0.875rem;
    position: fixed;
    top: 1.5rem;
    right: 1rem;
    width: 300px;
    background: var(--background-goldengray);
    color: var(--fontcolor-lavender);
    padding: 0.5em;
    border-radius:var(--radius-subtle);
    border: 1px solid var(--fontcolor-gray);
    backdrop-filter: blur(var(--blur-moderate));
    -webkit-backdrop-filter: blur(var(--blur-moderate));
    z-index: 999;
    transform: translateX(100%);
    opacity: 0;
    will-change: transform, opacity;
}
.achievement.show {
    animation: achievementSlideIn 0.3s ease forwards;
}</style><script role="script" id="twine-user-script" type="text/twine-javascript">importStyles("https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css");

Config.history.controls = true;/* 开启回退 */
Config.history.maxStates = 6;/* 回退步数 */
Config.saves.slots = 2;/* 存档数 */

/* 侧边栏显示 */
$(document).on(':passageend', (ev) => {
  if (ev.passage.tags.includes('UIBarhide')) {
    UIBar.hide();
     $rightUiBar.hide();
  }else{
    UIBar.show();
     $rightUiBar.show();
  }
});

/* 更新数据, By BlackStar, Vers.0.0.1-beta.2 */
(()=>{const mergeObjs=(target,source,options={})=>{const{mergePaths:mergePaths=[],excludePaths:excludePaths=[]}=options;function isObject(obj){return obj&&typeof obj==="object"&&!Array.isArray(obj)}function buildPath(base,cur,append=false){if(base===""){return cur}else if(append){return`${base}.${cur}`}else{return isNaN(cur)?`${base}.${cur}`:`${base}[${cur}]`}}function mergeArrays(targetArr,sourceArr,path){if(targetArr.length===0)return sourceArr;if(isObject(targetArr[0])&&"id"in targetArr[0]){const mergedArray=[...targetArr];sourceArr.forEach((sourceItem=>{const existingItem=mergedArray.find((item=>item.id===sourceItem.id));if(existingItem){deepMerge(existingItem,sourceItem,path)}else{mergedArray.push(sourceItem)}}));return mergedArray}else{return Array.from(new Set([...targetArr,...sourceArr]))}}function deepMerge(target,source,path=""){if(!isObject(target)||!isObject(source)){return target}Object.keys(source).forEach((key=>{const currentPath=buildPath(path,key);if(excludePaths.includes(currentPath)){return}if(mergePaths.includes(currentPath)){if(Array.isArray(source[key])&&Array.isArray(target[key])){target[key]=mergeArrays(target[key],source[key],currentPath)}else if(isObject(source[key])){if(!target[key])target[key]={};deepMerge(target[key],source[key],currentPath)}else{target[key]=source[key]}}else{if(!target.hasOwnProperty(key)){target[key]=source[key]}}}))}deepMerge(target,source);return target};Macro.add("reload",{handler(){const oldData=State.variables;for(const key in State.variables){if(State.variables.hasOwnProperty(key)){delete State.variables[key]}}$.wikiPassage("StoryInit");const newData=State.variables;Object.entries(mergeObjs(oldData,newData,setup.reload_rules||[])).forEach((([key,val])=>{State.variables[key]=val}));setTimeout((()=>Engine.play(passage())),Engine.DOM_DELAY)}});setup.mergeObjs=mergeObjs;window.mergeObjs=window.mergeObjs||mergeObjs})();
Save.onLoad.add(function (save) {
  	save.state.history.forEach(moment => {
      const oldData = moment.variables;
      $.wikiPassage('StoryInit');
      const newData = State.variables;
      Object.entries(mergeObjs(oldData, newData, setup.reload_rules || [])).forEach(([key, val]) => {
        moment.variables[key] = val;
      });
    });
});
/* End Update SaveData */

//设置菜单
/* Settings code - Start */
Setting.addList("textDelay", {
	label	: "延迟对话出现速度",
	list	: ["无延迟", "1s", "2s", "3s"],
	default	: "无延迟"
});
/* Settings code - End */


//日夜模式切换
setup.settingTheme = function () {
	if (settings.Theme) {
		// Delay is required during initialization.
		setTimeout(function () { $("html").addClass("bleached"); }, 20);
	}	else {
		$("html").removeClass("bleached");setTimeout(function () { $("html").addClass("night"); }, 20);
	}
};
Setting.addToggle("Theme", {
	label  : "日间模式:",
	default: true,
	onInit   : setup.settingTheme,
	onChange : setup.settingTheme
});

/*   弹窗切换   */
window.changemap = function(page, ID) {
    let content = "";
    let pages = {};

    switch (ID) {
        case "stories":
            pages = {
                page1: "未完成",
                page2: "已完成",
            };
            break;
        case "items":
            pages = {
                page1: "物品",
                page2: "食物",
                page3: "书籍",
                page4: "猎物",
                page5: "渔获",
            };
            break;
           case "logs":
            pages = {
                page1: "日志",
                page2: "社交",
                page3: "成就",
                page4: "线索",
            };
            break;
        default:
            content = `
                <div class="popup-content">
                    <p>未知页面。</p>
                </div>
            `;
    }

    if (pages[page]) {
        content = Story.get(pages[page]).processText(); 
    } else {
        console.error("未知页面！");
        return;
    }

    if (ID === "stories") {
        Dialog.setup(`
            <div class="title-buttons">
                <button onclick="changemap('page1', 'stories')" class="popup-button">未完成</button>
                <button onclick="changemap('page2', 'stories')" class="popup-button">已完成</button>
            </div>
        `);
    } else if (ID === "items") {
        Dialog.setup(`
            <div class="title-buttons">
                <button onclick="changemap('page1', 'items')" class="popup-button">物品</button>
                <button onclick="changemap('page2', 'items')" class="popup-button">食物</button>
                 <button onclick="changemap('page3', 'items')" class="popup-button">书籍</button>
                <button onclick="changemap('page4', 'items')" class="popup-button">猎物</button>
                 <button onclick="changemap('page5', 'items')" class="popup-button">渔获</button>
            </div>
        `);
    } else if (ID === "logs") {
        Dialog.setup(`
            <div class="title-buttons">
                <button onclick="changemap('page1', 'logs')" class="popup-button">日志</button>
                <button onclick="changemap('page2', 'logs')" class="popup-button">社交</button>
                 <button onclick="changemap('page3', 'logs')" class="popup-button">成就</button>
                <button onclick="changemap('page4', 'logs')" class="popup-button">线索</button>
            </div>
        `);
    }

    Dialog.wiki(content);
    Dialog.open();

    document
      .querySelector(`.popup-button[onclick*="${page}"][onclick*="${ID}"]`)
      .classList.add('active');
};
/*弹窗切换END*/


/* 右侧边栏 */
var $rightUiBar = $('<div id="right-ui-bar"></div>').insertAfter("#ui-bar");

var rightTray = $rightUiBar.append('<div id="right-ui-bar-tray"><button id="right-ui-bar-toggle" tabindex="0" title="Toggle the Right UI bar" aria-label="Toggle the Right UI bar" type="button"></button></div>');

var rightBody = $rightUiBar.append('<div id="right-ui-bar-body"></div>');

/* Attach the toggle button click. */
$rightUiBar.find('#right-ui-bar-toggle').ariaClick({label : "Toggle the Right UI bar"}, () => $rightUiBar.toggleClass('stowed'));

/* Automatically show the contents of the StoryRightSidebar passage in the right-ui-bar-body element. */
postrender["Display Right Sidebar Contents"] = function (content, taskName) {
	setPageElement('right-ui-bar-body', 'StoryRightSidebar');
};

$(document).ready(function() {
            var media = window.matchMedia('(max-width: 768px)');
            
              function clickStowed(event) {
                if ($(event.target).closest('#ui-bar, #right-ui-bar').length > 0) {
                  return;
                }
                const isLeftStowed = UIBar.isStowed();
                  const isRightStowed = $rightUiBar.hasClass('stowed')
                  
                if(!isLeftStowed || !isRightStowed) {
                    UIBar.stow();
                    $rightUiBar.addClass('stowed');
                }
            }
  
              function handleMedia(event) {
                  console.log(event.matches);
                if (event.matches) {
                    UIBar.stow();
                    $rightUiBar.addClass('stowed');
                      $('body').on('click', clickStowed);
                } else {
                    UIBar.unstow();
                    $rightUiBar.removeClass('stowed');
                      $('body').off('click', clickStowed);
                }
            }

            media.addEventListener('change', handleMedia);
            handleMedia(media);
            
            $(window).on('resize', function() {
                 handleMedia(media);
            });
});
/*右侧边栏END*/

/*简易库存, for SugarCube 2, by Chapel v3.0.1, 2024-07-22*/
;"use strict";function _typeof(t){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof(t)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,_toPropertyKey(i.key),i)}}function _createClass(t,e,n){return e&&_defineProperties(t.prototype,e),n&&_defineProperties(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function _toPropertyKey(t){var e=_toPrimitive(t,"string");return"symbol"==_typeof(e)?e:String(e)}function _toPrimitive(t,e){if("object"!=_typeof(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!=_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}!function(){var t={description:"",handler:null,displayName:"",consumable:!0,unique:!1,permanent:!1},e=new Map,n=function(){function n(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:clone(t),r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];if(_classCallCheck(this,n),!e||"string"!=typeof e)throw new Error("invalid item ID");if("object"!==_typeof(i))throw new Error("invalid item definition");Object.assign(this,Object.assign({},t,i)),this.id=e,this._tags=r instanceof Array?r:"string"==typeof r?[r]:[]}return _createClass(n,[{key:"tags",get:function(){return this._tags}},{key:"hasTag",value:function(t){return this._tags.includes(t)}},{key:"hasAllTags",value:function(){return this._tags.includesAll([].slice.call(arguments).flat(1/0))}},{key:"hasAnyTags",value:function(){return this._tags.includesAny([].slice.call(arguments).flat(1/0))}},{key:"name",get:function(){return this.displayName||this.id},set:function(t){this.displayName=t}},{key:"use",value:function(){return"string"==typeof this.handler?$.wiki(this.handler):"function"==typeof this.handler&&this.handler(this),this}},{key:"inspect",value:function(){return Dialog.setup(this.name,"simple-inventory item-description"),Dialog.wiki(this.description),Dialog.open(),this}}],[{key:"is",value:function(t){return t instanceof n}},{key:"add",value:function(t,i,r){var a=new n(t,i,r);return e.set(t,a),a}},{key:"get",value:function(t){return e.get(t)}},{key:"has",value:function(t){return e.has(t)}},{key:"list",get:function(){return e}}]),n}();setup.Item=n,window.Item=window.Item||n}(),function(){var t=setup.Item,e=!1,n="&hellip;",i={inspect:"Inspect",use:"使用",drop:"丢弃",stack:"全部",take:"Take",give:"Give",stackPre:"&nbsp;&times;&nbsp;",stackPost:"&nbsp;"},r={};function a(e){return t.has(e)&&t.get(e).unique}var s=function(){function s(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];_classCallCheck(this,s),this.data=clone(t),this._tags=e instanceof Array?e:"string"==typeof e?[e]:[]}return _createClass(s,[{key:"emit",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return s.emit(t,this,e),this}},{key:"array",get:function(){var t=this,e=[];return Object.keys(this.data).forEach((function(n){if(e.push(n),t.data[n]>1)for(var i=1;i<t.data[n];i++)e.push(n)})),e}},{key:"list",get:function(){return Object.keys(this.data)}},{key:"length",get:function(){return this.array.length}},{key:"uniqueLength",get:function(){return this.list.length}},{key:"table",get:function(){return this.data}},{key:"tags",get:function(){return this._tags}},{key:"hasTag",value:function(t){return this._tags.includes(t)}},{key:"hasAllTags",value:function(){return this._tags.includesAll([].slice.call(arguments).flat(1/0))}},{key:"hasAnyTags",value:function(){return this._tags.includesAny([].slice.call(arguments).flat(1/0))}},{key:"count",value:function(t){return t?this.data[t]||0:this.length}},{key:"has",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return this.data[t]>=e}},{key:"hasAll",value:function(){var t=this;return[].slice.call(arguments).flat(1/0).every((function(e){return t.has(e)}))}},{key:"hasAny",value:function(){var t=this;return[].slice.call(arguments).flat(1/0).some((function(e){return t.has(e)}))}},{key:"compare",value:function(t){var e=this,n=s.itemset(t);return Object.keys(n).every((function(t){return e.has(t,n[t])}))}},{key:"merge",value:function(t){var e=this,n=s.itemset(t);return Object.keys(n).forEach((function(t){s.change(e,t,n[t])})),n}},{key:"unmerge",value:function(t){var e=this,n={},i=s.itemset(t);return Object.keys(i).forEach((function(t){e.has(t,i[t])?n[t]=i[t]:e.has(t)&&(n[t]=e.count(t)),s.change(e,t,i[t],!0)})),n}},{key:"pickup",value:function(){var t=this.merge(s.parseArgList.apply(null,arguments));return this.emit("update",{delta:t}),this}},{key:"drop",value:function(){var t=this.unmerge(s.parseArgList.apply(null,arguments));return this.emit("update",{delta:t}),this}},{key:"empty",value:function(){var t=clone(this.data);return this.data={},this.emit("update",{delta:t}),this}},{key:"transfer",value:function(t){var e=s.parseArgList.apply(null,[].slice.call(arguments).slice(1));if(!s.is(t))throw new TypeError("target inventory is not an inventory instance");var n=this.unmerge(e);return t.merge(n),this.emit("update",{target:t,delta:n}),this}},{key:"isEmpty",value:function(){return 0===this.length}},{key:"iterate",value:function(t){var e=this;return"function"!=typeof t||this.list.forEach((function(n){t(n,e.data[n])})),this}},{key:"use",value:function(e){if(t.has(e)){var n=t.get(e);if(n.use(),n.consumable){s.change(this,e,1,!0);var i={};i[e]=1,this.emit("update",{delta:i})}return this.emit("use",{item:n}),this}}},{key:"clone",value:function(){return new s(this.data||{},this._tags||[])}},{key:"toJSON",value:function(){return JSON.reviveWrapper("new setup.Inventory("+JSON.stringify(this.data)+", "+JSON.stringify(this._tags)+")")}}],[{key:"confirm",get:function(){return e},set:function(t){e="string"==typeof t&&"all"===t.trim().toLowerCase()?"all":"string"==typeof t&&"stack"===t.trim().toLowerCase()?"stack":!!t}},{key:"emptyMessage",get:function(){return n},set:function(t){"string"==typeof t&&(n=t)}},{key:"strings",get:function(){return Object.assign(clone(i),r)},set:function(t){"object"===_typeof(t)&&(r=Object.assign(r,clone(t)))}},{key:"change",value:function(e,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(0!==i){if(e instanceof s&&(e=e.data),"object"!==_typeof(e)){if(e)throw new TypeError("cannot access inventory data");e={}}if(!(o=n)||"string"!=typeof o||!o.trim())throw new TypeError("invalid item name/id");var o;if("number"==typeof i&&!Number.isNaN(i)&&Number.isInteger(i)||(i=1),r&&(i*=-1),i>0){if(Object.keys(e).includes(n)&&a(n))return;i>1&&a(n)&&(i=1),Object.keys(e).includes(n)||(e[n]=0),e[n]+=i}else{if(function(e){return t.has(e)&&t.get(e).permanent}(n))return;Object.keys(e).includes(n)&&"number"==typeof e[n]&&(e[n]+=i),e[n]<=0&&delete e[n]}return e}}},{key:"itemset",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(s.is(t)&&(t=t.data),"object"!==_typeof(t))return{};var e={};return Object.keys(t).forEach((function(n){"number"==typeof t[n]&&Number.isInteger(t[n])&&0!==t[n]&&(e[n]=t[n])})),e}},{key:"parseArgList",value:function(){var t=[].slice.call(arguments).flat(1/0);if(t.length%2!=0)throw new Error("item sets should be pairs of item IDs and numbers");var e={};return t.forEach((function(n,i){i%2==0&&(e[n]=t[i+1])})),e}},{key:"is",value:function(t){return t instanceof s}},{key:"emit",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};$(document).trigger(Object.assign({type:":inventory-"+t+".simple-inventory",inventory:e,target:null,delta:{},item:null},n))}},{key:"create",value:function(t,e){return new s(t,e)}}]),s}();setup.Inventory=s,window.Inventory=window.Inventory||s}(),function(){var t=setup.Item,e=setup.Inventory;function n(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"Alert",a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"Are you sure?";if(!t||"function"!=typeof t)throw new Error("Invalid confirmation callback!");if(e.confirm)if("all"!==e.confirm||"all"===i)if("stack"!==e.confirm||i){var s={display:"inline-block",float:"right"},o=$(document.createElement("div")),u=$(document.createElement("p")).append(a),l=$(document.createElement("div")).addClass("confirmation-buttons"),c=$(document.createElement("button")).append("Okay").addClass("confirm-yes").css(Object.assign(s,{"margin-right":"0.5rem"})),d=$(document.createElement("button")).append("Cancel").addClass("confirm-no").css(s);t&&"function"==typeof t&&c.ariaClick(t),n&&"function"==typeof n&&d.ariaClick(n),l.append(d,c),o.append(u,l),Dialog.setup(r,"simple-inventory confirmation"),Dialog.append(o),Dialog.open()}else t();else t();else t()}function i(t){var e=$(document.createElement("span")).addClass("spacer");return t&&e.wiki(""+t),e}function r(t,i){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return"give"===String(i).toLowerCase().trim()?i=e.strings.give:"take"===String(i).toLowerCase().trim()?i=e.strings.take:i&&"drop"!==String(i).toLowerCase().trim()||(i=e.strings.drop),$(document.createElement(r?"button":"a")).addClass("all-link drop-link").wiki(i+" all").ariaClick((function(){t.isEmpty()||n((function(){a&&e.is(a)?(a.merge(t),t.empty()):t.empty(),Dialog.close()}),(function(){Dialog.close()}),!0)}))}function a(a){var s,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{description:!0,use:!0,transfer:null,drop:!0,all:!0,stack:!0,dropActionText:"",classes:""},u=$(document.createElement("ul")).addClass("simple-inventory-list");if(a.length){if(s=a.list.map((function(r){var s=[],u=r;t.has(r)&&(u=t.get(r).name),o.description&&t.has(r)&&t.get(r).description?s.push(function(n,i,r){var a=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return r=r||e.strings.inspect,$(document.createElement(a?"button":"a")).addClass("inspect-link").wiki(""+r).ariaClick((function(){t.get(i).inspect()}))}(a,r,u)):s.push($(document.createElement("span")).append(t.has(r)?t.get(r).name:r).addClass("item-name")),s.push(function(t,n,i,r){var a=$(document.createElement("span")),s=t.count(n);return i=i||e.strings.stackPre,r=r||e.strings.stackPost,1==s?a.addClass("item-count single"):a.addClass("item-count multi"),a.append(""+i+(s||0)+r)}(a,r)),o.use&&t.has(r)&&t.get(r).handler?s.push(function(t,n,i){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return i=i||e.strings.use,$(document.createElement(r?"button":"a")).addClass("use-link").wiki(""+i).ariaClick((function(){t.use(n)}))}(a,r)):s.push(i()),(o.transfer&&e.is(o.transfer)||o.drop)&&!function(e){return t.has(e)&&t.get(e).permanent}(r)?(s.push(function(t,i,r){var a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;return"give"===String(r).toLowerCase().trim()?r=e.strings.give:"take"===String(r).toLowerCase().trim()?r=e.strings.take:r&&"drop"!==String(r).toLowerCase().trim()||(r=e.strings.drop),$(document.createElement(a?"button":"a")).addClass("drop-link").wiki(""+r).ariaClick((function(){n((function(){s&&e.is(s)?t.transfer(s,i,1):t.drop(i,1),Dialog.close()}),(function(){Dialog.close()}))}))}(a,r,o.dropActionText,!1,o.transfer||null)),a.count(r)>1&&o.stack?s.push(function(t,i,r){var a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;return"give"===String(r).toLowerCase().trim()?r=e.strings.give:"take"===String(r).toLowerCase().trim()?r=e.strings.take:r&&"drop"!==String(r).toLowerCase().trim()||(r=e.strings.drop),r=r+"&nbsp;"+e.strings.stack,$(document.createElement(a?"button":"a")).addClass("stack-link drop-link").wiki(""+r).ariaClick((function(){n((function(){s&&e.is(s)?t.transfer(s,i,t.count(i)):t.drop(i,t.count(i)),Dialog.close()}),(function(){Dialog.close()}))}))}(a,r,o.dropActionText,!1,o.transfer||null)):s.push(i())):s.push(i());var l=r.normalize().toLowerCase().replace(/\s+/g,"-");return $(document.createElement("li")).append(s).addClass("simple-inventory-listing").attr({"data-item-id":l,"data-keyword":u})})),o.all){var l=$(document.createElement("li")).addClass("all-listing simple-inventory-listing").append([i("&mdash;"),i(),i(),r(a,o.dropActionText,!1,o.transfer||null)]);s.push(l)}}else s=$(document.createElement("li")).addClass("simple-inventory-listing").append($(document.createElement("span")).wiki(e.emptyMessage));return u.append(s),u}e.prototype.interface=function(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=this,r=$(document.createElement("div")).addClass("simple-inventory-wrapper");return e.filter&&r.append(function(){var t=$(document.createElement("div")).addClass("simple-inventory-filter"),e=$(document.createElement("input")).attr({type:"text",placeholder:"搜索"}).on("input",(function(){var n=e.val().trim().toLowerCase(),i=t.parent().find("ul.simple-inventory-list li.simple-inventory-listing:not(.all-listing)");n?i.each((function(t,e){var i=$(e);i&&i.length&&(i.attr("data-keyword").substring(0,n.length).trim().toLowerCase()!==n?i.hide():i.show())})):i.show()}));return t.append(e),t}()),r.append(a(this,e)),$(document).on(":inventory-update.simple-inventory.gui-built-in",(function(){r.length?r.empty().append(a(i,e)):$(document).off(":inventory-update.simple-inventory.gui-built-in")})),n&&n instanceof $?t=n:n&&(t=$(n)),t&&r.appendTo(t),r}}(),function(){setup.Inventory,setup.Item;var t=".simple-inventory-userland",e=":inventory-update.simple-inventory"+t,n=":inventory-use.simple-inventory"+t;function i(t){return t&&"function"==typeof t}Object.assign(setup.Inventory,{events:{update:{on:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";i(t)&&$(document).on(e+n,t)},one:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";i(t)&&$(document).one(e+n,t)},off:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";$(document).off(e+t)}},use:{on:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";i(t)&&$(document).on(n+e,t)},one:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";i(t)&&$(document).one(n+e,t)},off:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";$(document).off(n+t)}}}})}(),function(){var t=":";function e(e){var n=function(t){return t.replace(/\r+/g,"\n").replace(/\n+/,"\n").replace(/ +/g," ").trim().split(/\n/g)}(e),i={};return n.forEach((function(e){if(e&&e.trim()&&e.includes(t)){var n=e.trim().split(t);i[n[0].trim()]=n[1].trim()}})),i}var n=function(t){try{return Story.has(t)?e(Story.get(t).text):{}}catch(t){return console.error(t.message,t),{}}}("inventory.strings");n.empty&&"string"==typeof n.empty&&n.empty.trim()&&(setup.Inventory.emptyMessage=n.empty,delete n.empty),setup.Inventory.strings=n||{}}(),function(){var t=setup.Item,e=setup.Inventory;function n(t){return t&&"string"==typeof t&&t.length>=2&&("$"===t[0]||"_"===t[0])}function i(t){if(n(t)&&(t=State.getVar(t)),e.is(t))return t}Macro.add(["item","consumable"],{tags:["description","tags","unique","permanent"],handler:function(){var e,n,i,r,a=null,s=!1,o=!1,u=!1;if(State.length>0)return this.error("items must be defined in `StoryInit` or story JavaScript!");if(!this.args[0]||"string"!=typeof this.args[0]||!this.args[0].trim())return this.error("invalid item ID");if(e=this.args[0].trim(),"consumable"===this.name&&(a=this.payload[0].contents||null,s=!0),this.args[1]&&(n=this.args[1]),this.payload.length>1){var l=this.payload.find((function(t){return"description"===t.name})),c=this.payload.find((function(t){return"tags"===t.name})),d=this.payload.find((function(t){return"unique"===t.name})),f=this.payload.find((function(t){return"permanent"===t.name}));l&&(i=l.contents.trim()),c&&(r=c.args.flat(1/0)),d&&(o=!0),f&&(u=!0)}t.add(e,{displayName:n||"",description:i||"",handler:a,consumable:s,unique:o,permanent:u},r)}}),Macro.add("newinv",{handler:function(){var t=this.args.raw.trim().split(" ").first().replace(/["']/g,"").trim();if(!n(t))return this.error("argument must be a story or temporary variable!");State.setVar(t,new e({},this.args.flat(1/0).slice(1)))}}),Macro.add(["pickup","drop"],{handler:function(){var t=i(this.args[0]);return t?this.args.length<3?this.error("no items to pick up were provided"):void t[this.name](this.args.slice(1)):this.error("first argument must be a valid inventory!")}}),Macro.add("dropall",{handler:function(){var t=i(this.args[0]);if(!t)return this.error("first argument must be a valid inventory!");t.empty()}}),Macro.add(["transfer","merge","unmerge"],{handler:function(){var t=i(this.args[0]);if(!t)return this.error("first argument must be a valid inventory!");var e=i(this.args[1]);if(!e)return this.error("second argument must be a valid inventory!");if("transfer"===this.name){if(this.args.length<4)return this.error("no items to transfer were provided");t.transfer(e,this.args.slice(2))}else t[this.name](e)}}),Macro.add(["inv","take","give"],{handler:function(){var t=null,n=i(this.args[0]);if(!n)return this.error("first argument must be a valid inventory!");this.args[1]&&i(this.args[1])&&(t=i(this.args[1]));var r={description:this.args.includesAny("inspect","description"),use:this.args.includes("use"),transfer:t,drop:this.args.includes("drop"),all:this.args.includes("all"),stack:this.args.includes("stack"),filter:this.args.includes("filter"),dropActionText:"inv"===this.name?"丢弃":e.strings[this.name.trim().toLowerCase()],classes:"macro-".concat(this.name)};n.interface(r,$(this.output))}})}(),function(){var t=setup.Item,e=setup.Inventory;function n(t,e,n){if("object"!==_typeof(e))throw new TypeError("the extension should be a plain generic object holding the properties and methods you want to add");Object.keys(e).forEach((function(i){if(t[i]&&!n)throw new Error('Cannot override existing property "'+i+'"!');t[i]=e[i]}))}Object.assign(e,{extend:function(t){n(e,t,arguments.length>1&&void 0!==arguments[1]&&arguments[1])},extendPrototype:function(t){var i=arguments.length>1&&void 0!==arguments[1]&&arguments[1];n(e.prototype,t,i)}}),Object.assign(t,{extend:function(e){n(t,e,arguments.length>1&&void 0!==arguments[1]&&arguments[1])},extendPrototype:function(e){var i=arguments.length>1&&void 0!==arguments[1]&&arguments[1];n(t.prototype,e,i)}})}();
// End Simple Inventory

/* twine-user-script #2: "Story JavaScript" */
Config.ui.stowBarInitially = false;

// <<dialog>> macro
Macro.add('dialog', {
       tags : ['onopen', 'onclose'],
    handler : function () {
        
        // handle args (if any)
        var errors = [];
        var content = '', onOpen = null, onClose = null;
        var title = (this.args.length > 0) ? this.args[0] : '';
        var classes = (this.args.length > 1) ? this.args.slice(1).flat(Infinity) : [];

        this.payload.forEach( function (pl, idx) {
            if (idx === 0) {
                content = pl.contents;
            } else {
                if (pl.name === 'onopen') {
                    onOpen = onOpen ? onOpen + pl.contents : pl.contents;
                } else {
                    onClose = onClose ? onClose + pl.contents : pl.contents;
                }
            }
        });
        
        // add the macro- class
        classes.push('macro-' + this.name);
        
        // dialog box
        Dialog.setup(title, classes.join(' '));
        Dialog.wiki(content);

        // should these be shadowWrapper-aware?
        if (onOpen && typeof onOpen === 'string' && onOpen.trim()) {
            $(document).one(':dialogopened', function () {
                $.wiki(onOpen);
            });
        }
        if (onClose && typeof onClose === 'string' && onClose.trim()) {
            $(document).one(':dialogclosed', function () {
                $.wiki(onClose);
            });
        }
        Dialog.open();
    }

});

/* Macro Utils, By BlackStar, Partially adapted from ChapelR, Ver.0.2.0 */
(()=>{const isValidVariable=varName=>varName&&typeof varName==="string"&&varName.length>=2&&(varName[0]==="$"||varName[0]==="_");const repeat=(times,action)=>{for(let i=0;i<times;i++){action(i)}};const WikiVars=(pairs,entity)=>{const shadowStore={};for(const[varName,value]of Object.entries(pairs)){if(Object.hasOwn(State.temporary,varName)){shadowStore[`_${varName}`]=State.temporary[varName]}State.temporary[varName]=value;entity.addShadow(`_${varName}`);if(Object.hasOwn(State.variables,varName)){shadowStore[`$${varName}`]=State.variables[varName]}State.variables[varName]=State.temporary[varName];entity.addShadow(`$${varName}`)}try{new Wikifier(entity.output,entity?.payload?.[0]?.contents||"")}finally{for(const[varName]of Object.entries(pairs)){if(Object.hasOwn(shadowStore,`_${varName}`)){State.temporary[varName]=shadowStore[`_${varName}`]}else{delete State.temporary[varName]}if(Object.hasOwn(shadowStore,`$${varName}`)){State.variables[varName]=shadowStore[`$${varName}`]}else{delete State.variables[varName]}}}};const applyBounds=(value,min,max)=>Math.max(min,Math.min(max,value));setup.applyBounds=applyBounds;window.applyBounds=window.applyBounds||applyBounds;setup.repeat=repeat;window.repeat=window.repeat||repeat;setup.isValidVariable=isValidVariable;window.isValidVariable=window.isValidVariable||isValidVariable;setup.WikiVars=WikiVars;window.WikiVars=window.WikiVars||WikiVars})();
/* End Macro Utils */

/* Recipes, By BlackStar, Based on simple-inventory, Ver.0.2.0.alpha.15 */
// 测试版，请勿更新
(()=>{"use strict";const Conditions=Object.freeze({INCLUDES:"includes",EQUALS:"equals"});State.variables.recipe_save_data=State.variables.recipe_save_data||new Map;const save_data=()=>State.variables.recipe_save_data;const defaultOpts={servings:1,successRate:100,priority:100,condition:Conditions.INCLUDES};const defaultSaveData={unlock:false};setup.Conditions=Conditions;window.Conditions=window.Conditions||Conditions;class Recipe{constructor(id,methods=[],opts=clone(defaultOpts),tags=[]){this.id=id;if(typeof methods!=="object"||typeof opts!=="object"){throw new Error("Invalid recipe definition")}this.methods=methods;Object.assign(this,Object.assign({},defaultOpts,opts));if(!save_data().has(id)){save_data().set(id,clone(defaultSaveData))}this._tags=tags instanceof Array?tags:typeof tags==="string"?[tags]:[]}get unlock(){return save_data().get(this.id).unlock}set unlock(value){save_data().get(this.id).unlock=value}get name(){return this.displayName||this.id}set name(val){this.displayName=val}get tags(){return this._tags}hasTag(tag){return this._tags.includes(tag)}hasAllTags(tags){return this._tags.includesAll(tags)}hasAnyTags(tags){return this._tags.includesAny(tags)}validate(ingredients){switch(this.condition){case Conditions.EQUALS:return this.equals(ingredients);case Conditions.INCLUDES:return this.includes(ingredients);default:throw new TypeError(`Invalid condition type: ${this.condition}`)}}calculate(input,index){if(this.methods.length<=index){throw new Error(`Unable to access recipe at index ${index}, total number of available crafting methods is ${this.ingredients.length}`)}return Object.entries(this.methods[index]).reduce(((min,[ingredient,require])=>{const available=input[ingredient];return Math.min(min,Math.floor(available/require))}),Infinity)}multiply(servings,index){if(index!==undefined&&this.methods.length<=index){throw new Error(`Unable to access recipe at index ${index}, total number of available crafting methods is ${this.ingredients.length}`)}if(typeof servings!=="number"||servings<=0){throw new Error("Invalid number of servings")}const required=[];const processList=index!==undefined?[this.methods[index]]:this.methods;for(const method of processList){const obj={};for(const[ingredient,number]of Object.entries(method)){obj[ingredient]=number*servings}required.push(obj)}return required}includes(ingredients){for(const method of this.methods){if(Object.keys(ingredients).length<Object.keys(method).length){return undefined}}for(const[index,method]of this.methods.entries()){let match=true;for(const ingredient in method){if(!ingredients[ingredient]||ingredients[ingredient]<method[ingredient]){match=false;break}}if(match){return index}}return undefined}cook(){if(this.successRate===100){return true}const number=randomInt(1,100);if(this.successRate>=number){return true}return false}equals(ingredients){for(const method of this.methods){if(Object.keys(ingredients).length<Object.keys(method).length){return undefined}}for(const[index,method]of this.methods.entries()){let match=true;for(const ingredient in method){if(!ingredients[ingredient]||ingredients[ingredient]!==this.ingredients[ingredient]){match=false;break}}if(match){return index}}return undefined}}setup.Recipe=Recipe;window.Recipe=window.Recipe||Recipe})();(()=>{"use strict";const convertToArray=input=>{const array=[];for(const[key,value]of Object.entries(input)){array.push(key,value)}return array};class RecipeBook{static success="制作成功";static failure="制作失败";static not_found="配方不存在";static not_unlocked="配方未解锁";static missing_materials="缺少材料";static unlocked_success="配方成功解锁";static default_no_recipe="空配方";static crafting_table="crafting_table";constructor(ct,recipes=new Map,invs=[]){if(!(recipes instanceof Map)){throw new Error('Expected "recipes" to be an instance of Map')}if(!Array.isArray(invs)){throw new Error('Expected "invs" to be an array')}this.invs=invs;this.ct=ct;State.variables[this.ct]=State.variables[this.ct]||new Inventory;this.recipes=recipes;this._recipes=RecipeBook.sort(recipes)}has(id){return this.recipes.has(id)}hasItems(input){const obj=State.variables[this.ct];for(const[key,required]of Object.entries(input)){const actualCount=obj.count(key);if(actualCount<required){return false}}return true}drop(input){const obj=State.variables[this.ct];obj.drop(...convertToArray(input))}update(){this._recipes=RecipeBook.sort(this.recipes)}hasAllTags(){const tags=[].slice.call(arguments).flat(Infinity);const result=[];for(const recipe of this._recipes){if(recipe.hasAllTags(tags)){result.push(recipe)}}return result}searchIndex(priority){let low=0;let high=this._recipes.length-1;while(low<=high){const mid=Math.floor((low+high)/2);if(this._recipes[mid].priority===priority){return mid}else if(this._recipes[mid].priority<priority){low=mid+1}else{high=mid-1}}return low}insert(id,methods,opts,tags){if(!Array.isArray(methods)){methods=[methods]}const recipe=this.set(id,methods,opts,tags);const index=this.searchIndex(recipe.priority);this._recipes.splice(index,0,recipe)}set(id,methods,opts,tags){if(!Array.isArray(methods)){methods=[methods]}const recipe=new Recipe(id,methods,opts,tags);this.recipes.set(id,recipe);return recipe}calculate(input){let[idx,recipe]=this.match(input);if(idx===undefined||recipe===undefined){return[RecipeBook.default_no_recipe,0]}return[recipe.name,recipe.calculate(input,idx)*recipe.servings]}cook(input,servings=1){let[idx,recipe]=this.match(input);let result={id:"",success:false,unlock:false,exist:false,servings:0,message:RecipeBook.not_found};if(recipe==undefined&&idx==undefined){}else if(!recipe.unlock&&typeof input==="string"){result.id=recipe.name;result.success=false;result.unlock=false;result.message=RecipeBook.not_unlocked}else if(typeof input==="string"&&idx===undefined){debugger;result.id=recipe.name;result.servings=0;result.success=false;result.message=RecipeBook.missing_materials;const required=recipe.multiply(servings);for(const ele of required){if(this.hasItems(ele)){this.drop(ele);result.success=true;result.servings=servings;result.message=RecipeBook.success;break}}}else if(idx!==undefined,recipe!==undefined){result.id=recipe.id;result.success=recipe.cook();input.length=0;if(result.success){result.servings=recipe.calculate(input,idx);if(!recipe.unlock){result.message=RecipeBook.unlocked_success}else{result.message=RecipeBook.success}recipe.unlock=true}else{result.servings=0;result.message=RecipeBook.failure}}if(recipe)result.servings*=recipe.servings;return result}cookSave(inv,input,servings=1){const result=this.cook(input,servings);if(result.success){RecipeBook.pickup(inv,result.id,result.servings)}return result}match(input){if(typeof input==="object"&&input!==null){for(const recipe of this._recipes){if(!(recipe instanceof Recipe)){throw new Error(`Invalid Recipe: ${recipe}`)}const idx=recipe.validate(input);if(idx!==undefined){return[idx,recipe]}}}else if(typeof input==="string"){const recipe=this.recipes.get(input);if(recipe===undefined){return[undefined,undefined]}return[undefined,recipe]}else{throw new Error(`Invalid argument: ${input}`)}return[undefined,undefined]}filter(filters){if(typeof filterObjs==="undefined"){return this.error('The "filter-utils" is required but has not been imported')}return filterObjs(this._recipes,filters)}get crafting_table(){return this.ct}set crafting_table(value){this.ct=value;State.variables[this.ct]=State.variables[this.ct]||new Inventory}static sort(recipes){const defaultPriority=100;const recipeArr=Array.from(recipes.values());let counts={};recipeArr.forEach((recipe=>{const priority=recipe.priority!==undefined?recipe.priority:defaultPriority;counts[priority]=(counts[priority]||0)+1}));const priorities=Object.keys(counts).map(Number).sort(((a,b)=>a-b));let accumulatedCounts={};let cumulativeSum=0;priorities.forEach((priority=>{accumulatedCounts[priority]=cumulativeSum;cumulativeSum+=counts[priority]}));let arr=Array(recipeArr.length);for(let i=recipeArr.length-1;i>=0;i--){const recipe=recipeArr[i];const priority=recipe.priority!==undefined?recipe.priority:defaultPriority;let position=accumulatedCounts[priority];arr[position]=recipe;accumulatedCounts[priority]++}return arr}static pickup(inv,...item){if(!(inv instanceof Inventory)){throw new Error("Invalid inventory")}return inv.pickup(...item)}}const addAccessors=(cls,properties)=>{properties.forEach((property=>{Object.defineProperty(cls.prototype,property,{get(){return cls[property]},set(value){cls[property]=value}})}))};addAccessors(RecipeBook,["success","failure","not_found","not_unlocked","missing_materials","unlocked_success","default_no_recipe"]);setup._RecipeBook=RecipeBook;window._RecipeBook=window._RecipeBook||RecipeBook;setup.RecipeBook=setup.RecipeBook||new RecipeBook(RecipeBook.crafting_table);window.RecipeBook=window.RecipeBook||setup.RecipeBook})();(()=>{Macro.add("cook",{tags:null,handler(){if(this.args.length<1){return this.error("Not enough arguments provided. At least two arguments are required")}const items=this.args[0];if(!(typeof items==="object"||typeof items==="string")||items===null){return this.error("Expected an object or a string, but received: "+typeof items)}let result;if(this.args.length>=2){const inv=this.args[1];if(!inv||!(inv instanceof Inventory)){return this.error("Expected an instance of Inventory, but received: "+typeof inv)}result=RecipeBook.cookSave(inv,items,parseInt(this.args[2])||1)}else{result=RecipeBook.cook(items)}WikiVars({result:result},this)}});Macro.add("filter_recipe",{tags:null,handler(){if(this.args.length<1){return this.error("Not enough arguments provided. At least two arguments are required.")}const filters=this.args[0];if(filters&&typeof filters!=="object"){return this.error("Invalid input: 'filters' should be an object")}const result=RecipeBook.filter(filters);WikiVars({result:result},this)}});Macro.add("recipes_with_tag",{handler(){if(this.args.length<1){return this.error("Not enough arguments provided. At least one tag is required")}const result=RecipeBook.filter(this.args);WikiVars({result:result},this)}});Macro.add("calculate",{tags:null,handler(){if(this.args.length<1){return this.error("Not enough arguments provided. At least one tag is required")}const obj=this.args[0];if(typeof obj!=="object"){return this.error("Invalid argument: expected an object as the first argument")}const[name,servings]=RecipeBook.calculate(obj);WikiVars({servings:servings,name:name},this)}})})();
/* End Recipes */

RecipeBook.crafting_table= 'food';

/* Filter Utils, By BlackStar, Ver.0.2.1 */
(()=>{const isRange=condition=>condition&&typeof condition==="object"&&("min"in condition||"max"in condition);const filterObjs=(objects,filters,callback=null)=>{const length=filters.length;const ext=filters.ext;delete filters.ext;delete filters.length;const result=[];let count=0;for(const obj of objects){if(length&&count>=length){break}const isMatch=Object.entries(filters).every((([key,condition])=>{const val=obj[key];if(isRange(condition)){const{min:min,max:max}=condition;return(min==null||val>=min)&&(max==null||val<=max)}if(Array.isArray(condition)){return condition.includesAll(val)}return val===condition}));if(isMatch&&(callback==null||callback(obj,ext))){result.push(obj);count++}}return result};setup.filterObjs=filterObjs;window.filterObjs=window.filterObjs||filterObjs})();
/* End Filter Utils */

// <<popup>> macro
Macro.add('popup', {
    handler : function () {
        
        // errors
        if (this.args.length < 1) {
            return this.error('need at least one argument; the passage to display');
        }
        if (!Story.has(this.args[0])) {
            return this.error('the passage ' + this.args[0] + 'does not exist');
        }
        
        // passage name and title
        var psg   = this.args[0];
        var title = (this.args.length > 1) ? this.args[1] : '';
        var classes = (this.args.length > 2) ? this.args.slice(2).flat(Infinity) : [];
        
        // add the macro- class
        classes.push('macro-' + this.name);
        
        // dialog box
        Dialog.setup(title, classes.join(' '));
        Dialog.wiki(Story.get(psg).processText());
        Dialog.open();
        
    }

});

/*<<dialogclose>> macro 弹窗关闭*/
Macro.add('dialogclose', { 
    skipArgs : true, 
    handler : function () {
        Dialog.close();
    } 
});

/* 延迟文本code - Start */
$(document).on(':passagerender', function (ev) {
	var elems = $(ev.content).find('.delayed');
	var delay = 1000;
	if (elems.length > 0) {
		elems.each(function (i) {
			$(this)
				.delay(delay * (i + 1))
				.fadeTo(delay, 1);
		});
	}
});

/* <<fadein>> macro 淡入淡出*/
Macro.add('fadein', {
tags : null,
handler : function () {
 
var $wrapper = $(document.createElement('span'));
var content = this.payload[0].contents, time, delay;
 
if (this.args.length === 0) {
return this.error('no arguments given');
}
 
time = Util.fromCssTime(this.args[0]);
delay = (this.args.length > 1) ? Util.fromCssTime(this.args[1]) : 0;
 
$wrapper
.wiki(content)
.addClass('macro-' + this.name)
.appendTo(this.output)
.hide()
.delay(delay)
.fadeIn(time);
}
});
 
// <<fadeout>> macro
Macro.add('fadeout', {
tags : null,
handler : function () {
 
var $wrapper = $(document.createElement('span'));
var content = this.payload[0].contents, time, delay;
 
if (this.args.length === 0) {
return this.error('no arguments given');
}
 
time = Util.fromCssTime(this.args[0]);
delay = (this.args.length > 1) ? Util.fromCssTime(this.args[1]) : 0;
 
$wrapper
.wiki(content)
.addClass('macro-' + this.name)
.appendTo(this.output)
.delay(delay)
.fadeOut(time);
}
});

/*---------------------------成就系统-------------------------*/
// 初始化全局变量
if (window.setup === undefined) {
    window.setup = {};
}

// 初始化成就系统所需的数组
window.setup.achievements = [];
window.setup.achievementDefinitions = [];
window.setup.globalAchievements = [];

// 修改成就定义函数
window.defineAchievement = function(id, title, description, icon, category = "general", lockedDescription = "羽墨尚未点燃...") {
    let iconContent;
    
    // 处理不同类型的图标
    if (icon.startsWith('http') || icon.startsWith('https')) {
        // 网络图片
        iconContent = `<img src="${icon}" class="achievement-icon-image" alt="${title}">`;
    } else if (icon.endsWith('.png') || icon.endsWith('.jpg') || icon.endsWith('.jpeg') || icon.endsWith('.gif')) {
        // 本地图片 
        iconContent = `<img src="${icon}" class="achievement-icon-image" alt="${title}">`;
    } else {
        // emoji 或其他文本图标
        iconContent = icon;
    }
        
    window.setup.achievementDefinitions.push({
        id: id,
        title: title,
        description: description,
        lockedDescription: lockedDescription,
        icon: iconContent,
        category: category
    });
};
// 成就宏增强版
Macro.add('achievement', {
    handler: function() {
        var id = this.args[0];
        var achievement = window.setup.achievementDefinitions.find(a => a.id === id);
        
        if (!achievement) {
            return this.error(`Achievement with ID "${id}" not found`);
        }
        
        State.variables.achievements = State.variables.achievements || [];
        
        // 检查是否已在当前存档中解锁
        var isUnlockedInCurrentSave = State.variables.achievements.some(a => a.id === id);
        
        // 只有当前存档未解锁时才继续处理
        if (!isUnlockedInCurrentSave) {
            // 添加到当前存档成就
            const newAchievement = {
                id: id,
                unlockTime: new Date().toISOString()
            };
            
            State.variables.achievements.push(newAchievement);
            window.setup.achievements = State.variables.achievements;

            // 添加到全局成就记录
            if (!window.setup.globalAchievements.some(a => a.id === id)) {
                window.setup.globalAchievements.push(newAchievement);
                localStorage.setItem('twine-global-achievements', JSON.stringify(window.setup.globalAchievements));
            }
            
            // 显示成就通知 - 修改这部分
            var $achievement = $("<div class='achievement'>" +
                "<div class='achievement-icon'>" + achievement.icon + "</div>" +
                "<div class='achievement-content'>" +
                    "<div class='achievement-title'>" + achievement.title + "</div>" +
                    "<div class='achievement-description'>" + achievement.description + "</div>" +
                "</div>" +
            "</div>");
            
            // 改为添加到 body
            $achievement.appendTo('body');
            
            // 使用 requestAnimationFrame 确保动画正常工作
            requestAnimationFrame(() => {
                $achievement.addClass('show');
            });
            
            // 设置移除计时器
            setTimeout(() => {
                $achievement.removeClass('show');
                setTimeout(() => $achievement.remove(), 1000);
            }, 5000);
            
            updateAchievementsList();
        }
    }
});
            /* 内容*/
Macro.add('achievementspopup', {
    handler: function() {
        var categories = [...new Set(window.setup.achievementDefinitions.map(a => a.category))];
        
        // Create the achievements popup content
        var popupHtml = `
            <div id="achievements-popup" class="achievements-popup">
                <div class="achievements-content">
                    <div class="achievements-filters">
                        <select id="category-filter">
                            <option value="all">全部章节</option>
                            ${categories.map(c => `<option value="${c}">${c}</option>`).join('')}
                        </select>
                        <select id="status-filter">
                            <option value="all">全部状态</option>
                            <option value="unlocked">已记录</option>
                            <option value="locked">未讲述</option>
                        </select>
                    </div>
                    <div id="achievements-list"></div>
                </div>
            </div>
        `;
        
        // Append the popup HTML to the passage content
        $(this.output).append(popupHtml);

        // Use setTimeout to delay the update until the passage is fully rendered
        setTimeout(() => {
            updateAchievementsList();  // Update the list after ensuring the DOM is fully loaded
        }, 50);

        // 使用事件委托绑定change事件
        $(document).off('change', '#category-filter, #status-filter')
          .on('change', '#category-filter, #status-filter', function() {
        console.log('Filter changed:', this.id, this.value);
        updateAchievementsList();
});
    }
});
console.log(window.setup.achievementDefinitions); 

// 检查成就状态宏
Macro.add('checkachievement', {
    handler: function() {
        var id = this.args[0];
        State.variables.hasAchievement = State.variables.achievements && 
          State.variables.achievements.some(a => a.id === id);
    }
});

// 添加成就判定函数
window.checkAchievementCondition = function(id, condition) {
    if (condition && !State.variables.achievements.some(a => a.id === id)) {
        // 使用现有的成就宏触发成就
        Engine.play(`<<achievement '${id}'>>`);
    }
};

// 更新成就列表函数
function updateAchievementsList() {
    var $list = $('#achievements-list');
    if (!$list.length) return;

    console.log('Updating achievements list...');
    var categoryFilter = $('#category-filter').val();
    var statusFilter = $('#status-filter').val();
    
    console.log('Filters:', {
        category: categoryFilter,
        status: statusFilter,
        achievements: State.variables.achievements
    });
    
    // 获取当前滚动位置
    var scrollTop = $list.scrollTop();
    
    // 保持高度稳定，防止滚动跳动
    $list.css('min-height', $list.height());
    
    // 清空列表
    $list.empty();
    
    // 创建一个文档片段来提高性能
    var fragment = document.createDocumentFragment();
    var itemCount = 0;

    window.setup.achievementDefinitions.forEach(achievement => {
        // 检查成就是否已解锁
        var isUnlocked = State.variables.achievements && 
            State.variables.achievements.some(a => a.id === achievement.id);
            
        // 应用筛选器
        var showByCategory = categoryFilter === 'all' || achievement.category === categoryFilter;
        var showByStatus = statusFilter === 'all' || 
            (statusFilter === 'unlocked' && isUnlocked) ||
            (statusFilter === 'locked' && !isUnlocked);
            
        if (!showByCategory || !showByStatus) return;

        var title = isUnlocked ? achievement.title : "未讲述的故事";
        var description = isUnlocked ? 
            achievement.description : 
            (achievement.lockedDescription || "羽墨尚未点燃...");
        var icon = isUnlocked ? achievement.icon : "❓";
        
        var className = isUnlocked ? "unlocked-current" : "locked";

        // 创建成就项元素
        var $achievementItem = $("<div>").addClass('achievement-item ' + className)
            .attr('data-index', itemCount++) // 添加索引属性用于动画
            .append(
                $("<span>").addClass('achievement-icon').html(icon),
                $("<div>").addClass('achievement-info')
                    .append(
                        $("<span>").addClass('achievement-title').text(title),
                        $("<div>").addClass('achievement-description').text(description)
                    )
            );

        fragment.appendChild($achievementItem[0]);
    });
    
    // 一次性添加所有成就项
    $list.append(fragment);
    
    // 恢复滚动位置
    $list.scrollTop(scrollTop);
    
    // 触发动画
    setTimeout(() => {
        $('.achievement-item').addClass('show');
    }, 50);
    
    // 移除最小高度限制
    setTimeout(() => {
        $list.css('min-height', '');
    }, 300);
    
    // 检查是否有任何成就显示
    if ($list.children().length === 0) {
        $list.append("<div class='no-achievements'>你的传记上空空如也</div>");
    }

    // 添加调试日志
    console.log('Filter update complete:', {
        categoryFilter: $('#category-filter').val(),
        statusFilter: $('#status-filter').val(),
        visibleAchievements: $list.children('.achievement-item').length,
        totalAchievements: window.setup.achievementDefinitions?.length || 0
    });

}

// 调试函数
function debugAchievements() {
    console.log('Achievement state:', {
        definitions: window.setup.achievementDefinitions,
        unlocked: State.variables.achievements,
        filters: {
            category: $('#category-filter').val(),
            status: $('#status-filter').val()
        }
    });
}
window.debugAchievements = debugAchievements;
// 测试解锁函数
function unlockTestAchievement(id) {
    if (!State.variables.achievements) {
        State.variables.achievements = [];
    }
    if (!State.variables.achievements.some(a => a.id === id)) {
        State.variables.achievements.push({
            id: id,
            unlockTime: new Date().getTime()
        });
        updateAchievementsList();
    }
}
window.unlockTestAchievement = unlockTestAchievement;
// 保存全局成就状态
function saveGlobalAchievements() {
    try {
        localStorage.setItem('twine-global-achievements', JSON.stringify(window.setup.globalAchievements));
    } catch (e) {
        console.error('Error saving global achievements:', e);
    }
};

// 加载全局成就状态
function loadGlobalAchievements() {
    try {
        const savedGlobalAchievements = localStorage.getItem('twine-global-achievements');
        if (savedGlobalAchievements) {
            window.setup.globalAchievements = JSON.parse(savedGlobalAchievements);
        }
    } catch (e) {
        console.error('Error loading global achievements:', e);
        window.setup.globalAchievements = [];
    }
};

// 页面加载时的处理
$(document).on(':passagestart', function() {
    try {
        // 加载全局成就
        loadGlobalAchievements();
        // 确保当前存档的成就数组已初始化
        State.variables.achievements = State.variables.achievements || [];
        window.setup.achievements = State.variables.achievements;
    } catch (e) {
        console.error('Error loading achievements:', e);
    }
});

// 保存存档时的处理
$(document).on(':passagesave', function() {
    try {
        localStorage.setItem('twine-achievements', JSON.stringify(State.variables.achievements));
        saveGlobalAchievements();
    } catch (e) {
        console.error('Error saving achievements:', e);
    }
});

// 读取存档时的处理
$(document).on(':stateload', function() {
    try {
        // 加载全局成就
        loadGlobalAchievements();
        // 加载当前存档的成就
        const currentSaveAchievements = State.variables.achievements || [];
        window.setup.achievements = currentSaveAchievements;
        // 更新成就列表显示
        updateAchievementsList();
    } catch (e) {
        console.error('Error loading achievements:', e);
    }
});

// 清空历史成就
Macro.add('clearGlobalAchievements', {   
    handler: function() {
        // 清空数组
        window.setup.globalAchievements = [];
    }
});

/*-----------------界面汉化-----------------*/
(function () {
/*常规设置*/
	l10nStrings.textAbort = '中止';
	l10nStrings.textAborting = '终止';
	l10nStrings.textCancel = '删除';
	l10nStrings.textClear = '清除';
	l10nStrings.textClose = '关闭';
	l10nStrings.textDelete = '删除';
	l10nStrings.textExport = '导出';
	l10nStrings.textIdentity = '游戏';
	l10nStrings.textImport = '导入';
	l10nStrings.textLoad = '加载';
	l10nStrings.textOff = '关闭';
	l10nStrings.textOk = '确认';
	l10nStrings.textOn = '打开';
	l10nStrings.textSave = '保存';
	l10nStrings.textTurn = '转向';
/*报错*/
	l10nStrings.errorNonexistentPassage = '片段 "{passage}" 并不存在';
/*警告*/
	l10nStrings.warningNoStorage = '缺少所有可用的存储API。出错可能是因为禁用了第三方的cookie设置，这也会影响web存储或隐私浏览模式';
	l10nStrings.warningNoWebStorage = '缺少web存储API，因此这个{textIdentity}会以降级模式运行。您也许可以继续，但是某些部件可能无法正常工作。';
	l10nStrings.warningDegraded = '缺少支持这个{textIdentity}所需的一些功能，因此它会以降级模式运行。您也许可以继续，但是某些部件可能无法正常工作。';
	l10nStrings.warningNoSaves = '缺少支持保存所需的某些功能，因此这个会话已禁用保存。';
/*API: 保存*/
	l10nStrings.saveErrorDisallowed = '目前不允许保存';
	l10nStrings.saveErrorDecodeFail = '无法解码保存，可能是由于损坏';
	l10nStrings.saveErrorDiskLoadFail = '无法从磁盘加载保存文件';
	l10nStrings.saveErrorIdMismatch = '从错误的{textIdentity}保存';
	l10nStrings.saveErrorInvalidData = '保存时缺少所需数据，可能是由于损坏造成的';
	l10nStrings.saveErrorNonexistent = '保存不存在';
/*基础 UI*/
	l10nStrings.uiBarLabelToggle = '切换侧边栏';
	l10nStrings.uiBarLabelBackward = '回溯 {textIdentity} 历史记录';
	l10nStrings.uiBarLabelForward = '在 {textIdentity} 历史记录中向前移动';
	l10nStrings.restartTitle = '重新开始';
	l10nStrings.restartMesgPrompt = '所有未保存的进度都将丢失，你确定要重新开始吗？';
/*弹出框：保存*/
	l10nStrings.continueTitle = '继续';
	l10nStrings.savesTitle = '存档';
	l10nStrings.savesHeaderBrowser = '在浏览器内';
	l10nStrings.savesHeaderDisk = '在磁盘上';
	l10nStrings.savesLabelBrowserClear = '清除所有浏览器保存的内容';
	l10nStrings.savesLabelBrowserExport = '将浏览器存档导出为捆绑包';
	l10nStrings.savesLabelBrowserImport = '从捆绑包中导入浏览器存档';
	l10nStrings.savesLabelDiskLoad = '从磁盘加载';
	l10nStrings.savesLabelDiskSave = '保存到磁盘';
	l10nStrings.savesTextBrowserAuto = '自动';
	l10nStrings.savesTextBrowserSlot = '存档位';
	l10nStrings.savesTextNoDate = '未知';
/*弹出框：设置*/
	l10nStrings.settingsTitle = '设置';
	l10nStrings.settingsTextReset = '重置为默认值';
/*调试：错误视图*/
	l10nStrings.errorViewTitle = '错误';
	l10nStrings.alertTitle = '提醒';
	l10nStrings.errorViewLabelToggle = '切换错误视图';
/*调试：调试栏*/
	l10nStrings.debugBarLabelToggle = '切换调试栏';
	l10nStrings.debugBarLabelViewsToggle = '切换调试视图';
	l10nStrings.debugBarLabelWatchAdd = '添加新的监控';
	l10nStrings.debugBarLabelWatchAll = '全部监控';
	l10nStrings.debugBarLabelWatchClear = '清除所有监控';
	l10nStrings.debugBarLabelWatchDelete = '删除此监控';
	l10nStrings.debugBarLabelWatchPlaceholder = '变量名';
	l10nStrings.debugBarLabelPassagePlaceholder = '片段名';
	l10nStrings.debugBarLabelPassagePlay = '播放片段';
	l10nStrings.debugBarLabelWatchToggle = '切换监控视图';
	l10nStrings.debugBarMesgNoWatches = '未设置监控';
	l10nStrings.debugBarTextAdd = '添加';
	l10nStrings.debugBarTextPassage = '片段';
	l10nStrings.debugBarTextViews = '视图';
	l10nStrings.debugBarTextWatch = '监控';
})();

//通知, for SugarCube 2, by Chapel,  v1.1.1, 2024-07-22,
;!function(){var s=/\d+m?s$/;function a(s,a,e){"string"==typeof s&&("number"!=typeof a&&(a=!1),$(document).trigger({type:":notify",message:s,delay:a,class:e||""}))}$(document.body).append("<div id='notify'></div>"),$(document).on(":notify",(function(s){s.message&&"string"==typeof s.message&&(s.message.trim(),s.class?"string"==typeof s.class?s.class="open macro-notify "+s.class:Array.isArray(s.class)?s.class="open macro-notify "+s.class.join(" "):s.class="open macro-notify":s.class="open macro-notify",s.delay?("number"!=typeof s.delay&&(s.delay=Number(s.delay)),Number.isNaN(s.delay)&&(s.delay=2e3)):s.delay=2e3,$("#notify").empty().wiki(s.message).addClass(s.class),setTimeout((function(){$("#notify").removeClass()}),s.delay))})),Macro.add("notify",{tags:null,handler:function(){var e=this.payload[0].contents,t=!1,i=!1;if(this.args.length>0){var n=s.test(this.args[0]);"number"==typeof this.args[0]||n?(t=n?Util.fromCssTime(this.args[0]):this.args[0],i=this.args.length>1&&this.args.slice(1).flat(1/0)):i=this.args.flat(1/0).join(" ")}a(e,t,i)}}),setup.notify=a}();

// 网站图标
$(document.head).append('<link rel="icon" href="https://f2.toyhou.se/file/f2-toyhou-se/images/87542596_ae2quifopx6FUoz.png" type="image/png" />');

/* 开启自动保存，数值是自动保存使用的存档槽数量，默认为0，0禁用自动保存 */
Config.saves.maxAutoSaves = 1;
/* 对拥有标签autosave的段落进行自动保存 */
Config.saves.isAllowed = function (saveType) {
	if (saveType === Save.Type.Auto) {
		return tags().includes("autosave");
	}
	return true;
};

//保存显示文本为段落文本
Config.saves.descriptions = function (saveType) {
    return passage();
};

//物品api
(() => {
    'use strict';
    // item class
    const defaultOpts = {
        description : '', // item description rendered in modal when inspected
        handler : null, // callback function or wiki code
        displayName : '', // display name replaces id
        consumable: true, // can be used, and is consumed (dropped) on use
        unique : false, // a given inventory may only ever have one
        permanent : false // cannot be dropped or transferred once picked up
    };
    const ItemList = new Map();
    class Item {
        // new Item(id [, optsions] [, tags]) -> creates a new Item instance
        // undcoumented! users should use `Item.add()`
        constructor(id = '', opts = clone(defaultOpts), tags = []) {
            if (!id || typeof id !== 'string') {
                throw new Error('invalid item ID');
            }
            if (typeof opts !== 'object') {
                throw new Error('invalid item definition');
            }
            Object.assign(this, Object.assign({}, defaultOpts, opts));
            this.id = id;
            this._tags = tags instanceof Array ? tags : 
                typeof tags === 'string' ? [ tags ] : [];
        }
        // static methods
        // Item.is(thing) -> returns true if thing is an Item instance
        static is (thing) {
            return thing instanceof Item;
        }
        // Item.add(id [, definition] [, tags]) -> creates and registers a new Item instance
        static add (id, def, tags) {
            const item = new Item(id, def, tags);
            ItemList.set(id, item);
            return item;
        }
        // Item.get(id) -> returns Item instance by ID
        static get (id) {
            return ItemList.get(id);
        }
        // Item.has(id) -> returns true if Item with given ID exists
        static has (id) {
            return ItemList.has(id);
        }
        // Item.list -> returns map of registered Item instances, indexed by ID
        static get list () {
            return ItemList;
        }
        // instance methods

        // tags
        get tags () {
            // return tags array (editable)
            return this._tags;
        }
        hasTag (tag) {
            // has the indicated tag
            return this._tags.includes(tag);
        }
        hasAllTags () {
            // has all the indicated tags
            return this._tags.includesAll([].slice.call(arguments).flat(Infinity));
        }
        hasAnyTags () {
            // has any of the indicated tags
            return this._tags.includesAny([].slice.call(arguments).flat(Infinity));
        }
        // item#name -> item's name, which is the displayName or ID, can be set
        get name () {
            return this.displayName || this.id;
        }
        set name (val) {
            this.displayName = val;
        }
        // item#use() -> runs item's usage callback
        use () {
            if (typeof this.handler === 'string') {
                $.wiki(this.handler);
            } else if (typeof this.handler === 'function') {
                this.handler(this);
            }
            return this;
        }
        // item#inspect() -> creates a dialog with the item's description
        inspect () {
            Dialog.setup(this.name, 'simple-inventory item-description');
            Dialog.wiki(this.description);
            Dialog.open();
            return this;
        }
    }
    setup.Item = Item;
    window.Item = window.Item || Item;
})();

/* WordWheel-Fork.1, Ver.0.1.0 */
// Made by SjoerdHekking with too much help from Gwen
setup.circle = {
    msg: "Error".split(""),
    size: 14,
    circleY: 1,
    circleX: 1,
    letter_spacing: 5,
    diameter: 22,
    rotation: 0.4,
    speed: 0.2,
    currStep: 20,
    y: [],
    x: [],
    Y: [],
    X: [],
  	start: 0,
    circleInitnopy: false,
    circleFirstDiv: document.createElement("div"),
    circleSecondDiv: document.createElement("div"),
    circleMouse: function (e) {
      e = e || window.event;
      setup.circle.ymouse = !isNaN(e.pageY) ? e.pageY : e.clientY; // setup.circle.y-position
      setup.circle.xmouse = !isNaN(e.pageX) ? e.pageX : e.clientX; // setup.circle.x-position
    },
    makeCircle: function () { // rotation/positioning
      if (setup.circle.circleInitnopy) {
        setup.circle.circleFirstDiv.style.top = document.body.scrollTop + "px";
        setup.circle.circleFirstDiv.style.left = document.body.scrollLeft + "px";
      }
      setup.circle.currStep -= setup.circle.rotation;
      for (let i = setup.circle.n; i > -1; --i) { // makes the circle
        let d = document.getElementById("iemsg" + i).style;
        d.top = Math.round(setup.circle.y[i] + setup.circle.a * Math.sin((setup.circle.currStep + i) / setup.circle.letter_spacing) * setup.circle.circleY - 15) + "px";
        d.left = Math.round(setup.circle.x[i] + setup.circle.a * Math.cos((setup.circle.currStep + i) / setup.circle.letter_spacing) * setup.circle.circleX) + "px";
      }
    },
    circleDrag: function () { // makes the resistance
      if (!setup.circle.start) {
      	return;
      }
      setup.circle.y[0] = setup.circle.Y[0] += (setup.circle.ymouse - setup.circle.Y[0]) * setup.circle.speed;
      setup.circle.x[0] = setup.circle.X[0] += (setup.circle.xmouse - 20 - setup.circle.X[0]) * setup.circle.speed;
      for (let i = setup.circle.n; i > 0; --i) {
        setup.circle.y[i] = setup.circle.Y[i] += (setup.circle.y[i - 1] - setup.circle.Y[i]) * setup.circle.speed;
        setup.circle.x[i] = setup.circle.X[i] += (setup.circle.x[i - 1] - setup.circle.X[i]) * setup.circle.speed;
      }
      setup.circle.makeCircle();
      requestAnimationFrame(setup.circle.circleDrag);
    },
    circleInit: function () {
      // appends message divs, & sets initial values for positioning arrays
      setup.circle.start += 1;
      if (setup.circle.start > 1) {
      	return;
      }
      setup.circle.n = setup.circle.msg.length - 1;
      setup.circle.a = Math.round(setup.circle.size * setup.circle.diameter * 0.20);
      setup.circle.ymouse = setup.circle.a * setup.circle.circleY + 20;
      setup.circle.xmouse = setup.circle.a * setup.circle.circleX + 20;
      setup.circle.circleFirstDiv.id = "outerCircleText";
      setup.circle.circleFirstDiv.style.fontSize = setup.circle.size + "px";
      if (!isNaN(window.pageYOffset)) {
        setup.circle.ymouse += window.pageYOffset;
        setup.circle.xmouse += window.pageXOffset;
      }
      else
        setup.circle.circleInitnopy = true;
      if ($("#outerCircleText").is(":hidden")) {
        $("#outerCircleText").show();
        if (window.addEventListener) {
			setup.circle.circleInit();
			document.addEventListener("mouseover", setup.circle.circleMouse, false);
			document.addEventListener("mousemove", setup.circle.circleMouse, false);
			if (/Apple/.test(navigator.vendor))
			window.addEventListener("scroll", setup.circle.circleAscroll, false);
		}
		else if (window.attachEvent) {
			// window.attachEvent("onload", setup.circle.circleInit);
			document.attachEvent("onmousemove", setup.circle.circleMouse);
		}
      } else {
      	for (let i = setup.circle.n; i > -1; --i) {
          let d = document.createElement("div");
          d.id = "iemsg" + i;
          d.style.height = setup.circle.a + "px";
          d.style.width = setup.circle.a + "px";
          d.appendChild(document.createTextNode(setup.circle.msg[i]));
          setup.circle.circleSecondDiv.appendChild(d); setup.circle.y[i] = setup.circle.x[i] = setup.circle.Y[i] = setup.circle.X[i] = 0;
        }
      }
      
      setup.circle.circleFirstDiv.appendChild(setup.circle.circleSecondDiv);
      document.body.appendChild(setup.circle.circleFirstDiv);
      setup.circle.circleDrag();
    },
    circleAscroll: function () {
      setup.circle.ymouse += window.pageYOffset;
      setup.circle.xmouse += window.pageXOffset;
      window.removeEventListener("scroll", setup.circle.circleAscroll, false);
    },
  	stop: function() {
    	setup.circle.start = 0;
       	document.removeEventListener("mouseover", setup.circle.circleMouse, false);
        document.removeEventListener("mousemove", setup.circle.circleMouse, false);
        // 取消滚动监听 (对于 Apple 浏览器)
        if (/Apple/.test(navigator.vendor)) {
            window.removeEventListener("scroll", setup.circle.circleAscroll, false);
        }
      	$('#outerCircleText').hide();
    }
};
  
// MACRO

Macro.add("wordwheel", {
	tags: ["fontSize", "fontsize", "circleSize", "circlesize"],
	handler: function () {
		let errorArray = [];
		if (!window.addEventListener && !window.attachEvent && !document.createElement) {errorArray.push("Unable to either add EvenListener, AttachEvent or createElement")}; 
		if(this.args.length <= 0)
			return this.error("First argument cannot be skipped, please insert a string via <<wordwheel \"Text here.\">>.");
		if(this.args[0] === "")
			return this.error("First argument cannot be an empty string.");
		if(this.args[0].length > 31)
			return this.error("Word wheel doesn't accept more than 50 characters.");
		
		setup.circle.msg = this.args[0].split("");


		for (const pay of this.payload) {
			switch (pay.name.toLowerCase()) {
			case "fontsize":
				if (pay.args[0] > 30)
					errorArray.push("Font size cannot be bigger than 30.");
				if (pay.args[0] < 4)
					errorArray.push("Font size cannot be negative nor below 4.");
			
				setup.circle.size = pay.args[0];
			break;
			case "circlesize":
				if (pay.args[0] > 70)
					errorArray.push("Circle size cannot be above 70.");
				if (pay.args[0] < 20)
					errorArray.push("Circle size cannot be below 20");

				setup.circle.diameter = pay.args[0];
			break;
			}
		}

		if (errorArray.length > 0)
			return this.error(errorArray.join("\n"));

		else if (window.addEventListener) {
			setup.circle.circleInit();
			document.addEventListener("mouseover", setup.circle.circleMouse, false);
			document.addEventListener("mousemove", setup.circle.circleMouse, false);
			if (/Apple/.test(navigator.vendor))
			window.addEventListener("scroll", setup.circle.circleAscroll, false);
		}
		else if (window.attachEvent) {
			// window.attachEvent("onload", setup.circle.circleInit);
			document.attachEvent("onmousemove", setup.circle.circleMouse);
		}
	}
});
/* End WordWheel-Fork.1 */

function videoMuteHandler() {
	// (Un)Mute the videos
	$("video").prop("muted", settings.videoMute);  // (Un)Mute all videos
}
Setting.addToggle("videoMute", {
	label	 : "背景音乐静音",
	default  : false,
	onInit	 : videoMuteHandler,
	onChange : videoMuteHandler
});

(function () {
	// Set initial values.
	var options = {
		current  : 50,  // Default volume level.
		rangeMax : 100,
		step	 : 1,
		setting  : true
	};
	Setting.load();
	if (options.setting && settings.volume) {
		options.current = parseInt(settings.volume);
	}
	var vol = {
		last: options.current,
		start: (options.current / options.rangeMax).toFixed(2)
	};

	// Function to update the volume level.
	function setVolume (val) {
		if (typeof val !== 'number') val = Number(val);
		if (Number.isNaN(val) || val < 0) val = 0;
		if (val > 1) val = 1;
		options.current = Math.round(val * options.rangeMax);
		if (options.setting) {
			settings.volume = options.current;
			Setting.save();
		}
		if ($('input[name=volume]').val() != options.current) {
			$('input[name=volume]').val(options.current);
		}
		try {
			if (SimpleAudio) {
				if (typeof SimpleAudio.volume === 'function') {
					SimpleAudio.volume(val);
				} else {
					SimpleAudio.volume = val;
				}
				return val;
			} else {
				throw new Error('Cannot access audio API.');
			}
		} catch (err) {
			// Fall back to the wikifier if we have to.
			console.error(err.message, err);
			$.wiki('<<masteraudio volume ' + val + '>>');
			return val;
		}
	}

	// Fix the initial volume level display.
	postdisplay['volume-task'] = function (taskName) {
		delete postdisplay[taskName];
		setVolume(vol.start);
	};

	// Grab volume level changes from the volume slider.
	$(document).on('input', 'input[name=volume]', function() {
		var change = parseInt($('input[name=volume]').val());
		setVolume(change / options.rangeMax);
		vol.last = change;
	});

	// Create the <<volume>> macro.
	Macro.add('volume', {
		handler : function () {
			var wrapper = $(document.createElement('span'));
			var slider = $(document.createElement('input'));
			var className = 'macro-' + this.name;
			slider.attr({
				id		: 'volume-control',
				type	: 'range',
				name	: 'volume',
				min		: '0',
				max		: options.rangeMax,
				step	: options.step,
				value	: options.current
			});
			// Class '.macro-volume' and ID '#volume-control' for styling the slider
			wrapper.append(slider).addClass(className).appendTo(this.output);
		}
	});

	// Add Setting API integration for SugarCube 2.26 and higher.
	function updateVolume () {
		setVolume(settings.volume / options.rangeMax);
	}
	if (options.setting) {
		if (Setting && Setting.addRange && typeof Setting.addRange === 'function') {
			Setting.addRange('volume', {
				label : '音量: ',
				min : 0,
				max : options.rangeMax,
				step : options.step,
				default : options.current,
				onInit : updateVolume,
				onChange : updateVolume
			});
		} else {
			console.error('This version of SugarCube does not include the `Settings.addRange()` method; please try updating to the latest version of SugarCube.');
		}
	}
}());

      // 打字跳过＋显示选项
setup.typewriter = (() => {
  let currentTyping = null;
 
  function typewriter(element, text, speed = 50, choiceElement = null) {
    if (currentTyping) {
      currentTyping.abort = true;
    }
 
    element.textContent = '';
    element.classList.add('typing');
    
    const cursor = document.createElement('span');
    cursor.className = 'cursor';
    element.appendChild(cursor);
    
    let i = 0;
    let aborted = false;
    
    function handleSkip(e) {
      // 任意鼠标按键都可以触发跳过
      aborted = true;
    }
    document.addEventListener('mousedown', handleSkip);
    
    return new Promise(resolve => {
      currentTyping = { abort: false };
      
      function type() {
        if (currentTyping.abort || aborted) {
          document.removeEventListener('mousedown', handleSkip);
          element.innerHTML = text;
          finish();
          return;
        }
 
        if (i < text.length) {
          const char = text.charAt(i);
          if (char === '\n') {
            element.insertBefore(document.createElement('br'), cursor);
          } else {
            element.insertBefore(document.createTextNode(char), cursor);
          }
          i++;
          setTimeout(type, speed);
        } else {
          document.removeEventListener('mousedown', handleSkip);
          finish();
        }
      }
 
      function finish() {
        cursor.remove();
        if (choiceElement) {
          setTimeout(() => {
            choiceElement.style.display = 'block';
            choiceElement.style.opacity = '1';
            choiceElement.style.transform = 'translateY(0)';
          }, 100);
        }
        resolve();
      }
 
      type();
    });
  }
 
  return typewriter;
})();
 
Macro.add('typewriter', {
  tags: ['choices'],
  handler: function() {
    if (!this.args[0]) {
      return this.error('No typing speed specified');
    }
 
    const speed = this.args[0];
    const $wrapper = $('<div/>').addClass('typewriter');
    
    let $choices = null;
    
    if (this.payload[1]) {
      $choices = $('<div/>').addClass('choice-container').css({
        'display': 'none',
        'opacity': '0',
        'transform': 'translateY(20px)',
        'transition': 'all 0.5s ease'
      });
      
      $choices.wiki(this.payload[1].contents);
    }
    
    this.output.appendChild($wrapper[0]);
    if ($choices) {
      this.output.appendChild($choices[0]);
    }
    
    setup.typewriter($wrapper[0], this.payload[0].contents, speed, $choices ? $choices[0] : null);
  }
});

/*黑星版*/
/* Type-wp, Modified from SugarCube, Ver.0.1.2 */
Macro.add("type-wp",{isAsync:true,tags:null,typeId:0,handler(){if(this.args.length===0){return this.error("no speed specified")}const speed=cssTimeToMS(this.args[0]);if(speed<0){return this.error(`speed time value must be non-negative (received: ${this.args[0]})`)}let cursor;let elClass="";let elId="";let elTag="div";let skipKey=Config.macros.typeSkipKey;let start=400;let pause=speed;let symbols=RegExp(/[]/);const options=this.args.slice(1);while(options.length>0){const option=options.shift();switch(option){case"class":{if(options.length===0){return this.error("class option missing required class name(s)")}elClass=options.shift();if(elClass===""){throw new Error('class option class name(s) must be non-empty (received: "")')}break}case"element":{if(options.length===0){return this.error("element option missing required element tag name")}elTag=options.shift();if(elTag===""){throw new Error('element option tag name must be non-empty (received: "")')}break}case"id":{if(options.length===0){return this.error("id option missing required ID")}elId=options.shift();if(elId===""){throw new Error('id option ID must be non-empty (received: "")')}break}case"keep":cursor="keep";break;case"none":cursor="none";break;case"skipkey":{if(options.length===0){return this.error("skipkey option missing required key value")}skipKey=options.shift();if(skipKey===""){throw new Error('skipkey option key value must be non-empty (received: "")')}break}case"start":{if(options.length===0){return this.error("start option missing required time value")}const value=options.shift();start=cssTimeToMS(value);if(start<0){throw new Error(`start option time value must be non-negative (received: ${value})`)}break}case"pause":{if(options.length===0){return this.error("pause option missing required time value")}const value=options.shift();pause=cssTimeToMS(value);if(start<0){throw new Error(`pause option time value must be non-negative (received: ${value})`)}break}case"symbols":{if(options.length===0){return this.error("symbols option missing required time value")}const value=options.shift();const escapedStr=value.replace(/([.*+?^${}()|[\]\\/])/g,"\\$1");symbols=RegExp(`[${escapedStr}]`);if(start<0){throw new Error(`symbols option time value must be non-negative (received: ${value})`)}break}default:return this.error(`unknown option: ${option}`)}}const contents=this.payload[0].contents;if(contents.trim()===""){return}if(Config.debug){this.debugView.modes({block:true})}const className=`macro-${this.name}`;const namespace=`.${className}`;const $target=jQuery(document.createElement(elTag)).addClass(`${className} ${className}-target`).appendTo(this.output);if(!TempState.macroTypeQueue){TempState.macroTypeQueue=[];$(document).off(namespace).one(`:passageinit${namespace}`,(()=>$(document).off(namespace)))}const startTyping=TempState.macroTypeQueue.length===0;const selfId=++this.self.typeId;const allowCleanup=this.self.allowCleanup;TempState.macroTypeQueue.push({id:selfId,handler:this.shadowHandler((()=>{const $wrapper=jQuery(document.createElement(elTag)).addClass(className);if(elId){$wrapper.attr("id",elId)}if(elClass){$wrapper.addClass(elClass)}new Wikifier($wrapper,contents,allowCleanup(elTag)?undefined:{cleanup:false});const passage=State.passage;const turn=State.turns;if(speed===0||!Config.macros.typeVisitedPassages&&State.passages.slice(0,-1).some((title=>title===passage))||$wrapper.find(".error").length>0){$target.replaceWith($wrapper);TempState.macroTypeQueue.shift();if(TempState.macroTypeQueue.length>0){TempState.macroTypeQueue.first().handler()}return}const typer=new NodeTyper({targetNode:$wrapper.get(0),classNames:cursor==="none"?null:`${className}-cursor`});$target.replaceWith($wrapper);const typingCompleteId=":typingcomplete";const typingStartId=":typingstart";const typingStopId=":typingstop";const keydownAndNS=`keydown${namespace}`;const typingStopAndNS=`${typingStopId}${namespace}`;$(document).off(keydownAndNS).on(keydownAndNS,(ev=>{if(scrubEventKey(ev.key)===skipKey&&(ev.target===document.body||ev.target===document.documentElement)){ev.preventDefault();$(document).off(keydownAndNS);typer.finish()}})).one(typingStopAndNS,(()=>{if(TempState.macroTypeQueue){if(TempState.macroTypeQueue.length===0){triggerEvent(typingCompleteId)}else{TempState.macroTypeQueue.first().handler()}}}));$("body, .type-click-skip").on("click",(ev=>{if($(ev.target).closest("#ui-bar, .type-exclude, button, input, textarea, a").length>0){return}ev.preventDefault();typer.finish()}));const typeNode=function typeNode(){const typeNodeMember=function typeNodeMember(typeIntervalId){if(State.passage!==passage||State.turns!==turn||!typer.type()){if(typeIntervalId){clearInterval(typeIntervalId)}if(TempState.macroTypeQueue&&TempState.macroTypeQueue.length>0&&TempState.macroTypeQueue.first().id===selfId){TempState.macroTypeQueue.shift()}triggerEvent(typingStopId,$wrapper);$wrapper.addClass(`${className}-done`);if(cursor==="keep"){$wrapper.addClass(`${className}-cursor`)}}const lastChar=$wrapper.text().slice(-1);let delay=speed;if(symbols.test(lastChar)){delay=pause}setTimeout(typeNodeMember,delay)};triggerEvent(typingStartId,$wrapper);typeNodeMember()};if(start){setTimeout(typeNode,start)}else{typeNode()}}))});if(startTyping){if(Engine.isPlaying()){$(document).one(`:passageend${namespace}`,(()=>TempState.macroTypeQueue.first().handler()))}else{TempState.macroTypeQueue.first().handler()}}},allowCleanup(tagName){switch(tagName.toUpperCase()){case"ARTICLE":case"DIV":case"FOOTER":case"FORM":case"HEADER":case"MAIN":case"SECTION":return true}return false}});
/* End Type-wp */



/*------------------------制作---------------------------*/
/*吃的*/
RecipeBook.set("烤肉", {"兽肉": 1});
RecipeBook.set("烤鸡腿", {"禽肉": 1});
RecipeBook.set("黄油", {"羊奶": 1}, {servings: 3});
RecipeBook.set("方糖", {"甜菜": 1}, {servings: 6});
RecipeBook.set("煎蛋", {"鸟蛋": 1});
RecipeBook.set("柠香三文鱼", {"白鲑鱼": 1, "柠檬": 1});
RecipeBook.set("茄汁鲈鱼", {"黑鲈鱼": 1, "番茄": 2});
RecipeBook.set("蜂蜜柠檬水", {"蜂蜜": 1, "柠檬": 1});
RecipeBook.set("炸薯条", {"土豆": 1, "鱼油": 1}, {servings: 5});
RecipeBook.set("炸鱼", {"面粉": 1, "鱼肉": 1, "鱼油": 1}, {servings: 2});
RecipeBook.set("土豆泥", {"土豆": 1, "黄油": 1}, {servings: 2});
RecipeBook.set("炸鱼薯条", {"炸鱼": 1, "炸薯条": 1});
RecipeBook.set("鲜花饼", [{"红玫瑰": 3, "面粉": 1, "糖": 3},{"黄玫瑰": 3, "面粉": 1, "糖": 3},{"蓝玫瑰": 3, "面粉": 1, "糖": 3},{"白玫瑰": 3, "面粉": 1, "糖": 3}], {servings: 3});
RecipeBook.set("土豆蛋饼", {"土豆": 1, "黄油": 1, "鸟蛋": 1}, {servings: 2});
RecipeBook.set("浆果馅饼", {"浆果": 5, "面粉": 1, "黄油": 1, "糖": 3}, {servings: 4});
RecipeBook.set("番茄浓汤", {"番茄": 1, "土豆": 1, "洋葱": 1, "羊奶": 1});
RecipeBook.set("扇贝汤", {"扇贝": 5, "洋葱": 1, "黄油": 1, "羊奶": 1});
RecipeBook.set("红椒酿肉", {"兽肉": 2, "黄油": 1, "黑麦啤酒": 1, "辣酱": 1, "面粉": 1});
RecipeBook.set("浆果馅饼", {"浆果": 5, "面粉": 1, "黄油": 1, "糖": 3});
RecipeBook.set("蘑菇鱼汤", {"鱼肉": 1, "黄油": 1, "洋葱": 1, "毒蘑菇": 1, "面粉": 1}, {servings: 4});
RecipeBook.set("苏格兰汤", {"鳕鱼": 1, "洋葱": 1, "土豆": 1, "羊奶": 1}, {servings: 3});
RecipeBook.set("渔夫派", [{"鱼肉": 1, "胡萝卜": 1, "土豆泥": 1, "羊奶": 1, "黄油": 1, "洋葱": 1}, {"鱼肉": 1, "玉米": 1, "土豆泥": 1, "羊奶": 1, "黄油": 1, "洋葱": 1}], {servings: 4});
RecipeBook.set("羊倌派", {"兽肉": 1, "胡萝卜": 1, "洋葱": 1, "土豆泥": 1, "羊奶": 1, "黄油": 1}, {servings: 4});
RecipeBook.set("面包片", {"面粉": 1, "黄油": 1, "羊奶": 1, "糖": 1}, {servings: 5});
RecipeBook.set("法式吐司", {"面包片": 2, "鸟蛋": 1, "羊奶": 1, "黄油": 1}, {servings: 3});
RecipeBook.set("蔬菜什锦", [{"洋葱": 2, "胡萝卜": 1, "欧芹": 1, "黄油": 1}, {"洋葱": 2, "胡萝卜": 1, "欧芹": 1, "黄油": 1, "番茄": 1}], {servings: 4});
/*喝的*/
RecipeBook.set("牡丹花茶", {"牡丹花": 1, "糖": 1}, {servings: 3});
RecipeBook.set("无花果酒", {"无花果": 6, "柿子酒": 1, "黑蜂蜂蜜": 1}, {servings: 6});
RecipeBook.set("巴尔谢酒", {"丁香树皮": 1, "玉米": 1, "蜂蜜": 1, "朗姆酒": 1}, {servings: 5});
RecipeBook.set("颂歌蜜酒", {"智慧鲑鱼血": 3, "蜂蜜": 1}, {servings: 4});
RecipeBook.set("蒲公英酒", {"蒲公英": 3, "糖": 1, "柠檬": 1}, {servings: 5});

/*用的*/
RecipeBook.set("皮革手套", [{"兔皮": 6}, {"鼬皮": 2}]);
RecipeBook.set("月光提灯", [{"鱼竿": 1, "萤火虫罐": 1}]);

RecipeBook.update();

/*-----------------------------物品描述--------------------------------*/
/*在描述中使用的*/
Item.add("鲜花诗集", {
    displayName: "鲜花诗集",
    description: '【用永无乡最美的花朵写成的诗篇, 花瓣就像墨水一样平展, 有着天鹅绒般的触感, 闻起来仿佛身处花园】<br><br><<if $xhsjusable == 2>><center><<link "❖阅读">><<run Dialog.setup("阅读");Dialog.wiki("【你轻轻翻阅着, 鲜花组成的诗歌鲜活而令你沉醉, 但除此之外, 那些花朵的形状和颜色在你眼里没有任何意义. 你合上了鲜花诗集】<<set $knowledgeexp +=10>><<addkexpWidget>>");Dialog.open();>><<set $xhsjusable = 1>><</link>></center><</if>>',
}, ["cantlose", "fuelS"]);
Item.add("律法之书", {
    displayName: "律法之书",
    description: '【】<br><br><<link "❖阅读">><<run Dialog.setup("阅读");Dialog.wiki("【】<<set $knowledgeexp +=10>><<addkexpWidget>>");Dialog.open();>><</link>></center>',
}, ["cantlose", "fuelS"]);
Item.add("笔记残页", {
    displayName: "笔记残页",
    description: '【】<br><br><<link "❖阅读">><<run Dialog.setup("阅读");Dialog.wiki("【】<<set $knowledgeexp +=10>><<addkexpWidget>>");Dialog.open();>><</link>></center>',
}, ["cantlose", "fuelC"]);
Item.add("丝带白玫瑰", {
    displayName: "丝带白玫瑰",
    description: '【洁白如雪的玫瑰, 枝干上的棘刺已经被精心剔除, 花托上还绑着一根的蓝丝带, 象征着一个约定】<br><br><center><<link "❖佩戴">><<run Dialog.setup("佩戴");Dialog.wiki("【1111】");Dialog.open();>><</link>></center>',
}, [ "rose", "flower", "fuelB"]);
Item.add("海螺号角", {
    displayName: "海螺号角",
    description: '【加工过的普通的海螺, 被打磨抛光, 在难以注意到的内部雕上了一串不知名的文字. 在海上遇见危险时可以吹响它】<br><br><center><<link "❖使用">><<drop $item "海螺号角" 1>><<if $danger == "海域">><<set $danger == "平息">><<goto "海域危机">><<run Dialog.setup("使用");Dialog.wiki("【你突然回忆起Era关于海域危险的话, 从包里慌张的翻出他送给你的海螺, 毫无选择的吹响了它, 接着, 那群盘旋在远处的鸟群像受到召唤一样向你飞来, 而刚才还在翻涌的海面已经归于平静, 危险似乎走远了...】");Dialog.open();>><<else>><<run Dialog.setup("使用");Dialog.wiki("【你吹响了Era送给你的海螺, 低沉的号角声响起又落下, 什么都没有出现, 什么都没有消失, 只有你手里的海螺已经裂成了碎片】");Dialog.open();>><</if>><</link>></center>',
}, [ "enchanted", "escape"]);
Item.add("信者铃", {
    displayName: "信者铃",
    description: '【看上去似乎是使用银来制作的火漆印章，没有过多的装饰，看上去非常简便。只是印章的部分使用了非常复杂的花纹，看上去像是某种魔咒】<br><br><center><<link "❖观察">><<run Dialog.setup("阅读");Dialog.wiki("【仔细观察才发现，在那手摇铃铛的把柄底部，似乎有着非常复杂繁琐的花纹……】<<if $xzlob != 1>><<set $xhsjusable = 1, $observationexp +=10>><<addoexpWidget>><</if>>");Dialog.open();>><</link>><br><<link "❖使用">><<run Dialog.setup("阅读");Dialog.wiki("【你摇了摇这枚铃铛，略等了那么一会儿，便看见不知道从那里出现的奥里向你这边小跑了过来】<<set $npc = "奥里">>");Dialog.open();>><</link>></center>',
}, [ "cantlose"]);
Item.add("安家许可证", {
    displayName: "安家许可证",
    description: '<br><<textbox "_home" "" autofocus>><<set _home to ["小镇","草甸","沙地","高地","贝雷河","秋毛岗","罗索伦特湖"]>>住址:<<listbox "$home">> <<optionsfrom _home>> <</listbox>>   <<button "确认">><<if $feather lt 200>><<lessfeather>><<else>><<set $feather -= 200>><<run Dialog.setup("安家");Dialog.wiki("【$nn现在住在$home! 回家看看吧】");Dialog.open();>><<drop $item "安家许可证" 1>><<go to 家>><</if>><</button>>',
}, [ "cantlose", "fuelC"]);
Item.add("智慧鲑鱼", {
    displayName: "智慧鲑鱼",
    description: '【通常, 猫们会花费七年又七个月在向南奔流的河流里捕捞这种鱼, 而你也许花了不到七天. 你还听说, 这种鱼会一刻不停的抛出问题, 直到没谁能回答它, 随即就会被自己的知识噎死; 但现在看来, 它和普通的鱼没什么两样, 你甚至不确定它是否获得了智慧. 看来你得自己动手了】<br><br><center><<link "❖宰杀">><<if $item.has("玻璃瓶")>><<drop $fish "智慧鲑鱼" 1>><<pickup $item "智慧鲑鱼血" 1>><<run Dialog.setup("宰杀");Dialog.wiki("【1111】");Dialog.open();>><<else>><<run Dialog.setup("宰杀");Dialog.wiki("【你没有可供盛载的容器】");Dialog.open();>><</if>><</link>></center>',
}, [ "fishy"]);
Item.add("破损的柯尔特", {
    displayName: "破损的柯尔特",
    description: '【弹膛和枪筒内布满黑色尖刺的柯尔特左轮手枪, 无法填入子弹, 没用的废品】<br><br><center><<link "❖修复">><<run Dialog.setup("宰杀");Dialog.wiki("【1111】");Dialog.open();>><</link>></center>',
}, [ "enchanted"]);

/*仅描述的*/
Item.add("无", {displayName: "无", description: '//无, 没有, 不//', }, [ "none"]);
Item.add("幸运兔脚", {displayName: "幸运兔脚", description: '【由炭火和咒语制成, 包含着一个生灵的牺牲, 可以帮你逃脱一次厄运】', }, [ "enchanted", "escape", "物品"]);
Item.add("鹿角十字架", {displayName: "鹿角十字架", description: '【鹿角模样的十字架, 在本该十字交叉的上端延伸出了形状近似的鹿角, 握在手里十分有分量】', }, [ "bone", "物品"]);
Item.add("火漆印章", {displayName: "火漆印章", description: '【看上去似乎是使用银来制作的火漆印章，没有过多的装饰，看上去非常简便。只是印章的部分使用了非常复杂的花纹，看上去像是某种魔咒】', }, [ "cantlose", "物品"]);
Item.add("易拉罐", {displayName: "易拉罐", description: '【没用的东西，只有丢掉的份儿了】', }, [ "laji", "物品"]);
Item.add("石榴石", {displayName: "石榴石", description: '【拥有血液一般的色泽, 似乎随时都会燃烧起来】', }, [ "stone", "fuelS", "物品"]);
Item.add("猫眼石", {displayName: "猫眼石", description: '【名贵而稀有的宝石, 中央明亮的裂缝仿佛在注视着什么】', }, [ "stone", "eralove", "物品"]);
Item.add("蛋白石", {displayName: "蛋白石", description: '【细腻的手感怎么也摸不够】', }, [ "stone", "物品"]);
Item.add("灵魂", {displayName: "灵魂", description: '【不知为何, 灵魂在永无乡似乎没那么容易消散, 你甚至可以用容器去储存它, 但千万别带在身边】', }, [ "soul", "fuelS", "物品"]);
Item.add("没药", {displayName: "没药", description: '【太阳底下最好的香料】', }, [ "material", "fuelB", "食物"]);
Item.add("粉红色小卡片", {displayName: "粉红色小卡片", description: '【底色并非粉色的小小卡片，上面用明显到刺眼的字体写着天上人间这几个字，而底部则是写着联系方式，底图则是个漂亮的女性，躺在沙发上摆弄着姿势，将卡片翻到背面，你可以发现那是一个简易地图，重点标识了店面位置】', }, [ "cantlose", "fuelC", "物品"]);
Item.add("祷祝蜡烛", {displayName: "祷祝蜡烛", description: '【摆放在约柜四周的黑色蜡烛，散发出一种朦胧而哀伤的光芒，似乎不分昼夜的在燃烧着, 却不见有人来替换】', }, [ "flame", "物品"]);
Item.add("旅店钥匙", {displayName: "旅店钥匙", description: '【属于小镇的旅店里某一间房的钥匙, 上面写着<<=$bmon>><<=$bday>>号】', }, ["cantlose", "fuelD", "物品"]);
Item.add("鱼饵", {displayName: "鱼饵", description: '【】', }, [ "fishy", "bug", "物品"]);
Item.add("蜘蛛", {displayName: "蜘蛛", description: '【】', }, [ "bug", "fuelD", "物品"]);
Item.add("蚂蚁", {displayName: "蚂蚁", description: '【】', }, [ "bug", "fuelD", "物品"]);
Item.add("蛾子", {displayName: "蛾子", description: '【】', }, [ "bug", "fuelC", "物品"]);
Item.add("鱼骨", {displayName: "鱼骨", description: '【】', }, [ "bone", "猎物"]);
Item.add("布尔盖酒配方", {displayName: "布尔盖酒配方", description: '【】', }, [ "formula", "fuelC", "物品"]);
Item.add("五彩贝", {displayName: "五彩贝", description: '【】', }, [ "stone", "物品"]);
Item.add("玻璃瓶", {displayName: "玻璃瓶", description: '【】', }, [ "容器", "物品"]);
Item.add("信纸", {displayName: "信纸", description: '【】', }, [ "物品"]);
Item.add("蜡烛", {displayName: "蜡烛", description: '【】', }, [ "物品"]);
Item.add("煤油灯", {displayName: "煤油灯", description: '【】', }, [ "物品"]);


/***鱼***/
Item.add("海鳌虾", {displayName: "海鳌虾", description: '【硕大的虾钳子保持着它的锋利，沉稳的重量让人感受到它的力量】', }, ["eralove", "fishy"]);
Item.add("龙虾", {displayName: "龙虾", description: '【离开海水的龙虾甲壳的光泽依旧鲜艳，触须微微卷曲】', }, ["eralike", "fishy"]);
Item.add("乌贼", {displayName: "乌贼", description: '【安静地躺在鱼篓中，柔软的身体随着动作微微晃动，隐隐透出一丝墨色】', }, ["fishy"]);
Item.add("鳗鱼", {displayName: "鳗鱼", description: '【狭长的身体滑腻蜷缩在鱼篓中，闪着黏湿的光泽】<br><br>〖鱼缸占据空间 2〗', }, ["鱼缸", "fishy"]);
Item.add("泥鳅", {displayName: "泥鳅", description: '【小巧灵活的泥鳅尾部微微摆动，似乎随时准备钻出鱼篓】<br><br>〖鱼缸占据空间 1〗', }, ["鱼缸", "fishy"]);
Item.add("欧鳊", {displayName: "欧鳊", description: '【鳞片的细密在微微反射着光，折射出淡淡的银光】<br><br>〖鱼缸占据空间 2〗', }, ["鱼缸", "fishy"]);
Item.add("黑鲈鱼", {displayName: "黑鲈鱼", description: '【厚实身躯充满力量，暗色的鳞片如黑夜般深邃】<br><br>〖鱼缸占据空间 2〗', }, ["鱼缸", "fishy", "食材"]);
Item.add("雅罗鱼", {displayName: "雅罗鱼", description: '【纤细轮廓透着柔和的光泽，宛如湖面映照的月光】<br><br>〖鱼缸占据空间 1〗', }, ["鱼缸", "fishy"]);
Item.add("鲤鱼", {displayName: "鲤鱼", description: '【硕大厚实，橙红色的鳞片在微光下依然醒目】<br><br>〖鱼缸占据空间 2〗', }, ["鱼缸", "fishy"]);
Item.add("虾虎鱼", {displayName: "虾虎鱼", description: '【虾虎鱼小巧灵活，身体紧贴着鱼篓，散发着淡淡的光泽】<br><br>〖鱼缸占据空间 1〗', }, ["鱼缸", "fishy"]);
Item.add("白鲑鱼", {displayName: "白鲑鱼", description: '【银白色鳞片在微光中闪耀，身形修长且充满力量】<br><br>〖鱼缸占据空间 2〗', }, ["鱼缸", "fishy", "食材"]);
Item.add("虹鳟鱼", {displayName: "虹鳟鱼", description: '【鳞片如彩虹般绚丽，色彩在背包中微微流动】<br><br>〖鱼缸占据空间 2〗', }, ["鱼缸", "fishy"]);
Item.add("鹦哥鱼", {displayName: "鹦哥鱼", description: '【像鹦鹉一样颜色艳丽, 仿佛海洋的活力凝聚于此】', }, ["fishy"]);
Item.add("红蝎鱼", {displayName: "红蝎鱼", description: '【刺状鳍微微张开，暗红色的身体透出一股危险的气息】', }, ["fishy"]);
Item.add("鲻鱼", {displayName: "鲻鱼", description: '【灰色身躯光滑且修长，鳞片紧密排列，泛着冷冽的光泽】', }, ["fishy"]);
Item.add("鳕鱼", {displayName: "鳕鱼", description: '【身形宽大而饱满, 能做出一顿美餐】', }, ["fishy", "食材"]);
Item.add("沙丁鱼", {displayName: "沙丁鱼", description: '【】', }, [ "fishy"]);
Item.add("比目鱼", {displayName: "比目鱼", description: '【】', }, ["fishy"]);
Item.add("凤尾鱼", {displayName: "凤尾鱼", description: '【】', }, [ "fishy"]);
Item.add("彩虹濑鱼", {displayName: "彩虹濑鱼", description: '【】', }, ["fishy"]);
Item.add("纹首鮨", {displayName: "纹首鮨", description: '【】', }, [ "fishy"]);
Item.add("鲱鱼", {displayName: "鲱鱼", description: '【】', }, ["fishy"]);
Item.add("蓝鳍金枪鱼", {displayName: "蓝鳍金枪鱼", description: '【】', }, [ "fishy"]);
Item.add("无须鳕鱼", {displayName: "无须鳕鱼", description: '【】', }, ["fishy"]);
Item.add("鲯鳅鱼", {displayName: "鲯鳅鱼", description: '【】', }, [ "fishy"]);
Item.add("大西洋狐鲣", {displayName: "大西洋狐鲣", description: '【】', }, ["fishy"]);
Item.add("军曹鱼", {displayName: "军曹鱼", description: '【】', }, [ "fishy"]);
Item.add("大比目鱼", {displayName: "大比目鱼", description: '【】', }, ["fishy"]);
/***消耗品***/
Item.add("羊奶", {displayName: "羊奶", description: "【新鲜的哺乳动物提取物】<br><br>〖食用后体力+2〗", handler: "<<set $HP += 2>>", consumable: true}, ["creamy", "食材"]);
Item.add("煎蛋", {displayName: "煎蛋", description: "【】<br><br>〖食用后体力+5〗", handler: "<<set $HP += 5>>", consumable: true}, ["meaty", "食材"]);
Item.add("柠香三文鱼", {displayName: "柠香三文鱼", description: "【】<br><br>〖食用后体力+15〗", handler: "<<set $HP += 15>>", consumable: true}, ["fishy"]);
Item.add("茄汁鲈鱼", {displayName: "茄汁鲈鱼", description: "【】<br><br>〖食用后体力+15〗", handler: "<<set $HP += 15>>", consumable: true}, ["fishy"]);
Item.add("蜂蜜柠檬水", {displayName: "蜂蜜柠檬水", description: "【】<br><br>〖食用后体力+7〗", handler: "<<set $HP += 7>>", consumable: true}, ["honey"]);
Item.add("土豆泥", {displayName: "土豆泥", description: "【】<br><br>〖食用后体力+3〗", handler: "<<set $HP += 3>>", consumable: true}, ["creamy", "食材"]);
Item.add("炸鱼薯条", {displayName: "炸鱼薯条", description: "【】<br><br>〖食用后体力+10〗", handler: "<<set $HP += 10>>", consumable: true}, ["fishy"]);
Item.add("鲜花饼", {displayName: "鲜花饼", description: "【】<br><br>〖食用后体力+8〗", handler: "<<set $HP += 8>>", consumable: true}, ["flower"]);
Item.add("奶油蘑菇汤", {displayName: "奶油蘑菇汤", description: "【】<br><br>〖食用后体力+12〗", handler: "<<set $HP += 12>>", consumable: true}, ["creamy"]);
Item.add("土豆蛋饼", {displayName: "土豆蛋饼", description: "【】<br><br>〖食用后体力+8〗", handler: "<<set $HP += 8>>", consumable: true}, ["meaty"]);
Item.add("番茄浓汤", {displayName: "番茄浓汤", description: "【】<br><br>〖食用后体力+8〗", handler: "<<set $HP += 8>>", consumable: true}, ["fruity"]);
Item.add("香蒜扇贝汤", {displayName: "香蒜扇贝汤", description: "【】<br><br>〖食用后体力+13〗", handler: "<<set $HP += 13>>", consumable: true}, ["fishy"]);
Item.add("红椒酿肉", {displayName: "红椒酿肉", description: "【】<br><br>〖食用后体力+12〗", handler: "<<set $HP += 12>>", consumable: true}, ["spicy"]);
Item.add("蘑菇鱼汤", {displayName: "蘑菇鱼汤", description: "【】<br><br>〖食用后体力+15〗", handler: "<<set $HP += 15>>", consumable: true}, ["fishy"]);
Item.add("苏格兰汤", {displayName: "苏格兰汤", description: "【】<br><br>〖食用后体力+16〗", handler: "<<set $HP += 16>>", consumable: true}, ["fishy"]);
Item.add("渔夫派", {displayName: "渔夫派", description: "【】<br><br>〖食用后体力+12〗", handler: "<<set $HP += 12>>", consumable: true}, ["fishy"]);
Item.add("羊倌派", {displayName: "羊倌派", description: "【】<br><br>〖食用后体力+12〗", handler: "<<set $HP += 12>>", consumable: true}, ["meaty"]);


Item.add("巧克力棒", {displayName: "巧克力棒", description: "【】", handler:"<<set $HP to $HP+ 4>>", consumable: true}, ["食材", "食物"]);
Item.add("熏肉干", {displayName: "熏肉干", description: "【】", handler:"<<set $HP to $HP+ 8>>", consumable: true}, ["食物"]);
Item.add("鱼肉", {displayName: "鱼肉", description: "【来自新鲜的鱼! 使用后获得鱼油  * 2】", handler:"<<pickup $item '鱼油' 2>>", consumable: true}, ["fishy", "食材"]);
Item.add("意式浓缩", {displayName: "意式浓缩", description: "【一杯快速的意式浓缩能让你在工作前提起精神】<br><br>〖使用后体力+8〗", handler:  "<<set $HP to $HP+ 8, $coffin+=1>>" , consumable: true}, ["coffee", "食物"]);
Item.add("榛子咖啡", {displayName: "榛子咖啡", description: "【】<br><br>〖使用后体力+10 学识点数+1〗", handler: "<<run Dialog.setup('饮用榛子咖啡');Dialog.wiki('【使用描述】');Dialog.open();>><<set $HP +=10, $knowledgeexp +=1, $coffin+=1>><<addkexpWidget>>", consumable: true}, ["coffee"]);
Item.add("苹果派", {displayName: "苹果派", description: "【多汁可口的馅料让你感到满足. 苹果派是最伟大的发明】<br><br>〖使用后体力+7〗", handler:  "<<set $HP += 7>>" , consumable: true}, [ "pie", "sweet"]);
Item.add("浆果馅饼", {displayName: "浆果馅饼", description: "【多汁可口的馅料让你感到满足. 浆果馅饼是最伟大的发明】<br><br>〖使用后体力+7〗", handler:  "<<set $HP += 7>>" , consumable: true}, [ "pie", "sweet"]);
Item.add("烤鸡腿", {displayName: "烤鸡腿", description: "【】<br><br>〖使用后体力+8〗", handler:  "<<set $HP to $HP+ 8>>" , consumable: true}, ["meaty"]);
Item.add("蜂蜜", {displayName: "蜂蜜", description: "【】<br><br>〖使用后体力+1〗", handler:  "<<set $HP += 1, $san +=2>>" , consumable: true}, ["honey", "食材", "食物"]);
Item.add("红茶", {displayName: "红茶", description: "【】<br><br>〖使用后体力+2〗", handler:  "<<set $HP += 2>>" , consumable: true}, [ "tea", "食物"]);
Item.add("果汁", {displayName: "果汁", description: "【一杯有些温暖的果汁。口味酸甜，也许你能从中闻到些太阳的香气】<br><br>〖使用后体力+2〗", handler:  "<<set $HP += 2>>" , consumable: true}, ["fruity", "sweet", "食物"]);
Item.add("朗姆葡萄酥卷", {displayName: "朗姆葡萄酥卷", description: "【老板娘亲手做的小点心，浸过朗姆酒的葡萄干带着淡淡的酒香味】<br><br>〖使用后体力+6〗", handler:  "<<set $HP += 6>>" , consumable: true}, ["sweet", "食物"]);
Item.add("黑巧小蛋糕", {displayName: "黑巧小蛋糕", description: "【】<br><br>〖使用后体力+4〗", handler:  "<<set $HP += 4>>" , consumable: true}, [ "sweet"]);
Item.add("浆果", {displayName: "浆果", description: "【】<br><br>〖使用后体力+1〗", handler:  "<<set $HP += 1>>" , consumable: true}, ["fruity", "sweet", "seed", "食物"]);
Item.add("炸鱼", {displayName: "炸鱼", description: "【】<br><br>〖使用后体力+8〗", handler:  "<<set $HP += 8>>" , consumable: true}, ["fatty", "fishy", "食材", "食物"]);
Item.add("炸薯条", {displayName: "炸薯条", description: "【】<br><br>〖使用后体力+2〗", handler:  "<<set $HP += 2>>" , consumable: true}, [ "fatty", "食材"]);
Item.add("蜜酒", {displayName: "蜜酒", description: "【】<br><br>〖使用后体力+5〗", handler:  "<<set $HP += 5, $san += 2, $drunk+=3>>" , consumable: true}, ["酒", "honey", "食材", "sweet", "食物"]);
Item.add("黑麦啤酒", {displayName: "黑麦啤酒", description: "【】<br><br>〖使用后体力+6〗", handler:  "<<set $HP += 6, $drunk+=2>>" , consumable: true}, [ "酒", "eralike", "食材", "食物"]);
Item.add("朗姆酒", {displayName: "朗姆酒", description: "【】<br><br>〖使用后体力+3〗", handler:  "<<set $HP += 3, $drunk+=1>>" , consumable: true}, [  "酒", "eralove", "食材", "食物"]);
Item.add("蜜蜂的膝盖", {displayName: "蜜蜂的膝盖", description: "【】<br><br>〖使用后体力+8〗", handler:  "<<set $HP += 8, $san += 3, $drunk+=3>>" , consumable: true}, ["酒", "honey", "sweet", "食物"]);
Item.add("颂歌蜜酒", {displayName: "颂歌蜜酒", description: "【】<br><br>〖使用后体力+6〗", handler:  "<<set $HP += 6, $drunk+=6>>" , consumable: true}, ["酒", "honey"]);
Item.add("柿子酒", {displayName: "柿子酒", description: "【乌黑醇香的家酿酒, 似乎是永无乡上的特产, 几乎每家每户都会在家中准备上这些口感甘甜的果酒, 也是赠礼的最佳选择】", handler:  "<<run Dialog.setup('饮用柿子酒');Dialog.wiki('【有什么近似梦幻的东西滑进了你的嘴里, 然后是你的喉咙, 接着, 这种温暖而美妙的感觉扩散至了你的每一处知觉. 所有的悲痛, 所有的不幸, 似乎都已被这果酒洗刷. 等酒效过去, 你又回到了那个满是烦恼的世界】');Dialog.open();>><<set $lotus to $lotus+ 1>><<if $lotus <= 24>><<set $san to $san+ 25>><<elseif $lotus <= 72>><<set $san to $san+ 15>><<elseif $lotus <= 144>><<set $san to $san+ 5>><<elseif $lotus >= 241 && $lotus <=360>><<set $san to $san- 5>><<elseif $lotus <=666>><<set $san to $san- 10>><</if>>" , consumable: true}, [  "酒"]);
/***材料***/
Item.add("黑蜂蜂蜜", {displayName: "黑蜂蜂蜜", description: "【在别处你可见不到如此纯粹的蜂蜜, 盛起来时宛如流动的黄金, 可当你试着去享用它, 尝起来就像来自地狱的诅咒, 满是死亡的味道】", }, ["honey", "bitter", "食材"]);
Item.add("鱼油", {displayName: "鱼油", }, ["oily", "fishy", "食材"]);
Item.add("禽肉", {displayName: "禽肉", }, [ "食材"]);
Item.add("兽肉", {displayName: "兽肉", }, [ "食材"]);
Item.add("鸟蛋", {displayName: "鸟蛋", }, [ "食材"]);
Item.add("蘑菇", {displayName: "蘑菇", }, [ "食材", "seed"]);
Item.add("柠檬", {displayName: "柠檬", }, [ "食材"]);
Item.add("土豆", {displayName: "土豆", }, [ "食材"]);
Item.add("面粉", {displayName: "面粉", }, [ "食材"]);
Item.add("黄油", {displayName: "黄油", }, [ "食材"]);
Item.add("方糖", {displayName: "砂盐", }, [ "食材", "食物"]);
Item.add("砂盐", {displayName: "砂盐", }, [ "食材", "食物"]);
Item.add("洋葱", {displayName: "洋葱", }, [ "食材"]);
Item.add("番茄", {displayName: "番茄", }, [ "食材"]);
Item.add("辣椒", {displayName: "辣椒", }, [ "食材"]);
Item.add("大蒜", {displayName: "大蒜", }, [ "食材"]);
Item.add("白酱", {displayName: "白酱", }, [ "食材"]);
Item.add("甜菜", {displayName: "甜菜", }, [ "食材"]);
Item.add("玉米", {displayName: "玉米", }, [ "食材"]);
Item.add("胡萝卜", {displayName: "胡萝卜", }, [ "食材"]);
Item.add("欧芹", {displayName: "欧芹", }, [ "食材"]);
Item.add("葡萄", {displayName: "葡萄", }, [ "酿酒", "fruity"]);

Item.add("羊绒", {displayName: "羊绒", }, [ "制作"]);
Item.add("兔皮", {displayName: "兔皮", }, ["制作", "leather"]);
Item.add("鹿皮", {displayName: "鹿皮", }, [ "制作", "leather"]);
Item.add("鼬皮", {displayName: "鼬皮", }, [ "制作", "leather"]);
/***植物***/
Item.add("蒲公英种子", {displayName: "蒲公英种子", description: "【小小的种子似乎随时会被吹走】<br><br>〖可在田圃里种植〗", }, ["seed", "物品"]);
Item.add("玫瑰花种子", {displayName: "玫瑰花种子", description: "【干瘪的种子不知道会开出什么样的花】<br><br>〖可在田圃里种植〗", }, ["seed", "物品"]);
Item.add("向日葵种子", {displayName: "向日葵种子", description: "【饱满的种子看着可以食用的样子】<br><br>〖可在田圃里种植〗", }, ["seed", "物品"]);
Item.add("牡丹花种子", {displayName: "牡丹花种子", description: "【】<br><br>〖可在田圃里种植〗", }, ["seed", "物品"]);
Item.add("勿忘我种子", {displayName: "勿忘我种子", description: "【】<br><br>〖可在田圃里种植〗", }, ["seed", "物品"]);
Item.add("金盏花种子", {displayName: "金盏花种子", description: "【】<br><br>〖可在田圃里种植〗", }, ["seed", "物品"]);
Item.add("紫罗兰种子", {displayName: "紫罗兰种子", description: "【】<br><br>〖可在田圃里种植〗", }, ["seed", "物品"]);
Item.add("附子花种子", {displayName: "附子花种子", description: "【】<br><br>〖可在田圃里种植〗", }, ["seed", "物品"]);
Item.add("鸢尾花种子", {displayName: "鸢尾花种子", description: "【】<br><br>〖可在田圃里种植〗", }, ["seed", "物品"]);
Item.add("土豆种子", {displayName: "土豆种子", description: "【】<br><br>〖可在田圃里种植〗", }, ["seed", "物品"]);
Item.add("洋葱种子", {displayName: "洋葱种子", description: "【】<br><br>〖可在田圃里种植〗", }, ["seed", "物品"]);
Item.add("辣椒种子", {displayName: "辣椒种子", description: "【】<br><br>〖可在田圃里种植〗", }, ["seed", "物品"]);
Item.add("胡萝卜种子", {displayName: "胡萝卜种子", description: "【】<br><br>〖可在田圃里种植〗", }, ["seed", "物品"]);
Item.add("玉米种子", {displayName: "玉米种子", description: "【】<br><br>〖可在田圃里种植〗", }, ["seed", "物品"]);
Item.add("甜菜种子", {displayName: "甜菜种子", description: "【】<br><br>〖可在田圃里种植〗", }, ["seed", "物品"]);
Item.add("番茄种子", {displayName: "番茄种子", description: "【】<br><br>〖可在田圃里种植〗", }, ["seed", "物品"]);
Item.add("欧芹种子", {displayName: "欧芹种子", description: "【】<br><br>〖可在田圃里种植〗", }, ["seed", "物品"]);
Item.add("葡萄种子", {displayName: "葡萄种子", description: "【】<br><br>〖可在田圃里种植〗", }, ["seed", "物品"]);
Item.add("玫瑰花", {displayName: "玫瑰花", },  ["flower"]);
Item.add("鸢尾花", {displayName: "鸢尾花", },  ["flower"]);
Item.add("红玫瑰", {displayName: "红玫瑰", description: "【岛上随处可见野玫瑰, 但这不代表她们没有主人. 而这朵, 不可置疑的, 属于你】", }, ["rose", "flower", "物品"]);
Item.add("白玫瑰", {displayName: "白玫瑰", description: "【岛上随处可见野玫瑰, 但这不代表她们没有主人. 而这朵, 不可置疑的, 属于你】", }, ["rose", "flower", "物品"]);
Item.add("蓝玫瑰", {displayName: "蓝玫瑰", description: "【岛上随处可见野玫瑰, 但这不代表她们没有主人. 而这朵, 不可置疑的, 属于你】", }, ["rose", "flower", "物品"]);
Item.add("黄玫瑰", {displayName: "黄玫瑰", description: "【岛上随处可见野玫瑰, 但这不代表她们没有主人. 而这朵, 不可置疑的, 属于你】", }, ["rose", "flower", "物品"]);
Item.add("黑玫瑰", {displayName: "黑玫瑰", description: "【岛上随处可见野玫瑰, 但这不代表她们没有主人. 而这朵, 不可置疑的, 属于你】", }, ["rose", "flower", "物品"]);
Item.add("紫玫瑰", {displayName: "紫玫瑰", description: "【岛上随处可见野玫瑰, 但这不代表她们没有主人. 而这朵, 不可置疑的, 属于你】", }, ["rose", "flower", "物品"]);
Item.add("粉玫瑰", {displayName: "粉玫瑰", description: "【岛上随处可见野玫瑰, 但这不代表她们没有主人. 而这朵, 不可置疑的, 属于你】", }, ["rose", "flower", "物品"]);
Item.add("蒲公英", {displayName: "蒲公英", description: "【蓬松的模样随时准备着启航, 也许它能将你的心愿带去远方】", }, [ "flower", "物品"]);
Item.add("附子花", {displayName: "附子花", description: "【即使作为毒剂在历史与故事中臭名昭著, 附子仍是一种美丽的花. 在永无乡上没有花不会被欢迎】", }, [ "flower", "物品"]);
Item.add("藜芦花", {displayName: "藜芦花", description: "【冬季点饰花园的最佳选择之一, 除开可爱的外表, 还十分有药用价值】", }, [ "flower", "物品"]);
Item.add("牡丹花", {displayName: "牡丹花", description: "【华美、艳丽, 这样的花朵即使只是欣赏着似乎都能将你从精神的痛苦中解救出来】", }, [ "flower", "物品"]);
Item.add("白鹭兰", {displayName: "白鹭兰", description: "【很适合居家摆放的盆栽, 盛开时就如同一群展翅高飞的白鹭】", }, [ "flower", "物品"]);
Item.add("紫罗兰", {displayName: "紫罗兰", description: "【小小的, 不起眼的紫色小花, 丛丛簇簇的开满山野, 也许这就是爱在万物前的模样】", }, [ "flower", "物品"]);
Item.add("向日葵", {displayName: "向日葵", description: "【是否会有一朵向日葵后悔自己没有追随太阳?】", }, [ "flower"]);
Item.add("勿忘我", {displayName: "勿忘我", description: "【遗憾的是在这里它还没有那么多情感上的含义, 作为随处可见的蓝色小花, 它们也么那么容易被忘记】", }, [ "flower", "物品"]);
Item.add("风信子", {displayName: "风信子", description: "【夜晚的时候, 寒冷的时候, 风信子会带来光明, 与寂静】", }, [ "flower", "物品"]);
Item.add("金色鸢尾", {displayName: "金色鸢尾", description: "【彩虹是由鸢尾花铺成? 你很确定你从没听过这种说法, 很明显也没有任何文字记载过这些】", }, [ "flower", "物品"]);
Item.add("青色鸢尾", {displayName: "金色鸢尾", description: "【彩虹是由鸢尾花铺成? 你很确定你从没听过这种说法, 很明显也没有任何文字记载过这些】", }, [ "flower", "物品"]);
Item.add("橙色鸢尾", {displayName: "金色鸢尾", description: "【彩虹是由鸢尾花铺成? 你很确定你从没听过这种说法, 很明显也没有任何文字记载过这些】", }, [ "flower", "物品"]);
Item.add("红色鸢尾", {displayName: "金色鸢尾", description: "【彩虹是由鸢尾花铺成? 你很确定你从没听过这种说法, 很明显也没有任何文字记载过这些】", }, [ "flower", "物品"]);
Item.add("绿色鸢尾", {displayName: "金色鸢尾", description: "【彩虹是由鸢尾花铺成? 你很确定你从没听过这种说法, 很明显也没有任何文字记载过这些】", }, [ "flower", "物品"]);
Item.add("紫色鸢尾", {displayName: "金色鸢尾", description: "【彩虹是由鸢尾花铺成? 你很确定你从没听过这种说法, 很明显也没有任何文字记载过这些】", }, [ "flower", "物品"]);
Item.add("蓝色鸢尾", {displayName: "金色鸢尾", description: "【彩虹是由鸢尾花铺成? 你很确定你从没听过这种说法, 很明显也没有任何文字记载过这些】", }, [ "flower", "物品"]);
/*------------------------任务---------------------------*/
/*主线*/
Item.add("新的开始", {
    displayName: "新的开始",
    description: '//你踏上了永无乡, 成为了她的新居民, 但是接下来呢? 你会选择什么样的生活?//<br><font color=#fff>⋙⋙⋙⋙⋙⋙⋘⋘⋘⋘⋘⋘</font><br><<if $msstat == "新的开始1">>✎【领鸟羽】每日签到, 很简单, 三岁小孩都能做到, 我说的对吗, $nn?<<elseif $msstat == "新的开始2">>✔︎【领鸟羽】看来你已经完成了这项, 每天一次的免费鸟羽, 换在别的地方哪有这种美事<br>✎【赚一些鸟羽】不要去折磨那些可怜的鸟儿, 我们不用他们的羽毛. 鸟羽是永无乡上的货币, 和其他硬币别无一二, 喏, 我刚给你的就是. 你可以用它买到这个岛上的许多东西, 当然也有它买不到的东西, 现在还不是说这些的时候<br>至于该怎么挣钱, 你随时可以来询问我「赚钱指南」, 别担心这不收费, 但你要真心想感谢我, 一些点心不算过分吧?<br>〖获得200鸟羽以完成此项〗<<elseif $msstat == "新的开始3">>✔︎【领鸟羽】看来你已经完成了这项, 每天一次的免费鸟羽, 换在别的地方哪有这种美事<br>✔︎【赚一些鸟羽】没那么难, 是吧? 我们可是费劲了心思让你不那么容易变成穷光蛋. 指南不定时会更新, 记得多看看<br>✎【做一些服装】你看起来轻飘飘的, 就好像...什么也没穿. 服装不仅是装饰品, 它们还能给你提供属性加成. 你可以去玛丽亚的店里买一件, 但我更推荐自己做一件, 毕竟这才是任务安排. 去小镇的工坊那儿做件皮毛大衣吧, 然后我们都能清净了<br><</if>><font color=#fff>⋙⋙⋙⋙⋙⋙⋘⋘⋘⋘⋘⋘</font>',
}, ["主线"]);

Item.add("【已完成】新的开始", {
    displayName: "【已完成】新的开始",
    description: '✔︎【领鸟羽】看来你已经完成了这项, 每天一次的免费鸟羽, 换在别的地方哪有这种美事<br>✔︎【赚一些鸟羽】没那么难, 是吧? 我们可是费劲了心思让你不那么容易变成穷光蛋. 指南不定时会更新, 记得多看看<br>✔︎【做一些服装】终于结束了',
}, ["已完成"]);

/*支线*/
Item.add("点心代送", {
    displayName: "点心代送",
    description: '//帮咖啡店的老板娘送出四盒点心//<br>⋙⋙⋙⋙⋙⋙⋘⋘⋘⋘⋘⋘<br><<if $dxdsstat == 4>>✎【第一盒】第一盒点心的纸条上写着: Parrome, 小镇的医院, 他基本上不会离开医院<<elseif $dxdsstat == 3>>✔︎【第一盒】已完成<br>✎【第二盒】第二盒点心的纸条上写着: Era, 草甸, 如果不在就去酒馆或者礁岩区看看<<elseif $dxdsstat == 2>>✔︎【第一盒】已完成<br>✔︎【第二盒】已完成<br>✎【第三盒】第三盒点心的纸条上写着: Tret, 副港口的鱼铺, 如果不在就去沙地散步看看<<elseif $dxdsstat == 1>>✔︎【第一盒】已完成<br>✔︎【第二盒】已完成<br>✔︎【第三盒】已完成<br>✎【第四盒】最后一盒感觉要比其他的都重得多, 纸条上写着: Otis, 小镇的图书馆, 如果图书馆关门了, 试试说一声"点心代送"<<elseif $dxdsstat == 0>>✔︎【第一盒】已完成<br>✔︎【第二盒】已完成<br>✔︎【第三盒】已完成<br>✔︎【第四盒】已完成<br>【回咖啡店告诉老板娘吧】<</if>><br>⋙⋙⋙⋙⋙⋙⋘⋘⋘⋘⋘⋘',
}, ["已完成"]);

/*成就*/
window.defineAchievement("beginning", "新的篇章", "你成为了永无乡的新居民", "⭐", "永无乡岛志", "写下你的第一页吧");


window.defineAchievement("coffin", "梦境税收", "现在你终于有时间去数清星星上的针脚了", "⭐", "密契茶会", "当第六杯黑潮漫入喉间，你听见瓷杯底传来铁链拖拽声");
window.defineAchievement("lotus", "永无忧愁", "白日悠长, 黑夜凄冷, 你的时间, 两者皆无. 你属于蜡烛与玫瑰环绕的永无乡, 在那里, 你永无忧愁", "⭐", "密契茶会", "洗刷灵魂, 忘却烦恼");
window.defineAchievement("bugs", "甲壳杀手", "碾碎甲壳的脆响是对你的勇猛最响亮的掌声", "⭐", "密契茶会");
window.defineAchievement("Tolaaite", "错误的胃口", "也许有一天你会成为它们的美餐, 但不是现在", "⭐", "密契茶会");
window.defineAchievement("lostsheep", "迷途羔羊", "你已经上了五十余个国家的羊倌禁止名单了", "⭐", "密契茶会");



window.defineAchievement("fish", "潮渊尽处", "1111", "⭐", "琥珀窖藏");
window.defineAchievement("hunt", "狂猎敕令", "2222", "⭐", "琥珀窖藏" );</script><tw-tag name="noreturn" color="red"></tw-tag><tw-tag name="widget" color="orange"></tw-tag><tw-tag name="nobr" color="yellow"></tw-tag><tw-tag name="autosave" color="blue"></tw-tag><tw-tag name="init" color="green"></tw-tag><tw-tag name="UIBarhide" color="green"></tw-tag><tw-passagedata pid="1" name="LSS马场" tags="nobr" position="700,300" size="100,100">&lt;&lt;if $loc != &quot;LSS马场&quot;&gt;&gt;&lt;&lt;set $minute += random(2,5)&gt;&gt;&lt;&lt;set $loc = &quot;LSS马场&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;//马场占据着草甸最平坦的一块土地, 规划出了一片足够让马匹驰骋的赛道. 在没有比赛的日子, 马场经理诺姆先生会在附近的草地上放牧马群. 你看到马厩的标语上写着&quot;欢迎来到LSS! 我们将在每个礼拜四为大家带来岛上最为精彩的赛马比赛! &quot;//&lt;br&gt;&lt;br&gt;

✧「查询赛事」&lt;br&gt;
✧「下注」 &lt;br&gt;&lt;br&gt;

&lt;&lt;link ▷「离开」 草甸&gt;&gt;&lt;&lt;/link&gt;&gt;</tw-passagedata><tw-passagedata pid="2" name="NPC" tags="nobr" position="1300,0" size="100,100">&lt;&lt;if $npc == &quot;Era&quot;&gt;&gt;&lt;div id=&quot;idcard&quot;&gt;
&lt;table style=&quot;width:100%; border-style: none;&quot;&gt;
&lt;tbody align=&quot;center&quot;&gt;
  &lt;tr&gt;&lt;td rowspan=7 style=&quot;width:60%&quot;&gt;&lt;img src=&quot;https://f2.toyhou.se/file/f2-toyhou-se/images/95498951_qB9XiZ5yT88KHqA.png&quot; width=100% class=&quot;pic&quot;&gt;&lt;/td&gt;&lt;/tr&gt;
  &lt;tr&gt;&lt;td&gt;Era&lt;/td&gt;&lt;/tr&gt;
    &lt;tr&gt;&lt;td&gt;年龄：27&lt;/td&gt;&lt;/tr&gt;
  &lt;tr&gt;&lt;td&gt;来自：西班牙&lt;/td&gt;&lt;/tr&gt;
  &lt;tr&gt;&lt;td&gt;身份：船长&lt;/td&gt;&lt;/tr&gt;
  &lt;tr&gt;&lt;td&gt;住所：草甸&lt;/td&gt;&lt;/tr&gt;
  &lt;tr&gt;&lt;td&gt;工作：羊倌&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/div&gt;
&lt;br&gt;&lt;div id=&quot;chatextcard&quot;&gt;&lt;center&gt;◄ ✻ ✻ ✻ ✻ ✻ ✻ ✻ ✻ ✻ ►&lt;/center&gt;&lt;br&gt;
 永无乡上唯一的羊倌, 话语间充斥着他曾经真假难辨的海盗故事, 若有谁表现出感兴趣, 便能兴致勃勃的讲上一个钟头. 似乎很早就来到了岛上, 日复一日的在草甸上放着羊, 也许这就是他怀念岛外生活的原因? 
&lt;br&gt;&lt;br&gt;&lt;br&gt;
&lt;&lt;link ◈交谈 交谈&gt;&gt;&lt;&lt;dialogclose&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;br&gt;
&lt;&lt;link ◈赠送&gt;&gt;&lt;&lt;if $eragift ==0&gt;&gt;&lt;&lt;run Dialog.setup(&quot;赠送&quot;); Dialog.wiki(&quot;【Era今天已经接受过你的礼物了】&quot;); Dialog.open();&gt;&gt;
&lt;&lt;else&gt;&gt;&lt;&lt;run
  Dialog.setup(Story.get(&quot;物品选项&quot;).processText());
  Dialog.wiki(Story.get(&quot;赠送&quot;).processText());
  Dialog.open();
&gt;&gt;&lt;&lt;/if&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;br&gt;
&lt;&lt;if $loc == &quot;草甸&quot;&gt;&gt;&lt;&lt;link ◈放羊-⏳01：00 era互动&gt;&gt;&lt;&lt;set $choice = &quot;放羊&quot;, $npc to 0&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;br&gt;&lt;&lt;/if&gt;&gt;
&lt;&lt;if $erahgd &gt;= 16 &amp;&amp; $erahgd &lt;= 85&gt;&gt;&lt;&lt;link ✧讲个故事 era互动&gt;&gt;&lt;&lt;set $choice = &quot;讲个故事&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;br&gt;&lt;&lt;/if&gt;&gt;
&lt;&lt;if $erahgd &gt;= 86 &amp;&amp; $erahgd &lt;= 99&gt;&gt;&lt;&lt;link ✧造船 era互动&gt;&gt;&lt;&lt;set $choice = &quot;造船&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;br&gt;&lt;&lt;/if&gt;&gt;
&lt;&lt;if $dxdsstat == 3&gt;&gt;&lt;&lt;link ✧点心代送 支线选项&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;br&gt;&lt;&lt;/if&gt;&gt;&lt;/div&gt;&lt;&lt;/if&gt;&gt;

&lt;&lt;if $npc == &quot;奥里&quot;&gt;&gt;&lt;if !$erahgd&gt;&gt;&lt;&lt;set $erahgd = 0&gt;&gt;
&lt;table style=&quot;width:100%&quot;&gt;&lt;tbody align=&quot;left&quot;&gt;
&lt;tr&gt;&lt;td colspan=2&gt;姓名: Orionis Stella&lt;/td&gt;&lt;/tr&gt;
&lt;tr&gt;&lt;td style=&quot;width:50%&quot;&gt;年龄: 18&lt;/td&gt;&lt;td style=&quot;width:50%&quot;&gt;来自: 墨西哥&lt;/td&gt;&lt;/tr&gt;
&lt;tr&gt;&lt;td colspan=2&gt;住所: 副港口灯塔房&lt;/td&gt;&lt;/tr&gt;
&lt;tr&gt;&lt;td style=&quot;width:50%&quot;&gt;身份: 信者&lt;/td&gt;&lt;td style=&quot;width:50%&quot;&gt;工作: 邮递员&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;br&gt;
◅ ✻ ✻ ✻ ✻ ✻ ✻ ✻ ✻ ✻ ▻&lt;br&gt;
刚来到此处不久的猫族，似乎总是处于寻找着什么的模样。接受了邮递员的工作后很快就融入了永无乡，成为了看不出差异的一份子。但，似乎总是能在热闹地带找到她……？&lt;br&gt;
◅ ✻ ✻ ✻ ✻ ✻ ✻ ✻ ✻ ✻ ▻&lt;br&gt;
&lt;br&gt;
&lt;&lt;link ✧交谈 交谈&gt;&gt;&lt;&lt;dialogclose&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;br&gt;
[[✧送信|送信]]&lt;br&gt;
&lt;&lt;if $orihgd &gt;= 0 &amp;&amp; $orihgd &lt;= 80&gt;&gt;&lt;&lt;link ✧赠送&gt;&gt;&lt;&lt;if $origift ==0&gt;&gt;&lt;&lt;run Dialog.setup(赠送).processText()); Dialog.wiki(&quot;【奥里今天已经接受过你的礼物了】&quot;); Dialog.open();&gt;&gt;
&lt;&lt;else&gt;&gt;&lt;&lt;run Dialog.setup(Story.get(&quot;物品选项&quot;).processText()); Dialog.wiki(Story.get(&quot;赠送&quot;).processText()); Dialog.open();&gt;&gt;&lt;&lt;/if&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;br&gt;&lt;&lt;/if&gt;&gt;
&lt;br&gt;
&lt;&lt;if $orihgd &gt;= 0 &amp;&amp; $orihgd &lt;= 85&gt;&gt;[[✧帮帮我|奥里互动]]&lt;br&gt;&lt;&lt;/if&gt;&gt;
&lt;&lt;if $orihgd &gt;= 20 &amp;&amp; $orihgd &lt;= 29&gt;&gt;[[✧今日份乐子|奥里互动]]&lt;br&gt;&lt;&lt;/if&gt;&gt;
&lt;&lt;if $orihgd &gt;= 40 &amp;&amp; $orihgd &lt;= 49&gt;&gt;[[✧你的过去|奥里互动&lt;br&gt;&lt;&lt;/if&gt;&gt;
&lt;&lt;if $orihgd &gt;= 40 &amp;&amp; $orihgd &lt;= 49&gt;&gt;[[✧星空与桥|奥里互动&lt;br&gt;&lt;&lt;/if&gt;&gt;&lt;&lt;/if&gt;&gt;

&lt;&lt;if $npc == &quot;安德森&quot;&gt;&gt;
&lt;table style=&quot;width:100%&quot;&gt;&lt;tr&gt;&lt;td&gt;姓名: Andersen Monitor&lt;/td&gt;&lt;td&gt;年龄: 18&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;来自: 苏联&lt;/td&gt;&lt;td&gt;身份: 未知&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;住所: 罗索伦特湖&lt;/td&gt;&lt;td&gt;工作: 无&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;br&gt;
◅ ✻ ✻ ✻ ✻ ✻ ✻ ✻ ✻ ✻ ▻&lt;br&gt;
安德森看上去像是什么游戏或是小说里经典的神秘人——虽然他确实很神秘，但却不够经典。他几乎全身都被那个斗篷盖住，只有在他到处乱动时才能隐隐约约看到他的身体&lt;br&gt;
◅ ✻ ✻ ✻ ✻ ✻ ✻ ✻ ✻ ✻ ▻&lt;br&gt;
&lt;br&gt;
&lt;&lt;link ✧交谈 交谈&gt;&gt;&lt;&lt;dialogclose&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;br&gt;
✧赠送&lt;br&gt;✧给齿轮&lt;br&gt;&lt;&lt;/if&gt;&gt;

&lt;&lt;if $npc == &quot;琥珀夫人&quot;&gt;&gt;
&lt;table style=&quot;width:100%&quot;&gt;&lt;tbody align=&quot;left&quot;&gt;
&lt;tr&gt;&lt;td colspan=2&gt;姓名: Specia Amber&lt;/td&gt;&lt;/tr&gt;
&lt;tr&gt;&lt;td style=&quot;width:50%&quot;&gt;来自: 法国&lt;/td&gt;&lt;td style=&quot;width:50%&quot;&gt;工作: 酒馆老板&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;br&gt;
&lt;center&gt;◅ ✻ ✻ ✻ ✻ ✻ ✻ ✻ ✻ ✻ ▻&lt;/center&gt;&lt;br&gt;
琥珀夫人戴着一顶黑色软边宽檐帽，其上装饰着粉蓝两色丝带和翠鸟的翅膀。她的脸上总是挂着迷人的微笑。但可惜的是你无法一览这位美人的全貌——帽檐在她的脸上投下了深深的阴影，使你完全看不见她的双眼。你会好奇她有一双怎样的眼睛吗？&lt;br&gt;&lt;br&gt;
&lt;center&gt;◅ ✻ ✻ ✻ ✻ ✻ ✻ ✻ ✻ ✻ ▻&lt;/center&gt;
 &lt;div id=&quot;textcard&quot;&gt;&lt;&lt;link ✧交谈 交谈&gt;&gt;&lt;&lt;dialogclose&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;br&gt;
✧酿酒&lt;br&gt;
✧赠送&lt;br&gt;
✧特别的餐点&lt;/div&gt;&lt;&lt;/if&gt;&gt;

&lt;&lt;if $npc == &quot;琼&quot;&gt;&gt;
&lt;table style=&quot;width:100%&quot;&gt;&lt;tbody align=&quot;left&quot;&gt;
&lt;tr&gt;&lt;td colspan=2&gt;姓名: Joan Esposito&lt;/td&gt;&lt;/tr&gt;
&lt;tr&gt;&lt;td style=&quot;width:50%&quot;&gt;来自: 意大利&lt;/td&gt;&lt;td style=&quot;width:50%&quot;&gt;住所: 贝雷河&lt;/td&gt;&lt;/tr&gt;
&lt;tr&gt;&lt;td colspan=2&gt;工作: 主港口灯塔看守&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;br&gt;
  ◅ ✻ ✻ ✻ ✻ ✻ ✻ ✻ ✻ ✻ ▻&lt;br&gt;
  一个瘦瘦高高的男青年，蓬松的长卷发，深蓝色的大眼睛。身上常年披着白色的僧袍，由金腰带和肩扣固定在身上，一打眼看过去却像是什么也没穿。他有一条不太听话的大尾巴，时常从僧袍底下钻出来，扫他自己的蔷薇色的鼻尖&lt;br&gt;
  ◅ ✻ ✻ ✻ ✻ ✻ ✻ ✻ ✻ ✻ ▻&lt;br&gt;&lt;br&gt;
&lt;&lt;link ✧交谈 交谈&gt;&gt;&lt;&lt;dialogclose&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;br&gt;
[[✧提交鱼油|兑换]]&lt;br&gt;&lt;&lt;/if&gt;&gt;

&lt;&lt;if $npc == &quot;Otis&quot;&gt;&gt;
&lt;table style=&quot;width:100%&quot;&gt;&lt;tbody align=&quot;left&quot;&gt;
&lt;tr&gt;&lt;td style=&quot;width:50%&quot;&gt;姓名: Otis&lt;/td&gt;&lt;td style=&quot;width:50%&quot;&gt;年龄: 37&lt;/td&gt;&lt;/tr&gt;
&lt;tr&gt;&lt;td style=&quot;width:50%&quot;&gt;来自: 挪威&lt;/td&gt;&lt;td style=&quot;width:50%&quot;&gt;身份: 作家&lt;/td&gt;&lt;/tr&gt;
&lt;tr&gt;&lt;td colspan=2&gt;工作: 图书管理员&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;br&gt;
◅ ✻ ✻ ✻ ✻ ✻ ✻ ✻ ✻ ✻ ▻&lt;br&gt;
你从未见过Otis离开图书馆, 他仿佛只存于在那张小小的书桌后面, 日以继夜地写着他的小说, 也许某一天, 你能看到那个故事的结局&lt;br&gt;
  ◅ ✻ ✻ ✻ ✻ ✻ ✻ ✻ ✻ ✻ ▻&lt;br&gt;&lt;br&gt;
&lt;&lt;link ✧交谈 交谈&gt;&gt;&lt;&lt;dialogclose&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;br&gt;
✧借书
&lt;&lt;if $dxdsstat == 1&gt;&gt;&lt;br&gt;&lt;&lt;link ✧点心代送 支线选项&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;&lt;/if&gt;&gt;&lt;&lt;/if&gt;&gt;

&lt;&lt;if $npc == &quot;佩罗大夫&quot;&gt;&gt;
&lt;table style=&quot;width:100%&quot;&gt;&lt;tbody align=&quot;left&quot;&gt;
&lt;tr&gt;&lt;td colspan=2&gt;姓名: Perramo T. M. Colina&lt;/td&gt;&lt;/tr&gt;
&lt;tr&gt;&lt;td style=&quot;width:50%&quot;&gt;年龄: 56&lt;/td&gt;&lt;td style=&quot;width:50%&quot;&gt;来自: 哥伦比亚&lt;/td&gt;&lt;/tr&gt;
&lt;tr&gt;&lt;td style=&quot;width:50%&quot;&gt;身份: 大夫&lt;/td&gt;&lt;td style=&quot;width:50%&quot;&gt;工作: 医院&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;br&gt;
◅ ✻ ✻ ✻ ✻ ✻ ✻ ✻ ✻ ✻ ▻&lt;br&gt;
即使岛主为他在小镇的街口安排了一间带有田地的平房, 佩罗大夫更多时候是住在医院的. 他就在装有换气扇的那面墙旁挂起了吊床, 将药瓶稀稀散散地放上物架, 在书桌上摊开他不知要写给谁的空白信纸. 要问起来, 他的回答永远是: &quot;早晚的事&quot;&lt;br&gt;
◅ ✻ ✻ ✻ ✻ ✻ ✻ ✻ ✻ ✻ ▻&lt;br&gt;&lt;br&gt;
&lt;&lt;link ✧交谈 交谈&gt;&gt;&lt;&lt;dialogclose&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;br&gt;[[✧买药|买药]]&lt;br&gt;
&lt;&lt;if $dxdsstat == 4&gt;&gt;&lt;br&gt;&lt;&lt;link ✧点心代送 支线选项&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;&lt;/if&gt;&gt;&lt;&lt;/if&gt;&gt;

&lt;&lt;if $npc == &quot;萨巴夫人&quot;&gt;&gt;
&lt;table style=&quot;width:100%&quot;&gt;&lt;tbody align=&quot;left&quot;&gt;
&lt;tr&gt;&lt;td&gt;姓名: Nanibgal Nispa&lt;/td&gt;&lt;td&gt;年龄: 63&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;来自: 伊拉克王国&lt;/td&gt;&lt;td&gt;身份: 农学家&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;住所: 小镇&lt;/td&gt;&lt;td&gt;工作: 无&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;br&gt;
◅ ✻ ✻ ✻ ✻ ✻ ✻ ✻ ✻ ✻ ▻&lt;br&gt;
萨巴夫人已经老去, 她毕生掌握的智慧如今就像阳光下的泡沫, 但好在她仍熟稔各类作物的培育, 也很乐意在午后三点的时候和你分享她新抄写的诗&lt;br&gt;
◅ ✻ ✻ ✻ ✻ ✻ ✻ ✻ ✻ ✻ ▻&lt;br&gt;&lt;br&gt;
&lt;&lt;link ✧交谈 交谈&gt;&gt;&lt;&lt;dialogclose&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;br&gt;✧交换诗集&lt;&lt;/if&gt;&gt;

&lt;&lt;if $npc == &quot;Coni&quot;&gt;&gt;
&lt;table style=&quot;width:100%&quot;&gt;&lt;tr&gt;&lt;td&gt;姓名: Cinconejo Ahuia&lt;/td&gt;&lt;td&gt;年龄: 32&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;来自: 墨西哥&lt;/td&gt;&lt;td&gt;身份: 流浪汉&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;住所: 无&lt;/td&gt;&lt;td&gt;工作: 无&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;br&gt;
◅ ✻ ✻ ✻ ✻ ✻ ✻ ✻ ✻ ✻ ▻&lt;br&gt;
Coni——岛上几乎猫尽皆知的酒鬼, 赊账到琥珀夫人已经不再试图从他那儿要来酒钱, 还好心地给他提供了酒馆角落的桌椅当作夜晚栖身的地方. 没谁知道他是如何流浪到的永无乡, 岛主曾经给他供给过几次资助, 但一切物资到他手里都会被换成酒水, 仿佛那才是他的生命之源&lt;br&gt;
◅ ✻ ✻ ✻ ✻ ✻ ✻ ✻ ✻ ✻ ▻&lt;br&gt;&lt;br&gt;
&lt;&lt;link ✧交谈 交谈&gt;&gt;&lt;&lt;dialogclose&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;br&gt;✧布尔盖酒&lt;&lt;/if&gt;&gt;

&lt;&lt;if $npc == &quot;Tret&quot;&gt;&gt;
&lt;table style=&quot;width:100%&quot;&gt;&lt;tr&gt;&lt;td&gt;姓名: Tret&#39;yak Veselov&lt;/td&gt;&lt;td&gt;年龄: 53&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;来自: 苏俄&lt;/td&gt;&lt;td&gt;身份: 伤残老兵&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;住所: 副港口&lt;/td&gt;&lt;td&gt;工作: 渔夫&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;br&gt;
◅ ✻ ✻ ✻ ✻ ✻ ✻ ✻ ✻ ✻ ▻&lt;br&gt;
  一位饱经风霜的老猫, 岁月和战争都毫不吝啬的在他身上留下痕迹——他的右眼因战败而变得空洞, 另一只眼也因为年老覆上了白翳, 黑色的皮毛已渐渐泛白, 安着木制假肢的左腿让他再也不能自如的应对本该成为他归宿的大海, 如今的Tret只剩下他血脉里斯拉夫的威严, 和案板上待宰的鱼肉&lt;br&gt;
◅ ✻ ✻ ✻ ✻ ✻ ✻ ✻ ✻ ✻ ▻&lt;br&gt;&lt;br&gt;
&lt;&lt;link ✧交谈 交谈&gt;&gt;&lt;&lt;dialogclose&gt;&gt;&lt;&lt;/link&gt;&gt;
&lt;&lt;if $dxdsstat == 2&gt;&gt;&lt;br&gt;&lt;&lt;link ✧点心代送 支线选项&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;&lt;/if&gt;&gt;&lt;&lt;/if&gt;&gt;

&lt;&lt;if $npc == &quot;Daisy&quot;&gt;&gt;
◅ ✻ ✻ ✻ ✻ ✻ ✻ ✻ ✻ ✻ ▻&lt;br&gt;
皮肤黝黑的白发牧师。虽然每天总是笑眯眯地对待任何人，但那眼神深处所向往的是……？&lt;br&gt;
◅ ✻ ✻ ✻ ✻ ✻ ✻ ✻ ✻ ✻ ▻&lt;br&gt;&lt;br&gt;
&lt;&lt;link ✧交谈 交谈&gt;&gt;&lt;&lt;dialogclose&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;br&gt;
✧祈祷&lt;br&gt;
✧忏悔      
&lt;&lt;if _bjb != 1&gt;&gt;&lt;br&gt;&lt;&lt;link ❖领取物资&gt;&gt;&lt;&lt;goto &quot;补给包&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;&lt;/if&gt;&gt;&lt;&lt;/if&gt;&gt;

&lt;&lt;if $npc == &quot;玛丽亚小姐&quot;&gt;&gt;
◅ ✻ ✻ ✻ ✻ ✻ ✻ ✻ ✻ ✻ ▻&lt;br&gt;
一位时尚、优雅和精致的女士, 她的品味在永无乡上无人能及, 但你最好不要问起她和那些女孩的关系, 亦或是她的珠宝的来历, 只是享受她精心剪裁设计的服装就好, 那是猫族能穿上的最美的服装&lt;br&gt;
◅ ✻ ✻ ✻ ✻ ✻ ✻ ✻ ✻ ✻ ▻&lt;br&gt;&lt;br&gt;
&lt;&lt;link ✧交谈 交谈&gt;&gt;&lt;&lt;dialogclose&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;br&gt;   &lt;&lt;/if&gt;&gt;  

&lt;br&gt;&lt;br&gt;
&lt;div style=&quot;float: right;&quot;&gt;&lt;&lt;link ▷「离开」 $loc&gt;&gt;&lt;&lt;dialogclose&gt;&gt;&lt;&lt;set $npc to 0&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;/div&gt;</tw-passagedata><tw-passagedata pid="3" name="PassageFooter" tags="nobr" position="2025,200" size="100,100">&lt;br&gt;  &lt;br&gt;   &lt;br&gt;  &lt;br&gt;

 
 &lt;&lt;if !$orifirstc&gt;&gt;&lt;&lt;else&gt;&gt;&lt;div id=&quot;minisidebar&quot;&gt;
&lt;&lt;link &#39;&lt;i class=&quot;fa-solid fa-scroll&quot; style=&quot;font-size: 1.3em;&quot;&gt;&lt;/i&gt;&#39;&gt;&gt;&lt;&lt;run changemap(&quot;page1&quot;, &quot;stories&quot;)&gt;&gt;&lt;&lt;/link&gt;&gt;
&amp;emsp;
&lt;&lt;link &#39;&lt;i class=&quot;fa-solid fa-bag-shopping&quot; style=&quot;font-size: 1.3em;&quot;&gt;&lt;/i&gt;&#39;&gt;&gt;
 &lt;&lt;run changemap(&quot;page1&quot;, &quot;items&quot;)&gt;&gt;&lt;&lt;/link&gt;&gt;
&amp;emsp;
&lt;&lt;if $loc != &quot;白雾&quot;&gt;&gt;&lt;&lt;link &#39;&lt;i class=&quot;fa-solid fa-signs-post&quot; style=&quot;font-size: 1.3em;&quot;&gt;&lt;/i&gt;&#39;&gt;&gt;&lt;&lt;run
  Dialog.setup(&quot;永无乡地图&quot;);
  Dialog.wiki(Story.get(&quot;map&quot;).processText());
  Dialog.open();
&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;&lt;/if&gt;&gt;
&amp;emsp;
&lt;&lt;link &#39;&lt;i class=&quot;fa-duotone fa-solid fa-book-bookmark&quot; style=&quot;font-size: 1.3em;&quot;&gt;&lt;/i&gt;&#39;&gt;&gt; &lt;&lt;run changemap(&quot;page1&quot;, &quot;logs&quot;)&gt;&gt;&lt;&lt;/link&gt;&gt;
&amp;emsp;
&lt;&lt;link &#39;&lt;i class=&quot;fa-solid fa-hat-wizard&quot; style=&quot;font-size: 1.3em;&quot;&gt;&lt;/i&gt;&#39;&gt;&gt;&lt;&lt;run
  Dialog.setup(&quot;装备&quot;);
  Dialog.wiki(Story.get(&quot;装备栏&quot;).processText());
  Dialog.open();
&gt;&gt;&lt;&lt;/link&gt;&gt;
&amp;emsp;
&lt;&lt;link &#39;&lt;i class=&quot;fa-solid fa-feather-pointed&quot; style=&quot;font-size: 1.3em;&quot;&gt;&lt;/i&gt;&#39;&gt;&gt;&lt;&lt;run
   Dialog.setup(&quot;Seisinofoaga&quot;);
  Dialog.wiki(Story.get(&quot;seisi&quot;).processText());
  Dialog.open();
&gt;&gt;&lt;&lt;/link&gt;&gt;
 &lt;/div&gt;&lt;&lt;/if&gt;&gt;
 
&lt;&lt;if $drunk &gt;=66&gt;&gt; &lt;&lt;set _progress7 to $drunk/6&gt;&gt;
&lt;div id=&quot;drunk&quot; @style=&quot; &#39;backdrop-filter:blur(&#39; +_progress7+&#39;px);&#39; &quot;&gt;&lt;/div&gt;&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="4" name="PassageHeader" tags="" position="2125,200" size="100,100"></tw-passagedata><tw-passagedata pid="5" name="PassageReady" tags="" position="2025,300" size="100,100">/*数据同步*/
&lt;&lt;if $test !=1013&gt;&gt;&lt;&lt;pickup $coffee &quot;黑巧小蛋糕&quot; 1 &quot;意式浓缩&quot; 1 &quot;蜂蜜鲜奶&quot; 1 &quot;朗姆葡萄酥卷&quot; 1 &quot;蓝山咖啡&quot; 1 &quot;朗姆冰淇淋&quot; 1 &quot;羊角面包&quot; 1 &quot;芝士三明治&quot; 1 &quot;阿芙加朵&quot; 1 &quot;摩卡&quot; 1 &quot;红茶&quot; 1 &quot;卡布奇诺&quot; 1&gt;&gt;
&lt;&lt;drop $coffee &quot;蜂蜜牛奶&quot; 1 &quot;香蕉奶昔&quot; 1&gt;&gt;&lt;&lt;pickup $store &quot;玻璃瓶&quot; 1 &quot;信纸&quot; 1 &quot;方糖&quot; 1 &quot;尘盐&quot; 1 &quot;蜡烛&quot; 1 &quot;煤油灯&quot; 1 &quot;巧克力棒&quot; 1 &quot;熏肉干&quot; 1 &quot;土豆种子&quot; 1 &quot;番茄种子&quot; 1 &quot;辣椒种子&quot; 1 &quot;洋葱种子&quot; 1 &quot;葡萄种子&quot; 1 &quot;玉米种子&quot; 1 &quot;胡萝卜种子&quot; 1&gt;&gt;&lt;&lt;/if&gt;&gt;
&lt;&lt;set _now to new Date()&gt;&gt;
&lt;&lt;set _dt = &quot;&lt;&lt;=_now.getFullYear()&gt;&gt;-&lt;&lt;=_now.getMonth()+1&gt;&gt;-&lt;&lt;=_now.getDate()&gt;&gt;&quot;&gt;&gt;
&lt;&lt;set $nt to $month*1000000+$day*10000+$hour/24*10000+$minute/60*100&gt;&gt;

&lt;&lt;if setup.getStat(&quot;wound&quot;) &gt;= 24&gt;&gt;&lt;&lt;set $death = &quot;伤口&quot;&gt;&gt;&lt;&lt;goto &quot;死亡&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;
&lt;&lt;if setup.getStat(&quot;dread&quot;) &gt;= 24&gt;&gt;&lt;&lt;set $death = &quot;恐惧&quot;&gt;&gt;&lt;&lt;goto &quot;死亡&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;
&lt;&lt;if setup.getStat(&quot;nightmare&quot;) &gt;= 24&gt;&gt;&lt;&lt;set $death = &quot;噩梦&quot;&gt;&gt;&lt;&lt;goto &quot;死亡&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;
&lt;&lt;if setup.getStat(&quot;suspicion&quot;) &gt;= 24&gt;&gt;&lt;&lt;set $death = &quot;质疑&quot;&gt;&gt;&lt;&lt;goto &quot;死亡&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;

&lt;&lt;if setup.getStat(&quot;heartless&quot;) &gt;= 50&gt;&gt;&lt;&lt;set $soul = &quot;寒冷&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;
&lt;&lt;if setup.getStat(&quot;bloody&quot;) &gt;= 50&gt;&gt;&lt;&lt;set $soul = &quot;染血&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;
&lt;&lt;if setup.getStat(&quot;confidence&quot;) &gt;= 50&gt;&gt;&lt;&lt;set $soul = &quot;凝固&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;
&lt;&lt;if setup.getStat(&quot;enjoy&quot;) &gt;= 50&gt;&gt;&lt;&lt;set $soul = &quot;发酵&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;
&lt;&lt;if $hunger &gt;= 24&gt;&gt;&lt;&lt;set $soul = &quot;饥饿&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;
&lt;&lt;if $abs &gt;= 20&gt;&gt;&lt;&lt;set $soul = &quot;无光&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;

&lt;&lt;if $hour &gt;= 6 &amp;&amp; $hour &lt;=17&gt;&gt;
	&lt;&lt;set $dn = 1&gt;&gt;
    &lt;&lt;else&gt;&gt;&lt;&lt;set $dn = 0&gt;&gt;&lt;&lt;/if&gt;&gt;

&lt;&lt;if $hour &gt;=6 &amp;&amp; $hour &lt;=17&gt;&gt;&lt;&lt;set $oriloc = [&quot;罗索伦特湖&quot;,&quot;草甸&quot;,&quot;沙地&quot;,&quot;贝雷河&quot;,&quot;小镇&quot;,&quot;礁岩区&quot;,&quot;主港口&quot;,&quot;副港口&quot;,&quot;断桥&quot;,&quot;秋毛岗&quot;,&quot;拓荒者木屋&quot;].random()&gt;&gt;&lt;&lt;else&gt;&gt;&lt;&lt;set $oriloc = &quot;仓库&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;

&lt;&lt;if $hour &gt;=6 &amp;&amp; $hour &lt;=21&gt;&gt;&lt;&lt;set $nmloc = [&quot;罗索伦特湖&quot;,&quot;草甸&quot;,&quot;沙地&quot;,&quot;贝雷河&quot;,&quot;小镇&quot;,&quot;礁岩区&quot;,&quot;主港口&quot;,&quot;副港口&quot;,&quot;断桥&quot;,&quot;秋毛岗&quot;,&quot;拓荒者木屋&quot;].random()&gt;&gt;&lt;&lt;else&gt;&gt;&lt;&lt;set $nmloc = &quot;天上人间&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;

&lt;&lt;if $hour &gt;=8 &amp;&amp; $hour &lt;=18 &amp;&amp; $week ==3&gt;&gt;&lt;&lt;set $nixloc =&quot;花店&quot;&gt;&gt;&lt;&lt;elseif $hour &gt;=8 &amp;&amp; $hour &lt;=18&gt;&gt;&lt;&lt;set $nixloc =&quot;拓荒者木屋&quot;&gt;&gt;&lt;&lt;else&gt;&gt;&lt;&lt;set _w to random(1,15)&gt;&gt;&lt;&lt;if _w &lt;=3&gt;&gt;&lt;&lt;set $nixloc = &quot;献祭&quot;&gt;&gt;&lt;&lt;else&gt;&gt;&lt;&lt;set $nixloc = &quot;不在&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;&lt;&lt;/if&gt;&gt;

&lt;&lt;if $hour &gt;=8 &amp;&amp; $hour &lt;=18&gt;&gt;&lt;&lt;set $tretloc =&quot;鱼铺&quot;&gt;&gt;&lt;&lt;elseif $hour &lt;=2 &amp;&amp; $hour &gt;=19&gt;&gt;&lt;&lt;set $tretloc =&quot;钓鱼&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;

&lt;&lt;if $hour &gt;= 8 &amp;&amp; $hour &lt;= 17 &amp;&amp; $weather != &quot;中雨&quot; &amp;&amp; $weather != &quot;雷阵雨&quot; &amp;&amp; $weather != &quot;小雨&quot; &amp;&amp; $weather != &quot;暴雨&quot;&gt;&gt;&lt;&lt;set $eraloc =&quot;草甸&quot;&gt;&gt;&lt;&lt;elseif $hour &lt;=23 &amp;&amp; $hour &gt;=18&gt;&gt;&lt;&lt;set $eraloc =[&quot;沙地&quot;,&quot;小镇&quot;,&quot;礁岩区&quot;,&quot;主港口&quot;,&quot;副港口&quot;,&quot;断桥&quot;,&quot;酒馆&quot;,&quot;天上人间&quot;].random()&gt;&gt;&lt;&lt;else&gt;&gt;&lt;&lt;set _w to random(1,15)&gt;&gt;&lt;&lt;if _w &lt;=4&gt;&gt;&lt;&lt;set $eraloc = &quot;集会&quot;&gt;&gt;&lt;&lt;else&gt;&gt;&lt;&lt;set $eraloc =&quot;溶洞&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;&lt;&lt;/if&gt;&gt;

&lt;&lt;if $hour &lt;=16 &amp;&amp; $hour &gt;=13 &amp;&amp; $weather == &quot;晴天&quot;&gt;&gt;&lt;&lt;set $spaloc =&quot;小镇&quot;&gt;&gt;&lt;&lt;elseif $hour &lt;=10&gt;&gt;&lt;&lt;set $spaloc =&quot;家&quot;&gt;&gt;&lt;&lt;elseif $hour &gt;=17&gt;&gt;&lt;&lt;set $spaloc =&quot;图书馆&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;

&lt;&lt;if $hour &lt;=21 &amp;&amp; $week ==7&gt;&gt;&lt;&lt;set $joloc =&quot;酒馆&quot;&gt;&gt;&lt;&lt;elseif $hour &lt;=17 &amp;&amp; $hour &gt;=10&gt;&gt;&lt;&lt;set $joloc =&quot;主港口灯塔&quot;&gt;&gt;&lt;&lt;elseif $week !=7&gt;&gt;&lt;&lt;set $joloc =[&quot;贝雷河&quot;,&quot;家&quot;].random()&gt;&gt;&lt;&lt;/if&gt;&gt;

&lt;&lt;if $hour &lt;=12 &amp;&amp; $hour &gt;=8&gt;&gt;&lt;&lt;set $maryloc =&quot;泡泡布提&quot;&gt;&gt;&lt;&lt;elseif $hour &gt;=13 &amp;&amp; $hour &lt;=18&gt;&gt;&lt;&lt;set $maryloc =&quot;泡泡布提&quot;&gt;&gt;&lt;&lt;else&gt;&gt;&lt;&lt;set $maryloc =[&quot;天上人间&quot;,&quot;家&quot;,&quot;黑市&quot;,&quot;沙地&quot;].random()&gt;&gt;&lt;&lt;/if&gt;&gt;

/***体力锁***/
&lt;&lt;if $coffin &gt;=6&gt;&gt;&lt;&lt;set $hpv = $HP, $hpt = $nt, $hplock = 1&gt;&gt;&lt;&lt;/if&gt;&gt;
&lt;&lt;if $hplock == 1 &amp;&amp; $nt &lt; $hpt+417&gt;&gt;&lt;&lt;set $HP = $hpv&gt;&gt;&lt;&lt;/if&gt;&gt;
&lt;&lt;if $nt &gt;= $hpt+417&gt;&gt;&lt;&lt;set $hplock = 0&gt;&gt;&lt;&lt;/if&gt;&gt;

/*---------------成就--------------*/
&lt;&lt;if $coffin &gt;=3&gt;&gt;
&lt;&lt;checkachievement &quot;coffin&quot;&gt;&gt;
&lt;&lt;if !$hasAchievement&gt;&gt;
&lt;&lt;achievement &quot;coffin&quot;&gt;&gt;
&lt;&lt;/if&gt;&gt;&lt;&lt;/if&gt;&gt;

&lt;&lt;if $fishcollect.length &gt;=40 &amp;&amp; !$achv_fish&gt;&gt;&lt;&lt;set $achv_fish = []&gt;&gt;&lt;&lt;notify 5s&gt;&gt;&lt;font color=&quot;BD5786&quot;&gt;☆获得成就 : 钓鱼大师☆&lt;/font&gt;&lt;&lt;/notify&gt;&gt;&lt;&lt;set $achv_fish.push({name: &#39;钓鱼大师&#39;, dscr: &#39;【测试】&#39;, pic: &#39;成就金&#39;, date:&#39;_dt&#39;})&gt;&gt;&lt;&lt;set $achv.push($achv_fish)&gt;&gt;&lt;&lt;/if&gt;&gt;

&lt;&lt;if $lotus ==333 &amp;&amp; !$achv_lotus&gt;&gt;&lt;&lt;set $achv_lotus = []&gt;&gt;&lt;&lt;notify 5s&gt;&gt;&lt;font color=&quot;BD5786&quot;&gt;☆获得成就 : 永无忧愁☆&lt;/font&gt;&lt;&lt;/notify&gt;&gt;&lt;&lt;set $achv_lotus.push({name: &#39;永无忧愁&#39;, dscr: &#39;【白日悠长, 黑夜凄冷, 你的时间, 两者皆无. 你属于蜡烛与玫瑰环绕的永无乡, 在那里, 你永无忧愁】&#39;, pic: &#39;成就闪&#39;, date:&#39;_dt&#39;})&gt;&gt;&lt;&lt;set $achv.push($achv_lotus)&gt;&gt;&lt;&lt;/if&gt;&gt;

&lt;&lt;if $hdylg ==10&gt;&gt;&lt;&lt;notify 5s&gt;&gt;&lt;font color=&quot;BD5786&quot;&gt;☆获得成就 : 难道我是吸铁石☆&lt;/font&gt;&lt;&lt;/notify&gt;&gt;&lt;&lt;set $achv.push({name: &#39;难道我是吸铁石&#39;, dscr: &#39;【虽然你喜爱钓鱼这件修身养性的运动，但你钓上来的鱼甚至没有易拉罐多。到底是乱扔垃圾的人多？还是……你是吸铁石成精？】&#39;})&gt;&gt;&lt;&lt;/if&gt;&gt;
/****************/

/*------------种地----------------*/
&lt;&lt;if $land1[0].stat &gt;=1 &amp;&amp; $land1[0].stat &lt;=5&gt;&gt;
&lt;&lt;if $nt &gt;= $needt1&gt;&gt;
&lt;&lt;set $land1[0].stat +=1&gt;&gt;&lt;&lt;notify 3s&gt;&gt;田圃1中的植物已成长为新状态&lt;&lt;/notify&gt;&gt;
&lt;&lt;set $needt1 = $nt + random(50,20000)&gt;&gt;
&lt;&lt;/if&gt;&gt;&lt;&lt;/if&gt;&gt;

&lt;&lt;if $land2[0].stat &gt;=1 &amp;&amp; $land2[0].stat &lt;=5&gt;&gt;
&lt;&lt;if $nt &gt;= $needt2&gt;&gt;
&lt;&lt;set $land2[0].stat +=1&gt;&gt;&lt;&lt;notify 3s&gt;&gt;田圃2中的植物已成长为新状态&lt;&lt;/notify&gt;&gt;
&lt;&lt;set $needt2 = $nt + random(50,20000)&gt;&gt;
&lt;&lt;/if&gt;&gt;&lt;&lt;/if&gt;&gt;

&lt;&lt;if $land3[0].stat &gt;=1 &amp;&amp; $land3[0].stat &lt;=5&gt;&gt;
&lt;&lt;if $nt &gt;= $needt3&gt;&gt;
&lt;&lt;set $land3[0].stat +=1&gt;&gt;&lt;&lt;notify 3s&gt;&gt;田圃3中的植物已成长为新状态&lt;&lt;/notify&gt;&gt;
&lt;&lt;set $needt3 = $nt + random(50,20000)&gt;&gt;
&lt;&lt;/if&gt;&gt;&lt;&lt;/if&gt;&gt;

&lt;&lt;if $land4[0].stat &gt;=1 &amp;&amp; $land4[0].stat &lt;=5&gt;&gt;
&lt;&lt;if $nt &gt;= $needt3&gt;&gt;
&lt;&lt;set $land4[0].stat +=1&gt;&gt;&lt;&lt;notify 4s&gt;&gt;田圃4中的植物已成长为新状态&lt;&lt;/notify&gt;&gt;
&lt;&lt;set $needt2 = $nt + random(50,20000)&gt;&gt;
&lt;&lt;/if&gt;&gt;&lt;&lt;/if&gt;&gt;

</tw-passagedata><tw-passagedata pid="6" name="StoryCaption" tags="" position="100,0" size="100,100">&lt;&lt;if !$nn&gt;&gt; 欢迎你来到永无乡, 远方的旅客, &lt;br&gt;请完成入岛登记&lt;br&gt;&lt;br&gt;&lt;&lt;elseif $loc == &quot;未知&quot;&gt;&gt;$nn, 永无乡永远都是你的归宿&lt;&lt;else&gt;&gt;嗨$nn!&lt;br&gt;&lt;&lt;if $nn == &quot;Nix&quot;&gt;&gt;&lt;img src=&quot;https://f2.toyhou.se/file/f2-toyhou-se/images/95512775_jgcolbTxzr46GdO.png&quot; width=60% class=&quot;picr&quot;&gt;&lt;br&gt;&lt;&lt;/if&gt;&gt;欢迎来到&lt;br&gt;&lt;font size=5px&gt;$loc&lt;/font&gt;&lt;br&gt;&lt;&lt;if $loc == &quot;白雾&quot;&gt;&gt;美味&lt;&lt;else&gt;&gt;永远&lt;&lt;/if&gt;&gt;的朋友!&lt;br&gt;
&lt;&lt;do&gt;&gt;鸟羽: &lt;&lt;= $feather&gt;&gt;&lt;&lt;/do&gt;&gt;&lt;&lt;/if&gt;&gt;&lt;&lt;timeWidget&gt;&gt;&lt;&lt;do&gt;&gt;&lt;&lt;if $week == 1&gt;&gt;&lt;&lt;set $dayOfWeek = &quot;礼拜一&quot;&gt;&gt;&lt;&lt;elseif $week == 2&gt;&gt;&lt;&lt;set $dayOfWeek = &quot;礼拜二&quot;&gt;&gt;&lt;&lt;elseif $week == 3&gt;&gt;&lt;&lt;set $dayOfWeek = &quot;礼拜三&quot;&gt;&gt;&lt;&lt;elseif $week == 4&gt;&gt;&lt;&lt;set $dayOfWeek = &quot;礼拜四&quot;&gt;&gt;&lt;&lt;elseif $week == 5&gt;&gt;&lt;&lt;set $dayOfWeek = &quot;礼拜五&quot;&gt;&gt;&lt;&lt;elseif $week == 6&gt;&gt;&lt;&lt;set $dayOfWeek = &quot;礼拜六&quot;&gt;&gt;&lt;&lt;elseif $week == 7&gt;&gt;&lt;&lt;set $dayOfWeek = &quot;礼拜日&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;
&lt;&lt;if $dtr == 0&gt;&gt;&lt;&lt;set $dtn1 to random(1,24), $dtn2 to random(1,24), $dtr to 1&gt;&gt;&lt;&lt;/if&gt;&gt;&lt;&lt;weatherWidget&gt;&gt;&lt;&lt;if $hour eq $dtn1 &amp;&amp; $dtr1 == 0&gt;&gt;&lt;&lt;set $dtr1 to 1&gt;&gt;&lt;&lt;set $weather = $weathers&gt;&gt;&lt;&lt;set $wind = $winds&gt;&gt;&lt;&lt;/if&gt;&gt;&lt;&lt;if $hour eq $dtn2 &amp;&amp; $dtr2 == 0&gt;&gt;&lt;&lt;set $weather = $weathers&gt;&gt;&lt;&lt;set $wind = $winds&gt;&gt;&lt;&lt;set $dtr2 to 1&gt;&gt;&lt;&lt;/if&gt;&gt;&lt;div id=&quot;moon&quot;&gt;&lt;&lt;moonphase&gt;&gt;&amp;nbsp;$weather $wind&lt;/div&gt;$showmonth月$showday日 $dayOfWeek  $showHour:$showMinute&lt;br&gt;
&lt;&lt;if !$nn&gt;&gt;&lt;&lt;else&gt;&gt;&lt;b&gt;体力&lt;/b&gt; &lt;&lt;if $HP lt 0&gt;&gt;&lt;&lt;set $HP = 0&gt;&gt;&lt;&lt;/if&gt;&gt;&lt;&lt;if $HP gt 100&gt;&gt;&lt;&lt;set $HP = 100&gt;&gt;&lt;&lt;/if&gt;&gt;$HP/100&lt;meter min=&quot;0&quot; high=&quot;20&quot; optimum=&quot;100&quot; max=&quot;100&quot; @value=&quot;$HP&quot; align=&quot;center&quot; style=&quot;width:200px&quot;&gt;&lt;/meter&gt;
&lt;&lt;set $kl to $player.knowledge+ 1&gt;&gt;&lt;&lt;set _extk to setup.getStat(&quot;knowledge&quot;)- $player.knowledge&gt;&gt;&lt;span class=&quot;tooltip&quot;&gt;&lt;b&gt;学识&lt;/b&gt;&lt;span class=&quot;tooltiptext&quot;&gt;$player.knowledge/120&lt;br&gt;知识, 阅历, 智慧&lt;/span&gt;&lt;/span&gt; $player.knowledge &lt;font color=&quot;white&quot;&gt;+_extk&lt;/font&gt;&lt;meter min=0 @max=&quot;$kl&quot;  @value=&quot;$knowledgeexp&quot; align=&quot;center&quot; style=&quot;width:200px&quot;&gt;&lt;/meter&gt;
&lt;&lt;set $sl to $player.strength+ 1&gt;&gt;&lt;&lt;set _exts to setup.getStat(&quot;strength&quot;)- $player.strength&gt;&gt;&lt;b&gt;力量&lt;/b&gt; $player.strength &lt;font color=&quot;white&quot;&gt;+_exts&lt;/font&gt;&lt;meter @value=&quot;$strengthexp&quot; min=&quot;0&quot; high=&quot;0&quot; @max=&quot;$sl&quot; align=&quot;center&quot; style=&quot;width:200px&quot;&gt;&lt;/meter&gt;
&lt;&lt;set $ol to $player.observation+ 1&gt;&gt;&lt;&lt;set _exto to setup.getStat(&quot;observation&quot;)- $player.observation&gt;&gt;&lt;b&gt;观察&lt;/b&gt; $player.observation &lt;font color=&quot;white&quot;&gt;+_exto&lt;/font&gt;&lt;meter @value=&quot;$observationexp&quot; min=&quot;0&quot; high=&quot;0&quot; @max=&quot;$ol&quot; align=&quot;center&quot; style=&quot;width:200px&quot;&gt;&lt;/meter&gt;
&lt;&lt;set $pl to $player.persuasive+ 1&gt;&gt;&lt;&lt;set _extp to setup.getStat(&quot;persuasive&quot;)- $player.persuasive&gt;&gt;&lt;b&gt;话术&lt;/b&gt; $player.persuasive &lt;font color=&quot;white&quot;&gt;+_extp&lt;/font&gt;&lt;meter @value=&quot;$persuasiveexp&quot; min=&quot;0&quot; high=&quot;0&quot; @max=&quot;$pl&quot; align=&quot;center&quot; style=&quot;width:200px&quot;&gt;&lt;/meter&gt;&lt;&lt;/if&gt;&gt;&lt;&lt;/do&gt;&gt;
  &lt;br&gt;</tw-passagedata><tw-passagedata pid="7" name="StoryDisplayTitle" tags="" position="2025,550" size="100,100">&lt;img src=&quot;https://f2.toyhou.se/file/f2-toyhou-se/images/87586917_ODEphEoOE67jGWI.png&quot; width=100%&gt;</tw-passagedata><tw-passagedata pid="8" name="StoryInit" tags="" position="0,0" size="100,100">&lt;&lt;cacheaudio &quot;mainBGM&quot; &quot;media/audio/Neverland.mp3&quot;&gt;&gt;
&lt;&lt;cacheaudio &quot;gardenBGM&quot; &quot;media/audio/GardenofUntamedRoses.mp3&quot;&gt;&gt;
&lt;&lt;cacheaudio &quot;wildhuntBGM&quot; &quot;media/audio/Whistling Winds.mp3&quot;&gt;&gt;
&lt;&lt;cacheaudio &quot;homeBGM&quot; &quot;media/audio/coming home.mp3&quot;&gt;&gt;
&lt;&lt;cacheaudio &quot;NixBGM&quot; &quot;media/audio/Dancing on the Snow.mp3&quot;&gt;&gt;
&lt;&lt;cacheaudio &quot;pubBGM&quot; &quot;media/audio/sunset at the exclusive.mp3&quot;&gt;&gt;
&lt;&lt;cacheaudio &quot;LunaBGM&quot; &quot;media/az/goodbye moon.mp3&quot;&gt;&gt;


&lt;&lt;cacheaudio &quot;diceroll&quot; &quot;media/audio/Dice Roll.mp3&quot;&gt;&gt;
&lt;&lt;cacheaudio &quot;轻敲门&quot; &quot;media/audio/轻敲门.mp3&quot;&gt;&gt;
&lt;&lt;cacheaudio &quot;摔碎杯子&quot; &quot;media/audio/摔碎杯子.mp3&quot;&gt;&gt;
&lt;&lt;cacheaudio &quot;整理杯子&quot; &quot;media/audio/整理杯子.mp3&quot;&gt;&gt;

  &lt;ScrollView android:layout_width=&quot;fill_parent&quot;
  android:layout_height=&quot;wrap_content&quot; android:scrollbars=&quot;none&quot;&gt;
  &lt;TextView android:id=&quot;@+id/showhtml&quot; android:layout_width=&quot;fill_parent&quot;
     android:layout_height=&quot;wrap_content&quot; /&gt;
&lt;/ScrollView&gt;

&lt;&lt;set setup.items to {}&gt;&gt; 
&lt;&lt;set $test to 1015&gt;&gt; 

//初始值们
&lt;&lt;set $hunger=0, $abs =0, $social = 0, $fame = 0, $feather to 0, $points to 16, $HP to 100, $knowledgeexp to 0, $myth to 0, $drunk = 0, $coffin = 0, $hplock = 0, $firefit = 0&gt;&gt;&lt;&lt;set $strengthexp to 0&gt;&gt;&lt;&lt;set $observationexp to 0&gt;&gt;&lt;&lt;set $persuasiveexp to 0&gt;&gt;&lt;&lt;set $loc = &quot;未知&quot;, $loct = &quot;未知&quot;, $job = &quot;暂无&quot;,$home = &quot;暂无&quot;&gt;&gt;&lt;&lt;set $chop = 0&gt;&gt;&lt;&lt;set $dgcs = 6&gt;&gt;&lt;&lt;set $fycs = 3&gt;&gt;&lt;&lt;set $gzcs = 3&gt;&gt;&lt;&lt;set $text = &quot;永无乡&quot;, $textc = &quot;//漂浮在地中海某处的小岛，终年气候温和&lt;br&gt;永无乡欢迎所有人的到来//&quot;&gt;&gt;&lt;&lt;set $stoletime =  0&gt;&gt;
&lt;&lt;set $innpay = 1, $date to 1, $month = 2, $day = 13, $lny to 0, $week to 7, $hour to 8, $minute to 0, $dtr to 0, $dtr1 to 0, $dtr2 to 0, $weather to &quot;晴天&quot;, $wind to &quot;东风&quot;, $npc = 0&gt;&gt;
&lt;&lt;set $sheep to 27, $boat to 6&gt;&gt;&lt;&lt;set $lostsheep = [0, 0]&gt;&gt;
&lt;&lt;set $land1 =[],  $land2 =[], $land3 =[], $land4 =[], $land5 =[], $land6 =[]&gt;&gt;&lt;&lt;set $achv = []&gt;&gt;

&lt;&lt;set $land1.push({name: &#39;无&#39;, stat: 0}),  $land2.push({name: &#39;无&#39;, stat: 0}), $land3.push({name: &#39;无&#39;, stat: 0}), $land4.push({name: &#39;无&#39;, stat: 0}), $land5.push({name: &#39;无&#39;, stat: 0}), $land6.push({name: &#39;无&#39;, stat: 0})&gt;&gt;

//数值们
&lt;&lt;set $san to 100&gt;&gt;&lt;&lt;set $luck to random(35,95)&gt;&gt;&lt;&lt;set $sin to 0&gt;&gt;
&lt;&lt;set $player = {knowledge: 0, strength: 0, observation: 0, persuasive: 0, wound: 0, dread: 0, nightmare: 0, suspicion : 0, cautious: 0, heartless: 0, bloody: 0, confidence : 0, generous: 0, enjoy: 0}&gt;&gt;

/*背包们*/
&lt;&lt;newinv $item&gt;&gt;&lt;&lt;newinv $food&gt;&gt;&lt;&lt;newinv $prey&gt;&gt;&lt;&lt;newinv $fish&gt;&gt;&lt;&lt;newinv $book&gt;&gt;&lt;&lt;include &quot;描述&quot;&gt;&gt;

/*店铺们*/
&lt;&lt;set setup.item = new Map([
[&quot;黑巧小蛋糕&quot;, 28],[&quot;意式浓缩&quot;, 10],[&quot;蜂蜜鲜奶&quot;, 12],[&quot;朗姆葡萄酥卷&quot;, 32],[&quot;蓝山咖啡&quot;, 50],[&quot;朗姆冰淇淋&quot;, 25],[&quot;羊角面包&quot;, 14],[&quot;阿芙加朵&quot;, 25],[&quot;摩卡&quot;, 20],[&quot;卡布奇诺&quot;, 25],[&quot;红茶&quot;, 12],[&quot;橙汁&quot;, 5],[&quot;朗姆酒&quot;, 15],[&quot;柿子酒&quot;, 25],[&quot;贝雷帽&quot;, 28],[&quot;草帽&quot;, 12],[&quot;女仆制服&quot;, 56],[&quot;朴素的连衣裙&quot;, 27],[&quot;船长帽&quot;, 40],[&quot;七里靴&quot;, 48],[&quot;芝士三明治&quot;, 22],[&quot;贝雷帽&quot;, 28],[&quot;蜜酒&quot;, 27],[&quot;蜜蜂的膝盖&quot;, 33],[&quot;暗与暴风雨&quot;, 38],[&quot;血腥玛格丽特&quot;, 40],[&quot;黄金鸟&quot;, 42],[&quot;月亮河&quot;, 40],[&quot;法国75号&quot;, 38],[&quot;黑麦啤酒&quot;, 12],[&quot;白鹭兰&quot;, 54],[&quot;百合花&quot;, 37],[&quot;金花茶&quot;, 76],[&quot;马蹄莲&quot;, 48],[&quot;牡丹花&quot;, 42],[&quot;金鸟&quot;, 42],[&quot;鸢尾花&quot;, 48],[&quot;藻球&quot;, 25],[&quot;星夜晚礼服&quot;, 450],[&quot;玻璃瓶&quot;, 6],[&quot;信纸&quot;, 4],[&quot;方糖&quot;, 2],[&quot;尘盐&quot;, 2],[&quot;蜡烛&quot;, 6],[&quot;煤油灯&quot;, 22],[&quot;巧克力棒&quot;, 8],[&quot;熏肉干&quot;, 8],[&quot;土豆种子&quot;, 2],[&quot;番茄种子&quot;, 2],[&quot;辣椒种子&quot;, 8],[&quot;洋葱种子&quot;, 8],[&quot;葡萄种子&quot;, 2],[&quot;玉米种子&quot;, 2],[&quot;胡萝卜种子&quot;, 2]
])&gt;&gt;

&lt;&lt;newinv $nest&gt;&gt;

&lt;&lt;newinv $coffee&gt;&gt;
&lt;&lt;pickup $coffee &quot;黑巧小蛋糕&quot; 1 &quot;意式浓缩&quot; 1 &quot;蜂蜜鲜奶&quot; 1 &quot;朗姆葡萄酥卷&quot; 1 &quot;蓝山咖啡&quot; 1 &quot;朗姆冰淇淋&quot; 1 &quot;羊角面包&quot; 1 &quot;芝士三明治&quot; 1 &quot;阿芙加朵&quot; 1 &quot;摩卡&quot; 1 &quot;红茶&quot; 1 &quot;卡布奇诺&quot; 1&gt;&gt;
&lt;&lt;newinv $store&gt;&gt;
&lt;&lt;pickup $store &quot;玻璃瓶&quot; 1 &quot;信纸&quot; 1 &quot;方糖&quot; 1 &quot;尘盐&quot; 1 &quot;蜡烛&quot; 1 &quot;煤油灯&quot; 1 &quot;巧克力棒&quot; 1 &quot;熏肉干&quot; 1 &quot;土豆种子&quot; 1 &quot;番茄种子&quot; 1 &quot;辣椒种子&quot; 1 &quot;洋葱种子&quot; 1 &quot;葡萄种子&quot; 1 &quot;玉米种子&quot; 1 &quot;胡萝卜种子&quot; 1&gt;&gt;
&lt;&lt;newinv $pub&gt;&gt;
&lt;&lt;pickup $pub &quot;橙汁&quot; 1 &quot;蜜酒&quot; 1 &quot;黑麦啤酒&quot; 1 &quot;朗姆酒&quot; 1 &quot;柿子酒&quot; 1 &quot;蜜蜂的膝盖&quot; 1 &quot;暗与暴风雨&quot; 1 &quot;血腥玛格丽特&quot; 1 &quot;黄金鸟&quot; 1 &quot;月亮河&quot; 1 &quot;法国75号&quot; 1&gt;&gt;
&lt;&lt;newinv $flowerist&gt;&gt;
&lt;&lt;pickup $flowerist &quot;白鹭兰&quot; 1 &quot;百合花&quot; 1 &quot;金花茶&quot; 1 &quot;马蹄莲&quot; 1 &quot;牡丹花&quot; 1 &quot;鸢尾花&quot; 1 &quot;藻球&quot; 1&gt;&gt;
&lt;&lt;newinv $clothes&gt;&gt;
&lt;&lt;pickup $clothes &quot;星夜晚礼服&quot; 1 &quot;女仆制服&quot; 1&gt;&gt;

&lt;&lt;set setup.prices = new Map([
[&quot;沙丁鱼&quot;, 1],[&quot;泥鳅&quot;, 1],[&quot;雅罗鱼&quot;, 2],[&quot;凤尾鱼&quot;, 1],[&quot;彩虹濑鱼&quot;, 15],[&quot;虾虎鱼&quot;, 1],[&quot;纹首鮨&quot;, 8],[&quot;比目鱼&quot;, 5],[&quot;虹鳟鱼&quot;, 20],[&quot;鲻鱼&quot;, 6],[&quot;鲤鱼&quot;, 3],[&quot;鲱鱼&quot;, 2],[&quot;白鲑鱼&quot;, 3],[&quot;龙虾&quot;, 8],[&quot;鹦哥鱼&quot;, 2],[&quot;大比目鱼&quot;, 6],[&quot;鳕鱼&quot;, 3],[&quot;无须鳕鱼&quot;, 4],[&quot;鲯鳅鱼&quot;, 4],[&quot;欧鳊&quot;, 3],[&quot;大西洋狐鲣&quot;, 28],[&quot;蓝鳍金枪鱼&quot;, 33]
])&gt;&gt;

&lt;&lt;set setup.chop = new Map([
[&quot;沙丁鱼&quot;, 1],[&quot;泥鳅&quot;, 1],[&quot;雅罗鱼&quot;, 1],[&quot;凤尾鱼&quot;, 1],[&quot;彩虹濑鱼&quot;, 1],[&quot;虾虎鱼&quot;, 2],[&quot;纹首鮨&quot;, 2],[&quot;比目鱼&quot;, 2],[&quot;虹鳟鱼&quot;, 2],[&quot;鲻鱼&quot;, 2],[&quot;鲤鱼&quot;, 2],[&quot;鲱鱼&quot;, 2],[&quot;白鲑鱼&quot;, 3],[&quot;龙虾&quot;, 3],[&quot;鹦哥鱼&quot;, 3],[&quot;大比目鱼&quot;, 3],[&quot;鳕鱼&quot;, 3],[&quot;无须鳕鱼&quot;, 3],[&quot;鲯鳅鱼&quot;, 3],[&quot;欧鳊&quot;, 3],[&quot;大西洋狐鲣&quot;, 5],[&quot;蓝鳍金枪鱼&quot;, 5]
])&gt;&gt;

&lt;&lt;set setup.sell = new Map([
])&gt;&gt;

//箱子们
&lt;&lt;newinv $hospital&gt;&gt;
&lt;&lt;pickup $hospital &quot;鸦片酊&quot; 15 &quot;安眠药&quot; 20 &quot;烟卷&quot; 33 &quot;药丸&quot; 25 &quot;绷带&quot; 30 &quot;未寄出的信件&quot; 3 &quot;铂金戒指&quot; 1 &quot;老照片&quot; 1 &quot;植物标本盒&quot; 1 &quot;作物培育笔记&quot; 1 &quot;碎茶杯&quot; 1 &quot;信纸&quot; 10&gt;&gt;
&lt;&lt;newinv $pubhide&gt;&gt;
&lt;&lt;newinv $coffeehide&gt;&gt;
&lt;&lt;pickup $coffeehide &quot;吊坠项链&quot; 1 &quot;六分仪&quot; 1 &quot;烧焦的航海图&quot; 1 &quot;老照片&quot; 1&gt;&gt;
&lt;&lt;newinv $house&gt;&gt;
&lt;&lt;pickup $house &quot;断弦的吉他&quot; 1 &quot;天文望远镜&quot; 1 &quot;字迹模糊的短诗&quot; 1 &quot;老照片&quot; 1 &quot;信纸&quot; 10 &quot;羽毛笔&quot; 12 &quot;甘草袋&quot; 6&gt;&gt;

//任务们
&lt;&lt;newinv $ms&gt;&gt;&lt;&lt;newinv $ss&gt;&gt;&lt;&lt;newinv $msd&gt;&gt;&lt;&lt;newinv $ssd&gt;&gt;&lt;&lt;newinv $missed&gt;&gt;

//成就们
&lt;&lt;set $hdylg = 0&gt;&gt;&lt;&lt;set $lotus = 0&gt;&gt;&lt;&lt;set $fishcollect= []&gt;&gt;&lt;&lt;set $gball= []&gt;&gt;&lt;&lt;set $preycollect= []&gt;&gt;&lt;&lt;set $winecollect= []&gt;&gt;

//装备栏
&lt;&lt;newinv $head&gt;&gt;&lt;&lt;newinv $neck&gt;&gt;&lt;&lt;newinv $top&gt;&gt;&lt;&lt;newinv $hand&gt;&gt;&lt;&lt;newinv $pants&gt;&gt;&lt;&lt;newinv $foot&gt;&gt;&lt;&lt;newinv $tool&gt;&gt;&lt;&lt;include &quot;装备&quot;&gt;&gt;
&lt;&lt;set $headSlot = &quot;无&quot;&gt;&gt;&lt;&lt;set $neckSlot = &quot;无&quot;&gt;&gt;&lt;&lt;set $topSlot = &quot;无&quot;&gt;&gt;&lt;&lt;set $handSlot = &quot;无&quot;&gt;&gt;&lt;&lt;set $pantsSlot = &quot;无&quot;&gt;&gt;&lt;&lt;set $footSlot = &quot;无&quot;&gt;&gt;&lt;&lt;set $toolSlot = &quot;无&quot;, $toolds = &quot;无，没有，不&quot;&gt;&gt;
&lt;&lt;set $adjustments = 
{tool : {knowledge: 0, strength: 0, observation: 0, persuasive: 0, wound: 0, dread: 0, nightmare: 0, suspicion: 0, cautious: 0, heartless: 0, bloody: 0, confidence : 0, generous: 0, enjoy: 0}, 
head : {knowledge: 0, strength: 0, observation: 0, persuasive: 0, wound: 0, dread: 0, nightmare: 0, suspicion: 0, cautious: 0, heartless: 0, bloody: 0, confidence : 0, generous: 0, enjoy: 0}, 
neck : {knowledge: 0, strength: 0, observation: 0, persuasive: 0, wound: 0, dread: 0, nightmare: 0, suspicion: 0, cautious: 0, heartless: 0, bloody: 0, confidence : 0, generous: 0, enjoy: 0}, 
top : {knowledge: 0, strength: 0, observation: 0, persuasive: 0, wound: 0, dread: 0, nightmare: 0, suspicion: 0, cautious: 0, heartless: 0, bloody: 0, confidence : 0, generous: 0, enjoy: 0}, 
hand : {knowledge: 0, strength: 0, observation: 0, persuasive: 0, wound: 0, dread: 0, nightmare: 0, suspicion: 0, cautious: 0, heartless: 0, bloody: 0, confidence : 0, generous: 0, enjoy: 0}, 
pants : {knowledge: 0, strength: 0, observation: 0, persuasive: 0, wound: 0, dread: 0, nightmare: 0, suspicion: 0, cautious: 0, heartless: 0, bloody: 0, confidence : 0, generous: 0, enjoy: 0}, 
foot : {knowledge: 0, strength: 0, observation: 0, persuasive: 0, wound: 0, dread: 0, nightmare: 0, suspicion: 0, cautious: 0, heartless: 0, bloody: 0, confidence : 0, generous: 0, enjoy: 0}}&gt;&gt;

&lt;&lt;set setup.equip = function equip (slot, item) 
{let adj;
    if (slot !== &quot;tool&quot; &amp;&amp; slot !== &quot;head&quot; &amp;&amp; slot !== &quot;neck&quot; &amp;&amp; slot !== &quot;top&quot; &amp;&amp; slot !== &quot;hand&quot; &amp;&amp; slot !== &quot;pants&quot; &amp;&amp; slot !== &quot;foot&quot;) {throw new Error(`Invalid gear slot: ${slot}`); }
    if (item === &quot;&quot;) {adj = clone({knowledge : 0, strength : 0, observation : 0, persuasive : 0, wound : 0, dread : 0, nightmare : 0, suspicion : 0, cautious: 0, heartless: 0, bloody: 0, confidence : 0, generous: 0, enjoy : 0});} 
    else {adj = setup[slot].get(item);}
    if (!adj) {throw new Error(`Invalid weapon: ${item}`);}
    if (slot === &quot;tool&quot;) {$toolSlot = item;} 
    else if (slot === &quot;head&quot;) {$headSlot = item;}  else if (slot === &quot;neck&quot;) {$neckSlot = item;} else if (slot === &quot;top&quot;) {$topSlot = item;} else if (slot === &quot;hand&quot;) {$handSlot = item;} else if (slot === &quot;pants&quot;) {$pantsSlot = item;} else {$footSlot = item;}
    $adjustments[slot] = clone(adj);}&gt;&gt;

&lt;&lt;set setup.getStat = function getStat (stat) {
if (ndef $player[stat]) {throw new Error(`Invalid stat: ${stat}`);}
    let ret = Math.trunc(Math.clamp($player[stat] + $adjustments.tool[stat] + $adjustments.head[stat] +  $adjustments.neck[stat] + $adjustments.top[stat] + $adjustments.hand[stat] + $adjustments.pants[stat] + $adjustments.foot[stat], 0, 99));
    if (Number.isNaN(ret)) {ret = 0;}
    return ret;
}&gt;&gt;</tw-passagedata><tw-passagedata pid="9" name="StoryMenu" tags="" position="200,0" size="100,100">&lt;&lt;if !$map&gt;&gt;&lt;&lt;else&gt;&gt;&lt;&lt;link &#39;&lt;i class=&quot;fa-solid fa-scroll&quot;&gt;&lt;/i&gt;&amp;nbsp;任务&#39;&gt;&gt; &lt;&lt;run changemap(&quot;page1&quot;, &quot;stories&quot;)&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;&lt;/if&gt;&gt;

&lt;&lt;if !$firstitem&gt;&gt;&lt;&lt;else&gt;&gt;
&lt;&lt;link &#39;&lt;i class=&quot;fa-solid fa-bag-shopping&quot;&gt;&lt;/i&gt;&amp;nbsp;物品&#39;&gt;&gt;
 &lt;&lt;run changemap(&quot;page1&quot;, &quot;items&quot;)&gt;&gt;
&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;&lt;/if&gt;&gt;

&lt;&lt;if !$map || $loc == &quot;白雾&quot;&gt;&gt;&lt;&lt;else&gt;&gt;
&lt;&lt;link &#39;&lt;i class=&quot;fa-solid fa-signs-post&quot;&gt;&lt;/i&gt;&amp;nbsp;地图&#39;&gt;&gt;&lt;&lt;run
  Dialog.setup(&quot;永无乡地图&quot;);
  Dialog.wiki(Story.get(&quot;map&quot;).processText());
  Dialog.open();
&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;&lt;/if&gt;&gt;

&lt;&lt;if !$orifirstc&gt;&gt;&lt;&lt;else&gt;&gt;&lt;&lt;link &#39;&lt;i class=&quot;fa-duotone fa-solid fa-book-bookmark&quot;&gt;&lt;/i&gt;&amp;nbsp;日志&#39;&gt;&gt; &lt;&lt;run changemap(&quot;page1&quot;, &quot;logs&quot;)&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="10" name="StoryRightSidebar" tags="nobr" position="300,0" size="100,100">&lt;&lt;do&gt;&gt;
&lt;&lt;if !$nn&gt;&gt;&lt;center&gt;&lt;h2&gt;CREDITS&lt;/h2&gt;世界观创作、游戏制作、剧情设计：Nix&lt;br&gt;文本编写：暮雪深、安德森、真央、Nix&lt;br&gt;特别感谢：Chapel、Shour、黑星&lt;br&gt;&lt;br&gt;&lt;br&gt;有任何问题请联系&lt;br&gt;qq: 641549971&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;版本&lt;br&gt;1.1.4.022225_alpha&lt;br&gt;制作&amp;测试阶段&lt;/center&gt;
&lt;&lt;elseif !$firsts&gt;&gt;&lt;&lt;elseif !$npc || $npc == 0&gt;&gt;

&lt;font size=4px&gt;&lt;b&gt;当前主线&lt;/b&gt;&lt;/font&gt;&lt;br&gt;
$msname&lt;br&gt;
&lt;&lt;set _msds = Item.get($msname).description&gt;&gt;_msds&lt;br&gt;&lt;br&gt;

&lt;b&gt;&lt;&lt;button &#39;&lt;i class=&quot;fa-solid fa-feather-pointed&quot; style=&quot;font-size: 1.3em;&quot;&gt;&lt;/i&gt;  呼唤Seisi &#39;&gt;&gt;&lt;&lt;run
  Dialog.setup(&quot;Seisinofoaga&quot;);
  Dialog.wiki(Story.get(&quot;seisi&quot;).processText());
  Dialog.open();
&gt;&gt;&lt;&lt;/button&gt;&gt;&lt;/b&gt;&lt;br&gt;

&lt;&lt;if setup.getStat(&quot;wound&quot;) != 0 || setup.getStat(&quot;dread&quot;) != 0 || setup.getStat(&quot;nightmare&quot;) != 0 || setup.getStat(&quot;suspicion&quot;) != 0&gt;&gt;&lt;br&gt;&lt;i class=&quot;fa-solid fa-skull&quot;&gt;&lt;/i&gt;&amp;nbsp;&lt;font size=4px&gt;&lt;b&gt;异常&lt;/b&gt;&lt;/font&gt;
&lt;br&gt;
&lt;&lt;if setup.getStat(&quot;wound&quot;) != 0&gt;&gt;伤口 &lt;font color=#BA3030&gt;&lt;&lt;= setup.getStat(&quot;wound&quot;)&gt;&gt;/50&lt;/font&gt;&lt;meter min=&quot;0&quot; max=&quot;50&quot; @value=&quot;setup.getStat(&quot;wound&quot;)&quot; align=&quot;center&quot; style=&quot;width:200px&quot;&gt;&lt;/meter&gt;&lt;br&gt;&lt;&lt;/if&gt;&gt;
&lt;&lt;if setup.getStat(&quot;dread&quot;) != 0&gt;&gt;恐惧 &lt;font color=#BA3030&gt;&lt;&lt;= setup.getStat(&quot;dread&quot;)&gt;&gt;/50&lt;/font&gt;&lt;meter min=&quot;0&quot; max=&quot;50&quot; @value=&quot;setup.getStat(&quot;dread&quot;)&quot; align=&quot;center&quot; style=&quot;width:200px&quot;&gt;&lt;/meter&gt;&lt;br&gt;&lt;&lt;/if&gt;&gt;
&lt;&lt;if setup.getStat(&quot;nightmare&quot;) != 0&gt;&gt;噩梦 &lt;font color=#BA3030&gt;&lt;&lt;= setup.getStat(&quot;nightmare&quot;)&gt;&gt;/50&lt;/font&gt;&lt;meter min=&quot;0&quot; max=&quot;50&quot; @value=&quot;setup.getStat(&#39;nightmare&#39;)&quot; align=&quot;center&quot; style=&quot;width:200px&quot;&gt;&lt;/meter&gt;&lt;br&gt;&lt;&lt;/if&gt;&gt;
&lt;&lt;if setup.getStat(&quot;suspicion&quot;) != 0&gt;&gt;嫌疑&lt;font color=#BA3030&gt;&lt;&lt;= setup.getStat(&quot;suspicion&quot;)&gt;&gt;/50&lt;/font&gt;&lt;meter min=&quot;0&quot; max=&quot;50&quot; @value=&quot;setup.getStat(&quot;suspicion&quot;)&quot; align=&quot;center&quot; style=&quot;width:200px&quot;&gt;&lt;/meter&gt;&lt;&lt;/if&gt;&gt;&lt;&lt;/if&gt;&gt;
&lt;br&gt;
&lt;i class=&quot;fa-solid fa-hat-wizard&quot; style=&quot;font-size: 1.3em;&quot;&gt;&lt;/i&gt;&amp;nbsp;&lt;font size=4px&gt;&lt;b&gt;装备&lt;/b&gt;&lt;/font&gt;
&lt;br&gt;
&lt;&lt;include &quot;装备栏&quot;&gt;&gt;

&lt;br&gt;&lt;br&gt;

&lt;div id=&quot;textcard&quot;&gt;&lt;font size=4px&gt;&lt;b&gt;@@#text;&lt;&lt;= $text&gt;&gt;@@&lt;/b&gt;&lt;/font&gt;&lt;br&gt;
&lt;font size=3px&gt;//@@#textc;&lt;&lt;= $textc&gt;&gt;@@//&lt;/font&gt;&lt;br&gt;&lt;/div&gt;
&lt;&lt;button &#39;&lt;i class=&quot;fa-solid fa-arrows-rotate&quot;&gt;&lt;/i&gt;&#39;&gt;&gt;&lt;&lt;textWidget&gt;&gt;&lt;&lt;/button&gt;&gt;
&lt;br&gt;&lt;br&gt;
&lt;&lt;if $nn == &quot;Nix&quot;&gt;&gt;[[测试]]&lt;&lt;/if&gt;&gt;
&lt;&lt;elseif $npc != 0&gt;&gt;&lt;font size=4px&gt;&lt;b&gt;当前角色&lt;/b&gt;&lt;/font&gt;&lt;br&gt;&amp;nbsp;&lt;&lt;include &quot;NPC&quot;&gt;&gt;
&lt;&lt;/if&gt;&gt;&lt;&lt;/do&gt;&gt;

&lt;&lt;if $loct != $loc&gt;&gt;&lt;&lt;set $npc = 0, $loct = $loc, $coffin = 0&gt;&gt;&lt;&lt;redo&gt;&gt;&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="11" name="demo结语" tags="" position="1300,1275" size="100,100">&lt;center&gt;

demo的游戏内容到此结束, 包含一个主线任务、三段主线剧情、一个支线任务、四个可攻略角色、七个一般角色、六个成就、五条线索

感谢试玩! 接下来看看星空吧! 

&lt;&lt;link 点这里 萤火虫&gt;&gt;&lt;&lt;set $qte to true&gt;&gt;&lt;&lt;set $succ = 0, $num to random(4,8)&gt;&gt;&lt;&lt;/link&gt;&gt;

&lt;/center&gt;</tw-passagedata><tw-passagedata pid="12" name="era互动" tags="nobr" position="1500,0" size="100,100">&lt;&lt;if $lostsheep[0] == 1 &amp;&amp; $sheeploc == $loc&gt;&gt;
【一团白色的身影出现在前方, 你终于找到了走失的绵羊, 把它带回了羊群还给Era】&lt;&lt;set $lostsheep[0] = 0, $sheep +=1, $choice to &quot;放羊&quot;&gt;&gt;&lt;br&gt;&lt;br&gt;
&lt;&lt;link ▷「去找Era」 草甸&gt;&gt;&lt;&lt;/link&gt;&gt;
&lt;&lt;elseif $lostsheep[0] == 1&gt;&gt;
【你走遍了整个地区, 没有看到一撮羊毛. 去别的地方试试运气吧】&lt;br&gt;&lt;br&gt;
&lt;&lt;link ▷「离开」 $loc&gt;&gt;&lt;&lt;/link&gt;&gt;
&lt;&lt;elseif $choice == &quot;放羊&quot; &amp;&amp; $fycs == 0&gt;&gt;【Era觉得你今天已经做得够多了, 去找点其他事做或者休息一下吧】&lt;br&gt;
&lt;br&gt;
&lt;&lt;link ▷「返回」 草甸&gt;&gt;&lt;&lt;set $choice to 0&gt;&gt;&lt;&lt;/link&gt;&gt;
&lt;&lt;elseif $choice == &quot;放羊&quot;&gt;&gt;&lt;&lt;set _n to random(1,15)&gt;&gt;&lt;&lt;set $fycs -= 1&gt;&gt; &lt;&lt;set _rpe = [&quot;【你接过Era的牧羊杖, 晃着铃铛朝羊群走去. 他们专心致志地啃着草地, 丝毫没有注意到已经更换了牧羊者】&quot;,&quot;【Era很高兴自己能去休息会了, 他找了块舒服的石头躺上去, 有一搭没一搭的跟你聊着, 在你要离开这片草场的时候把帽子盖到脸上, 睡了过去】&quot;].random()&gt;&gt;_rpe&lt;br&gt;
&lt;br&gt;
&lt;&lt;timed 4s t8n&gt;&gt;【你将羊群领到一处又一处的新鲜草地. 
&lt;&lt;if _n &lt;=10 &amp;&amp; $san &lt;= 55&gt;&gt;
&lt;&lt;set _rpe1 = [&quot;羊群咬碎植物的咀嚼声, 奔波于岛屿山坡上的海风, 这个季节独有的阳光和温度, 让你彻底放松下来】&quot;,&quot;一路的步行让你感到疲惫, 你躺在草地上, 试图小眯一觉, 但是有几只绵羊凑过来, 似乎把你当成了新品种的植物, 啃起了你的外套. 你不得不站起来继续你的工作】&quot;].random()&gt;&gt;_rpe1&lt;br&gt;
&lt;br&gt;
&lt;&lt;timed 6s t8n&gt;&gt;【不早了, 是时候把羊群还给Era了】
&lt;br&gt;&lt;br&gt;
&lt;&lt;link ▷「返回」 草甸&gt;&gt;&lt;&lt;set $hour to $hour+ 1&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;&lt;/timed&gt;&gt;
&lt;&lt;elseif _n &lt;=14&gt;&gt;
&lt;&lt;set _rpe1 = [&quot;羊群咬碎植物的咀嚼声, 奔波于岛屿山坡上的海风, 这个季节独有的阳光和温度, 让你彻底放松下来】&quot;,&quot;一路的步行让你感到疲惫, 你躺在草地上, 试图小眯一觉, 但是有几只绵羊凑过来, 似乎把你当成了新品种的植物, 啃起了你的外套. 你不得不站起来继续你的工作】&quot;].random()&gt;&gt;_rpe1&lt;br&gt;
&lt;br&gt;
&lt;&lt;timed 6s t8n&gt;&gt;【不早了, 是时候把羊群还给Era了】
&lt;br&gt;&lt;br&gt;
&lt;&lt;link ▷「返回」 草甸&gt;&gt;&lt;&lt;set $hour to $hour+ 1&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;&lt;/timed&gt;&gt;
&lt;&lt;else&gt;&gt;&lt;&lt;set $sheeploc = [&quot;罗索伦特湖&quot;,&quot;草甸&quot;,&quot;沙地&quot;,&quot;贝雷河&quot;,&quot;小镇&quot;,&quot;礁岩区&quot;,&quot;主港口&quot;,&quot;副港口&quot;,&quot;断桥&quot;,&quot;秋毛岗&quot;,&quot;拓荒者木屋&quot;].random()&gt;&gt;&lt;&lt;set $sheep -=1&gt;&gt;&lt;&lt;set $lostsheep[0] = 1, $lostsheep[1] += 1&gt;&gt;
&lt;&lt;set _rpe1 = [&quot;羊群咬碎植物的咀嚼声, 奔波于岛屿山坡上的海风, 这个季节独有的阳光和温度, 让你感觉困倦. 没多久, 你就睡着了】&quot;,&quot;一路的步行让你感到疲惫, 你躺在草地上, 试图小眯一觉. 不一会, 你就睡着了】&quot;].random()&gt;&gt;_rpe1&lt;br&gt;&lt;br&gt;
&lt;&lt;timed 6s t8n&gt;&gt;【你醒了过来. 你想知道自己睡了多久】&lt;br&gt;&lt;br&gt;
【你站起身, 开始清点羊群. 一只, 两只...一共有$sheep只. 但是Era的羊群应该有&lt;&lt;=$sheep +1&gt;&gt;只绵羊. 你意识到自己弄丢了一只绵羊, 你得在给Era交差前找到它】&lt;br&gt;&lt;br&gt;
&lt;&lt;if $lostsheep[1] ==1&gt;&gt;&lt;&lt;notify 5s&gt;&gt;&lt;font color=&quot;BD5786&quot;&gt;☆获得成就 : 新手牧羊人☆&lt;/font&gt;&lt;&lt;/notify&gt;&gt;&lt;&lt;set $achv.push({name: &#39;新手牧羊人&#39;, dscr: &#39;【你很确信羊不是种聪明的动物, 但把它们弄丢的你此刻显得更不聪明】&#39;})&gt;&gt;&lt;&lt;/if&gt;&gt;

//通过地图在不同地点找羊, 你必须在今天结束之前找到丢失的绵羊, 否则era要收取200鸟羽的赔偿金//
&lt;&lt;link ▷「继续」 草甸&gt;&gt;&lt;&lt;set $choice to 0&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;&lt;/timed&gt;&gt;
&lt;&lt;/if&gt;&gt;&lt;br&gt;&lt;br&gt;
&lt;&lt;/timed&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;if $choice == &quot;接受&quot;&gt;&gt;&lt;&lt;set $erahgd += 5&gt;&gt;&lt;&lt;set _s to random(1,4)&gt;&gt;
【故事的内容是他那亦真亦假的海盗生涯, 你已经听过无数遍, 但你还是表现出认真聆听的样子】&lt;br&gt;
&lt;&lt;if $erahgd &lt;= 25 &amp;&amp; _s ==1&gt;&gt;&lt;&lt;pickup $item &quot;海螺号角&quot; 1&gt;&gt;
&lt;br&gt;【Era似乎很满意你的态度, 从他的随身物品中翻出来一只抛光过的海螺送给你】&lt;br&gt;&lt;font color=#4E84BA&gt;✧你获得海螺号角*1✧&lt;/font&gt;
&lt;br&gt;&lt;br&gt;
&lt;&lt;link ▷「继续」 草甸&gt;&gt;&lt;&lt;set $choice to 0&gt;&gt;&lt;&lt;/link&gt;&gt;
&lt;&lt;/if&gt;&gt;&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="13" name="map" tags="" position="0,100" size="100,100">&lt;center&gt;&lt;img src=&quot;https://f2.toyhou.se/file/f2-toyhou-se/images/87543023_OIVHUOa4IIFoVeI.png&quot;  width=100%&gt;&lt;h3&gt;--- 可活动地区 ---&lt;/h3&gt;
&lt;&lt;link [[♢「小镇」|小镇]]&gt;&gt;&lt;&lt;dialogclose&gt;&gt;&lt;&lt;/link&gt;&gt;  &lt;&lt;link [[♢「草甸」|草甸]]&gt;&gt;&lt;&lt;dialogclose&gt;&gt;&lt;&lt;/link&gt;&gt;  &lt;&lt;link [[♢「沙地」|沙地]]&gt;&gt;&lt;&lt;dialogclose&gt;&gt;&lt;&lt;/link&gt;&gt; &lt;&lt;link [[♢「高地」|高地]]&gt;&gt;&lt;&lt;dialogclose&gt;&gt;&lt;&lt;/link&gt;&gt; &lt;&lt;link [[♢「贝雷河」|贝雷河]]&gt;&gt;&lt;&lt;dialogclose&gt;&gt;&lt;&lt;/link&gt;&gt; 
&lt;&lt;link [[♢「秋毛岗」|秋毛岗]]&gt;&gt;&lt;&lt;dialogclose&gt;&gt;&lt;&lt;/link&gt;&gt; &lt;&lt;link [[♢「罗索伦特湖」|罗索伦特湖]]&gt;&gt;&lt;&lt;dialogclose&gt;&gt;&lt;&lt;/link&gt;&gt; &lt;&lt;link [[♢「主港口」|主港口]]&gt;&gt;&lt;&lt;dialogclose&gt;&gt;&lt;&lt;/link&gt;&gt; &lt;&lt;link [[♢「副港口」|副港口]]&gt;&gt;&lt;&lt;dialogclose&gt;&gt;&lt;&lt;/link&gt;&gt; &lt;&lt;link [[♢「礁岩区」|礁岩区]]&gt;&gt;&lt;&lt;dialogclose&gt;&gt;&lt;&lt;/link&gt;&gt;

&lt;h3&gt;--- 禁止前往地区 ---&lt;/h3&gt;
♢「深林」   ♢「山区」   ♢「守夜者钟楼」&lt;/center&gt;

&lt;div style=&quot;float: right;&quot;&gt;&lt;&lt;link ♢「漫步」&gt;&gt;&lt;&lt;wanderWidget&gt;&gt;&lt;&lt;goto $locs&gt;&gt;&lt;&lt;dialogclose&gt;&gt;&lt;&lt;/link&gt;&gt;     &lt;&lt;link ♢「回家」&gt;&gt;&lt;&lt;dialogclose&gt;&gt;&lt;&lt;if $home == &quot;旅店&quot;&gt;&gt;&lt;&lt;goto &quot;旅店&quot;&gt;&gt;&lt;&lt;elseif $home == &quot;暂无&quot;&gt;&gt;&lt;&lt;run Dialog.setup(&quot;回家&quot;);Dialog.wiki(&quot;你还没有住所&quot;);Dialog.open();&gt;&gt;&lt;&lt;else&gt;&gt;&lt;&lt;goto &quot;家&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;/div&gt;&lt;br&gt;&lt;br&gt;</tw-passagedata><tw-passagedata pid="14" name="seisi" tags="" position="1300,100" size="100,100">&lt;&lt;set _rpl= [&quot;【Seisi抖抖翅膀表示祂听到了】&quot;,&quot;【Seisi偏着头等待你继续说下去】&quot;].random()&gt;&gt;_rpl


&lt;&lt;link &quot;✧问好&quot;&gt;&gt;&lt;&lt;run Dialog.setup(&quot;问好&quot;);Dialog.wiki(Story.get(&quot;问好&quot;).processText());Dialog.open();&gt;&gt;&lt;&lt;/link&gt;&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;&lt;link &quot;✧鸟窝&quot;&gt;&gt;&lt;&lt;run Dialog.setup(&quot;鸟窝&quot;);Dialog.wiki(Story.get(&quot;鸟窝&quot;).processText());Dialog.open();&gt;&gt;&lt;&lt;/link&gt;&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;&lt;link &quot;✧领鸟羽&quot;&gt;&gt;&lt;&lt;run Dialog.setup(&quot;领鸟羽&quot;);Dialog.wiki(Story.get(&quot;领鸟羽&quot;).processText());Dialog.open();&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;&lt;if $dn == 0&gt;&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;&lt;link &quot;✧晚安&quot;&gt;&gt;&lt;&lt;set $hi = 1&gt;&gt;&lt;&lt;run Dialog.setup(&quot;晚安&quot;);Dialog.wiki(Story.get(&quot;问好&quot;).processText());Dialog.open();&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;&lt;/if&gt;&gt;
&lt;&lt;if $firsts == 1&gt;&gt;&lt;&lt;link &quot;✧赚钱指南&quot;&gt;&gt;&lt;&lt;run Dialog.setup(&quot;赚钱指南&quot;);Dialog.wiki(Story.get(&quot;赚钱指南&quot;).processText());Dialog.open();&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="15" name="一般梦" tags="" position="1200,300" size="100,100">&lt;&lt;set _s to random(1,20)&gt;&gt;&lt;&lt;set $HP to $HP+ 48&gt;&gt;&lt;&lt;if _s &lt;= 12&gt;&gt;&lt;center&gt;——✮入梦·鹈鹕王国✭——&lt;/center&gt;

&lt;&lt;timed 1s t8n&gt;&gt;【你梦到了一片粉色的王国. 海滩四周满是鹈鹕, 它们似乎在按照一种规律逐渐聚集起来, 开始...唱歌和跳舞?】&lt;&lt;/timed&gt;&gt;

&lt;&lt;timed 3s t8n&gt;&gt;【你听到它们唱着】&lt;&lt;/timed&gt;&gt;

&lt;center&gt;&lt;&lt;type 45ms start 3s skipkey &quot; &quot;&gt;&gt;🎶鹈鹕中的国王与皇后啊🎶
🎶再没谁能看到这么大的鸟儿啦!🎶
🎶也没谁有我们像鱼鳍一样的脚掌!🎶
🎶还有那可爱的坚韧似皮革的喉咙和下巴!🎶
🎶羽毛的皮肤, 水中的血脉, 我们是鹈鹕!🎶
🎶再没有像我们这么快乐的鸟儿啦!🎶
🎶羽毛的皮肤, 水中的血脉, 鹈鹕向前走!🎶
🎶那时我们这么想, 现在也还这样!🎶
🎶我们生活全靠着尼罗河, 我们喜欢那儿🎶
🎶夜里我们就睡在悬崖峭壁🎶
🎶白天我们捕鱼, 傍晚我们就站在🎶
🎶铺满黄沙, 光秃秃的长长海岛🎶
🎶当夕阳慢慢下沉🎶
🎶大岩石做的墙也变成暗棕色🎶
🎶紫色的河水迅速地翻滚着黯淡下来🎶
🎶乳白色的朱鹭也一闪而去🎶
🎶翅膀勾着翅膀, 我们围成一圈跳起舞来🎶
🎶我们的脚丫重重踏步, 发出砰砰声🎶
🎶张开我们的大嘴巴, 鹈鹕就要有鹈鹕的样子!🎶
🎶接下来就是我们夜夜哼唱的小曲啦🎶&lt;&lt;/type&gt;&gt;&lt;/center&gt;

&lt;&lt;timed 12s t8n&gt;&gt;&lt;center&gt;——✮入梦·鹈鹕王国·结束✭——&lt;/center&gt;&lt;&lt;/timed&gt;&gt;

&lt;&lt;timed 13s t8n&gt;&gt;【...真是个奇怪的梦. 你醒了过来, 恍惚间感觉镜子里的自己也长出了鹈鹕那样的大嘴巴】

&lt;&lt;link ▷「继续」&gt;&gt;&lt;&lt;goto &quot;家&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;&lt;/timed&gt;&gt;
&lt;&lt;else&gt;&gt;【你从睡眠中醒来. 真是轻松的一觉. 没有梦境的叨扰, 你感到疲惫和劳累都离你而去, 心中只剩宁静】
&lt;&lt;link ▷「继续」&gt;&gt;&lt;&lt;goto &quot;家&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="16" name="主港口" tags="nobr" position="100,300" size="100,100">&lt;&lt;if $loc != &quot;主港口&quot;&gt;&gt;&lt;&lt;set $loc = &quot;主港口&quot;&gt;&gt;&lt;&lt;timeWidget&gt;&gt;&lt;&lt;set $minute to $minute+ random(5,10)&gt;&gt;&lt;&lt;/if&gt;&gt;&lt;img src=&quot;https://f2.toyhou.se/file/f2-toyhou-se/images/87543127_J1376w3l9urqHNz.jpg&quot; width=100% class=&quot;pic&quot;&gt;
//贝雷河的北入海口被建造成了永无乡的主港口, 用于停靠外来船只. 较大的灯塔房是存放物资和信件的仓库, 一旁的小屋是灯塔管理员住所. 供给物资的货轮每月进港两次, 由岛主提前联系, 统一付款, 居民在每月末向岛主支付费用//
&lt;br&gt;
&lt;&lt;NPCloc&gt;&gt;
&lt;br&gt;地点活动&lt;br&gt;
&lt;&lt;if $lostsheep[0] == 1&gt;&gt;[[◈「找羊」|era互动]]&lt;br&gt;&lt;&lt;/if&gt;&gt;
[[◈「钓鱼」|钓鱼]]&lt;br&gt;
[[◈「散步」|散步]]&lt;br&gt;
&lt;br&gt;继续前往&lt;br&gt;
[[✧「灯塔」|灯塔]]&lt;br&gt;
✧「仓库」&lt;br&gt;
✧「港口码头」  &lt;br&gt;
&lt;br&gt;其他地区&lt;br&gt;
[[♢「小镇」|小镇]]&lt;br&gt;
[[♢「沙地」|沙地]]&lt;br&gt;
[[♢「贝雷河」|贝雷河]]</tw-passagedata><tw-passagedata pid="17" name="主线第一天" tags="nobr" position="900,1175" size="100,100">&lt;&lt;if $choice == 0&gt;&gt;
你正打算去忙自己的事, Seisi不知道什么时候已经落在了你的肩膀上, 猛地揪着你的耳朵, 还在发出一种禽类独有的啸叫声. 一时间你不知道耳朵的疼痛和Seisi聒噪的声音哪个让你更痛苦
&lt;br&gt;&lt;br&gt;
&lt;&lt;timed 2s t8n&gt;&gt; ⋙⋙⋙⋙⋙⋙⋘⋘⋘⋘⋘⋘&lt;br&gt;
&lt;&lt;link ▷「你怎么在这儿」 主线第一天&gt;&gt;&lt;&lt;set $choice to &quot;你怎么在这儿&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;br&gt;
&lt;&lt;link ▷「哎哟!」 主线第一天&gt;&gt;&lt;&lt;set $choice to &quot;哎哟&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;&lt;/timed&gt;&gt;

&lt;&lt;elseif $choice == &quot;你怎么在这儿&quot;&gt;&gt;
&lt;font color=#FFAA00&gt; Seisinofoaga&lt;/font&gt;: &lt;br&gt;
我怎么在这儿? 我来庆祝你完成了第一个任务! 喜欢我的祝贺吗, 这可是永无乡上最受欢迎的传统!&lt;br&gt;&lt;br&gt;
&lt;&lt;timed 2s t8n&gt;&gt;Seisi似乎很满意自己的幽默, 在你的肩膀上舒展起了翅膀, 丝毫不顾及有些翎羽差点戳进你的眼睛里&lt;br&gt;&lt;br&gt;
&lt;&lt;next&gt;&gt;好了, 现在快点收拾收拾自己, 岛主要见你&lt;br&gt;
&lt;br&gt;
&lt;&lt;next 1s&gt;&gt; ⋙⋙⋙⋙⋙⋙⋘⋘⋘⋘⋘⋘&lt;br&gt;
&lt;&lt;link ▷「见我?」 主线第一天&gt;&gt;&lt;&lt;set $choice to &quot;见我&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;&lt;/timed&gt;&gt;

&lt;&lt;elseif $choice == &quot;哎哟&quot;&gt;&gt;
&lt;font color=#FFAA00&gt; Seisinofoaga&lt;/font&gt;: &lt;br&gt;
喜欢我的祝贺吗, 这可是永无乡上最受欢迎的传统!&lt;br&gt;&lt;br&gt;
&lt;&lt;timed 2s t8n&gt;&gt;Seisi似乎很满意自己的幽默, 在你的肩膀上舒展起了翅膀, 丝毫不顾及有些翎羽差点戳进你的眼睛里&lt;br&gt;&lt;br&gt;
&lt;&lt;next&gt;&gt;好了, 现在快点收拾收拾自己, 岛主要见你&lt;br&gt;
&lt;br&gt;
&lt;&lt;next 1s&gt;&gt; ⋙⋙⋙⋙⋙⋙⋘⋘⋘⋘⋘⋘&lt;br&gt;
&lt;&lt;link ▷「见我?」 主线第一天&gt;&gt;&lt;&lt;set $choice to &quot;见我&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;&lt;/timed&gt;&gt;

&lt;&lt;elseif $choice == &quot;见我&quot;&gt;&gt;
&lt;font color=#FFAA00&gt; Seisinofoaga&lt;/font&gt;: &lt;br&gt;
对, 你. 你搬到岛上来住, 连这里的管理者都不想见见吗. Nix在拓荒者木屋等你, 动作快些&lt;br&gt;&lt;br&gt;
&lt;&lt;timed 2s t8n&gt;&gt; ⋙⋙⋙⋙⋙⋙⋘⋘⋘⋘⋘⋘&lt;br&gt;
&lt;&lt;link ▷「走吧」 主线第一天&gt;&gt;&lt;&lt;set $choice to &quot;走吧&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;&lt;/timed&gt;&gt;

&lt;&lt;elseif $choice == &quot;走吧&quot;&gt;&gt;
&lt;&lt;set $loc = &quot;拓荒者木屋&quot;&gt;&gt;&lt;&lt;timeWidget&gt;&gt;&lt;&lt;set $minute to $minute+ random(5,10)&gt;&gt;你踏进木屋, 木柴燃烧的气息立刻充斥着你的鼻孔, 却并不刺激, 更像是阳光那般的温暖气息. 你看到木屋的客厅里混杂着藤制摇椅和布制沙发, 似乎随时准备着接待一群客人; 一些盆栽被屋主不经意似地搁置在各个角落, 从横跨客厅外围的落地窗透进的阳光下努力生存; 客厅的另一面墙安上了壁橱, 用来放置各种杂物和书籍, 壁橱的尽头是一直通向屋顶的壁炉, 里面正在热烈燃烧着炉火&lt;br&gt;&lt;br&gt;
&lt;&lt;timed 3s t8n&gt;&gt;你盯着火焰看得出神, 差点没听见Nix那句&quot;请坐下吧&quot;. 等你回过神来, 发现自己已经坐在了沙发上, 面前是摆满茶点的小圆桌, 还有正在为你倒茶的Nix&lt;br&gt;&lt;br&gt;
&lt;&lt;next&gt;&gt;&quot;这些是我平日里的口味, 不知道你会不会喜欢. Nix递来的红茶在阳光下闪烁着宝石般通透的光芒, 热气中透露着那种发酵后的甜腻. 若你对茶叶有些学问, 你就会知道这杯茶的市价不菲&lt;br&gt;&lt;br&gt;
&lt;&lt;next&gt;&gt; ⋙⋙⋙⋙⋙⋙⋘⋘⋘⋘⋘⋘&lt;br&gt;
&lt;&lt;link ▷「喝茶」 主线第一天&gt;&gt;&lt;&lt;set $choice to &quot;喝茶&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;br&gt;
&lt;&lt;link ▷「谢谢」 主线第一天&gt;&gt;&lt;&lt;set $choice to &quot;谢谢&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;&lt;/timed&gt;&gt;

&lt;&lt;elseif $choice == &quot;喝茶&quot;&gt;&gt;
你喝了一口红茶, 如料想中的那般甜味, 还带有植物本该的苦涩和一丝烟熏的口感. 你现在很想来上一块茶点了&lt;br&gt;&lt;br&gt;
&lt;&lt;timed 1s t8n&gt;&gt;见你喝了茶, Nix也坐下享用了她的那杯. 空气中的灰尘在阳光下翻涌, 方才滋养起来的沉默被瓷器碰撞的声响泯末. Nix放下茶杯, 用她的蓝眼睛看着你:&quot;你叫...$nn, 对吧? 如果不对请原谅我, 记忆不是我的一个长项...&quot; 有一瞬间她似乎真的沉浸到了某段回忆中, 但在你能辨认之前就回到了微笑的表情】&lt;br&gt;&lt;br&gt;
&lt;&lt;next 3s&gt;&gt;&lt;&lt;link ▷「继续」 主线第一天&gt;&gt;&lt;&lt;set $choice to &quot;继续&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;&lt;/timed&gt;&gt;

&lt;&lt;elseif $choice == &quot;谢谢&quot;&gt;&gt;你道谢一声, 低头喝了口红茶, 如料想中的那般甜味, 还带有植物本该的苦涩和一丝烟熏的口感. 你现在很想来上一块茶点了&lt;br&gt;&lt;br&gt;
&lt;&lt;timed 1s t8n&gt;&gt;见你喝了茶, Nix也坐下享用了她的那杯. 空气中的灰尘在阳光下翻涌, 方才滋养起来的沉默被瓷器碰撞的声响泯末. Nix放下茶杯, 用她的蓝眼睛看着你:&quot;你叫...$nn, 对吧? 如果不对请原谅我, 记忆不是我的一个长项...&quot; 有一瞬间她似乎真的沉浸到了某段回忆中, 但在你能辨认之前就回到了微笑的表情&lt;&lt;/timed&gt;&gt;&lt;br&gt;&lt;br&gt;
&lt;&lt;timed 3s t8n&gt;&gt;&lt;&lt;link ▷「继续」 主线第一天&gt;&gt;&lt;&lt;set $choice to &quot;继续&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;&lt;/timed&gt;&gt;

&lt;&lt;elseif $choice == &quot;继续&quot;&gt;&gt;
&lt;&lt;if $id != &quot;无&quot;&gt;&gt;&quot;你是一名$id? 这很不错. 我知道你今天可能听过数十次了, 但我还是要说, 欢迎你入住永无乡. &quot;你觉得她几乎是迫不及待的说出来这句, &quot;这不是什么大地方, 比不上那些城市, 但大家的生活都很愉快, 彼此之间也没有什么隔阂, 而这就是我建起永无乡的初衷. &quot;&lt;&lt;else&gt;&gt;我知道你今天可能听过数十次了, 但我还是要说, 欢迎你入住永无乡. &quot;你觉得她几乎是迫不及待的说出来这句, &quot;这不是什么大地方, 比不上那些城市, 但大家的生活都很愉快, 彼此之间也没有什么隔阂, 而这就是我建起永无乡的初衷. &quot;&lt;&lt;/if&gt;&gt;&lt;br&gt;&lt;br&gt;
&lt;&lt;timed 2s t8n&gt;&gt;&quot;我知道任何事情在最开始时都会很艰难, 所以为了让新居民们能尽快拥有更好的生活品质, 我们在小镇的教堂里准备了一些免费物资, 在你空闲时间去找Daisy牧师领取就好, 他一般不会离开教堂太久. &quot;&lt;&lt;set _bjb to 0&gt;&gt;&lt;&lt;/timed&gt;&gt;&lt;br&gt;&lt;br&gt;
&lt;&lt;timed 4s t8n&gt;&gt;&quot;作为欢迎, 礼拜三的晚上我会在木屋外办一场篝火晚会, 新居民都会收到邀请, 老居民想参加就得靠自己的努力了, 毕竟我们的邀请函过上几天就会枯萎&quot;她边说着边从桌上的花篮里摘出一枝白玫瑰, 你很容易就注意到枝干上的棘刺已经被精心剔除, 花托上还绑着一根蓝丝带&lt;br&gt;
&lt;&lt;pickup $item &quot;丝带白玫瑰&quot; 1&gt;&gt;&lt;&lt;set _itemobtain = &quot;丝带白玫瑰 * 1&quot;&gt;&gt;&lt;&lt;itemobtain&gt;&gt;&lt;&lt;/timed&gt;&gt;
&lt;&lt;timed 8s t8n&gt;&gt;&quot;礼拜三晚上六点以后, 来拓荒者木屋带上白玫瑰, 你就能参加我们的篝火晚会啦. &quot;&lt;&lt;/timed&gt;&gt;&lt;br&gt;&lt;br&gt;
&lt;&lt;timed 9s t8n&gt;&gt;[[▷「继续」|提问2]]&lt;&lt;/timed&gt;&gt;

&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="18" name="主线第一天结束" tags="nobr" position="1300,1175" size="100,100">&lt;&lt;set $mss to &quot;主线第一天结束&quot;&gt;&gt;&lt;&lt;if $choice == &quot;进房&quot;&gt;&gt;【你跟着女孩来到二楼, 用钥匙打开了一个老式门锁, 眼前是一个狭小的单人间, 但看起来设施齐全, 起码对于它的价格来说已经足够了】&lt;br&gt;【你获得了在旅店的临时住所】&lt;&lt;set $home to &quot;旅店&quot;&gt;&gt;
&lt;br&gt;&lt;&lt;link ♢「继续」 家&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;&lt;elseif $choice == &quot;再想想&quot;&gt;&gt;【你觉得再考虑考虑这件事, 毕竟一晚10鸟羽的价格对现在的你来说也不是一笔小钱】&lt;br&gt;
【你离开了旅店】&lt;br&gt;
&lt;&lt;link ♢「继续」 小镇&gt;&gt;&lt;&lt;set $choice to 0&gt;&gt;&lt;&lt;/link&gt;&gt;
&lt;&lt;elseif $choice == &quot;拒绝&quot;&gt;&gt;【野外生活可能就是你所追求的, 你没再多想的拒绝了岛上的安排. Nix看上去有些无奈, 但还是尊重了你的选择. 她最后说:&quot;后悔的话再来找我也没关系, 总有一把钥匙会给你留着的. &quot;】&lt;br&gt;
【你离开了拓荒者木屋】&lt;br&gt;
&lt;&lt;link [[♢「继续」|高地]]&gt;&gt;&lt;&lt;set $choice to 0&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="19" name="主线第三天" tags="nobr" position="1500,1275" size="100,100">&lt;&lt;if $choice == 0&gt;&gt;
&lt;&lt;set $mss to &quot;主线第三天&quot;&gt;&gt;
【你来到了小镇广场】
&lt;br&gt;&lt;br&gt;
【你注意到今天的小镇不同以往的安静, 店铺的门窗都紧闭着, 虽然看起来并不像是打烊, 但几乎没有顾客像往常那样进出店门. 你疑惑的走在街道上, 意识到路旁看见你的居民都开始窃窃私语, 那些猫究竟在说些什么? 但你意识到猫群的注意力已经被另一种东西吸引过去——你回头, 看到治安官已经跨过了贝雷桥, 要进到小镇来了】&lt;br&gt;&lt;br&gt;
⋙⋙⋙⋙⋙⋙⋘⋘⋘⋘⋘⋘&lt;br&gt;
&lt;&lt;link ▷「站到旁边」 主线第三天&gt;&gt;&lt;&lt;set $choice to &quot;站到旁边&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;br&gt;
&lt;&lt;link ▷「站在原地」 主线第三天&gt;&gt;&lt;&lt;set $choice to &quot;站在原地&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;

&lt;&lt;elseif $choice == &quot;站到旁边&quot;&gt;&gt;
【你站到了街边, 和其他那些注视着治安官每一个步伐的居民混在一起, 试图让自己不被注意. 治安官身后还跟着一个人, 那是你不熟悉的面孔, 从服装上来看并不会是的同事, 并且他一幅筋疲力尽的模样, 仿佛刚从一场远征中归来. 治安官的目光一刻都没有落到你身上, 周围的居民似乎也对你不再感兴趣, 看来无论接下来会发生什么, 都与你无关了】&lt;br&gt;&lt;br&gt;
⋙⋙⋙⋙⋙⋙⋘⋘⋘⋘⋘⋘&lt;br&gt;
&lt;&lt;link ▷「离开」 主线第三天结束&gt;&gt;&lt;&lt;set $choice to &quot;离开&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;br&gt;
&lt;&lt;link ▷「询问周围居民」 主线第三天&gt;&gt;&lt;&lt;set $choice to &quot;询问周围居民&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;

&lt;&lt;elseif $choice == &quot;站在原地&quot;&gt;&gt;
【你有些不知所措的愣在原地, 眼看治安官离自己越来越近, 衣领突然被从身后拽住, 你几乎是像一篮蔬菜那般被提起, 接着被蛮横地拖进街道旁的屋檐下. 直到这时你才看清身后的猫是谁, 但那位壮硕的木匠还不等你开口, 就粗声指责你: &quot;你是傻了吗, 看不到治安官在进行审判吗? &quot;你这才注意到治安官Alex身后还跟着一个人, 那是你不熟悉的面孔, 从服装上来看并不会是Alex的同事, 并且他一幅筋疲力尽的模样, 仿佛刚从一场远征中归来. 治安官的目光一刻都没有落到你身上, 周围的居民似乎也对你不再感兴趣, 看来无论接下来会发生什么, 都与你无关了】&lt;br&gt;&lt;br&gt;
⋙⋙⋙⋙⋙⋙⋘⋘⋘⋘⋘⋘&lt;br&gt;
&lt;&lt;link ▷「离开」 主线第三天结束&gt;&gt;&lt;&lt;set $choice to &quot;离开&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;br&gt;
&lt;&lt;link ▷「审判?」 主线第三天&gt;&gt;&lt;&lt;set $choice to &quot;审判&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;

&lt;&lt;elseif $choice == &quot;询问周围居民&quot;&gt;&gt;
【你忍不住好奇, 想知道眼前这幅景象到底是怎么一回事, 而在猫群里那丛熟悉的蓝灰色正好闯进你的视线. 那是奥里, 岛上的信者, 你敢肯定她会很乐意告诉你在发生什么. 你跻身到奥里身旁, 轻声跟她打了招呼, 她表现出一阵小小的惊讶, 但很快就表示很高兴又见到你. 你向她提出来自己的疑惑】&lt;br&gt;&lt;br&gt;
&lt;&lt;timed 3s&gt;&gt;【&quot;是审判! &quot;奥里小声回答你, 似乎在避免和你眼神对视, &quot;岛上那些罪行过多的猫会被发起审判, 这是他们的惩罚. &quot;】&lt;br&gt;&lt;br&gt;
⋙⋙⋙⋙⋙⋙⋘⋘⋘⋘⋘⋘&lt;br&gt;
&lt;&lt;link ▷「罪行?」 主线第三天&gt;&gt;&lt;&lt;set $choice to &quot;罪行a&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;&lt;/timed&gt;&gt;

&lt;&lt;elseif $choice == &quot;审判&quot;&gt;&gt;
【你忍不住好奇, 向安山提出了这个问题, 高大的狸花猫上下大量你一番, 似乎确定你是新来的居民才开口回答: &quot;岛上的审判, 罪行过多的猫会被选出来接受惩罚. &quot;】&lt;br&gt;&lt;br&gt;
⋙⋙⋙⋙⋙⋙⋘⋘⋘⋘⋘⋘&lt;br&gt;
&lt;&lt;link ▷「罪行?」 主线第三天&gt;&gt;&lt;&lt;set $choice to &quot;罪行b&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;

&lt;&lt;elseif $choice == &quot;罪行a&quot;&gt;&gt;
【你以为永无乡对这些事情都不以为然, 全盘接受呢. &quot;岛上有一些明令禁止的事情, 如果你做了那些——当然你千万不要去做, 岛主的鸟都会知道的, 然后就变得像Paul一样. &quot;她在说跟在治安官身后那只公猫, &quot;哦, 可怜的Paul, 他拒绝接受审判, 跑到山区待了一晚, 差点儿把命搞丢, 但前往禁区只会让他的罪恶更多...&quot;】&lt;br&gt;&lt;br&gt;
⋙⋙⋙⋙⋙⋙⋘⋘⋘⋘⋘⋘&lt;br&gt;
&lt;&lt;link ▷「惩罚?」 主线第三天&gt;&gt;&lt;&lt;set $choice to &quot;惩罚a&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;

&lt;&lt;elseif $choice == &quot;罪行b&quot;&gt;&gt;
【你以为永无乡对这些事情都不以为然, 全盘接受呢. &quot;没有规矩何成方圆. 岛上当然有自己的规矩, 你要是犯了那些, 就会跟这个人一样, &quot;安山在说跟在治安官身后那只公猫, &quot;他做了恶行, 还不接受审判结果, 跑到山区待了一晚, 差点儿把命搞丢, 早知今日何必当初呢. &quot;】&lt;br&gt;&lt;br&gt;
⋙⋙⋙⋙⋙⋙⋘⋘⋘⋘⋘⋘&lt;br&gt;
&lt;&lt;link ▷「惩罚?」 主线第三天&gt;&gt;&lt;&lt;set $choice to &quot;惩罚b&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;

&lt;&lt;elseif $choice == &quot;惩罚a&quot;&gt;&gt;
【&quot;恶行总得有惩罚, 不是吗, 这是大家都接受的, 而且岛主尽可能的让惩罚更贴合个人意愿, 被审判的猫可以选择自己最接受的惩罚方式. &quot;她盯着你的眼睛, 确保你仍在听她讲话, &quot;但惩罚依旧是惩罚, 答应我不要去做那些事. &quot;】&lt;br&gt;&lt;br&gt;
⋙⋙⋙⋙⋙⋙⋘⋘⋘⋘⋘⋘&lt;br&gt;
&lt;&lt;link ▷「我明白了」 主线第三天&gt;&gt;&lt;&lt;set $choice to &quot;我明白了&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;

&lt;&lt;elseif $choice == &quot;惩罚b&quot;&gt;&gt;
【&quot;没有惩罚怎么能叫规矩, 你来的地方是没有这些东西吗. &quot;他看起来已经开始不耐烦了, &quot;你要是好奇惩罚内容, 就等着自己的那天吧. &quot;】&lt;br&gt;&lt;br&gt;
⋙⋙⋙⋙⋙⋙⋘⋘⋘⋘⋘⋘&lt;br&gt;
&lt;&lt;link ▷「我明白了」 主线第三天&gt;&gt;&lt;&lt;set $choice to &quot;我明白了&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;

&lt;&lt;elseif $choice == &quot;我明白了&quot;&gt;&gt;
【治安官带着那只公猫往教堂方向走去, 猫群渐渐散开, 你的同伴也告别了你重新回到工作上去. 你一时不知该去做些什么】&lt;br&gt;&lt;br&gt;
⋙⋙⋙⋙⋙⋙⋘⋘⋘⋘⋘⋘&lt;br&gt;
&lt;&lt;link ▷「离开」 主线第三天结束&gt;&gt;&lt;&lt;set $choice to &quot;离开&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;br&gt;
&lt;&lt;link ▷「偷偷跟着治安官」 主线第三天&gt;&gt;&lt;&lt;audio &quot;diceroll&quot; play&gt;&gt;&lt;&lt;set $choice to &quot;偷偷跟着治安官&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;

&lt;&lt;elseif $choice == &quot;偷偷跟着治安官&quot;&gt;&gt;
【既然没有猫愿意告诉自己审判的惩罚, 那你就只能自己去发现了. 你偷偷跟在治安官一行后面, 试图让自己看起来只是恰好同路要去往教堂. 
&lt;&lt;set _a to setup.getStat(&quot;observation&quot;)/18*100&gt;&gt;&lt;&lt;checkWidget&gt;&gt;
&lt;&lt;if _rst == &quot;大成功&quot; || _rst == &quot;成功&quot;&gt;&gt;你一路跟着他们到了教堂外, 没被谁注意到, 直到他们走进教堂, 门口看守模样的猫走过来把你拦下, 告你你里面正在进行审判】
&lt;&lt;set $observationexp to $observationexp+4&gt;&gt;&lt;&lt;addoexpWidget&gt;&gt;
&lt;br&gt;&lt;br&gt;
⋙⋙⋙⋙⋙⋙⋘⋘⋘⋘⋘⋘&lt;br&gt;
&lt;&lt;link ▷「离开」 主线第三天结束&gt;&gt;&lt;&lt;set $choice to &quot;离开a&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;br&gt;
&lt;&lt;link ▷「寻找别的入口」 主线第三天&gt;&gt;&lt;&lt;audio &quot;diceroll&quot; play&gt;&gt;&lt;&lt;set $choice to &quot;寻找别的入口&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;

&lt;&lt;else&gt;&gt;也许是你跟的太紧, 原本站在教堂门口, 看守模样的猫径直走到了你面前, 询问你为何在偷偷摸摸跟着他们】&lt;br&gt;&lt;br&gt;
⋙⋙⋙⋙⋙⋙⋘⋘⋘⋘⋘⋘&lt;br&gt;
&lt;&lt;link ▷「说实话」 主线第三天结束&gt;&gt;&lt;&lt;set $choice to &quot;说实话&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;br&gt;
&lt;&lt;link ▷「撒谎」 主线第三天结束&gt;&gt;&lt;&lt;audio &quot;diceroll&quot; play&gt;&gt;&lt;&lt;set $choice to &quot;撒谎&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;&lt;/if&gt;&gt;

&lt;&lt;elseif $choice == &quot;寻找别的入口&quot;&gt;&gt;
【你只好绕远, 从另一侧来到了教堂的北侧, 不论里面在进行什么, 你猜测都会是在这个方位, 毕竟这是圣坛的位置. 
&lt;&lt;set _a to $luck&gt;&gt;&lt;&lt;checkWidget&gt;&gt;
&lt;&lt;if _rst == &quot;大成功&quot; || _rst == &quot;成功&quot;&gt;&gt;
幸运的是, 北侧的窗户有一扇在虚掩着, 你正好能靠它听清里面的谈话】
&lt;br&gt;&lt;br&gt;
&lt;&lt;timed 2s&gt;&gt;【&quot;...我承认...&quot; 你听到里面传来这样的话语, 不一会后是另一个声音在说话: &quot;...从今天开始...你被...成为守夜者. &quot;】&lt;&lt;/timed&gt;&gt;
&lt;&lt;timed 4s&gt;&gt;【你觉得你该走了】&lt;&lt;set $clue.push({name: &#39;守夜者&#39;, dscr: &#39;审判的惩罚是成为守夜者&#39;})&gt;&gt;&lt;&lt;notify 3s&gt;&gt;〖获得线索: 守夜者〗&lt;&lt;/notify&gt;&gt;&lt;br&gt;&lt;br&gt;
⋙⋙⋙⋙⋙⋙⋘⋘⋘⋘⋘⋘&lt;br&gt;
&lt;&lt;link ▷「离开」 主线第三天结束&gt;&gt;&lt;&lt;set $choice to &quot;离开b&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;&lt;/timed&gt;&gt;
&lt;&lt;else&gt;&gt;可所有的窗户都紧闭着, 你在这些彩窗的阻拦下能听到的只有风声】&lt;br&gt;&lt;br&gt;
⋙⋙⋙⋙⋙⋙⋘⋘⋘⋘⋘⋘&lt;br&gt;
&lt;&lt;link ▷「离开」 主线第三天结束&gt;&gt;&lt;&lt;set $choice to &quot;离开a&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;&lt;/if&gt;&gt;

&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="20" name="主线第三天结束" tags="nobr" position="1650,1325" size="100,100">&lt;&lt;set $mss to &quot;主线第三天结束&quot;&gt;&gt;
&lt;&lt;if $choice == &quot;离开&quot;&gt;&gt;【治安官一行已经走远, 你也对之后的事情不感兴趣, 着手去干自己的事了】
&lt;&lt;timed 4s&gt;&gt;&lt;&lt;goto &quot;demo结语&quot;&gt;&gt;&lt;&lt;/timed&gt;&gt;

&lt;&lt;elseif $choice == &quot;离开a&quot;&gt;&gt;【你一无所获的离开, 好奇心没能得到回报的感觉并不好受, 但你今天的冒险冒险要到此为止了】&lt;&lt;timed 4s&gt;&gt;&lt;&lt;goto &quot;demo结语&quot;&gt;&gt;&lt;&lt;/timed&gt;&gt;

&lt;&lt;elseif $choice == &quot;离开b&quot;&gt;&gt;【你心情沉重的从教堂走远, 耳边仍回响着刚才听到的谈话. 为何成为守夜者是审判的惩罚? 你还不曾接触过任何一名守夜者, 只知道他们是保护岛上安全的存在】&lt;&lt;timed 4s&gt;&gt;&lt;&lt;goto &quot;demo结语&quot;&gt;&gt;&lt;&lt;/timed&gt;&gt;

&lt;&lt;elseif $choice == &quot;说实话&quot;&gt;&gt;【你如实告诉他, 自己是因为好奇审判才做出这样的行为, 他有些无奈的接受了你的解释, 告诉你审判的过程不被允许观看. 等你们完成这段谈话, 治安官已经再次出现在教堂门口, 审判似乎已经结束了】&lt;br&gt;&lt;&lt;set $social to $social+ 1&gt;&gt;&lt;font color=#FFAA00&gt;你的社会属性提升了1级&lt;/font&gt;
&lt;br&gt;&lt;br&gt;
&lt;&lt;link ▷「离开」 主线第三天结束&gt;&gt;&lt;&lt;set $choice to &quot;离开a&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;

&lt;&lt;elseif $choice == &quot;撒谎&quot;&gt;&gt;【你撒了个谎, 
&lt;&lt;set _a to setup.getStat(&quot;persuasive&quot;)/18*100&gt;&gt;&lt;&lt;checkWidget&gt;&gt;
&lt;&lt;if _rst == &quot;大成功&quot; || _rst == &quot;成功&quot;&gt;&gt;他看起来接受了你的说法, 准备放你走了. 等你们完成这段谈话, 治安官已经再次出现在教堂门口, 审判似乎已经结束了】
&lt;&lt;set $persuasiveexp += 4&gt;&gt;&lt;&lt;addpexpWidget&gt;&gt;
&lt;&lt;else&gt;&gt;他看起来并没有相信你的说法, 一直怀疑的盯着你. 等你们完成这段谈话, 治安官已经再次出现在教堂门口, 审判似乎已经结束了】&lt;&lt;set $player.suspicion +=2&gt;&gt;&lt;font color=#BA3030&gt;你的怀疑增加了2级&lt;/font&gt;&lt;&lt;/if&gt;&gt;
&lt;br&gt;&lt;br&gt;
&lt;&lt;link ▷「离开」 主线第三天结束&gt;&gt;&lt;&lt;set $choice to &quot;离开a&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;

&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="21" name="主线第二天" tags="nobr" position="1400,1175" size="100,100">&lt;&lt;if $choice == 0&gt;&gt;
&lt;&lt;set $mss to &quot;主线第二天&quot;&gt;&gt;
【你即将开始新一天的生活, 小镇的一角外却传来杂乱的响动, 你走过去查看, 只见旅店的门前站着一个中年模样的公猫, 抱着一堆收纳箱, 正在竭尽全力用打开旅店的门. 可能是拿了太多的物件的原因, 他始终没能做到这件简单的事情】&lt;br&gt;&lt;br&gt;
⋙⋙⋙⋙⋙⋙⋘⋘⋘⋘⋘⋘&lt;br&gt;
&lt;&lt;link ▷「帮帮他」 主线第二天&gt;&gt;&lt;&lt;set $choice to &quot;帮帮他&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;br&gt;
&lt;&lt;link ▷「不理他」 主线第二天&gt;&gt;&lt;&lt;set $choice to &quot;不理他&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;

&lt;&lt;elseif $choice == &quot;帮帮他&quot;&gt;&gt;
【你的教养不允许你在这种场合视而不见, 你上前去, 从他看不到的角度转动了门把手, 帮他打开了门. 男子愣了一会, 转身才看到身旁的你, 感激得仿佛快哭出来, 他想伸手向你道谢, 收纳盒随着他的动作全部掉到了地上. &quot;哦不... &quot;他的姿态定格在伸出右手的那一刻】&lt;br&gt;&lt;br&gt;
⋙⋙⋙⋙⋙⋙⋘⋘⋘⋘⋘⋘&lt;br&gt;
&lt;&lt;link ▷「握住他的手」 主线第二天&gt;&gt;&lt;&lt;set $choice to &quot;握住他的手&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;br&gt;
&lt;&lt;link ▷「帮他捡起箱子」 主线第二天&gt;&gt;&lt;&lt;set $choice to &quot;帮他捡起箱子&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;

&lt;&lt;elseif $choice == &quot;不理他&quot;&gt;&gt;
【你对陌生猫的挣扎视而不见, 你还有更要紧的事情要做呢. 可当你准备离开, 那男子咚一声倒在地上, 怀里的箱子也散落一地, 有一个还滚到了你的脚边. 你看看箱子, 又看看坐在地上的公猫, 他眼中是你无法忍受的无助】&lt;br&gt;&lt;br&gt;
⋙⋙⋙⋙⋙⋙⋘⋘⋘⋘⋘⋘&lt;br&gt;
&lt;&lt;link ▷「帮他捡起箱子」 主线第二天&gt;&gt;&lt;&lt;set $choice to &quot;帮他捡起箱子&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;

&lt;&lt;elseif $choice == &quot;握住他的手&quot;&gt;&gt;
【你决定在应对第二场意外之前先回应他的道谢, 并在握住对方手掌时说了几句安慰的话. 他看起来冷静了一些】&lt;br&gt;&lt;br&gt;
⋙⋙⋙⋙⋙⋙⋘⋘⋘⋘⋘⋘&lt;br&gt;
&lt;&lt;link ▷「帮他捡起箱子」 主线第二天&gt;&gt;&lt;&lt;audio &quot;diceroll&quot; play&gt;&gt;&lt;&lt;set $choice to &quot;帮他捡起箱子&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;

&lt;&lt;elseif $choice == &quot;帮他捡起箱子&quot;&gt;&gt;&lt;&lt;set $loc = &quot;旅店&quot;&gt;&gt;
【这些木箱子被很好的装订着, 即使再来一次意外也不会有多少损坏. 你抱起一个箱子, 很自然的帮他拿进了门. 他拖拽着剩余的几个跟在你身后】

&lt;&lt;set _a to setup.getStat(&quot;observation&quot;)/10*100&gt;&gt;&lt;&lt;checkWidget&gt;&gt;&lt;&lt;set _check1 = _rst&gt;&gt;
&lt;&lt;if _check1 == &quot;成功&quot;&gt;&gt;
&lt;&lt;timed 2s&gt;&gt;&lt;br&gt;&lt;br&gt;【在你搬起另一个箱子时, 你发现有一些木条松动了, 隐隐约约你可以看见, 里面装着一些布条包裹的画框】
&lt;&lt;set $observationexp to $observationexp+2&gt;&gt;&lt;&lt;addoexpWidget&gt;&gt;&lt;&lt;/timed&gt;&gt; 
&lt;&lt;elseif _check1 == &quot;大成功&quot;&gt;&gt;
&lt;&lt;set _a to setup.getStat(&quot;knowledge&quot;)/27*100&gt;&gt;&lt;&lt;checkWidget&gt;&gt;&lt;&lt;set _check2 = _rst&gt;&gt;
&lt;&lt;if _check2 == &quot;大成功&quot; || _check2 == &quot;成功&quot;&gt;&gt;
&lt;&lt;timed 2s&gt;&gt;&lt;br&gt;&lt;br&gt;【在你搬起另一个箱子时, 你发现有一些木条松动了, 隐隐约约你可以看见, 里面装着一些画框, 借着渗透进去的光线, 你似乎可以看见画布的内容. 你不太确定你看到了什么，画中的人物看上去衣着古典, 整个画面的氛围给你一种熟悉又遥远的感觉. 你确信你从未见过这样的作品】&lt;&lt;set $clue.push({name: &#39;第一个朋友&#39;, dscr: &#39;他的行李里有一些画面奇怪的油画&#39;})&gt;&gt;&lt;br&gt;
〖获得线索: 第一个朋友〗&lt;&lt;set $knowledgeexp += 6&gt;&gt;&lt;&lt;addkexpWidget&gt;&gt;&lt;&lt;set $observationexp to $observationexp+2&gt;&gt;&lt;&lt;addoexpWidget&gt;&gt;&lt;&lt;/timed&gt;&gt; 
&lt;&lt;else&gt;&gt;
&lt;&lt;timed 2s&gt;&gt;&lt;br&gt;&lt;br&gt;【在你搬起另一个箱子时, 你发现有一些木条松动了, 隐隐约约你可以看见, 里面装着一些画框, 借着渗透进去的光线, 你似乎可以看见画布的内容】&lt;&lt;/timed&gt;&gt; &lt;&lt;/if&gt;&gt;&lt;&lt;/if&gt;&gt;

&lt;br&gt;&lt;br&gt;
&lt;&lt;timed 4s&gt;&gt;【你们合力安放好了箱子, 现在终于可以安全的说上话了. 他先迫不及待的开了口 : &quot;这些实在是...实在是太感谢了, 我不知道该怎么回报你, 呃...&quot;他看起来用尽了全力在回忆, &quot;抱歉, 你有没有告诉过我你的名字? &quot;】&lt;br&gt;&lt;br&gt;
⋙⋙⋙⋙⋙⋙⋘⋘⋘⋘⋘⋘&lt;br&gt;
&lt;&lt;link ▷「告诉他」 主线第二天&gt;&gt;&lt;&lt;set $choice to &quot;告诉&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;br&gt;
&lt;&lt;link ▷「不告诉」 主线第二天&gt;&gt;&lt;&lt;set $choice to &quot;不告诉&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;&lt;/timed&gt;&gt; 

&lt;&lt;elseif $choice == &quot;告诉&quot;&gt;&gt;
【眼前这位中年猫显然有一些记忆问题. 你告诉他你们这还是第一次见面, 他可以叫你$nn, 你才来岛上不久. &quot;是这样吗, 那太巧了, 我也才到这里不久, 他们说我可以住在旅店, 我花了很久才找对地方, 现在在搬运我的行李...&quot;他看了眼一旁垒起来的木箱, 眉毛拧成一团, 似乎在想象之后把这些家伙搬上楼的痛苦. 】&lt;br&gt;&lt;br&gt;
&lt;&lt;timed 3s&gt;&gt; 【搬运工作确实让你感到些疲惫, 你想找个地方填填肚子好好休息上一会, 而一旁的公猫则开始研究起来怎么把箱子搬上二楼最省力】&lt;br&gt;&lt;br&gt;
⋙⋙⋙⋙⋙⋙⋘⋘⋘⋘⋘⋘&lt;br&gt;
&lt;&lt;link ▷「自己去」 主线第二天&gt;&gt;&lt;&lt;set $choice to &quot;自己去&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;br&gt;
&lt;&lt;link ▷「叫上他一起去吃点东西」 主线第二天&gt;&gt;&lt;&lt;set $choice to &quot;叫上他&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;&lt;/timed&gt;&gt; 

&lt;&lt;elseif $choice == &quot;不告诉&quot;&gt;&gt;
【眼前这位中年猫显然有一些记忆问题. 你们只是萍水相逢, 除此之外毫无关联, 你还不打算这么快就交到朋友, 你只告诉他你才来岛上不久. &quot;是这样吗, 那太巧了, 我也才到这里不久, &quot;他看起来没被你的避讳困扰, 愉快的讲给你他的情况, &quot;他们说我可以住在旅店, 我花了很久才找对地方, 现在在搬运我的行李...&quot;他看了眼一旁垒起来的木箱, 眉毛拧成一团, 似乎在想象之后把这些家伙搬上楼的痛苦. 】&lt;br&gt;&lt;br&gt;
&lt;&lt;timed 3s&gt;&gt; 【搬运工作确实让你感到些疲惫, 你想找个地方填填肚子好好休息上一会, 而一旁的公猫则开始研究起来怎么把箱子搬上二楼最省力】&lt;br&gt;&lt;br&gt;
⋙⋙⋙⋙⋙⋙⋘⋘⋘⋘⋘⋘&lt;br&gt;
&lt;&lt;link ▷「自己去」 主线第二天&gt;&gt;&lt;&lt;set $choice to &quot;自己去&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;br&gt;
&lt;&lt;link ▷「叫上他一起去吃点东西」 主线第二天&gt;&gt;&lt;&lt;set $choice to &quot;叫上他&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;&lt;/timed&gt;&gt; 

&lt;&lt;elseif $choice == &quot;叫上他&quot;&gt;&gt;
【那些行李可以等上半个小时. 你不介意带上刚认识的猫去一起吃饭, 尤其是看在他这样孤身一猫, 又那么的冒失. 公猫在听到你的邀请的下一秒立起了耳朵, 毫不犹豫的答应了你的邀请, 等着你带他去寻找餐馆】&lt;br&gt;&lt;br&gt;
⋙⋙⋙⋙⋙⋙⋘⋘⋘⋘⋘⋘&lt;br&gt;
&lt;&lt;link ▷「去酒馆」 主线第二天&gt;&gt;&lt;&lt;set $choice to &quot;去酒馆&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;br&gt;
&lt;&lt;link ▷「去咖啡馆」 主线第二天&gt;&gt;&lt;&lt;audio &quot;diceroll&quot; play&gt;&gt;&lt;&lt;set $choice to &quot;去咖啡馆&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;

&lt;&lt;elseif $choice == &quot;自己去&quot;&gt;&gt;
【你还不想跟刚见面的猫一起吃饭, 便招呼也没打的就走出了旅馆】&lt;br&gt;&lt;br&gt;&lt;&lt;set $loc = &quot;小镇&quot;&gt;&gt;
&lt;&lt;timed 3s&gt;&gt;【你才出门, 就听到公猫跟了出来. 他叫住你. &quot;你是要走了吗? &quot;你只能告诉他你打算去吃饭, 而他毫不犹豫的说要和你一起】&lt;br&gt;&lt;br&gt;
⋙⋙⋙⋙⋙⋙⋘⋘⋘⋘⋘⋘&lt;br&gt;
&lt;&lt;link ▷「去酒馆」 主线第二天&gt;&gt;&lt;&lt;set $choice to &quot;去酒馆&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;br&gt;
&lt;&lt;link ▷「去咖啡馆」 主线第二天&gt;&gt;&lt;&lt;audio &quot;diceroll&quot; play&gt;&gt;&lt;&lt;set $choice to &quot;去咖啡馆&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;&lt;/timed&gt;&gt; 

&lt;&lt;elseif $choice == &quot;去酒馆&quot;&gt;&gt;
【听到你的选择, 公猫扭扭捏捏半天, 才挤出来一句话: &quot;我不能喝酒...我们可以换一家吗? &quot;】&lt;br&gt;&lt;br&gt;
⋙⋙⋙⋙⋙⋙⋘⋘⋘⋘⋘⋘&lt;br&gt;
&lt;&lt;link ▷「去咖啡馆」 主线第二天&gt;&gt;&lt;&lt;audio &quot;diceroll&quot; play&gt;&gt;&lt;&lt;set $choice to &quot;去咖啡馆&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;

&lt;&lt;elseif $choice == &quot;去咖啡馆&quot;&gt;&gt;
【于是你们开始向咖啡馆走去. 一路上也许是因为疲惫, 没有谁想挑起话题
&lt;&lt;set _a to setup.getStat(&quot;observation&quot;)/33*100&gt;&gt;&lt;&lt;checkWidget&gt;&gt;
&lt;&lt;if _rst == &quot;大成功&quot;&gt;&gt;
. 你盯着地面走路, 不禁注意到, 一旁同伴的脚下, 似乎没有阴影】&lt;br&gt;〖获得线索 : 第一个朋友〗&lt;&lt;set $clue.push({name: &#39;第一个朋友&#39;, dscr: &#39;他似乎没有影子&#39;})&gt;&gt;
&lt;&lt;set $observationexp += 6&gt;&gt;&lt;&lt;addoexpWidget&gt;&gt;
&lt;&lt;else&gt;&gt;】&lt;&lt;/if&gt;&gt;
&lt;&lt;timed 3s&gt;&gt;&lt;&lt;set $loc = &quot;咖啡馆&quot;&gt;&gt;&lt;br&gt;&lt;br&gt;【你们来到咖啡馆, 找了一张小桌坐下, 拿起菜单准备点餐. 坐在你对面的公猫对着菜单摆出几个疑惑的表情, 接着又把它翻转过来, 那样子仿佛要从上面找出点什么不存在的东西来. 你没用多久就意识到了问题】&lt;br&gt;&lt;br&gt;
⋙⋙⋙⋙⋙⋙⋘⋘⋘⋘⋘⋘&lt;br&gt;
&lt;&lt;link ▷「你不识字吗?」 主线第二天&gt;&gt;&lt;&lt;set $choice to &quot;你不识字吗&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;&lt;/timed&gt;&gt; 

&lt;&lt;elseif $choice == &quot;你不识字吗&quot;&gt;&gt;
【你很奇怪, 他说着和你一样的语言, 却看不懂手里的文字, 他的穿着看着不像贫苦家庭出身, 你也确定他的英语发音很是标准】&lt;br&gt;&lt;br&gt;
&lt;&lt;timed 2s&gt;&gt;【你的提问让他尴尬的停下手里的动作, 耳朵平伏的承认了这一事实. &quot;非常抱歉...你能读给我这上面写的什么吗? &quot;他轻声轻气的请求着, 你只能一一读给他听. 他很快就选出了想吃的餐品, 而你也选好了自己的】&lt;br&gt;&lt;br&gt;&lt;&lt;/timed&gt;&gt;
&lt;&lt;timed 5s&gt;&gt;【就在你担心他身无分文的时候, 近乎解脱的看到他从衣兜里掏出来一堆鸟羽. &quot;我身上的钱币来这里之后都变成了这种硬币, 真奇怪, 不是吗. &quot;他故作轻松的耸耸肩, 付了钱】&lt;br&gt;&lt;br&gt;&lt;&lt;/timed&gt;&gt;
&lt;&lt;timed 7s&gt;&gt;【老板娘很快端上来你们的点餐, 那些点心看上去一如既往的可口. 公猫小心翼翼拿起一块, 先是嗅嗅, 才不确定的塞进嘴里, 接着像得到生日礼物的小猫那样叫起来: &quot;这个蛋糕!...我上次吃到这般美味的点心, 还是在...太久了. 我的母亲一定得尝尝这些. &quot;他不顾店里其他顾客的目光说着这些奇怪的话】&lt;br&gt;&lt;br&gt;
⋙⋙⋙⋙⋙⋙⋘⋘⋘⋘⋘⋘&lt;br&gt;
&lt;&lt;link ▷「制止他」 主线第二天&gt;&gt;&lt;&lt;set $choice to &quot;制止他&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;br&gt;
&lt;&lt;link ▷「继续吃点心」 主线第二天&gt;&gt;&lt;&lt;set $choice to &quot;吃点心&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;&lt;/timed&gt;&gt;

&lt;&lt;elseif $choice == &quot;制止他&quot;&gt;&gt;
【在你提醒后他才意识到自己引来的注意. &quot;打扰到别人了吗, 很抱歉...我平时都很安静. &quot;他开始安静下来, 和你一言不语的吃着点心】&lt;br&gt;&lt;br&gt;
&lt;&lt;timed 2s&gt;&gt;【等到两个餐盘都变得空空, 再也没有理由继续和这只麻烦的猫待在一起时, 你觉得是时候提出那个一直没机会问出的问题了】&lt;br&gt;&lt;br&gt;
⋙⋙⋙⋙⋙⋙⋘⋘⋘⋘⋘⋘&lt;br&gt;
&lt;&lt;link ▷「你还没告诉我你的名字呢」 主线第二天&gt;&gt;&lt;&lt;set $choice to &quot;名字&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;&lt;/timed&gt;&gt; 

&lt;&lt;elseif $choice == &quot;吃点心&quot;&gt;&gt;
【你不想打消他的兴奋, 安静的吃着你的那份, 他注意到你的样子, 也开始安静下来】&lt;br&gt;&lt;br&gt;
&lt;&lt;timed 2s&gt;&gt;【等到两个餐盘都变得空空, 再也没有理由继续和这只麻烦的猫待在一起时, 你觉得是时候提出那个一直没机会问出的问题了】&lt;br&gt;&lt;br&gt;
⋙⋙⋙⋙⋙⋙⋘⋘⋘⋘⋘⋘&lt;br&gt;
&lt;&lt;link ▷「你还没告诉我你的名字呢」 主线第二天&gt;&gt;&lt;&lt;set $choice to &quot;名字&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;&lt;/timed&gt;&gt;

&lt;&lt;elseif $choice == &quot;名字&quot;&gt;&gt;
【如果被麻烦了一早上, 还没得到对方的名字, 你觉得那简直是亏本买卖. 公猫听到这个问题, 放下餐勺, 露出了之前那种思考的神情】&lt;br&gt;&lt;br&gt;
&lt;&lt;timed 2s&gt;&gt;【沉默良久, 他终于决定开口: &quot;我还没有名字. 我还没想好. &quot;这是他的回答】&lt;br&gt;&lt;br&gt;&lt;&lt;/timed&gt;&gt;
&lt;&lt;timed 3s&gt;&gt;【怎么会有猫没有名字? 但是想起来你在哪, 这似乎也没那么奇怪, 总有猫不想跟过去扯上关系, 据你所知, 永无乡并不避讳收留那些来历不明的猫族. 这让你多了一个不想和他扯上关系的理由. 但他的下一句话让你更加惊讶】&lt;br&gt;&lt;br&gt;&lt;&lt;/timed&gt;&gt;
&lt;&lt;timed 5s&gt;&gt;【&quot;可以请你帮我取个名字吗? &quot;他说, 从兜里拿出上岛时要填写的登记表, &quot;我得把这个填完. &quot;他甚至还随身带着铅笔】&lt;br&gt;&lt;br&gt;
⋙⋙⋙⋙⋙⋙⋘⋘⋘⋘⋘⋘&lt;br&gt;
&lt;&lt;textbox &quot;$tnn&quot; &quot;你叫...&quot; autofocus&gt;&gt;&lt;&lt;button &quot;确认&quot;&gt;&gt;&lt;&lt;set $choice to &quot;取名&quot;&gt;&gt;&lt;&lt;goto &quot;主线第二天结束&quot;&gt;&gt;&lt;&lt;/button&gt;&gt;&lt;&lt;/timed&gt;&gt;

&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="22" name="主线第二天结束" tags="nobr" position="1500,1175" size="100,100">&lt;&lt;if $choice == &quot;取名&quot;&gt;&gt;
【你几乎是抱着玩乐的心态说出了这个名字, 却不料他欣然接受, 还不忘把登记表递给你, 让你帮忙填写. 你接过表, 注意到故乡那一栏歪歪扭扭的写着&quot;丹麦&quot;】&lt;br&gt;&lt;br&gt;
&lt;&lt;timed 2s&gt;&gt;【等一切都写好, 你意识到接下来还会有一件麻烦事等着自己. 果不其然, 他向你提出了又一个请求: &quot;他们说这份登记表应该送去岛主那, 但是我不知道岛主在哪...&quot;】&lt;&lt;/timed&gt;&gt;&lt;br&gt;&lt;br&gt;
&lt;&lt;timed 2s&gt;&gt;【你撂下笔. 也许你的今天就该这样度过, 被不认识的怪猫当作义务劳力】&lt;br&gt;&lt;br&gt;
⋙⋙⋙⋙⋙⋙⋘⋘⋘⋘⋘⋘&lt;br&gt;
&lt;&lt;link ▷「我带你去」 主线第二天结束&gt;&gt;&lt;&lt;set $choice to &quot;我带你去&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;br&gt;
&lt;&lt;link ▷「我去送吧」 主线第二天结束&gt;&gt;&lt;&lt;set $choice to &quot;我去送吧&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;&lt;/timed&gt;&gt;

&lt;&lt;elseif $choice == &quot;我带你去&quot;&gt;&gt;
【$tnn对你这个提议似乎并不赞成, 他摸摸鼻子, 耳朵不安的转动几下, 用一种非常为难的语气回答了你: &quot;我想趁着时间还早去把行李运上去. 耽搁太久会被旅店的猫以碍事为理由丢出去吧... &quot;过于明显的推辞, 你决定不再强求他了】&lt;br&gt;&lt;br&gt;
⋙⋙⋙⋙⋙⋙⋘⋘⋘⋘⋘⋘&lt;br&gt;
&lt;&lt;link ▷「我去送吧」 主线第二天结束&gt;&gt;&lt;&lt;set $choice to &quot;我去送吧&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;

&lt;&lt;elseif $choice == &quot;我去送吧&quot;&gt;&gt;&lt;&lt;set $dd = $date&gt;&gt;
【$tnn这才像全然解脱一般的笑起来, 起身理理衣服, 最后对你说道: &quot;再次感谢, 我的朋友. 你帮了我大忙了. 如果明天你再来这家咖啡馆, 就让我来请客吧&quot;】&lt;br&gt;&lt;font color=#4E84BA&gt;✧你获得了登记表*1✧&lt;/font&gt;&lt;br&gt;&lt;br&gt;
⋙⋙⋙⋙⋙⋙⋘⋘⋘⋘⋘⋘&lt;br&gt;
&lt;&lt;link ▷「出发」 主线第二天结束&gt;&gt;&lt;&lt;set $choice to &quot;出发&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;

&lt;&lt;elseif $choice == &quot;出发&quot;&gt;&gt;&lt;&lt;set $loc = &quot;拓荒者木屋
&quot;&gt;&gt;
【你来到拓荒者木屋, 发现门没上锁, 便轻敲几下就走了进去. Seisi似乎是缩在炉火旁打盹儿, 而你的到来让祂不耐烦的睁开了眼. 你急忙向祂说明来意, 并拿出来那张登记表】&lt;br&gt;&lt;br&gt;
⋙⋙⋙⋙⋙⋙⋘⋘⋘⋘⋘⋘&lt;br&gt;
&lt;&lt;link ▷「交付登记表」 主线第二天结束&gt;&gt;&lt;&lt;set $choice to &quot;交付登记表&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;

&lt;&lt;elseif $choice == &quot;交付登记表&quot;&gt;&gt;&lt;&lt;set $mss to &quot;主线第二天结束&quot;&gt;&gt;
【Seisi看都没看一眼内容, 飞到了一旁的沙发上. 有一瞬间你在犹豫要不要告诉Seisi那个人的奇怪举动】&lt;br&gt;&lt;br&gt;
⋙⋙⋙⋙⋙⋙⋘⋘⋘⋘⋘⋘&lt;br&gt;
&lt;&lt;link ▷「告诉」 主线第二天结束&gt;&gt;&lt;&lt;set $choice to &quot;告诉&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;br&gt;
&lt;&lt;link ▷「不告诉」 主线第二天结束&gt;&gt;&lt;&lt;set $choice to &quot;不告诉&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;

&lt;&lt;elseif $choice == &quot;告诉&quot;&gt;&gt;
【你现在是永无乡的一员, 岛上的危险因素也会影响到你的生活. 你向Seisi描述了一下之前的事情, Seisi嘀咕着说祂会告诉Nix的, 让你不必担忧. 你离开了拓荒者木屋】&lt;br&gt;&lt;&lt;set $social to $social+ 1&gt;&gt;&lt;font color=#FFAA00&gt;你的社会属性提升了1级&lt;/font&gt;&lt;br&gt;&lt;br&gt;
&lt;&lt;link ▷「继续」 高地&gt;&gt;&lt;&lt;set $choice to 0&gt;&gt;&lt;&lt;/link&gt;&gt;

&lt;&lt;elseif $choice == &quot;不告诉&quot;&gt;&gt;
【岛上的治安倒还不用你来担心, 你帮助了一个陌生猫, 仅此而已, 即使他在这里用的是你给的名字. 你离开了拓荒者木屋】&lt;br&gt;&lt;br&gt;
&lt;&lt;link ▷「继续」 高地&gt;&gt;&lt;&lt;set $choice to 0&gt;&gt;&lt;&lt;/link&gt;&gt;

&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="23" name="书籍" tags="" position="1700,200" size="100,100">&lt;&lt;inv $book drop inspect stack filter&gt;&gt;</tw-passagedata><tw-passagedata pid="24" name="买药" tags="" position="2025,650" size="100,100">还没写

&lt;&lt;link ▷「返回」 医院&gt;&gt;&lt;&lt;/link&gt;&gt;</tw-passagedata><tw-passagedata pid="25" name="交谈" tags="nobr" position="1300,200" size="100,100">&lt;&lt;if $npc == &quot;Era&quot;&gt;&gt;
/*初见*/
&lt;&lt;if $erafirstc != 1&gt;&gt;
【Era像是才注意到你在周围一样, 从发呆中回过神来: &quot;啊, 是你, 新来的家伙. &quot;他给了你一个无可挑剔的微笑, &quot;岛上的生活怎么样, 希望没让你太失望. Nix一直说, 这里的生活是最好的生活, 你觉得呢?&quot;】&lt;br&gt;&lt;br&gt;&lt;&lt;set $erafirstc = 1&gt;&gt;&lt;&lt;set $erahgd = 0&gt;&gt;
⋙⋙⋙⋙⋙⋙⋘⋘⋘⋘⋘⋘&lt;br&gt;
&lt;&lt;link ▷「是」 初见对话&gt;&gt;&lt;&lt;set $choice to &quot;是&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;br&gt;
&lt;&lt;link ▷「不是」 初见对话&gt;&gt;&lt;&lt;set $choice to &quot;不是&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;br&gt;
&lt;&lt;link ▷「还不知道」 初见对话&gt;&gt;&lt;&lt;set $choice to &quot;还不知道&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;
/*日常*/
&lt;&lt;elseif $loc == &quot;草甸&quot;&gt;&gt;&lt;&lt;set _rpl= [&quot;【Era向你抬了抬帽檐示好: “日安, $nn. 不错的天气. 相信我, 阳光在这个岛上尤为珍贵. ”】&quot;,&quot;【“很不错的羽毛, 不是吗? ”Era得意的展示着自己的羽毛帽, “这是大洋对面国度的公主亲手赠给我的. ” 他向你故作神秘的眨了下眼】&quot;,&quot;【“羊是种很聪明的生物, 他们知道在面对结局时自己怎样都无能为力, 于是愉快的享受当下. ” 不知怎得, 你从Era的语气里听出了一点羡慕的意味】&quot;,&quot;【Era用帽子遮着脸, 看起来在进行他日常的工作中小憩, 在你决定离开不再继续打扰时, 却看见他抖了抖尾巴, 似乎是在回应你】&quot;].random()&gt;&gt;_rpl

&lt;&lt;elseif $loc == &quot;酒馆&quot;&gt;&gt;&lt;&lt;set _rpl= [&quot;【“看来有人很会享受夜晚啊. ”Era晃晃手里的酒杯冲你问好】&quot;,&quot;【“要说好酒, 我只认东南海那边的椰子酒, 那是我最爱的一次出海、之一! 我们带回来足足能喝上三十个月的酒, 这儿的酒跟那些比起来, 一文不值! ”你非常肯定Era已经开始说醉话了】&quot;,&quot;【“啊, 工作一天后小酌一杯, 他们说得对, 我确实爱这部分的生活. ”】&quot;].random()&gt;&gt;_rpl

&lt;&lt;elseif $loc == &quot;溶洞&quot;&gt;&gt;
&lt;&lt;if $erafirstcavec != 1&gt;&gt;【啊，欢迎啊。虽然看起来破破烂烂，但这里就是我的“家”了。我知道你心里或许正嫌弃着门口挡路的荆棘、寒冷的直冲人面门的海风，以及这简陋的陈设。但这对我来说已经算是个温暖的窝了】&lt;&lt;set $erafirstc = 1&gt;&gt;
⋙⋙⋙⋙⋙⋙⋘⋘⋘⋘⋘⋘&lt;br&gt;
&lt;&lt;link ▷「看上去很不错」 初见对话&gt;&gt;&lt;&lt;set $choice to &quot;看上去很不错&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;br&gt;
&lt;&lt;link ▷「确实简陋」 初见对话&gt;&gt;&lt;&lt;set $choice to &quot;不是&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;
&lt;&lt;/if&gt;&gt;&lt;&lt;/if&gt;&gt;&lt;&lt;/if&gt;&gt;

&lt;&lt;if $npc == &quot;奥里&quot;&gt;&gt;&lt;&lt;set _s to random(1,7)&gt;&gt;
/*初见*/
&lt;&lt;if $orifirstc != 1&gt;&gt;
【你刚踏入小镇，一只蓝灰色的母猫就跳到了你面前。“你好，是……新来的？”眼前的女孩伸出手与你打了招呼，接着又笑着绕着你转了一圈，“那——欢迎你来到永无乡！我是这里的信者，想要送信之类的都可以来找我~”她说着，正好转到你面前，同时伸出了一只手】&lt;br&gt;&lt;br&gt;&lt;&lt;set $orifirstc = 1&gt;&gt;&lt;&lt;set $orihgd = 0&gt;&gt;
&lt;&lt;timed 3s&gt;&gt;【“很高兴认识你，我是Orionis。叫我奥里就可以啦~”】&lt;br&gt;&lt;br&gt;
⋙⋙⋙⋙⋙⋙⋘⋘⋘⋘⋘⋘&lt;br&gt;
&lt;&lt;link ▷「握住她的手」 初见对话&gt;&gt;&lt;&lt;set $choice to &quot;握住她的手&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;br&gt;
&lt;&lt;link ▷「犹豫」 初见对话&gt;&gt;&lt;&lt;set $choice to &quot;犹豫&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;br&gt;
&lt;&lt;link ▷「抱住她」 初见对话&gt;&gt;&lt;&lt;set $choice to &quot;抱住她&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;&lt;/timed&gt;&gt;
/*日常*/
&lt;&lt;elseif $choice == &quot;我来帮你&quot;&gt;&gt;
【“哇！真的吗？谢谢你的好意，不过这是我的工作，我相信我能做好。”她笑了笑，“能够看到收信人的笑脸，我也很满意啦~那可是海岸之外的人送来的，带有‘家’的信！”】 
&lt;&lt;elseif $choice == &quot;每天都有很多信吗&quot;&gt;&gt;
【“嗯，因为从镇子去到外面稍微有点难度，所以与外界的沟通大部分都是通过信件。永无乡只有我一个信者，所以看起来数量就有点多。”奥里拍了拍存放信件的腰包，“不过，之后有机会的话，或许会找个帮手！”】 
&lt;&lt;elseif $choice == &quot;你喜欢海吗&quot;&gt;&gt;
【“喜欢！”她毫不犹豫的回答道，“但，也没有那么喜欢。只是看海会觉得，心会跟着一起平静下来。”说着，她回头眨了眨眼，做了个鬼脸，“我不会游泳，所以也只能看看啦！”】
&lt;&lt;elseif $choice == &quot;去喝下午茶&quot;&gt;&gt;
【“好呀~既然是邀请，那我就愉快的接下啦！”她笑着伸出手拍了拍你的手掌，“走吧走吧！今天会有什么样的甜品呢？好期待~”】
&lt;&lt;elseif $choice == &quot;？&quot;&gt;&gt;
【“我在唱歌啦哈哈哈，有被吓到吗？”】
&lt;&lt;elseif $choice == &quot;不分昼夜&quot;&gt;&gt;
【哦！你很懂嘛！接下去要一起唱哦！”】
&lt;&lt;elseif $choice == &quot;你讨厌神明吗&quot;&gt;&gt;
【“嗯，很讨厌。也不能说是讨厌？总之，很讨厌那样的万能感。倒不是说嫉妒，只是觉得一整个世界都被栓在了神明身上，很累吧。”】
&lt;&lt;elseif $choice == &quot;不允许你这么说神明&quot;&gt;&gt;
【你有喜欢的神明吗？嗯……不过我还是坚定地，讨厌着万能的神明哦。神明和信徒，信徒和世界，被束缚着，束缚着……咦……？啊，没什么。”】
&lt;&lt;elseif $orihgd &lt;=19&gt;&gt;
&lt;&lt;set _s to random(1,7)&gt;&gt;
&lt;&lt;if _s ==1&gt;&gt;【“今天需要送的信还有……一、二、三、四……嗯……看样子还要加油了！”】&lt;br&gt;&lt;br&gt;⋙⋙⋙⋙⋙⋙⋘⋘⋘⋘⋘⋘&lt;br&gt;
&lt;&lt;link ▷「我来帮你」 交谈&gt;&gt;&lt;&lt;set $choice to &quot;我来帮你&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;br&gt;
&lt;&lt;link ▷「每天都有很多信吗」 交谈&gt;&gt;&lt;&lt;set $choice to &quot;每天都有很多信吗&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;
&lt;&lt;elseif _s ==2&gt;&gt;【“嗯……今天该做些什么呢？有机会的话要不要一起去看海？”】&lt;br&gt;&lt;br&gt;⋙⋙⋙⋙⋙⋙⋘⋘⋘⋘⋘⋘&lt;br&gt;
&lt;&lt;link ▷「你喜欢海吗」 交谈&gt;&gt;&lt;&lt;set $choice to &quot;你喜欢海吗&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;br&gt;
&lt;&lt;link ▷「去喝下午茶吗」 交谈&gt;&gt;&lt;&lt;set $choice to &quot;去喝下午茶&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;
&lt;&lt;elseif _s ==2&gt;&gt;【“嗯……今天该做些什么呢？有机会的话要不要一起去看海？”】&lt;br&gt;&lt;br&gt;⋙⋙⋙⋙⋙⋙⋘⋘⋘⋘⋘⋘&lt;br&gt;
&lt;&lt;link ▷「你喜欢海吗」 交谈&gt;&gt;&lt;&lt;set $choice to &quot;你喜欢海吗&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;br&gt;
&lt;&lt;link ▷「去喝下午茶吗」 交谈&gt;&gt;&lt;&lt;set $choice to &quot;去喝下午茶&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;
&lt;&lt;elseif _s ==3&gt;&gt;【“在这样的天气去海边呼吸新鲜空气，会觉得整个人都被净化了。”】
&lt;&lt;elseif _s ==4&gt;&gt;【“哼哼~哼哼哼~啊，我在唱歌。要一起吗？”】&lt;br&gt;&lt;br&gt;⋙⋙⋙⋙⋙⋙⋘⋘⋘⋘⋘⋘&lt;br&gt;
&lt;&lt;link ▷「你喜欢海吗」 交谈&gt;&gt;&lt;&lt;set $choice to &quot;你喜欢海吗&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;br&gt;
&lt;&lt;link ▷「去喝下午茶吗」 交谈&gt;&gt;&lt;&lt;set $choice to &quot;去喝下午茶&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;
&lt;&lt;elseif _s ==5&gt;&gt;【“金星的舞蹈！”】&lt;br&gt;&lt;br&gt;⋙⋙⋙⋙⋙⋙⋘⋘⋘⋘⋘⋘&lt;br&gt;
&lt;&lt;link ▷「？」 交谈&gt;&gt;&lt;&lt;set $choice to &quot;？&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;br&gt;
&lt;&lt;link ▷「不分昼夜！」 交谈&gt;&gt;&lt;&lt;set $choice to &quot;不分昼夜&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;
&lt;&lt;elseif _s ==6&gt;&gt;【“朗姆和死亡，对你来说是同义词。”】&lt;br&gt;&lt;br&gt;⋙⋙⋙⋙⋙⋙⋘⋘⋘⋘⋘⋘&lt;br&gt;
&lt;&lt;link ▷「？」 交谈&gt;&gt;&lt;&lt;set $choice to &quot;？&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;br&gt;
&lt;&lt;link ▷「不分昼夜！」 交谈&gt;&gt;&lt;&lt;set $choice to &quot;不分昼夜&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;
&lt;&lt;elseif _s ==7&gt;&gt;【“神明啊……真是无聊的东西。”】&lt;br&gt;&lt;br&gt;⋙⋙⋙⋙⋙⋙⋘⋘⋘⋘⋘⋘&lt;br&gt;
&lt;&lt;link ▷「你讨厌神明吗」 交谈&gt;&gt;&lt;&lt;set $choice to &quot;你讨厌神明吗&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;br&gt;
&lt;&lt;link ▷「不允许你这么说神明」 交谈&gt;&gt;&lt;&lt;set $choice to &quot;不允许你这么说神明&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;
&lt;&lt;/if&gt;&gt;&lt;&lt;/if&gt;&gt;&lt;&lt;/if&gt;&gt;

&lt;&lt;if $npc == &quot;安德森&quot;&gt;&gt;
/*初见*/
&lt;&lt;if $nmfirstc != 1&gt;&gt;&lt;&lt;set $nmhgd = 0, $nmfirstc =1&gt;&gt;
【“哎呀，你好呀？”你看到他歪歪头，毫无距离感的凑上来打量你“没见过的脸——你先别说！”他连忙捂住你的嘴，虽然看不到他的脸，但你能够明显的感受到他跳脱的情绪，他清亮的嗓音在你耳边响起，虽然声调很高，但明显可以辨认出是男性“你是新来的！”紧接着他就松开你向后撤去，猫呢——？】&lt;br&gt;&lt;br&gt;
⋙⋙⋙⋙⋙⋙⋘⋘⋘⋘⋘⋘&lt;br&gt;
&lt;&lt;link ▷「寻找」 初见对话&gt;&gt;&lt;&lt;set $choice to &quot;寻找&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;br&gt;
&lt;&lt;link ▷「离开」 初见对话&gt;&gt;&lt;&lt;set $choice to &quot;离开&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;
&lt;&lt;else&gt;&gt;没写
&lt;&lt;/if&gt;&gt;&lt;&lt;/if&gt;&gt;

&lt;&lt;if $npc == &quot;Tret&quot;&gt;&gt;
/*初见*/
&lt;&lt;if $tretfirstc != 1&gt;&gt;&lt;&lt;set $tretsxd = 0&gt;&gt;
【当你抛出一声试探性的问好后, 公猫只是倾了倾头, 用他完好的那边眼睛居高临下的盯着你, 似乎看不懂你在期待什么. 也许你需要再做点什么】&lt;br&gt;&lt;br&gt;&lt;&lt;set $tretfirstc = 1&gt;&gt;
⋙⋙⋙⋙⋙⋙⋘⋘⋘⋘⋘⋘&lt;br&gt;
&lt;&lt;link ▷「我是永无乡的新居民」 初见对话&gt;&gt;&lt;&lt;set $choice to &quot;新居民&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;br&gt;
&lt;&lt;link ▷「拿出鱼篓」 初见对话&gt;&gt;&lt;&lt;set $choice to &quot;拿出鱼篓&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;br&gt;
&lt;&lt;link ▷「打扰了」 初见对话&gt;&gt;&lt;&lt;set $choice to &quot;打扰了&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;
&lt;&lt;else&gt;&gt;没写
&lt;&lt;/if&gt;&gt;&lt;&lt;/if&gt;&gt;

&lt;&lt;if $npc == &quot;玛丽亚小姐&quot;&gt;&gt;
/*初见*/
&lt;&lt;if $maryfirstc != 1&gt;&gt;&lt;&lt;set $marysxd = 10&gt;&gt;
【从你推门而入的那刻起, 她的目光就如同捕获猎物般锁定在了你身上, 但直到你主动问好时, 玛丽亚小姐才从光线昏暗的角落里起身欢迎你. &quot;哦, 瞧瞧看, 今天的东风带来了新鲜的面孔, ”她轻声说道，笑容里带一种让人着迷的从容, &quot;是什么让你走进了我的小天堂? &quot;】&lt;br&gt;&lt;br&gt;&lt;&lt;set $maryfirstc = 1&gt;&gt;
⋙⋙⋙⋙⋙⋙⋘⋘⋘⋘⋘⋘&lt;br&gt;
&lt;&lt;link ▷「我想变得更美」 初见对话&gt;&gt;&lt;&lt;set $choice to &quot;我想变得更美&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;br&gt;
&lt;&lt;link ▷「这家店非常不错」 初见对话&gt;&gt;&lt;&lt;set $choice to &quot;这家店非常不错&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;
&lt;&lt;else&gt;&gt;没写
&lt;&lt;/if&gt;&gt;&lt;&lt;/if&gt;&gt;

&lt;&lt;if $npc == &quot;Otis&quot;&gt;&gt;
/*初见*/
&lt;&lt;if $otisfirstc != 1&gt;&gt;&lt;&lt;set $otissxd = 8&gt;&gt;
【Otis在你发出第三声呼喊时才终于迷茫的从他的书稿上抬起头来，厚重的镜片后的小眼睛半天才将视线落在你身上: &quot;哦, 嘿, 你好, 我猜我之前没见过你. &quot;】&lt;br&gt;【他似乎想从扶手椅上站起来和你握手, 但无奈于腹部的脂肪在和书桌的博弈中败下阵来, &quot;抱歉这里有点拥挤, 我指我的书桌——&quot; 他尴尬的环视了一下四周, &quot;好吧, 还有整个图书馆. 岛主把这里全权交给我打理, 但是我好像有点沉迷写作了... &quot;】&lt;br&gt;&lt;br&gt;&lt;&lt;set $otisfirstc = 1&gt;&gt;
⋙⋙⋙⋙⋙⋙⋘⋘⋘⋘⋘⋘&lt;br&gt;
&lt;&lt;link ▷「你在写什么」 初见对话&gt;&gt;&lt;&lt;set $choice to &quot;你在写什么&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;
&lt;&lt;else&gt;&gt;没写
&lt;&lt;/if&gt;&gt;&lt;&lt;/if&gt;&gt;

&lt;&lt;if $npc == &quot;Daisy&quot;&gt;&gt;
/*初见*/
没写
&lt;&lt;/if&gt;&gt;

&lt;&lt;if $npc == &quot;琥珀夫人&quot;&gt;&gt;
/*初见*/
&lt;&lt;if $amberfirstc != 1&gt;&gt;&lt;&lt;set $amberhgd = 5&gt;&gt;【“是不熟悉的气味和面孔…你是新来的吧？我想岛主的鸟已经指引你去过不少地方了，觉得永无乡怎么样？”】&lt;br&gt;&lt;br&gt;&lt;&lt;set $amberfirstc = 1&gt;&gt;
⋙⋙⋙⋙⋙⋙⋘⋘⋘⋘⋘⋘&lt;br&gt;
&lt;&lt;link ▷「还不错」 初见对话&gt;&gt;&lt;&lt;set $choice to &quot;还不错&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;br&gt;
&lt;&lt;link ▷「糟糕透了」 初见对话&gt;&gt;&lt;&lt;set $choice to &quot;糟糕透了&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;br&gt;
&lt;&lt;link ▷「还不知道」 初见对话&gt;&gt;&lt;&lt;set $choice to &quot;还不知道&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;
/*日常*/
&lt;&lt;else&gt;&gt;&lt;&lt;set _rpl= [&quot;【“什么是爱？就是那已错过的，被遗忘的，将堕落的东西。一切的一切中唯独无法被拯救的就是爱。”】&quot;,&quot;【“噢，我可以毫不夸张地告诉你，要是你来得正巧，你就能在我的酒馆里见到几乎全小镇的猫。”】&quot;,&quot;【“我？我不觉得死后会有什么魂灵，只有酒精才能让人安生】&quot;].random()&gt;&gt;_rpl
&lt;&lt;/if&gt;&gt;&lt;&lt;/if&gt;&gt;

&lt;&lt;if $npc == &quot;萨巴夫人&quot;&gt;&gt;
/*初见*/
&lt;&lt;if $spafirstc != 1&gt;&gt;&lt;&lt;set $spasxd = 1&gt;&gt;
【她缓缓抬头, 阳光将她笼罩着, 光线勾勒出来她衰老的躯体. &quot;你来了, &quot; 她的声音让你想起那种最经典的外婆的形象, &quot;这儿的阳光总让我忘了时间走得有多快. &quot;】&lt;br&gt;&lt;br&gt;&lt;&lt;set $spafirstc = 1&gt;&gt;
⋙⋙⋙⋙⋙⋙⋘⋘⋘⋘⋘⋘&lt;br&gt;
&lt;&lt;link ▷「你在等我？」 初见对话&gt;&gt;&lt;&lt;set $choice to &quot;你在等我&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;br&gt;
&lt;&lt;link ▷「你在写诗吗」 初见对话&gt;&gt;&lt;&lt;set $choice to &quot;你在写诗吗&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;
&lt;&lt;else&gt;&gt;没写
&lt;&lt;/if&gt;&gt;&lt;&lt;/if&gt;&gt;

&lt;&lt;if $npc == &quot;佩罗大夫&quot;&gt;&gt;
/*初见*/
&lt;&lt;if $perrafirstc != 1&gt;&gt;&lt;&lt;set $perrasxd = 0&gt;&gt;【你试图通过叩门来引起他的注意力. 公猫抬起头扫视了你一眼, 接着用不耐烦的语气对你说: &quot;药丸50鸟羽一枚, 我一次最多只能卖你三枚. &quot;不知为何, 他嘶哑的嗓音和那扇年久失修的换气扇发出的噪音毫无二致】&lt;br&gt;&lt;br&gt;&lt;&lt;set $perrafirstc = 1&gt;&gt;
⋙⋙⋙⋙⋙⋙⋘⋘⋘⋘⋘⋘&lt;br&gt;
&lt;&lt;link ▷「听他的话买药」 初见对话&gt;&gt;&lt;&lt;set $choice to &quot;听他的话买药&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;br&gt;
&lt;&lt;link ▷「我是来拜访的」 初见对话&gt;&gt;&lt;&lt;set $choice to &quot;我是来拜访的&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;
/*日常*/
&lt;&lt;else&gt;&gt;没写
&lt;&lt;/if&gt;&gt;&lt;&lt;/if&gt;&gt;

&lt;&lt;if $npc == &quot;琼&quot;&gt;&gt;&lt;&lt;if !$josxd&gt;&gt;&lt;&lt;set $josxd = 0&gt;&gt;&lt;&lt;/if&gt;&gt;
/*初见教堂*/
&lt;&lt;if $jofirstc != 1 &amp;&amp; $loc == &quot;小镇&quot;&gt;&gt;【陆陆续续离开的群猫中，坐在第一排的白色猫咪显得格外突兀。那件看起来有些古怪的黑色修女服与教堂间的气氛格格不入。白猫低着头看着地面，雪白的波浪卷毛垂下来挡住了本来能从修女服下露出来的半张脸】&lt;br&gt;&lt;br&gt;
⋙⋙⋙⋙⋙⋙⋘⋘⋘⋘⋘⋘&lt;br&gt;
&lt;&lt;link ▷「离开」 初见对话&gt;&gt;&lt;&lt;set $choice to &quot;离开&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;br&gt;
&lt;&lt;link ▷「搭话」 初见对话&gt;&gt;&lt;&lt;set $choice to &quot;搭话&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;
/*初见酒馆*/
&lt;&lt;elseif $jofirstc != 1 &amp;&amp; $loc == &quot;酒馆&quot;&gt;&gt;【白色的天使。那是你第一眼看到他时所能想到的最好的描述。他不应该出现在这里的，那张小桌子周身的氛围是那么宁静，与酒馆的躁动气氛格格不入。灯光照耀下，他仿佛有着鎏金的幻彩皮毛，蓬松的尾巴搭在自己的腿上，尾尖似乎在腿间轻轻晃动】&lt;br&gt;&lt;br&gt;
⋙⋙⋙⋙⋙⋙⋘⋘⋘⋘⋘⋘&lt;br&gt;
&lt;&lt;link ▷「在别处坐下」 初见对话&gt;&gt;&lt;&lt;set $choice to &quot;在别处坐下&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;br&gt;
&lt;&lt;link ▷「在他对面坐下」 初见对话&gt;&gt;&lt;&lt;set $choice to &quot;在他对面坐下&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;
/*初见贝雷河*/
/*认识后教堂第一次对话*/
&lt;&lt;elseif $jofirstcc != 1 &amp;&amp; $loc == &quot;教堂&quot;&gt;&gt;【那不是琼么？你有点疑惑，看到他仰着头正在祷告。他的祷告是虔诚的，默然的，粉红色的小鼻子对着圣坛上的神父，结束后你听见很小声的“Amen”】&lt;br&gt;&lt;br&gt;
⋙⋙⋙⋙⋙⋙⋘⋘⋘⋘⋘⋘&lt;br&gt;
&lt;&lt;link ▷「离开」 初见对话&gt;&gt;&lt;&lt;set $choice to &quot;离开&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;br&gt;
&lt;&lt;link ▷「上前搭话」 初见对话&gt;&gt;&lt;&lt;set $choice to &quot;上前搭话&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;
/*认识后酒馆第一次对话*/
&lt;&lt;elseif $jofirstpc != 1 &amp;&amp; $loc == &quot;酒馆&quot;&gt;&gt;【那是琼。酒馆里并不明亮的黄色灯光把他染成了沉郁的金色，你看到有发光的东西在粉红色的掌垫上滚动着】&lt;br&gt;&lt;br&gt;
⋙⋙⋙⋙⋙⋙⋘⋘⋘⋘⋘⋘&lt;br&gt;
&lt;&lt;link ▷「找别的地方坐下」 初见对话&gt;&gt;&lt;&lt;set $choice to &quot;找别的地方坐下&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;br&gt;
&lt;&lt;link ▷「坐到他对面」 初见对话&gt;&gt;&lt;&lt;set $choice to &quot;坐到他对面&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;
/*日常灯塔*/
&lt;&lt;elseif $loc == &quot;主港口灯塔&quot;&gt;&gt;
&lt;&lt;set _rpl= [&quot;【“没有钓到鱼吗？别难过。”他拍了拍你的肩膀：“海上的时令总是变化无常的，等到洋流向岸的时候再来吧。”】&quot;,&quot;【“鱼油还有，灯塔可以再亮很久！”他翘起尾巴，耳朵兴奋地抖动着：“如果你有多余的鱼油当然更好啦！”】&quot;,&quot;【如果你有蒲公英的话我就原谅你来打扰我，”他毛茸茸的脸鼓成了一个毛球，“漂亮的小鱼也可以吧。”】&quot;,&quot;【他疑惑地看着你，指了指身后的灯塔：“这里是灯塔，不卖糖果的。”】&quot;].random()&gt;&gt;_rpl
&lt;&lt;/if&gt;&gt;


&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="26" name="任务完成" tags="" position="800,400" size="100,100">&lt;&lt;if $msstat == &quot;新的开始完成&quot;&gt;&gt;&lt;&lt;set $achv.push({name: &#39;永无乡的新居民&#39;, dscr: &#39;你踏上了永无乡, 成为了她的新居民, 但是接下来呢? 你会选择什么样的生活?&#39;})&gt;&gt;&lt;&lt;notify 5s&gt;&gt;&lt;font color=&quot;BD5786&quot;&gt;☆获得成就 : 永无乡的新居民☆&lt;/font&gt;&lt;&lt;/notify&gt;&gt;【你刚放下手头的工具, 就看到Seisi跳到了工作台上, 爪子里抓着什么东西. 祂一直都在附近吗? 你等着Seisi开始祂的讲话】

&lt;font color=&quot;FFAA00&quot;&gt; Seisinofoaga&lt;/font&gt;: 
你完成了那堆任务, 我们也按时清理出来了一批空房, 这是你的安家许可证, 再付上200鸟羽, 你就能在永无乡拥有一栋独立的小屋了, 当然, 去不去住的选择权都在你

【Seisi把那卷羊皮纸交给你, 你挑开端正系好的红丝带, 只见里面用花体英文写着祝贺你开启在永无乡上的新生活, 以及一些住所选址的注意事项和建议, 落款签名是N. P. Reaper】&lt;&lt;pickup $item &quot;安家许可证&quot; 1&gt;&gt;
&lt;font color=#4E84BA&gt;✧你获得安家许可证*1✧&lt;/font&gt;
&lt;&lt;set $achv.push({name: &#39;新的开始&#39;, dscr: &#39;你踏上了永无乡, 成为了她的新居民, 但是接下来呢? 你会选择什么样的生活?&#39;})&gt;&gt;
&lt;&lt;notify 5s&gt;&gt;&lt;font color=&quot;BD5786&quot;&gt;☆获得成就 : 新的开始☆&lt;/font&gt;&lt;&lt;/notify&gt;&gt;
&lt;&lt;set $msstat = 0&gt;&gt;&lt;&lt;set $msname = &quot;无&quot;&gt;&gt;&lt;&lt;drop $ms &quot;新的开始&quot; 1&gt;&gt;&lt;&lt;pickup $msd &quot;【已完成】新的开始&quot; 1&gt;&gt;
&lt;&lt;link ▷「离开」 小镇&gt;&gt;&lt;&lt;if $nn == &quot;Nix&quot;&gt;&gt;&lt;&lt;set $home to &quot;拓荒者木屋&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;&lt;&lt;/link&gt;&gt;


&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="27" name="住房安排" tags="nobr" position="1100,1175" size="100,100">&lt;&lt;if $choice == &quot;接受&quot;&gt;&gt;【你同意了岛上的安排. 小镇的旅店总要好过住在野外. Nix冲你点点头, 起身去房间里拿钥匙了. 你似乎得到了一些短暂的独处时间】
&lt;br&gt;&lt;br&gt;
 ⋙⋙⋙⋙⋙⋙⋘⋘⋘⋘⋘⋘&lt;br&gt;
&lt;&lt;link ▷「继续喝茶」 木屋行动&gt;&gt;&lt;&lt;set $choice to &quot;继续喝茶&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;br&gt;
&lt;&lt;link ▷「四处转转」 木屋行动&gt;&gt;&lt;&lt;audio &quot;diceroll&quot; play&gt;&gt;&lt;&lt;set $choice to &quot;四处转转&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;br&gt;
&lt;&lt;link ▷「什么也不做」 木屋行动&gt;&gt;&lt;&lt;set $choice to &quot;什么也不做&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;

&lt;&lt;else&gt;&gt;
【&quot;说道安顿, &quot;Nix坐回到她的藤椅里, &quot;尽管确保每一位居民的起居条件是我的责任, 但我们必须得承认, 永无乡上剩余的住房不多了, 而建造新的屋子要花费一定的钱财和时间. &quot;她此时的表情恰到好处的忧虑. &quot;为了保持秩序, 我们还不得不规定每所屋子要付上200鸟羽. 相信我, 这比起建造上花的数额根本不及什么. &quot;】
&lt;br&gt;&lt;br&gt;
&lt;&lt;timed 3s t8n&gt;&gt;【那么这就是这次见面真正的原因了, 你攥了攥手心, 听岛主继续说着. &quot;...所以在为你安排好住房, 或你能付起相应的价格之前, 我们只能为你腾出小镇旅店的客房, 而这相对便宜一些, 每晚10鸟羽. &quot;】&lt;&lt;/timed&gt;&gt;
&lt;br&gt;&lt;br&gt;
&lt;&lt;timed 5s t8n&gt;&gt;【你意识到自己只能接受这个安排, 除非你身上有足够的钱, 或者不介意在户外过夜. 据你所知, 岛上还是有一些夜间出没的猛兽的】&lt;&lt;/timed&gt;&gt;
&lt;br&gt;&lt;br&gt;&lt;br&gt;
&lt;&lt;timed 6s t8n&gt;&gt; ⋙⋙⋙⋙⋙⋙⋘⋘⋘⋘⋘⋘&lt;br&gt;
&lt;&lt;link ▷「接受」 住房安排&gt;&gt;&lt;&lt;set $choice to &quot;接受&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;br&gt;
&lt;&lt;link ▷「拒绝」 主线第一天结束&gt;&gt;&lt;&lt;set $choice to &quot;拒绝&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;&lt;/timed&gt;&gt;
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="28" name="偷窃" tags="nobr" position="1100,600" size="100,100">&lt;&lt;if $choice == &quot;撬锁&quot;&gt;&gt;
&lt;&lt;set _t to random(25,35)&gt;&gt;&lt;&lt;set _r to setup.getStat(&quot;strength&quot;)*_t/10&gt;&gt;&lt;&lt;set _a to setup.getStat(&quot;strength&quot;)/_r*100&gt;&gt;&lt;&lt;checkWidget&gt;&gt;
&lt;&lt;if _rst == &quot;大成功&quot; || _rst == &quot;成功&quot;&gt;&gt;
&lt;&lt;set _t to random(20,30)&gt;&gt;&lt;&lt;set _r to setup.getStat(&quot;observation&quot;)*_t/10&gt;&gt;&lt;&lt;set _a to setup.getStat(&quot;observation&quot;)/_r*100&gt;&gt;&lt;&lt;checkWidget&gt;&gt;
&lt;&lt;if _rst == &quot;大成功&quot; || _rst == &quot;成功&quot;&gt;&gt;
&lt;&lt;set $loc = $stoleloc, $strengthexp += 2, $observationexp += 2&gt;&gt;
【经过你的一番尝试, 木门简陋的门锁在你手下嘎吱一声放弃了自己的职责, 你成功进入了$stoleloc】&lt;&lt;addsexpWidget&gt;&gt;&lt;&lt;addoexpWidget&gt;&gt;
&lt;br&gt;&lt;br&gt;&lt;&lt;set _s to random(1,100)&gt;&gt;&lt;&lt;set _r to random(1,100)&gt;&gt;&lt;&lt;set _m to random(1,50)&gt;&gt;&lt;&lt;set _n to random(1,3)&gt;&gt;

/***偷窃内容***/
&lt;&lt;if $stoleloc == &quot;居民的家&quot;&gt;&gt;
&lt;&lt;if ($housedes2 == &quot;主人在家&quot; &amp;&amp; _s &lt;=36) || ($housedes2 == &quot;非常安静&quot; &amp;&amp; _s &lt;=12)&gt;&gt;
【你发出来的一系列声响惊动了房主】
◈逃跑
&lt;&lt;if setup.getStat(&quot;confidence&quot;) &gt;= 12&gt;&gt;◈辩解&lt;&lt;/if&gt;&gt;
    &lt;&lt;else&gt;&gt;
    你蹑手蹑脚的在屋子里寻找值得偷窃的东西. 
        &lt;&lt;if _r &lt;=40&gt;&gt;&lt;&lt;stoleall&gt;&gt;
        &lt;&lt;elseif _r &lt;= 75&gt;&gt;你找到了一些食物, 他们看上去还足够新鲜&lt;&lt;set _item =  [&quot;浆果馅饼&quot;,&quot;鲜花饼&quot;,&quot;苹果派&quot;].random()&gt;&gt;
        &lt;&lt;elseif _r &lt;= 98&gt;&gt;鱼缸里自由游动着被精心照料的鱼儿, 也许你可以抓走一些&lt;&lt;set _item =  [&quot;浆果馅饼&quot;,&quot;鲜花饼&quot;,&quot;苹果派&quot;].random()&gt;&gt;
        &lt;&lt;else&gt;&gt;
            &lt;&lt;if $house.Length &gt;0&gt;&gt;
            &lt;&lt;set _i =random(1, $house.Length)&gt;&gt;
            &lt;&lt;set _item = $house.list[_i], _n = 1&gt;&gt;你找到了一个_item
            &lt;&lt;else&gt;&gt;&lt;&lt;stoleall&gt;&gt;&lt;&lt;/if&gt;&gt;
        &lt;&lt;/if&gt;&gt;
    &lt;br&gt;&lt;br&gt;
    ◈&lt;&lt;link 拿走 小镇&gt;&gt;&lt;&lt;itemcheck&gt;&gt;&lt;&lt;set $choice = 0&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;br&gt;
    ▷&lt;&lt;link 离开 小镇&gt;&gt;&lt;&lt;set $choice = 0&gt;&gt;&lt;&lt;/link&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;elseif $stoleloc == &quot;医院&quot;&gt;&gt;
&lt;&lt;if _s &lt;=20&gt;&gt;【你发出来的一系列声响惊动了佩拉大夫】
◈逃跑
&lt;&lt;if setup.getStat(&quot;confidence&quot;) &gt;= 12&gt;&gt;◈辩解&lt;&lt;/if&gt;&gt;
&lt;&lt;else&gt;&gt;
你蹑手蹑脚的在医院里寻找值得偷窃的东西. 
 &lt;&lt;if _r &lt;=65&gt;&gt;&lt;&lt;stoleall&gt;&gt;
        &lt;&lt;else&gt;&gt;
&lt;&lt;if $hospital.Length &gt;0&gt;&gt;
&lt;&lt;set _i =random(1, $hospital.Length)&gt;&gt;
&lt;&lt;set _item = $house.list[_i], _n = 1&gt;&gt;你找到了一个_item
            &lt;&lt;else&gt;&gt;&lt;&lt;stoleall&gt;&gt;&lt;&lt;/if&gt;&gt;
        &lt;&lt;/if&gt;&gt;
&lt;br&gt;&lt;br&gt;
    ◈&lt;&lt;link 拿走 小镇&gt;&gt;&lt;&lt;itemcheck&gt;&gt;&lt;&lt;set $choice = 0&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;br&gt;
    ▷&lt;&lt;link 离开 小镇&gt;&gt;&lt;&lt;set $choice = 0&gt;&gt;&lt;&lt;/link&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;elseif $stoleloc == &quot;咖啡馆&quot;&gt;&gt;
&lt;&lt;if _s &lt;=7&gt;&gt;【你发出来的一系列声响惊动了老板娘】
◈逃跑
&lt;&lt;if setup.getStat(&quot;confidence&quot;) &gt;= 12&gt;&gt;◈辩解&lt;&lt;/if&gt;&gt;
&lt;&lt;else&gt;&gt;
你蹑手蹑脚的在黑暗里的咖啡馆寻找值得偷窃的东西. 
 &lt;&lt;if _r &lt;=42&gt;&gt;&lt;&lt;stoleall&gt;&gt;
 &lt;&lt;elseif _r &lt;= 98&gt;&gt;你找到了一些咖啡馆为明天准备的商品, 健忘的老板娘大概并不会发现你偷偷拿走了其中几个&lt;&lt;set _item =  [&quot;黑巧小蛋糕&quot;,&quot;意式浓缩&quot;,&quot;蜂蜜鲜奶&quot;,&quot;朗姆葡萄酥卷&quot;,&quot;蓝山咖啡&quot;,&quot;朗姆冰淇淋&quot;,&quot;羊角面包&quot;,&quot;芝士三明治&quot;,&quot;阿芙加朵&quot;,&quot;摩卡&quot;,&quot;红茶&quot;,&quot;卡布奇诺&quot;].random()&gt;&gt;
        &lt;&lt;else&gt;&gt;
        &lt;&lt;if $coffeehide.Length &gt;0&gt;&gt;
&lt;&lt;set _i =random(1, $coffeehide.Length)&gt;&gt;
&lt;&lt;set _item = $coffeehide.list[_i], _n = 1&gt;&gt;你找到了一个_item
&lt;&lt;else&gt;&gt;&lt;&lt;stoleall&gt;&gt;&lt;&lt;/if&gt;&gt;
        &lt;&lt;/if&gt;&gt;
&lt;br&gt;&lt;br&gt;
    ◈&lt;&lt;link 拿走 小镇&gt;&gt;&lt;&lt;itemcheck&gt;&gt;&lt;&lt;set $choice = 0, $sin +=1&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;br&gt;
    ▷&lt;&lt;link 离开 小镇&gt;&gt;&lt;&lt;set $choice = 0&gt;&gt;&lt;&lt;/link&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;elseif $stoleloc == &quot;酒馆&quot;&gt;&gt;
&lt;&lt;if _s &lt;=27&gt;&gt;【你发出来的一系列声响惊动了店里的某些东西, 你听到有悉悉索索的脚步声离你越来越近】
◈逃跑
&lt;&lt;if setup.getStat(&quot;confidence&quot;) &gt;= 12&gt;&gt;◈辩解&lt;&lt;/if&gt;&gt;
&lt;&lt;else&gt;&gt;
你蹑手蹑脚的在打样的咖啡馆寻找值得偷窃的东西. 
 &lt;&lt;if _r &lt;=42&gt;&gt;&lt;&lt;stoleall&gt;&gt;
 &lt;&lt;elseif _r &lt;= 98&gt;&gt;你找到了一些咖啡馆为明天准备的商品, 健忘的老板娘大概并不会发现你偷偷拿走了其中几个&lt;&lt;set _item =  [&quot;黑巧小蛋糕&quot;,&quot;意式浓缩&quot;,&quot;蜂蜜鲜奶&quot;,&quot;朗姆葡萄酥卷&quot;,&quot;蓝山咖啡&quot;,&quot;朗姆冰淇淋&quot;,&quot;羊角面包&quot;,&quot;芝士三明治&quot;,&quot;阿芙加朵&quot;,&quot;摩卡&quot;,&quot;红茶&quot;,&quot;卡布奇诺&quot;].random()&gt;&gt;
        &lt;&lt;else&gt;&gt;
        &lt;&lt;if $coffeehide.Length &gt;0&gt;&gt;
&lt;&lt;set _i =random(1, $coffeehide.Length)&gt;&gt;
&lt;&lt;set _item = $coffeehide.list[_i], _n = 1&gt;&gt;你找到了一个_item
&lt;&lt;else&gt;&gt;&lt;&lt;stoleall&gt;&gt;&lt;&lt;/if&gt;&gt;
        &lt;&lt;/if&gt;&gt;
&lt;br&gt;&lt;br&gt;
    ◈&lt;&lt;link 拿走 小镇&gt;&gt;&lt;&lt;itemcheck&gt;&gt;&lt;&lt;set $choice = 0, $sin +=1&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;br&gt;
    ▷&lt;&lt;link 离开 小镇&gt;&gt;&lt;&lt;set $choice = 0&gt;&gt;&lt;&lt;/link&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;/if&gt;&gt;
/***偷窃结束***/

&lt;&lt;else&gt;&gt;【你努力了, 但还不够】&lt;br&gt;&lt;br&gt;
▷&lt;&lt;link 离开 小镇&gt;&gt;&lt;&lt;set $choice = 0&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;&lt;addsexpWidget&gt;&gt;&lt;&lt;/if&gt;&gt;
&lt;&lt;else&gt;&gt;【你打不开这扇门】&lt;br&gt;&lt;br&gt;
▷&lt;&lt;link 离开 小镇&gt;&gt;&lt;&lt;set $choice = 0&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;&lt;/if&gt;&gt;&lt;&lt;/if&gt;&gt;

&lt;&lt;if $choice == &quot;搜寻四周&quot;&gt;&gt;
&lt;&lt;if $housedes == &quot;田地里作物旺盛&quot;&gt;&gt;【你找到了】
&lt;&lt;else&gt;&gt;没写&lt;&lt;/if&gt;&gt;&lt;br&gt;&lt;br&gt;
▷&lt;&lt;link 离开 小镇&gt;&gt;&lt;&lt;set $choice = 0&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="29" name="兑换" tags="nobr" position="1100,200" size="100,100">&lt;&lt;if $loc == &quot;鱼铺&quot;&gt;&gt;
/*兑换鱼饵*/
&lt;&lt;if $choice == &quot;兑换鱼饵&quot;&gt;&gt;【1鱼肉=2鱼饵】
&lt;&lt;textbox &quot;_amt1&quot; &quot;&quot; autofocus&gt;&gt; &lt;&lt;button &quot;兑换&quot;&gt;&gt;&lt;&lt;if $food.count(&#39;鱼肉&#39;) &gt;= _amt1&gt;&gt;&lt;&lt;set $amt1 to _amt1*1&gt;&gt;&lt;&lt;set $amt2 to _amt1*2&gt;&gt;&lt;&lt;pickup $item &quot;鱼饵&quot; $amt2&gt;&gt;&lt;&lt;drop $food &quot;鱼肉&quot; $amt1&gt;&gt;&lt;&lt;run Dialog.setup(&quot;兑换鱼饵&quot;);Dialog.wiki(&quot;【你获得了鱼饵 * $amt2】&quot;);Dialog.open();&gt;&gt;&lt;&lt;else&gt;&gt;&lt;&lt;run Dialog.setup(&quot;兑换鱼饵&quot;);Dialog.wiki(&quot;【你的鱼肉不足】&quot;);Dialog.open();&gt;&gt;&lt;&lt;/if&gt;&gt;&lt;&lt;/button&gt;&gt;
/*剁鱼*/
&lt;&lt;elseif $choice == &quot;剁鱼&quot;&gt;&gt;
&lt;&lt;if $fish.uniqueLength &gt;= 1&gt;&gt;▸▹ ✾ ✾ ✾ ✾ ✾ ✾ ✾ ✾ ✾ ✾ ✾ ✾ ✾ ✾ ✾ ✾ ✾ ✾ ✾ ✾ ✾ ✾ ✾ ✾ ◃◂
&lt;div class=&quot;shopping-interface&quot;&gt;
&lt;&lt;for _item, _amount range $fish.table&gt;&gt;&lt;&lt;chopfish _item _amount&gt;&gt;&lt;&lt;/for&gt;&gt;&lt;/div&gt;▸▹ ✾ ✾ ✾ ✾ ✾ ✾ ✾ ✾ ✾ ✾ ✾ ✾ ✾ ✾ ✾ ✾ ✾ ✾ ✾ ✾ ✾ ✾ ✾ ✾ ◃◂
&lt;&lt;else&gt;&gt;【你的鱼篓空空如也】&lt;&lt;/if&gt;&gt;
/*卖鱼*/
&lt;&lt;elseif $choice == &quot;出售&quot;&gt;&gt;
&lt;&lt;if $fish.uniqueLength &gt;= 1&gt;&gt;▸▹ ✾ ✾ ✾ ✾ ✾ ✾ ✾ ✾ ✾ ✾ ✾ ✾ ✾ ✾ ✾ ✾ ✾ ✾ ✾ ✾ ✾ ✾ ✾ ✾ ◃◂
&lt;div class=&quot;shopping-interface&quot;&gt;
&lt;&lt;for _item, _amount range $fish.table&gt;&gt;&lt;&lt;sellfish _item _amount&gt;&gt;&lt;&lt;/for&gt;&gt;&lt;/div&gt;▸▹ ✾ ✾ ✾ ✾ ✾ ✾ ✾ ✾ ✾ ✾ ✾ ✾ ✾ ✾ ✾ ✾ ✾ ✾ ✾ ✾ ✾ ✾ ✾ ✾ ◃◂
&lt;&lt;else&gt;&gt;【你的鱼篓空空如也】&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;

/*换鱼油*/
&lt;&lt;elseif $loc == &quot;主港口灯塔&quot;&gt;&gt;
&lt;&lt;if $item.has(&#39;鱼油&#39;)&gt;&gt;【“噢，好呀。”琼从屋里抱出一个玻璃罐子，“倒在这里吧。这些鱼油能让灯塔再亮上几个小时。”】
&lt;&lt;set _tmpf to $item.count(&#39;鱼油&#39;)&gt;&gt;
&lt;&lt;set _tmpf1 to $item.count(&#39;鱼油&#39;)&gt;&gt;
&lt;&lt;set $feather to $feather+ _tmpf&gt;&gt;&lt;&lt;redo&gt;&gt;&lt;&lt;drop $item &quot;鱼油&quot; _tmpf1&gt;&gt;&lt;br&gt;
&lt;font color=#4E84BA&gt;✧你获得了_tmpf枚鸟羽✧&lt;/font&gt;
&lt;&lt;else&gt;&gt;【你穷迫的翻找背包, 然而一瓶鱼油都没有如你所愿的出现在你的手里】
&lt;&lt;/if&gt;&gt;

/****购买****/
&lt;&lt;elseif $loc == &quot;咖啡馆&quot;&gt;&gt;
&lt;div class=&quot;shopping-interface&quot;&gt;
&lt;&lt;for _item, _amount range $coffee.table&gt;&gt;
&lt;&lt;buy _item _amount&gt;&gt;&lt;&lt;/for&gt;&gt;&lt;/div&gt;
&lt;br&gt;&lt;div style=&quot;float: right;&quot;&gt;每日现做，尽请挑选&lt;/div&gt;
&lt;&lt;elseif $loc == &quot;酒馆&quot;&gt;&gt;
&lt;div class=&quot;shopping-interface&quot;&gt;
&lt;&lt;for _item, _amount range $pub.table&gt;&gt;
&lt;&lt;buy _item _amount&gt;&gt;&lt;&lt;/for&gt;&gt;&lt;/div&gt;
&lt;&lt;elseif $loc == &quot;工坊&quot;&gt;&gt;
&lt;&lt;if $choice == &quot;左侧门&quot;&gt;&gt;没写
&lt;&lt;elseif $choice == &quot;右侧门&quot;&gt;&gt;没写

/*制作*/
&lt;&lt;else&gt;&gt;
▹☽ ✽ ✽ ✽ ✽ ✽ ✽ ✽ ✽ ✽ ✽ ✽ ✽ ✽ ✽ ✽ ✽ ✽ ✽ ✽ ✽ ✽ ✽ ✽ ☾◃&lt;br&gt;
&lt;b&gt;&amp;nbsp;•&amp;nbsp;&amp;nbsp;贝壳项链&lt;/b&gt;&amp;nbsp;&amp;nbsp;&lt;font size=2px&gt;(话术+1)&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;
✧材料：贝壳*5&amp;nbsp;&amp;nbsp;&amp;nbsp;拥有：&lt;&lt;=$item.count(&quot;贝壳&quot;)&gt;&gt;&lt;/font&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;&lt;link &quot;制作&quot;&gt;&gt;&lt;&lt;if $item.count(&#39;贝壳&#39;) &gt;= 5&gt;&gt;&lt;&lt;pickup $neck &quot;贝壳项链&quot; 1&gt;&gt;&lt;&lt;drop $item &quot;贝壳&quot; 5&gt;&gt;&lt;&lt;run Dialog.setup(&quot;制作&quot;);Dialog.wiki(&quot;【你获得了贝壳项链 * 1】&quot;);Dialog.open();&gt;&gt;&lt;&lt;else&gt;&gt;&lt;&lt;lessitem&gt;&gt;&lt;&lt;/if&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;br&gt;
&lt;b&gt;&amp;nbsp;•&amp;nbsp;&amp;nbsp;毛皮大衣&lt;/b&gt;&lt;br&gt;&lt;font size=2px&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;
✧材料：狐皮*3&amp;nbsp;&amp;nbsp;&amp;nbsp;拥有：&lt;&lt;=$item.count(&quot;狐皮&quot;)&gt;&gt;&lt;/font&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;&lt;link &quot;制作&quot;&gt;&gt;&lt;&lt;if $prey.count(&#39;狐皮&#39;) &gt;= 3&gt;&gt;&lt;&lt;pickup $top &quot;毛皮大衣&quot; 1&gt;&gt;&lt;&lt;drop $prey &quot;狐皮&quot; 3&gt;&gt;&lt;&lt;run Dialog.setup(&quot;制作&quot;);Dialog.wiki(&quot;【你获得了毛皮大衣 * 1】&quot;);Dialog.open();&gt;&gt;&lt;&lt;else&gt;&gt;&lt;&lt;lessitem&gt;&gt;&lt;&lt;/if&gt;&gt;&lt;&lt;/link&gt;&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;font size=2px&gt;兔皮*15&amp;nbsp;&amp;nbsp;&amp;nbsp;拥有：&lt;&lt;=$item.count(&quot;兔皮&quot;)&gt;&gt;&lt;/font&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;&lt;link &quot;制作&quot;&gt;&gt;&lt;&lt;if $prey.count(&#39;兔皮&#39;) &gt;= 15&gt;&gt;&lt;&lt;pickup $top &quot;毛皮大衣&quot; 1&gt;&gt;&lt;&lt;drop $prey &quot;兔皮&quot; 15&gt;&gt;&lt;&lt;run Dialog.setup(&quot;制作&quot;);Dialog.wiki(&quot;【你获得了毛皮大衣 * 1】&quot;);Dialog.open();&gt;&gt;&lt;&lt;else&gt;&gt;&lt;&lt;lessitem&gt;&gt;&lt;&lt;/if&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;br&gt;
&lt;b&gt;&amp;nbsp;•&amp;nbsp;&amp;nbsp;皮革手套&lt;/b&gt;&amp;nbsp;&amp;nbsp;&lt;font size=2px&gt;(力量+2)&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;
✧材料：鼬皮*2&amp;nbsp;&amp;nbsp;&amp;nbsp;拥有：&lt;&lt;=$item.count(&quot;鼬皮&quot;)&gt;&gt;&lt;/font&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;&lt;link &quot;制作&quot;&gt;&gt;&lt;&lt;if $item.count(&#39;鼬皮&#39;) &gt;= 2&gt;&gt;&lt;&lt;pickup $hand &quot;皮革手套&quot; 1&gt;&gt;&lt;&lt;drop $prey &quot;鼬皮&quot; 2&gt;&gt;&lt;&lt;run Dialog.setup(&quot;制作&quot;);Dialog.wiki(&quot;【你获得了皮革手套* 1】&quot;);Dialog.open();&gt;&gt;&lt;&lt;else&gt;&gt;&lt;&lt;lessitem&gt;&gt;&lt;&lt;/if&gt;&gt;&lt;&lt;/link&gt;&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;font size=2px&gt;兔皮*6&amp;nbsp;&amp;nbsp;&amp;nbsp;拥有：&lt;&lt;=$item.count(&quot;兔皮&quot;)&gt;&gt;&lt;/font&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;&lt;link &quot;制作&quot;&gt;&gt;&lt;&lt;if $prey.count(&#39;兔皮&#39;) &gt;= 6&gt;&gt;&lt;&lt;pickup $top &quot;皮革手套&quot; 1&gt;&gt;&lt;&lt;drop $prey &quot;兔皮&quot; 6&gt;&gt;&lt;&lt;run Dialog.setup(&quot;制作&quot;);Dialog.wiki(&quot;【你获得了皮革手套 * 1】&quot;);Dialog.open();&gt;&gt;&lt;&lt;else&gt;&gt;&lt;&lt;lessitem&gt;&gt;&lt;&lt;/if&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;br&gt;
▹☽ ✽ ✽ ✽ ✽ ✽ ✽ ✽ ✽ ✽ ✽ ✽ ✽ ✽ ✽ ✽ ✽ ✽ ✽ ✽ ✽ ✽ ✽ ✽ ☾◃
&lt;&lt;/if&gt;&gt;

&lt;&lt;elseif $loc == &quot;杂货铺&quot;&gt;&gt;
&lt;&lt;if $choice == &quot;出售&quot;&gt;&gt;/*卖钱*/
没写
/*购物*/
&lt;&lt;elseif $choice == &quot;购物&quot;&gt;&gt;
▸▹ ✾ ✾ ✾ ✾ ✾ ✾ ✾ ✾ ✾ ✾ ✾ ✾ ✾ ✾◃◂&lt;br&gt;&lt;div class=&quot;shopping-interface&quot;&gt;
&lt;&lt;for _item, _amount range $store.table&gt;&gt;
&lt;&lt;buy _item _amount&gt;&gt;&lt;&lt;/for&gt;&gt;&lt;/div&gt;
&lt;br&gt;▸▹ ✾ ✾ ✾ ✾ ✾ ✾ ✾ ✾ ✾ ✾ ✾ ✾ ✾ ✾◃◂
&lt;&lt;/if&gt;&gt;

&lt;&lt;elseif $loc == &quot;泡泡布提&quot;&gt;&gt;
没写

&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="30" name="创建角色" tags="" position="300,1175" size="100,100">&lt;&lt;audio &quot;mainBGM&quot; play&gt;&gt;&lt;h2&gt;基本信息&lt;/h2&gt;
全名:
 	&lt;&lt;textbox &quot;$name&quot; &quot;&quot; autofocus&gt;&gt; 
昵称: 
 	&lt;&lt;textbox &quot;$nn&quot; &quot;&quot;&gt;&gt; 
年龄: 
 	&lt;&lt;textbox &quot;$age&quot; &quot;&quot;&gt;&gt;
故乡: 
 	&lt;&lt;textbox &quot;$hometown&quot; &quot;&quot;&gt;&gt;&lt;&lt;if !$hometown&gt;&gt; &lt;&lt;set $hometown to &quot;未知&quot;&gt;&gt;&lt;&lt;/if&gt;&gt; 
身份: 
 	&lt;&lt;textbox &quot;$id&quot; &quot;&quot;&gt;&gt;&lt;&lt;if !$id&gt;&gt; &lt;&lt;set $id to &quot;无&quot;&gt;&gt;&lt;&lt;/if&gt;&gt; 
&lt;&lt;set _bdays to [&quot;1&quot;,&quot;2&quot;,&quot;3&quot;,&quot;4&quot;,&quot;5&quot;,&quot;6&quot;,&quot;7&quot;,&quot;8&quot;,&quot;9&quot;,&quot;10&quot;,&quot;11&quot;,&quot;12&quot;,&quot;13&quot;,&quot;14&quot;,&quot;15&quot;,&quot;16&quot;,&quot;17&quot;,&quot;18&quot;,&quot;19&quot;,&quot;20&quot;,&quot;21&quot;,&quot;22&quot;,&quot;23&quot;,&quot;24&quot;,&quot;25&quot;,&quot;26&quot;,&quot;27&quot;,&quot;28&quot;,&quot;29&quot;,&quot;30&quot;,&quot;31&quot;]&gt;&gt;&lt;&lt;set _bmons to [&quot;1&quot;,&quot;2&quot;,&quot;3&quot;,&quot;4&quot;,&quot;5&quot;,&quot;6&quot;,&quot;7&quot;,&quot;8&quot;,&quot;9&quot;,&quot;10&quot;,&quot;11&quot;,&quot;12&quot;]&gt;&gt;生日:
&lt;&lt;listbox &quot;$bmon&quot;&gt;&gt; &lt;&lt;optionsfrom _bmons&gt;&gt; &lt;&lt;/listbox&gt;&gt;   &lt;&lt;listbox &quot;$bday&quot;&gt;&gt; &lt;&lt;optionsfrom _bdays&gt;&gt; &lt;&lt;/listbox&gt;&gt;
称呼:
&lt;&lt;radiobutton &quot;$gender&quot; &quot;M&quot; `$gender === &quot;M&quot; ? &quot;checked&quot; : &quot;&quot;`&gt;&gt; 先生  &lt;&lt;radiobutton &quot;$gender&quot; &quot;FM&quot; `$gender === &quot;F&quot; ? &quot;checked&quot; : &quot;&quot;`&gt;&gt; 女士
&lt;&lt;set $blood = &quot;normal&quot;&gt;&gt;

&lt;&lt;button[[继续|属性分配]]]&gt;&gt;&lt;&lt;/button&gt;&gt;</tw-passagedata><tw-passagedata pid="31" name="初始选择" tags="nobr" position="700,1175" size="100,100">&lt;font color=&quot;FFAA00&quot;&gt; Seisinofoaga&lt;/font&gt;: 
&lt;&lt;type-wp 45ms element &quot;span&quot;&gt;&gt;永远别后悔你的选择, 你也没地方后悔
&lt;&lt;if $choice == &quot;鲜花诗集&quot;&gt;&gt;&lt;&lt;set _itemobtain = &quot;鲜花诗集 * 1&quot;&gt;&gt;&lt;&lt;pickup $book &quot;鲜花诗集&quot; 1&gt;&gt;&lt;&lt;set $xhsjusable = 2&gt;&gt;
&lt;&lt;elseif $choice == &quot;火漆印章&quot;&gt;&gt;&lt;&lt;set _itemobtain = &quot;火漆印章 * 1&quot;&gt;&gt;&lt;&lt;pickup $item &quot;火漆印章&quot; 1&gt;&gt;&lt;&lt;set $hqyzusable = 1&gt;&gt;
&lt;&lt;elseif $choice == &quot;关节指环&quot;&gt;&gt;&lt;&lt;set _itemobtain = &quot;关节指环 * 1&quot;&gt;&gt;&lt;&lt;pickup $hand &quot;关节指环&quot; 1&gt;&gt;&lt;&lt;/if&gt;&gt;
&lt;&lt;itemobtain&gt;&gt;
&lt;center&gt;〖你获得了一个物品, 通过物品栏来获得详情〗&lt;/center&gt;
&lt;&lt;set $firstitem = 1&gt;&gt;
&lt;&lt;if $nn == &quot;Nix&quot;&gt;&gt;&lt;&lt;pickup $hand &quot;蛇骷戒指&quot; 1&gt;&gt;&lt;&lt;pickup $book &quot;律法之书&quot; 1&gt;&gt;&lt;&lt;pickup $tool &quot;短镰&quot; 1&gt;&gt;&lt;&lt;set $seisihgd = 100&gt;&gt;&lt;&lt;/if&gt;&gt;&lt;br&gt;&lt;br&gt;
[[▷「进入永无乡」|进入永无乡]]&lt;&lt;/type-wp&gt;&gt;</tw-passagedata><tw-passagedata pid="32" name="初见对话" tags="nobr" position="1300,300" size="100,100">&lt;&lt;if $npc == &quot;Era&quot;&gt;&gt;
&lt;&lt;if $choice == &quot;是&quot;&gt;&gt;&lt;&lt;set _rpl= [&quot;【“那就太好了. 永无乡是个很大的地方, 你总会过上你想要的生活. ”】&quot;,&quot;【“那就太好了. 永无乡是个很大的地方, 你总会过上你想要的生活, 至少他们是这样说的.” Era向你挤挤眼, 又恢复到之前轻松的表情】&quot;,&quot;【“那就太好了. 永无乡是个很大的地方, 你总会过上你想要的生活, 或者像我一样, 每天就跟这些绵羊为伴.”】&quot;].random()&gt;&gt;_rpl
&lt;&lt;set $persuasiveexp += 3, _slevel = 1&gt;&gt;
&lt;&lt;addpexpWidget&gt;&gt;&lt;&lt;addsocial&gt;&gt;
&lt;&lt;elseif $choice == &quot;不是&quot;&gt;&gt;【&quot;是嘛, 那太可惜了, 不过好在这儿的日子很漫长, 你也许会慢慢适应她, 就像我一样. &quot;】&lt;br&gt;
&lt;&lt;set $erahgd += 2&gt;&gt;&lt;&lt;npcwaves&gt;&gt;
&lt;&lt;elseif $choice == &quot;还不知道&quot;&gt;&gt;&lt;&lt;pickup $item &quot;海螺号角&quot; 1&gt;&gt;【&quot;那不要紧. 永无乡是个很大的地方, 你总会过上你想要的生活. &quot;他边说边翻找着什么, 很快就从包里拿出来一个海螺, 递到你面前. &quot;这算是一点乔迁礼, 拿着吧. &quot;】
&lt;font color=#4E84BA&gt;✧你获得海螺号角 * 1✧&lt;/font&gt;

&lt;&lt;elseif $choice == &quot;看上去很不错&quot;&gt;&gt;【“没必要整那套客套话. 我想想该如何招待你，酒怎么样？我私藏了几瓶老酒，在岛上可是买不到的”Era看上去是真的很高兴你的到访】
&lt;&lt;set $persuasiveexp += 1,  _slevel = 1&gt;&gt;&lt;&lt;addsocial&gt;&gt;
&lt;&lt;addpexpWidget&gt;&gt;&lt;br&gt;&lt;&lt;set $erahgd += 2&gt;&gt;&lt;&lt;npcwaves&gt;&gt;

&lt;&lt;elseif $choice == &quot;确实简陋&quot;&gt;&gt;【“真诚或许是种美德, 我的朋友, 但在这里，真诚能换取到的东西不止是真心或是羁绊……仇恨与黑暗中的鬼魅也会循着味道而来，摧毁你的真诚。如果不想被吞噬干净，最好学聪明点哦】&lt;br&gt;&lt;&lt;set $player.cautious -= 1&gt;&gt;&lt;font color=#FFAA00&gt;你的谨慎降低了1级&lt;/font&gt;
&lt;&lt;/if&gt;&gt;
&lt;br&gt;&lt;br&gt;
&lt;&lt;link ▷「继续」 $loc&gt;&gt;&lt;&lt;set $npc to 0&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;&lt;/if&gt;&gt;

&lt;&lt;if $npc == &quot;奥里&quot;&gt;&gt;
&lt;&lt;if $choice == &quot;握住她的手&quot;&gt;&gt;【奥里很高兴地握住你的手上下摆动着：“那，如果你对这里还不是很熟悉的话，我可以带你逛一圈！这里没有我不知道的地方。”她看上去笑得很开心，一红一蓝的眸子中此刻似乎只倒映着你，错觉？等你回过神来的时候，她牵着你的手指了指城镇的方向，“来吧，想去哪？”】&lt;&lt;set _slevel = 1&gt;&gt;&lt;&lt;addsocial&gt;&gt;
&lt;&lt;elseif $choice == &quot;犹豫&quot;&gt;&gt;【“噢！抱歉，大概是我来太自来熟了？”她收回了手并且往后退了一步，你们之间的距离回到了最标准的社交距离。她仍然笑着，两只手顺势背到身后，脚尖点地，“不过不用太拘束，在这个地方只要做你自己就好了。总之……欢迎来到永无乡。”】&lt;br&gt;
&lt;&lt;set $social -= 1&gt;&gt;&lt;font color=#FFAA00&gt;你的社会属性减少了1级&lt;/font&gt;
&lt;&lt;elseif $choice == &quot;抱住她&quot;&gt;&gt;【被你突如其来的举动吓了一跳？奥里愣了一会儿，便同样笑着抱住了你——以朋友之间的方式：“看样子你也和我一样？真高兴认识你！”她拍了拍你的背，你们两这才从友好的拥抱状态中离开，奥里笑了笑，“虽然想要抱着一起转圈圈，不过那样的话对我们来说太早了？”她用开玩笑的口吻说道，一红一蓝的眸子笑得弯了起来，“欢迎来到永无乡，不介意的话要不要一起享用下午茶？”】&lt;br&gt;
&lt;&lt;set $orihgd += 2&gt;&gt;&lt;&lt;npcwaves&gt;&gt;&lt;&lt;set $strengthexp += 1&gt;&gt;&lt;&lt;addsexpWidget&gt;&gt;&lt;&lt;set $observationexp += 1&gt;&gt;&lt;&lt;addoexpWidget&gt;&gt;
&lt;&lt;/if&gt;&gt;&lt;br&gt;&lt;br&gt;
&lt;&lt;link ▷「继续」 小镇&gt;&gt;&lt;&lt;set $npc to 0&gt;&gt;&lt;&lt;set $choice to 0&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;&lt;/if&gt;&gt;

&lt;&lt;if $npc == &quot;安德森&quot;&gt;&gt;
&lt;&lt;if $choice == &quot;寻找&quot;&gt;&gt;&lt;&lt;set $nmhgd +=1&gt;&gt;
&lt;&lt;set _a to setup.getStat(&quot;observation&quot;)/10*100&gt;&gt;&lt;&lt;checkWidget&gt;&gt;&lt;&lt;if _rst == &quot;大成功&quot; || _rst == &quot;成功&quot;&gt;&gt;【你发现就那么一小会功夫他就窜到了你的身后，一个飞扑就扑在了你的背上，环住的你肩膀将头凑到你的脸旁边“对不对对不对？我猜对了没！”】&lt;&lt;npcwaves&gt;&gt;&lt;&lt;set $observationexp += 2&gt;&gt;&lt;&lt;addoexpWidget&gt;&gt;&lt;br&gt;
⋙⋙⋙⋙⋙⋙⋘⋘⋘⋘⋘⋘&lt;br&gt;
&lt;&lt;link ▷「是」 初见对话&gt;&gt;&lt;&lt;set $choice to &quot;是&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;br&gt;
&lt;&lt;link ▷「否」 初见对话&gt;&gt;&lt;&lt;set $choice to &quot;否&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;
&lt;&lt;else&gt;&gt;
&lt;&lt;set _a to setup.getStat(&quot;strength&quot;)/10*100&gt;&gt;&lt;&lt;checkWidget&gt;&gt;&lt;&lt;if _rst == &quot;大成功&quot; || _rst == &quot;成功&quot;&gt;&gt;【你被身后传来的巨大力道扑了个猝不及防，你踉跄了两步，稳住身体，还没缓过神就被凑到脸旁的他吓了一跳，他环住你的脖颈，像是小鸟一般叽叽喳喳的“对不对对不对？我猜对了没！”】&lt;&lt;set $strengthexp += 2&gt;&gt;&lt;&lt;addsexpWidget&gt;&gt;
&lt;br&gt;
⋙⋙⋙⋙⋙⋙⋘⋘⋘⋘⋘⋘&lt;br&gt;
&lt;&lt;link ▷「是」 初见对话&gt;&gt;&lt;&lt;set $choice to &quot;是&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;br&gt;
&lt;&lt;link ▷「否」 初见对话&gt;&gt;&lt;&lt;set $choice to &quot;否&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;
&lt;&lt;else&gt;&gt;【你被身后传来的巨大力道扑了个猝不及防，无法控制的向前倾斜，就在你还没作出什么反应就要被扑倒在地上时，你的耳边传来了他的声音，叽叽喳喳的乱叫着&quot;哎呀，你没事吧？&quot;他抓着的衣领硬生生把你拖拽在了原地，勉强的站稳了&quot;所以我猜对了吗？&quot;】&lt;br&gt;&lt;br&gt;
⋙⋙⋙⋙⋙⋙⋘⋘⋘⋘⋘⋘&lt;br&gt;
&lt;&lt;link ▷「是」 初见对话&gt;&gt;&lt;&lt;set $choice to &quot;是&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;br&gt;
&lt;&lt;link ▷「否」 初见对话&gt;&gt;&lt;&lt;set $choice to &quot;否&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;
&lt;&lt;/if&gt;&gt;&lt;&lt;/if&gt;&gt;
&lt;&lt;elseif $choice == &quot;离开&quot;&gt;&gt;
&lt;&lt;set _a to setup.getStat(&quot;strength&quot;)/10*100&gt;&gt;&lt;&lt;checkWidget&gt;&gt;&lt;&lt;if _rst == &quot;大成功&quot; || _rst == &quot;成功&quot;&gt;&gt;【你被身后传来的巨大力道扑了个猝不及防，你踉跄了两步，稳住身体，还没缓过神就被凑到脸旁的他吓了一跳，他环住你的脖颈，像是小鸟一般叽叽喳喳的“对不对对不对？我猜对了没！”】&lt;&lt;set $strengthexp += 2&gt;&gt;&lt;&lt;addsexpWidget&gt;&gt;
&lt;br&gt;
⋙⋙⋙⋙⋙⋙⋘⋘⋘⋘⋘⋘&lt;br&gt;
&lt;&lt;link ▷「是」 初见对话&gt;&gt;&lt;&lt;set $choice to &quot;是&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;br&gt;
&lt;&lt;link ▷「否」 初见对话&gt;&gt;&lt;&lt;set $choice to &quot;否&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;
&lt;&lt;else&gt;&gt;【你被身后传来的巨大力道扑了个猝不及防，无法控制的向前倾斜，就在你还没作出什么反应就要被扑倒在地上时，你的耳边传来了他的声音，叽叽喳喳的乱叫着&quot;哎呀，你没事吧？&quot;他抓着的衣领硬生生把你拖拽在了原地，勉强的站稳了&quot;所以我猜对了吗？&quot;】&lt;br&gt;&lt;br&gt;
⋙⋙⋙⋙⋙⋙⋘⋘⋘⋘⋘⋘&lt;br&gt;
&lt;&lt;link ▷「是」 初见对话&gt;&gt;&lt;&lt;set $choice to &quot;是&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;br&gt;
&lt;&lt;link ▷「否」 初见对话&gt;&gt;&lt;&lt;set $choice to &quot;否&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;elseif $choice == &quot;是&quot;&gt;&gt;&lt;&lt;set $nmhgd +=2&gt;&gt;【&quot;太好了！&quot;一副很开心的样子张开手臂，做出了个&quot;好耶&quot;的姿势，接着握住了你的手“其实我有件事想要拜托你。”】&lt;&lt;npcwaves&gt;&gt;
&lt;&lt;timed 3s t8n&gt;&gt;【他接着说道“我丢了一样东西，所以希望你能帮我找回来——”】&lt;br&gt;&lt;br&gt;
⋙⋙⋙⋙⋙⋙⋘⋘⋘⋘⋘⋘&lt;br&gt;
&lt;&lt;link ▷「你丢了什么」 初见对话&gt;&gt;&lt;&lt;set $choice to &quot;你丢了什么&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;br&gt;
&lt;&lt;link ▷「我不！」 初见对话&gt;&gt;&lt;&lt;set $choice to &quot;我不&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;br&gt;
&lt;&lt;link ▷「保持沉默」 初见对话&gt;&gt;&lt;&lt;set $choice to &quot;保持沉默&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;&lt;/timed&gt;&gt;
&lt;&lt;elseif $choice == &quot;否&quot;&gt;&gt;【&quot;哎——真的吗？你没骗我？&quot;他将信将疑的凑到你的面前紧紧的盯着你，不知道是在仔细看你的样貌还是在辨认你是否在说谎，正在你准备做些什么或是说些什么时，他重新站好在你面前“不过那些都不重要！”】
&lt;&lt;timed 3s t8n&gt;&gt;【他接着说道“我丢了一样东西，所以希望你能帮我找回来——”】&lt;br&gt;&lt;br&gt;
⋙⋙⋙⋙⋙⋙⋘⋘⋘⋘⋘⋘&lt;br&gt;
&lt;&lt;link ▷「你丢了什么」 初见对话&gt;&gt;&lt;&lt;set $choice to &quot;你丢了什么&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;br&gt;
&lt;&lt;link ▷「我不！」 初见对话&gt;&gt;&lt;&lt;set $choice to &quot;我不&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;br&gt;
&lt;&lt;link ▷「保持沉默」 初见对话&gt;&gt;&lt;&lt;set $choice to &quot;保持沉默&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;&lt;/timed&gt;&gt;
&lt;&lt;elseif $choice == &quot;你丢了什么&quot;&gt;&gt;【“一个怀表，没什么特别的，如果一定要说的话，那就是看上去很值钱！”他想了想又加了一句:“如果找到怀表的话，说不定会有秘密惊喜也说不定哦？希望你能够期待一下！”】&lt;br&gt;&lt;br&gt;
&lt;&lt;timed 3s t8n&gt;&gt;【他像是默认你同意了他的请求，对你挥挥手，已经准备要走了，难道他只是为了说这件事吗？——你不由得冒出了这样的想法，随后就听到他继续说“不用太认真找哦——随便找找就好了！”】&lt;&lt;pickup $ss &quot;怀表&quot; 1&gt;&gt;&lt;&lt;set $choice to 0&gt;&gt;&lt;br&gt;
〖开启任务【寻物】怀表〗&lt;br&gt;&lt;br&gt;&lt;&lt;link ▷「继续」 $loc&gt;&gt;&lt;&lt;set $npc to 0, set $choice to 0&gt;&gt;&lt;&lt;/link&gt;&gt;
&lt;&lt;/timed&gt;&gt;
&lt;&lt;elseif $choice == &quot;我不&quot;&gt;&gt;【“哦……”他有些失落的应了一声，但还是说“如果你想随时可以帮我找……”他想了想又加了一句:“如果找到怀表的话，说不定会有秘密惊喜也说不定哦？希望你能够期待一下！”】&lt;br&gt;&lt;br&gt;
&lt;&lt;timed 3s t8n&gt;&gt;【他像是默认你同意了他的请求，对你挥挥手，已经准备要走了，难道他只是为了说这件事吗？——你不由得冒出了这样的想法，随后就听到他继续说“不用太认真找哦——随便找找就好了！”】&lt;&lt;pickup $ss &quot;怀表&quot; 1&gt;&gt;&lt;&lt;set $choice to 0&gt;&gt;&lt;br&gt;
〖开启任务【寻物】怀表〗&lt;br&gt;&lt;br&gt;&lt;&lt;link ▷「继续」 $loc&gt;&gt;&lt;&lt;set $npc to 0, set $choice to 0&gt;&gt;&lt;&lt;/link&gt;&gt;
&lt;&lt;/timed&gt;&gt;
&lt;&lt;elseif $choice == &quot;保持沉默&quot;&gt;&gt;【“不要不理我嘛！！”他没有在意你的寡言，继续说道“我丢的是一个怀表，，没什么特别的，如果一定要说的话，那就是看上去很值钱！”他想了想又加了一句:“如果找到怀表的话，说不定会有秘密惊喜也说不定哦？希望你能够期待一下！”】&lt;br&gt;&lt;br&gt;
&lt;&lt;timed 3s t8n&gt;&gt;【他像是默认你同意了他的请求，对你挥挥手，已经准备要走了，难道他只是为了说这件事吗？——你不由得冒出了这样的想法，随后就听到他继续说“不用太认真找哦——随便找找就好了！”】&lt;&lt;pickup $ss &quot;怀表&quot; 1&gt;&gt;&lt;&lt;set $choice to 0&gt;&gt;&lt;br&gt;
〖开启任务【寻物】怀表〗&lt;br&gt;&lt;br&gt;&lt;&lt;link ▷「继续」 $loc&gt;&gt;&lt;&lt;set $npc to 0, set $choice to 0&gt;&gt;&lt;&lt;/link&gt;&gt;
&lt;&lt;/timed&gt;&gt;

&lt;&lt;/if&gt;&gt;&lt;&lt;/if&gt;&gt;

&lt;&lt;if $npc == &quot;Tret&quot;&gt;&gt;
&lt;&lt;if $choice == &quot;新居民&quot;&gt;&gt;
&lt;&lt;set $tretsxd += 1, _slevel = 1&gt;&gt;【当他开口时, 浓厚的口音和鱼腥味近似粗鲁的袭来. &quot;你是新来的, Да. 我是鱼铺的Tret, 你有好鱼的时候可以到我这来, 我会给你公道的价格. &quot;Tret打量你的眼神, 仿佛在计算以你的身板能带给他多少鱼获】&lt;&lt;addsocial&gt;&gt;&lt;br&gt;&lt;br&gt;
&lt;&lt;link ▷「返回」 鱼铺&gt;&gt;&lt;&lt;/link&gt;&gt;
&lt;&lt;elseif $choice == &quot;拿出鱼篓&quot;&gt;&gt;&lt;&lt;if $fish.uniqueLength &gt;= 1&gt;&gt;&lt;&lt;set $tretsxd += 3&gt;&gt;【你打开鱼篓向他展示自己的收获, 公猫抓起几条拿近了观察, 粗糙的灰毛下看不见任何表情变化. &quot;да, 这些都是很好的鱼, 你钓得不错. 我会给你公道的价格. &quot;他似乎很满意你到这来只是为了交易】&lt;br&gt;&lt;br&gt;
⋙⋙⋙⋙⋙⋙⋘⋘⋘⋘⋘⋘&lt;br&gt;
&lt;&lt;link ▷「寻求建议」 初见对话&gt;&gt;&lt;&lt;set $choice to &quot;求建议2&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;br&gt;
&lt;&lt;link ▷「打扰了」 初见对话&gt;&gt;&lt;&lt;set $choice to &quot;打扰了&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;
&lt;&lt;else&gt;&gt;&lt;&lt;set $tretsxd += 2&gt;&gt;【你的鱼篓空空如也. 公猫眯起眼睛打量了一会, 才开口道:&quot;我这里是只收不卖, 乞讨的话更是没有. &quot;浓厚的口音和鱼腥味近似粗鲁的袭来】&lt;br&gt;&lt;br&gt;
⋙⋙⋙⋙⋙⋙⋘⋘⋘⋘⋘⋘&lt;br&gt;
&lt;&lt;link ▷「寻求建议」&gt;&gt;&lt;&lt;goto &quot;初见对话&quot;&gt;&gt;&lt;&lt;set $choice to &quot;求建议1&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;br&gt;
&lt;&lt;link ▷「打扰了」&gt;&gt;&lt;&lt;goto &quot;初见对话&quot;&gt;&gt;&lt;&lt;set $choice to &quot;打扰了&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;&lt;/if&gt;&gt;
&lt;&lt;elseif $choice == &quot;求建议1&quot;&gt;&gt;&lt;&lt;set $social to $social+ 1&gt;&gt;【&quot;建议? 想要钓到好鱼, 就往大海去. 这里出售鱼饵, 要租船也来找我. 大海是无情的, 但也无私供给. 尊重她的方式, 她会给你带来好收获. 现在, 走吧. 当你有更多的鱼时再回来. &quot;】&lt;br&gt;&lt;font color=#FFAA00&gt;你的社会属性提升了1级&lt;/font&gt;&lt;br&gt;&lt;br&gt;
&lt;&lt;link ▷「返回」 鱼铺&gt;&gt;&lt;&lt;/link&gt;&gt;
&lt;&lt;elseif $choice == &quot;求建议2&quot;&gt;&gt;&lt;&lt;set $knowledgeexp += 1, _slevel = 1&gt;&gt;【&quot;建议? 想要钓到好鱼, 工具也很重要. 这里出售鱼饵, 要租船也来找我. 当你觉得现在的鱼竿已经不够你发挥时这儿也说不定有你想要的. &quot;老猫转身回到自己先前的工作中, 看起来这段对话已经有了它的结尾, 你正要离开, 他却以一种更深沉的声音又说起了什么:&quot;年轻人, 多警惕潜伏在海面之下的东西. &quot;】&lt;&lt;addkexpWidget&gt;&gt;&lt;&lt;addsocial&gt;&gt;&lt;br&gt;&lt;br&gt;
&lt;&lt;link ▷「返回」 鱼铺&gt;&gt;&lt;&lt;/link&gt;&gt;
&lt;&lt;elseif $choice == &quot;打扰了&quot;&gt;&gt;&lt;&lt;set $social to $social- 1&gt;&gt;&lt;&lt;set $tretsxd -= 2&gt;&gt;【你几步退出了和他的社交距离, 公猫也没在意, 继续投入到自己手上的工作】&lt;br&gt;&lt;font color=#FFAA00&gt;你的社会属性降低了1级&lt;/font&gt;&lt;br&gt;&lt;br&gt;
&lt;&lt;link ▷「返回」 鱼铺&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;&lt;/if&gt;&gt;&lt;&lt;/if&gt;&gt;

&lt;&lt;if $npc == &quot;琥珀夫人&quot;&gt;&gt;
&lt;&lt;if $choice == &quot;还不错&quot;&gt;&gt;
&lt;&lt;set $persuasiveexp to $persuasiveexp+3&gt;&gt;&lt;&lt;set $social to $social+ 1&gt;&gt;【“标准答案，我喜欢。那你觉得我的酒馆怎么样？”她微笑着问你】&lt;&lt;addpexpWidget&gt;&gt;&lt;br&gt;&lt;&lt;set $amberhgd += 1&gt;&gt;&lt;&lt;npcwaves&gt;&gt;&lt;br&gt;&lt;br&gt;
&lt;&lt;timed 2s t8n&gt;&gt;【还没等你回答，琥珀夫人便又接着说起来：“……不，这个问题不用回答，接二连三的问题会让人心烦意乱的。抱歉啦。一定要说的话，我的酒馆，简直是好得不得了与完美！——开玩笑的。总之，无论如何，希望你也能在这里找到对你来说有价值的东西。”】&lt;&lt;/timed&gt;&gt;
&lt;&lt;elseif $choice == &quot;糟糕透了&quot;&gt;&gt;
【“嗯？好吧，我喜欢你的直爽。但最好还是尽力接纳这里的生活，毕竟你已经无法离开这里了——开玩笑的。你不会当真吧？总之，无论如何，希望你也能在这里找到对你来说有价值的东西。”】&lt;br&gt;&lt;&lt;set $amberhgd += 3&gt;&gt;&lt;&lt;npcwaves&gt;&gt;&lt;br&gt;
&lt;&lt;timed 3s t8n&gt;&gt;【“不过，我相信你会逐渐喜欢上永无乡的。好啦，言归正传。我是这个酒馆的老板娘，他们都叫我琥珀夫人。你想来点什么呢？我们这里有全小镇最好的自酿酒哦——”】&lt;br&gt;&lt;br&gt;&lt;&lt;/timed&gt;&gt;
&lt;&lt;timed 5s t8n&gt;&gt;【琥珀夫人递上了一张手写菜单】&lt;br&gt;&lt;br&gt;
&lt;&lt;link ✧「查看菜单」 兑换&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;&lt;/timed&gt;&gt;
&lt;&lt;elseif $choice == &quot;还不知道&quot;&gt;&gt;&lt;&lt;set $player.cautious += 1&gt;&gt;【“哦…我喜欢你的谨慎。毕竟你才刚来，还需要多住几天才能了解自己是否适合永无乡。虽然大家都说在这儿能找到想要的生活，但实际上‘有些人’就是对这样的日子讨厌得要命。总之，无论如何，希望你也能在这里找到对你来说有价值的东西。”】&lt;br&gt;&lt;&lt;set _tname = &quot;谨慎&quot;, _tlevel = 1&gt;&gt;&lt;&lt;set $amberhgd += 2&gt;&gt;&lt;&lt;traitaddwaves&gt;&gt;&lt;&lt;npcwaves&gt;&gt;&lt;&lt;/if&gt;&gt;&lt;br&gt;&lt;br&gt;
&lt;&lt;link ▷「继续」 酒馆&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;&lt;/if&gt;&gt;

&lt;&lt;if $npc == &quot;萨巴夫人&quot;&gt;&gt;
&lt;&lt;if $choice == &quot;你在等我&quot;&gt;&gt;
【她对你说出的第一句话就让你诧异片刻, 也许岁月已经让这位女士记忆混乱, 将你错认成他人. &quot;这岛上每天都有新面孔....我出门时就在想不知什么时候能见到今天的. &quot;她给出了一个相当合理的解释, 接着, 她拍拍自己身侧的空位, 示意你坐在她身旁】&lt;br&gt;&lt;&lt;set _tname = &quot;谨慎&quot;, _tlevel = 1&gt;&gt;&lt;&lt;traitaddwaves&gt;&gt;&lt;br&gt;&lt;br&gt;
⋙⋙⋙⋙⋙⋙⋘⋘⋘⋘⋘⋘&lt;br&gt;
&lt;&lt;link ▷「你在写诗吗」&gt;&gt;&lt;&lt;goto &quot;初见对话&quot;&gt;&gt;&lt;&lt;set $choice to &quot;你在写诗吗&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;
&lt;&lt;elseif $choice == &quot;你在写诗吗&quot;&gt;&gt;
【她微微笑笑, 用枯瘦的手指将抄写本递给你: &quot;是的...但我并不是作者.我只是很爱抄写他们. &quot;她停顿住, 目光一直落在页面上, 仿佛在期待你读出诗句. 你看了一眼标题, 《锄头赞歌》? 这不是你设想中会有的名字】&lt;br&gt;&lt;br&gt;
⋙⋙⋙⋙⋙⋙⋘⋘⋘⋘⋘⋘&lt;br&gt;
&lt;&lt;link ▷「读诗」&gt;&gt;&lt;&lt;goto &quot;初见对话&quot;&gt;&gt;&lt;&lt;set $choice to &quot;读诗&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;br&gt;
&lt;&lt;link ▷「离开」&gt;&gt;&lt;&lt;goto &quot;初见对话&quot;&gt;&gt;&lt;&lt;set $choice to &quot;离开&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;
&lt;&lt;elseif $choice == &quot;读诗&quot;&gt;&gt;【不管怎样, 你还是一字一句的读了起来】&lt;br&gt;&lt;br&gt;
&lt;&lt;timed 2s t8n&gt;&gt;&lt;center&gt;//锄头使一切繁荣兴旺；锄头使一切蓬勃发展&lt;br&gt;
锄头是好大麦；锄头是监督者&lt;br&gt;
锄头是砖模子；锄头造就了人类生存&lt;br&gt;
锄头是青年力量的来源。锄头和篮子是建造城市的工具&lt;br&gt;
它建造最好的房屋；耕种最好的田地&lt;br&gt;
就是你，锄头，延展了良田！//&lt;/center&gt;&lt;&lt;/timed&gt;&gt;&lt;br&gt;&lt;br&gt;
&lt;&lt;timed 6s t8n&gt;&gt;【萨巴夫人沉浸在你的朗读中, 待你念完, 她那愉快的样子就像从死神手里又夺回了10年的寿命. &quot;这太美了, 年轻人...&quot;她轻轻抓住你的手, 自顾自的说了起来, &quot;你能为我找来更多诗吗? 抄写好, 交给我, 我会教给你一些种植上的技巧, 还会给你种子. &quot;她似乎没觉得这个交易有什么不对】&lt;&lt;set $knowledgeexp += 2&gt;&gt;&lt;&lt;addkexpWidget&gt;&gt;&lt;br&gt;&lt;&lt;set _slevel = 1, $spasxd += 3&gt;&gt;&lt;&lt;addsocial&gt;&gt;&lt;br&gt;&lt;br&gt;
&lt;&lt;link ▷「继续」 小镇&gt;&gt;&lt;&lt;/link&gt;&gt;
&lt;&lt;/timed&gt;&gt;
&lt;&lt;elseif $choice == &quot;离开&quot;&gt;&gt;
【你没时间陪一个行将就木的老妇人玩闹, 将抄写本还给了她, 准备离开了, 但萨巴夫人突然抓住你的手, 自顾自的说了起来, &quot;你能为我找来更多诗吗? 抄写好, 交给我, 我会教给你一些种植上的技巧, 还会给你种子. &quot;她似乎没觉得这个交易有什么不对】&lt;br&gt;&lt;&lt;set _tname = &quot;无情&quot;, _tlevel = 1&gt;&gt;&lt;&lt;traitaddwaves&gt;&gt;&lt;br&gt;&lt;br&gt;
&lt;&lt;link ▷「继续」 小镇&gt;&gt;&lt;&lt;/link&gt;&gt;
&lt;&lt;/if&gt;&gt;&lt;&lt;/if&gt;&gt;

&lt;&lt;if $npc == &quot;佩罗大夫&quot;&gt;&gt;
&lt;&lt;if $choice == &quot;听他的话买药&quot;&gt;&gt;
【话都说到这份上了, 看起来你必须得买点什么了. 毕竟是药物, 以后总有机会用到, 不是吗? 】&lt;br&gt;&lt;br&gt;
[[✧买药|买药]]
&lt;&lt;elseif $choice == &quot;我是来拜访的&quot;&gt;&gt;
【他对你抬了抬眼皮, 似乎这次开始认真在打量你, 但不出片刻他又翻过身去, 你听见他对着墙壁发出了一声鼻音】&lt;&lt;set $perrasxd += 1, _slevel = 1&gt;&gt;&lt;&lt;addsocial&gt;&gt;&lt;br&gt;&lt;br&gt;
&lt;&lt;link ▷「继续」 医院&gt;&gt;&lt;&lt;/link&gt;&gt;
&lt;&lt;/if&gt;&gt;&lt;&lt;/if&gt;&gt;

&lt;&lt;if $npc == &quot;玛丽亚小姐&quot;&gt;&gt;
&lt;&lt;if $choice == &quot;我想变得更美&quot;&gt;&gt;&lt;&lt;set $marysxd += 3&gt;&gt;
【她不住的笑了起来, 笑声仿佛群鸽振过耳畔: &quot;我很高兴你能这么想, 亲爱的. &quot;玛丽亚小姐向你走近几步, 周围的空气似乎都染上了她散发出的香气, &quot;美是一种力量, 一种能改变命运的力量. 选择一件合适的衣裳, 它可以让你成为众人瞩目的焦点, 甚至...主宰他们的目光. &quot; 】&lt;br&gt;&lt;br&gt;
⋙⋙⋙⋙⋙⋙⋘⋘⋘⋘⋘⋘&lt;br&gt;
&lt;&lt;link ▷「有什么推荐」&gt;&gt;&lt;&lt;goto &quot;初见对话&quot;&gt;&gt;&lt;&lt;set $choice to &quot;有什么推荐&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;
&lt;&lt;elseif $choice == &quot;这家店非常不错&quot;&gt;&gt;&lt;&lt;set $persuasiveexp to $persuasiveexp+3&gt;&gt;&lt;&lt;set $marysxd += 2&gt;&gt;
【她不住的笑了起来, 笑声仿佛群鸽振过耳畔: &quot;保持这个语调, 甜心. 这能让你在这儿收获不少好处, 起码是我这里. &quot; 玛丽亚小姐向你走近几步, 周围的空气似乎都染上了她散发出的香气, &quot;是的, 这里的一切都是我的作品. ”她的手指轻轻在空中划过, 仿佛在展示着她的王国, &quot;从最柔软的布料到最璀璨的宝石, 我的店铺只为那些懂得欣赏美的人而存在. &quot;】&lt;&lt;addpexpWidget&gt;&gt;&lt;br&gt;&lt;br&gt;
⋙⋙⋙⋙⋙⋙⋘⋘⋘⋘⋘⋘&lt;br&gt;
&lt;&lt;link ▷「有什么推荐」&gt;&gt;&lt;&lt;goto &quot;初见对话&quot;&gt;&gt;&lt;&lt;set $choice to &quot;有什么推荐&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;br&gt;
&lt;&lt;link ▷「您是这里最美的」&gt;&gt;&lt;&lt;goto &quot;初见对话&quot;&gt;&gt;&lt;&lt;set $choice to &quot;您是这里最美的&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;
&lt;&lt;elseif $choice == &quot;有什么推荐&quot;&gt;&gt;【她拍拍双手, 眼神大方而自信的在你身上流连, 仿佛在读取你的渴求: &quot;哦, 我亲爱的, 时尚是一首瞬息万变的旋律, 而你要做的, 就是找到那一件能你觉得最正确的服饰. &quot; 她用指甲修长的手指轻轻拨开悬挂在一起的衣物, 挑出了一件精致的蓝色晚礼服, 上面用银色刺绣点缀着星星暗纹, &quot;试试这件吧, 它能让你在任何场合都成为最璀璨的明星. 价格? 今天与你的谈话就足以支付了, 甜心. &quot;】&lt;&lt;pickup $top &quot;星夜晚礼服&quot; 1&gt;&gt;&lt;br&gt;
&lt;font color=#4E84BA&gt;✧你获得星夜晚礼服 * 1✧&lt;/font&gt;&lt;br&gt;&lt;br&gt;
&lt;&lt;link ▷「继续」 泡泡布提&gt;&gt;&lt;&lt;/link&gt;&gt;
&lt;&lt;elseif $choice == &quot;您是这里最美的&quot;&gt;&gt;【玛丽亚小姐眯起了眼睛, &quot;亲爱的, 我很感激你的尝试. &quot;她用手背拂过你的脸庞, 这轻微的触感带着她独特的香气久久没有散去, &quot;如果你真的足够特别, 今夜来店里等着我吧, 仅此一次哦. &quot;】&lt;br&gt;&lt;&lt;set $maryinv = 1&gt;&gt;
&lt;font color=#DB4282&gt;✧你获得玛丽亚小姐的邀请✧&lt;/font&gt;&lt;br&gt;&lt;br&gt;
&lt;&lt;link ▷「继续」 泡泡布提&gt;&gt;&lt;&lt;set $npc to 0&gt;&gt;&lt;&lt;/link&gt;&gt;
&lt;&lt;/if&gt;&gt;&lt;&lt;/if&gt;&gt;

&lt;&lt;if $npc == &quot;Otis&quot;&gt;&gt;
&lt;&lt;if $choice == &quot;你在写什么&quot;&gt;&gt;
【&quot;哦, 你会喜欢这个的. &quot;他用沾染着油墨的手指抚摸着摊开的纸张, 从你的角度难以辨识上面写着些什么, &quot;这是岛主的委托, 但也是我最大的心血. 等它完成的那一天, 它会成为这世上最伟大的作品. &quot;他听上去和你遇到过的任何一个自命不凡的作家没什么两样】&lt;br&gt;&lt;br&gt;
⋙⋙⋙⋙⋙⋙⋘⋘⋘⋘⋘⋘&lt;br&gt;
&lt;&lt;link ▷「我能看看吗」&gt;&gt;&lt;&lt;goto &quot;初见对话&quot;&gt;&gt;&lt;&lt;set $choice to &quot;我能看看吗&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;
&lt;&lt;elseif $choice == &quot;我能看看吗&quot;&gt;&gt;
【听到你的请求, 犹豫的表情在Otis脸上踌躇了几下, 但他仍努力给了你一个认真的回答: &quot;我也很想, 我的朋友, 但这首先是委托, 其次, 给读者看一个不完整的故事是身为作者的失责. 等我完成它的那一天, 你会是第二个, 不对, 第三个知道的猫! &quot;这似乎不是什么靠谱的承诺, 但收下它对你也没什么坏处】&lt;br&gt;&lt;br&gt;
⋙⋙⋙⋙⋙⋙⋘⋘⋘⋘⋘⋘&lt;br&gt;
&lt;&lt;link ▷「祝福他」&gt;&gt;&lt;&lt;goto &quot;初见对话&quot;&gt;&gt;&lt;&lt;set $choice to &quot;祝福他&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;br&gt;
&lt;&lt;link ▷「敷衍他」&gt;&gt;&lt;&lt;goto &quot;初见对话&quot;&gt;&gt;&lt;&lt;set $choice to &quot;敷衍他&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;br&gt;
&lt;&lt;link ▷「贬低他」&gt;&gt;&lt;&lt;goto &quot;初见对话&quot;&gt;&gt;&lt;&lt;set $choice to &quot;贬低他&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;
&lt;&lt;elseif $choice == &quot;祝福他&quot;&gt;&gt;
【&quot;多谢你的祝福, 朋友, 这对我帮助很大, 相信我. &quot;他从书桌的一侧拿起一罐饮料, 尽力伸长手臂递给你: &quot;这是我特意拜托岛主买来的榛子咖啡, 岛上可没有买的! 送给你, 就当作我糟糕的欢迎仪式的补偿. &quot;他故作神秘的眯起了眼睛, &quot;可别让隔壁的老板娘知道, 否则她的咖啡馆可就要没生意了! &quot;】&lt;&lt;pickup $food &quot;榛子咖啡&quot; 1&gt;&gt;&lt;&lt;set $clue.push({name: &#39;货物&#39;, dscr: &#39;岛上不出售榛子咖啡, 依赖于岛外进货&#39;})&gt;&gt;&lt;&lt;notify 3s&gt;&gt;〖获得线索: 榛子咖啡〗&lt;&lt;/notify&gt;&gt;&lt;br&gt;
&lt;font color=#4E84BA&gt;✧你获得榛子咖啡 * 1✧&lt;/font&gt;&lt;br&gt;
&lt;&lt;set $otissxd += 2, _slevel = 1&gt;&gt;&lt;&lt;addsocial&gt;&gt;&lt;br&gt;&lt;br&gt;
&lt;&lt;link ▷「继续」 图书馆&gt;&gt;&lt;&lt;set $npc to 0&gt;&gt;&lt;&lt;/link&gt;&gt;
&lt;&lt;elseif $choice == &quot;敷衍他&quot;&gt;&gt;
【&quot;好吧, 好吧, 到时候可以一定要来看啊. &quot;他拿起羽毛笔, 准备继续投入到他的伟大作品中了, &quot;现在, 你可以先看看图书馆里的书, 阅读可是多多益善啊, 我的朋友. &quot;】
&lt;&lt;set $knowledgeexp += 2, $otissxd += 1&gt;&lt;&lt;addkexpWidget&gt;&gt;&lt;br&gt;&lt;br&gt;
&lt;&lt;link ▷「继续」 图书馆&gt;&gt;&lt;&lt;set $npc to 0&gt;&gt;&lt;&lt;/link&gt;&gt;
&lt;&lt;elseif $choice == &quot;贬低他&quot;&gt;&gt;
【Otis有些不可置信的盯着你, 显然这个胖子在他无趣的一生中还没遇到过几个像你这样直言不讳的家伙. 他看起来有些受伤, 但还是组织起了语言回应你, 眼神中有些你读不出的情绪: &quot;随你说吧, 也许我之前的确看错了, 这个故事似乎不久就会成为一张废稿了. &quot;他拿起羽毛笔, 准备继续投入到他的作品中, 不再理会你】&lt;&lt;set $clue.push({name: &#39;Otis的作品&#39;, dscr: &#39;Otis在写的故事与你有关吗...?&#39;})&gt;&gt;&lt;&lt;notify 3s&gt;&gt;〖获得线索: Otis的作品〗&lt;&lt;/notify&gt;&gt;&lt;br&gt;
&lt;&lt;set $player.heartless += 1, $otissxd -= 3&gt;&gt;&lt;&lt;set _tname = &quot;无情&quot;, _tlevel = 1&gt;&gt;&lt;&lt;traitaddwaves&gt;&gt;&lt;br&gt;&lt;br&gt;
&lt;&lt;link ▷「继续」 图书馆&gt;&gt;&lt;&lt;set $npc to 0&gt;&gt;&lt;&lt;/link&gt;&gt;
&lt;&lt;/if&gt;&gt;&lt;&lt;/if&gt;&gt;

&lt;&lt;if $npc == &quot;琼&quot; &amp;&amp; $jofirstc != 1&gt;&gt;
/*初见教堂*/
&lt;&lt;if $choice == &quot;离开&quot;&gt;&gt;【当你转身离开的时候，他还在原处坐着，像一尊沉默的雕像】&lt;br&gt;&lt;br&gt;
&lt;&lt;link ▷「继续」 小镇&gt;&gt;&lt;&lt;set $npc = 0&gt;&gt;&lt;&lt;/link&gt;&gt;
&lt;&lt;elseif $choice == &quot;搭话&quot;&gt;&gt;&lt;&lt;set $josxd += 1&gt;&gt;【他抬起头，将前额的长发拨开，用绸缎一样的声音问道：“您好？”你看到那双深蓝色的眼睛里仿佛有消逝的星光。“您有什么事吗？”】&lt;br&gt;&lt;br&gt;
⋙⋙⋙⋙⋙⋙⋘⋘⋘⋘⋘⋘&lt;br&gt;
&lt;&lt;link ▷「道歉并离开」&gt;&gt;&lt;&lt;goto &quot;初见对话&quot;&gt;&gt;&lt;&lt;set $choice to &quot;道歉并离开&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;br&gt;
&lt;&lt;link ▷「“出去聊聊？”」&gt;&gt;&lt;&lt;goto &quot;初见对话&quot;&gt;&gt;&lt;&lt;set $choice to &quot;出去聊聊&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;br&gt;
&lt;&lt;link ▷「问他的名字」&gt;&gt;&lt;&lt;goto &quot;初见对话&quot;&gt;&gt;&lt;&lt;set $choice to &quot;问他的名字&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;
&lt;&lt;elseif $choice == &quot;道歉并离开&quot;&gt;&gt;&lt;&lt;set $jofirstc == 1&gt;&gt;【听到你说认错了猫，他点了点头，疑惑地看着你离开】&lt;br&gt;&lt;br&gt;
&lt;&lt;link ▷「继续」 小镇&gt;&gt;&lt;&lt;set $npc = 0&gt;&gt;&lt;&lt;/link&gt;&gt;
&lt;&lt;elseif $choice == &quot;出去聊聊&quot;&gt;&gt;&lt;&lt;set $jofirstc == 1&gt;&gt;&lt;&lt;set $josxd += 1&gt;&gt;【他笑了一下，摇摇头拒绝了你：“对不起，我还要做礼拜呢。”说完他低下头去，粉红色的掌垫合在一起】&lt;br&gt;&lt;br&gt;
&lt;&lt;link ▷「继续」 小镇&gt;&gt;&lt;&lt;set $npc = 0&gt;&gt;&lt;&lt;/link&gt;&gt;
&lt;&lt;elseif $choice == &quot;问他的名字&quot;&gt;&gt;&lt;&lt;set $jofirstc == 1&gt;&gt;&lt;&lt;set $josxd += 2&gt;&gt;【“琼，Joan Esposito。”不只是声音，他说话的习惯也像一个十几岁的小孩子，甚至不会在意你没有做自我介绍，也并不问你是谁。“安静些吧，这里是教堂。”你看到他在胸口画了一个十字，喃喃说了些什么，不再理你】&lt;br&gt;&lt;br&gt;
&lt;&lt;link ▷「继续」 小镇&gt;&gt;&lt;&lt;set $npc = 0&gt;&gt;&lt;&lt;/link&gt;&gt;
/*初见酒馆*/
&lt;&lt;elseif $choice == &quot;在别处坐下&quot;&gt;&gt;【酒馆的气氛很快让你迷醉其中，一晃神之间，再看向之前白色的天使所在的位置，你已经找不到任何踪迹。但似乎有一丝纯洁的气息仍旧留在那块空间里】&lt;br&gt;&lt;br&gt;
&lt;&lt;link ▷「继续」 酒馆&gt;&gt;&lt;&lt;set $npc = 0&gt;&gt;&lt;&lt;/link&gt;&gt;
&lt;&lt;elseif $choice == &quot;在他对面坐下&quot;&gt;&gt;&lt;&lt;set $josxd += 1&gt;&gt;【你坐下时看到白猫缩了一下爪子，深蓝色地眼睛里露出一丝犹豫。而后他捧起啤酒杯喝了一口，轻轻砸砸嘴】&lt;br&gt;&lt;br&gt;
⋙⋙⋙⋙⋙⋙⋘⋘⋘⋘⋘⋘&lt;br&gt;
&lt;&lt;link ▷「保持沉默」&gt;&gt;&lt;&lt;goto &quot;初见对话&quot;&gt;&gt;&lt;&lt;set $choice to &quot;保持沉默&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;br&gt;
&lt;&lt;link ▷「与他搭话」&gt;&gt;&lt;&lt;goto &quot;初见对话&quot;&gt;&gt;&lt;&lt;set $choice to &quot;与他搭话&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;
&lt;&lt;elseif $choice == &quot;保持沉默&quot;&gt;&gt;【他和你面对面各自饮酒，等到啤酒杯被喝空了，他起身离开了酒馆】&lt;br&gt;&lt;br&gt;&lt;&lt;link ▷「继续」 酒馆&gt;&gt;&lt;&lt;set $npc = 0&gt;&gt;&lt;&lt;/link&gt;&gt;
&lt;&lt;elseif $choice == &quot;与他搭话&quot;&gt;&gt;【“唔，琼，我叫Joan Esposito。”他说到，声音呈现出一种异样的孩子气，尾巴尖也快活地翘上了桌子，被他用爪子摁住，“你是谁？”】&lt;br&gt;&lt;br&gt;
⋙⋙⋙⋙⋙⋙⋘⋘⋘⋘⋘⋘&lt;br&gt;
&lt;&lt;link ▷「告诉他你的名字」&gt;&gt;&lt;&lt;goto &quot;初见对话&quot;&gt;&gt;&lt;&lt;set $choice to &quot;你的名字&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;br&gt;
&lt;&lt;link ▷「这不重要」&gt;&gt;&lt;&lt;goto &quot;初见对话&quot;&gt;&gt;&lt;&lt;set $choice to &quot;这不重要&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;
&lt;&lt;elseif $choice == &quot;你的名字&quot;&gt;&gt;&lt;&lt;set $jofirstc = 1&gt;&gt;&lt;&lt;set $josxd += 2&gt;&gt;【“很高兴认识你，”琼向你伸出爪子，你看到粉嫩的掌垫上躺着一块闪烁着光芒的贝壳。“这个就当做见面礼吧。”】&lt;&lt;pickup $item &quot;五彩贝&quot; 1&gt;&gt;&lt;br&gt;
&lt;font color=#4E84BA&gt;✧你获得五彩贝 * 1✧&lt;/font&gt;&lt;br&gt;&lt;br&gt;&lt;&lt;link ▷「继续」 酒馆&gt;&gt;&lt;&lt;set $npc = 0&gt;&gt;&lt;&lt;/link&gt;&gt;
&lt;&lt;elseif $choice == &quot;这不重要&quot;&gt;&gt;&lt;&lt;set $jofirstc = 1&gt;&gt;【“哦。”你的警惕态度似乎让琼有些不快，但他也只是松开了自己的尾巴尖，低下头去喝酒了。毕竟，对于酒馆里的每一只猫来说，其实都没有必要去尝试熟悉彼此】&lt;br&gt;&lt;br&gt;&lt;&lt;link ▷「继续」 酒馆&gt;&gt;&lt;&lt;set $npc = 0&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;&lt;/if&gt;&gt;&lt;&lt;/if&gt;&gt;

/*认识后教堂第一次对话*/
&lt;&lt;if $npc == &quot;琼&quot; &amp;&amp; $jofirstcc != 1 &amp;&amp; $loc ==&quot;教堂&quot;&gt;&gt;&lt;&lt;if $choice == &quot;离开&quot;&gt;&gt;【琼闭着眼睛，没有看到你】&lt;br&gt;&lt;br&gt;
&lt;&lt;link ▷「继续」 小镇&gt;&gt;&lt;&lt;/link&gt;&gt;
&lt;&lt;elseif $choice == &quot;上前搭话&quot;&gt;&gt;&lt;&lt;set $josxd += 2&gt;&gt;【“是$nn啊。来做礼拜么？”琼偏着头看着你，柔软的毛发顺在脸颊一侧，“听说花店上新了蒲公英……”他略带期待地眨了眨眼睛，“有机会的话，帮我带一枝好么？”你本想回答，却在他的眼睛里看到期盼落空，游轮沉入大海】&lt;br&gt;&lt;br&gt;
⋙⋙⋙⋙⋙⋙⋘⋘⋘⋘⋘⋘&lt;br&gt;
&lt;&lt;link ▷「保持沉默」&gt;&gt;&lt;&lt;goto &quot;初见对话&quot;&gt;&gt;&lt;&lt;set $choice to &quot;保持沉默&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;br&gt;
&lt;&lt;link ▷「答应送他蒲公英」&gt;&gt;&lt;&lt;goto &quot;初见对话&quot;&gt;&gt;&lt;&lt;set $choice to &quot;蒲公英&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;br&gt;
&lt;&lt;link ▷「保持向他索要购买蒲公英的钱沉默」&gt;&gt;&lt;&lt;goto &quot;初见对话&quot;&gt;&gt;&lt;&lt;set $choice to &quot;索要购买蒲公英的钱&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;
&lt;&lt;elseif $choice == &quot;保持沉默&quot;&gt;&gt;&lt;&lt;set $jofirstcc = 1&gt;&gt;【琼似乎习惯于没有回答的请求，他轻轻低吟着不知名的音乐，开始了下一轮祷告】&lt;br&gt;&lt;br&gt;&lt;&lt;link ▷「继续」 教堂&gt;&gt;&lt;&lt;set $npc = 0&gt;&gt;&lt;&lt;/link&gt;&gt;
&lt;&lt;elseif $choice == &quot;蒲公英&quot;&gt;&gt;&lt;&lt;set $jofirstcc = 1&gt;&gt;&lt;&lt;set $josxd += 2&gt;&gt;【琼有些诧异地看着你，好像你的回答完全出乎他的意料，似乎他本不准备应对这样的场面。良久，他掏出一个银十字架放在桌上：“谢谢你。”他微微躬身致谢，却站起来走到了椅子的另一边坐下】&lt;&lt;pickup $item &quot;银色十字架&quot; 1&gt;&gt;
&lt;font color=#4E84BA&gt;✧你获得了银色十字架*1✧&lt;/font&gt;&lt;br&gt;&lt;br&gt;&lt;&lt;link ▷「继续」 教堂&gt;&gt;&lt;&lt;set $npc = 0&gt;&gt;&lt;&lt;/link&gt;&gt;
&lt;&lt;elseif $choice == &quot;索要购买蒲公英的钱&quot;&gt;&gt;&lt;&lt;set $jofirstcc = 1, $josxd -= 2&gt;&gt;【“如果这样的话，就算了吧。”你的话似乎在琼的意料之中，他坦然地说道：“我没有钱。”】&lt;br&gt;&lt;br&gt;&lt;&lt;link ▷「继续」 教堂&gt;&gt;&lt;&lt;set $npc = 0&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;&lt;/if&gt;&gt;&lt;&lt;/if&gt;&gt;

/*认识后酒馆第一次对话*/
&lt;&lt;if $npc == &quot;琼&quot; &amp;&amp; $jofirstpc != 1 &amp;&amp; $loc ==&quot;酒馆&quot;&gt;&gt;
&lt;&lt;if $choice == &quot;找别的地方坐下&quot;&gt;&gt;【有猫坐到了琼的对面和他说话，当他离开的时候，桌上的啤酒杯彻底空了。琼端起杯子走向吧台续杯】&lt;br&gt;&lt;br&gt;
&lt;&lt;link ▷「继续」 酒馆&gt;&gt;&lt;&lt;/link&gt;&gt;
&lt;&lt;elseif $choice == &quot;坐到他对面&quot;&gt;&gt;&lt;&lt;set $jofirstpc = 1&gt;&gt;&lt;&lt;set $josxd += 2&gt;&gt;【深蓝色的眼睛看向你：“来这里放松吗？酒馆是好地方、美酒也是好东西……但是待久了会堕落的，要小心哦。”】&lt;br&gt;&lt;br&gt;
⋙⋙⋙⋙⋙⋙⋘⋘⋘⋘⋘⋘&lt;br&gt;
&lt;&lt;link ▷「自顾自做事」&gt;&gt;&lt;&lt;goto &quot;初见对话&quot;&gt;&gt;&lt;&lt;set $choice to &quot;自顾自做事&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;br&gt;
&lt;&lt;link ▷「为什么这么说」&gt;&gt;&lt;&lt;goto &quot;初见对话&quot;&gt;&gt;&lt;&lt;set $choice to &quot;为什么这么说&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;br&gt;
&lt;&lt;link ▷「怎么会在酒馆」&gt;&gt;&lt;&lt;goto &quot;初见对话&quot;&gt;&gt;&lt;&lt;set $choice to &quot;怎么会在酒馆&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;
&lt;&lt;elseif $choice == &quot;自顾自做事&quot;&gt;&gt;【琼一边玩手里的东西一边慢慢地把半杯酒喝干了。端着杯子走向吧台续杯】&lt;br&gt;&lt;br&gt;
&lt;&lt;link ▷「继续」 酒馆&gt;&gt;&lt;&lt;/link&gt;&gt;
&lt;&lt;elseif $choice == &quot;为什么这么说&quot;&gt;&gt;【“美酒会蒙蔽你的心智，让人做出万劫不复的事。”琼的眼神落在酒馆的一个角落里，“盛大的宴会，成十成百的沉醉。绫罗加身，瞳仁映着血色，不知是天使还是魔鬼在唱歌。”】&lt;br&gt;&lt;br&gt;
⋙⋙⋙⋙⋙⋙⋘⋘⋘⋘⋘⋘&lt;br&gt;
&lt;&lt;link ▷「岔开话题」&gt;&gt;&lt;&lt;goto &quot;初见对话&quot;&gt;&gt;&lt;&lt;set $choice to &quot;岔开话题&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;br&gt;
&lt;&lt;link ▷「听他说下去」&gt;&gt;&lt;&lt;goto &quot;初见对话&quot;&gt;&gt;&lt;&lt;set $choice to &quot;听他说下去&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;
&lt;&lt;elseif $choice == &quot;怎么会在酒馆&quot;&gt;&gt;【“面对大海太久也会生病，医生不能治疗的病。”琼说着摊开爪子，掌垫上躺着一块流光溢彩的贝壳：“这是我在海滩上找到的，我想把它送给喜欢它的人，你要么？”】&lt;br&gt;&lt;br&gt;
⋙⋙⋙⋙⋙⋙⋘⋘⋘⋘⋘⋘&lt;br&gt;
&lt;&lt;link ▷「接受」&gt;&gt;&lt;&lt;goto &quot;初见对话&quot;&gt;&gt;&lt;&lt;set $choice to &quot;接受&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;br&gt;
&lt;&lt;link ▷「拒绝」&gt;&gt;&lt;&lt;goto &quot;初见对话&quot;&gt;&gt;&lt;&lt;set $choice to &quot;拒绝&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;
&lt;&lt;elseif $choice == &quot;岔开话题&quot;&gt;&gt;【“啊，你说酒馆的装饰吗？”琼一下子回过神，晃了晃脑袋，蓬松的毛在空气中颤抖着，“我更喜欢家乡的风格……嗯，要有彩色的装饰、天顶画、金色的吊灯还有彩色的拼花大理石。”】&lt;br&gt;&lt;br&gt;
⋙⋙⋙⋙⋙⋙⋘⋘⋘⋘⋘⋘&lt;br&gt;
&lt;&lt;link ▷「你的家乡？」&gt;&gt;&lt;&lt;goto &quot;初见对话&quot;&gt;&gt;&lt;&lt;set $choice to &quot;你的家乡&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;br&gt;
&lt;&lt;link ▷「哦」&gt;&gt;&lt;&lt;goto &quot;初见对话&quot;&gt;&gt;&lt;&lt;set $choice to &quot;哦&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;
&lt;&lt;elseif $choice == &quot;听他说下去&quot;&gt;&gt;【“金色的大厅，灰色的世界。”琼托着腮帮子，脸蛋被推上去，把一边眼睛挤成了一条可爱的小缝：“我梦见鲜血遍地，神父告诉我，那不过是酒醉兴致多。”呢喃的语调里流转着一重隐约的旋律，他突然正色起来：“所以，不要喝酒。”】&lt;br&gt;&lt;&lt;set $social to $social+ 2&gt;&gt;&lt;font color=#FFAA00&gt;你的社会属性提升了2级&lt;/font&gt;&lt;br&gt;&lt;br&gt;
⋙⋙⋙⋙⋙⋙⋘⋘⋘⋘⋘⋘&lt;br&gt;
&lt;&lt;link ▷「小酌怡情」&gt;&gt;&lt;&lt;goto &quot;初见对话&quot;&gt;&gt;&lt;&lt;set $choice to &quot;小酌怡情&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;br&gt;
&lt;&lt;link ▷「嗯嗯好的」&gt;&gt;&lt;&lt;goto &quot;初见对话&quot;&gt;&gt;&lt;&lt;set $choice to &quot;嗯嗯好的&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;br&gt;
&lt;&lt;link ▷「那你怎么也喝？」&gt;&gt;&lt;&lt;goto &quot;初见对话&quot;&gt;&gt;&lt;&lt;set $choice to &quot;那你怎么也喝&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;
&lt;&lt;elseif $choice == &quot;你的家乡&quot;&gt;&gt;【“嗯，灰色的意大利。”他晃了一下头，低头喝酒】&lt;&lt;set $persuasiveexp +=1&gt;&gt;&lt;&lt;addpexpWidget&gt;&gt;&lt;br&gt;&lt;br&gt;
&lt;&lt;set $jofirstpc = 1&gt;&gt;&lt;&lt;link ▷「继续」 酒馆&gt;&gt;&lt;&lt;set $npc = 0&gt;&gt;&lt;&lt;/link&gt;&gt;
&lt;&lt;elseif $choice == &quot;哦&quot;&gt;&gt;【“当然，现在这样也很好。”他笑了笑，低头喝酒】&lt;br&gt;&lt;br&gt;
&lt;&lt;set $jofirstpc = 1&gt;&gt;&lt;&lt;link ▷「继续」 酒馆&gt;&gt;&lt;&lt;set $npc = 0&gt;&gt;&lt;&lt;/link&gt;&gt;
&lt;&lt;elseif $choice == &quot;小酌怡情&quot;&gt;&gt;【他像小孩子一样撇了一下嘴，抱着杯子换了一个角落】&lt;br&gt;&lt;br&gt;
&lt;&lt;set $jofirstpc = 1&gt;&gt;&lt;&lt;link ▷「继续」 酒馆&gt;&gt;&lt;&lt;set $npc = 0&gt;&gt;&lt;&lt;/link&gt;&gt;
&lt;&lt;elseif $choice == &quot;嗯嗯好的&quot;&gt;&gt;【“不要敷衍我啦。”他对你皱起鼻子，“不要喝酒。”说着端起酒杯喝了一大口】&lt;br&gt;&lt;br&gt;
&lt;&lt;set $jofirstpc = 1&gt;&gt;&lt;&lt;link ▷「继续」 酒馆&gt;&gt;&lt;&lt;set $npc = 0&gt;&gt;&lt;&lt;/link&gt;&gt;
&lt;&lt;elseif $choice == &quot;那你怎么也喝&quot;&gt;&gt;【“是苹果汁。”他笑出了一对小虎牙，抱紧了自己的啤酒杯：“不过不能分给你喝，你要是不开心的话……我送你这个漂亮的贝壳吧。”】&lt;&lt;pickup $item &quot;五彩贝&quot; 1&gt;&gt;&lt;br&gt;
&lt;font color=#4E84BA&gt;✧你获得五彩贝 * 1✧&lt;/font&gt;&lt;br&gt;&lt;br&gt;
&lt;&lt;set $jofirstpc = 1&gt;&gt;&lt;&lt;link ▷「继续」 酒馆&gt;&gt;&lt;&lt;set $npc = 0&gt;&gt;&lt;&lt;/link&gt;&gt;
&lt;&lt;elseif $choice == &quot;接受&quot;&gt;&gt;【“你喜欢？”琼的眼睛亮了一下，你不知道那是不是酒馆灯光带来的错觉，“那送给你！”】&lt;&lt;pickup $item &quot;五彩贝&quot; 1&gt;&gt;&lt;br&gt;
&lt;font color=#4E84BA&gt;✧你获得五彩贝 * 1✧&lt;/font&gt;&lt;br&gt;&lt;br&gt;
&lt;&lt;set $jofirstpc = 1&gt;&gt;&lt;&lt;link ▷「继续」 酒馆&gt;&gt;&lt;&lt;set $npc = 0&gt;&gt;&lt;&lt;/link&gt;&gt;
&lt;&lt;elseif $choice == &quot;拒绝&quot;&gt;&gt;【“……不喜欢吗？”琼耷拉下耳朵，转而举起杯子：“那要尝尝苹果汁吗？”】&lt;br&gt;&lt;br&gt;
&lt;&lt;set $jofirstpc = 1&gt;&gt;&lt;&lt;link ▷「继续」 酒馆&gt;&gt;&lt;&lt;set $npc = 0&gt;&gt;&lt;&lt;/link&gt;&gt;
&lt;&lt;/if&gt;&gt;&lt;&lt;/if&gt;&gt;

&lt;&lt;if $choice == &quot;推开&quot;&gt;&gt;
【你强忍着恶心推开Coni, 他那意外消瘦的身躯踉跄跌倒在地, 几块玉雕从他的大衣里滑出来, 他颤颤巍巍的捡起玉雕, 又凑到你面前. &quot;你帮我做出来布尔盖酒, 我就给你这些. &quot;】&lt;br&gt;&lt;br&gt;
⋙⋙⋙⋙⋙⋙⋘⋘⋘⋘⋘⋘&lt;br&gt;
&lt;&lt;link ▷「接受」&gt;&gt;&lt;&lt;goto &quot;初见对话&quot;&gt;&gt;&lt;&lt;set $choice to &quot;接受&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;br&gt;
&lt;&lt;link ▷「拒绝」&gt;&gt;&lt;&lt;goto &quot;初见对话&quot;&gt;&gt;&lt;&lt;set $choice to &quot;拒绝&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;
&lt;&lt;elseif $choice == &quot;询问布尔盖酒&quot;&gt;&gt;【你强忍着恶心, 问Coni布尔盖酒是什么, 他在听到问题后突然双目失神的放开了你, 你以为酒鬼的醉话已经结束, 却看见他从大衣的内袋中掏出几块玉雕. &quot;你帮我做出来布尔盖酒, 我就给你这些. &quot;他用颤颤巍巍的手爪捧着玉雕, 看起来丝毫不怜惜】&lt;br&gt;&lt;br&gt;
⋙⋙⋙⋙⋙⋙⋘⋘⋘⋘⋘⋘&lt;br&gt;
&lt;&lt;link ▷「接受」&gt;&gt;&lt;&lt;goto &quot;初见对话&quot;&gt;&gt;&lt;&lt;set $choice to &quot;接受&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;br&gt;
&lt;&lt;link ▷「拒绝」&gt;&gt;&lt;&lt;goto &quot;初见对话&quot;&gt;&gt;&lt;&lt;set $choice to &quot;拒绝&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;
&lt;&lt;elseif $choice == &quot;拒绝&quot;&gt;&gt;【即使是金子做的雕像也不能让你替这个流浪汉做事. 你毫不犹豫的拒绝了Coni的索求, 看着他近乎绝望的退回酒馆的角落, 你终于可以回到自己的正事上了】&lt;&lt;set $choice to 0, $conisxd =1, $abs +=1&gt;&gt;&lt;br&gt;&lt;br&gt;&lt;&lt;link ▷「继续」 酒馆&gt;&gt;&lt;&lt;/link&gt;&gt;
&lt;&lt;elseif $choice == &quot;接受&quot;&gt;&gt;【那些玉雕看上去久失保养, 因年代久远而失去了原有的色泽, 但若好好清洗擦拭一番, 必定能卖上好价钱. 心中的天秤略作比较, 你决定接下这个流浪汉的请求. 一杯酒有多难做?】
&lt;&lt;timed 2s t8n&gt;&gt;【Coni听到你的灾中抢救出来的手稿, 上面用潦草的英语在原文旁写着注释. 这是布尔盖酒的配方】&lt;br&gt;
&lt;&lt;pickup $ss &quot;布尔盖酒&quot; 1&gt;&gt;&lt;&lt;pickup $item &quot;布尔盖酒配方&quot; 1&gt;&gt;&lt;&lt;set $choice to 0, $conisxd =2&gt;&gt;&lt;font color=#4E84BA&gt;✧你获得了布尔盖酒配方*1✧&lt;/font&gt;&lt;br&gt;
〖开启任务【制作】布尔盖酒〗&lt;br&gt;
&lt;&lt;/timed&gt;&gt;
&lt;&lt;timed 4s t8n&gt;&gt;【Coni最后给了你一个意味深长的眼神: &quot;布尔盖酒, 越快越好... &quot;】&lt;br&gt;&lt;br&gt;&lt;&lt;link ▷「继续」 酒馆&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;&lt;/timed&gt;&gt;

&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="33" name="副港口" tags="nobr" position="200,300" size="100,100">&lt;&lt;if $loc != &quot;副港口&quot;&gt;&gt;&lt;&lt;set $loc = &quot;副港口&quot;&gt;&gt;&lt;&lt;set $minute to $minute+ random(5,10)&gt;&gt;&lt;&lt;set $HP to $HP- 1&gt;&gt;&lt;&lt;/if&gt;&gt;&lt;img src=&quot;https://f2.toyhou.se/file/f2-toyhou-se/images/87543219_PYG6MbOJqaUdTL1.jpg&quot; width=100% class=&quot;pic&quot;&gt;
//贝雷河的东入海口被建造成了永无乡的副港口, 用于居民出海捕鱼//
&lt;br&gt;当前角色&lt;&lt;NPCloc&gt;&gt;
&lt;br&gt;地点行动&lt;br&gt;
&lt;&lt;if $lostsheep[0] == 1&gt;&gt;[[✧「找羊」|era互动]]&lt;br&gt;&lt;&lt;/if&gt;&gt;
[[◈「出海」|海域]]&lt;br&gt;
[[◈「钓鱼」|钓鱼]]&lt;br&gt;
&lt;br&gt;继续前往&lt;br&gt;
[[✧「鱼铺」|鱼铺]]&lt;br&gt;
[[✧「栈桥」|栈桥]]&lt;br&gt;
&lt;br&gt;其他地点&lt;br&gt;
[[♢「草甸」|草甸]]&lt;br&gt;
[[♢「贝雷河」|贝雷河]]&lt;br&gt;
[[♢「礁岩区」|礁岩区]]&lt;br&gt;</tw-passagedata><tw-passagedata pid="34" name="医院" tags="nobr" position="600,400" size="100,100">&lt;&lt;if $dn == 0&gt;&gt;【咖啡馆的门紧闭着, 门口的牌子写着休息中. 换个时间再来吧】
&lt;&lt;else&gt;&gt;&lt;&lt;if $loc != &quot;医院&quot;&gt;&gt;&lt;&lt;set $loc = &quot;医院&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;//【你穿过医院那条昏暗的走廊和两侧数不尽的虚掩木门的空房间, 最终在尽头找到了这栋建筑里唯一的光源. 佩罗大夫正在吱呀作响的换气扇下的吊床里躺着, 毫不期待你的到来】//&lt;br&gt;
&lt;br&gt;
&lt;&lt;link&quot; ✣「NPC 佩罗大夫」 &quot; &quot;医院&quot;&gt;&gt;&lt;&lt;set $loct = $loc, $npc to &quot;佩罗大夫&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;br&gt;
&lt;br&gt;

&lt;&lt;/if&gt;&gt;
&lt;&lt;link ▷「离开」 小镇&gt;&gt;&lt;&lt;set $npc to 0&gt;&gt;&lt;&lt;/link&gt;&gt;

&lt;&lt;set $mss =&quot;主线第一天结束&quot;&gt;&gt;</tw-passagedata><tw-passagedata pid="35" name="各种" tags="widget nobr" position="600,100" size="100,100">&lt;&lt;widget &quot;line&quot;&gt;&gt;
&lt;div style=&quot;color:#FFAA00; text-align: center;&quot;&gt;--------------------✧✦✧✦✧--------------------&lt;/div&gt; 
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;weatherWidget&quot;&gt;&gt;
&lt;&lt;set $weathers= [&quot;晴天&quot;,&quot;晴天&quot;,&quot;晴天&quot;,&quot;少云&quot;,&quot;晴转多云&quot;,&quot;多云转阴&quot;,&quot;多云&quot;,&quot;阴天&quot;,&quot;有雾&quot;,&quot;雷阵雨&quot;,&quot;小雨&quot;,&quot;小雨&quot;,&quot;小雨&quot;,&quot;中雨&quot;,&quot;暴雨&quot;].random()&gt;&gt;
&lt;&lt;set $winds= [&quot;西南风&quot;,&quot;东风&quot;,&quot;西北风&quot;,&quot;西风&quot;,&quot;东北风&quot;,&quot;东南风&quot;,&quot;南风&quot;,&quot;北风&quot;].random()&gt;&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;textWidget&quot;&gt;&gt;
&lt;&lt;set $text= [&quot;永无乡&quot;,&quot;月亮&quot;,&quot;蠕虫&quot;,&quot;法则&quot;,&quot;沃土&quot;,&quot;猫族&quot;,&quot;巫师&quot;,&quot;龙裔&quot;,&quot;雪&quot;,&quot;骨头&quot;,&quot;律韵&quot;,&quot;东风&quot;,&quot;花店&quot;,&quot;乌柿树&quot;,&quot;天堂的入口&quot;,&quot;拉浮闪石&quot;,&quot;神明&quot;,&quot;柿子酒&quot;,&quot;灵魂&quot;,&quot;没药&quot;,&quot;Seisinofoaga&quot;,&quot;鸢尾花&quot;,&quot;附子花&quot;,&quot;鸟羽&quot;,&quot;羽墨&quot;,&quot;荆棘灰&quot;,&quot;荒野&quot;].random()&gt;&gt;
&lt;&lt;set $textc = setup.items[$text].description&gt;&gt;
&lt;&lt;replace &quot;#text&quot;&gt;&gt;&lt;&lt;= $text&gt;&gt;&lt;&lt;/replace&gt;&gt;&lt;&lt;replace &quot;#textc&quot;&gt;&gt;&lt;&lt;= $textc&gt;&gt;&lt;&lt;/replace&gt;&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;wanderWidget&quot;&gt;&gt;
&lt;&lt;set _s to random(1,27)&gt;&gt;
&lt;&lt;if $wind == &quot;东风&quot; &amp;&amp; _s &lt;= 8 || $san &lt;= 50 &amp;&amp; _s &lt;= 4 || $san &lt;= 20 &amp;&amp; _s &lt;= 12 ||  _s == 1&gt;&gt;&lt;&lt;set $locs = &quot;白雾&quot;, $tlocs = &quot;白雾&quot;&gt;&gt;
&lt;&lt;else&gt;&gt;&lt;&lt;set $locs to [&quot;罗索伦特湖&quot;,&quot;草甸&quot;,&quot;沙地&quot;,&quot;贝雷河&quot;,&quot;小镇&quot;,&quot;礁岩区&quot;,&quot;主港口&quot;,&quot;副港口&quot;,&quot;断桥&quot;,&quot;秋毛岗&quot;,&quot;拓荒者木屋&quot;,&quot;主港口灯塔&quot;,&quot;副港口灯塔&quot;,&quot;深林边缘&quot;,&quot;沼泽&quot;].random()&gt;&gt;
&lt;&lt;set $tlocs to [&quot;咖啡馆&quot;,&quot;酒馆&quot;,&quot;花店&quot;,&quot;医院&quot;,&quot;图书馆&quot;,&quot;泡泡布提&quot;,&quot;教堂&quot;,&quot;工坊&quot;,&quot;杂货铺&quot;,&quot;随便逛逛&quot;].random()&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;scicon&quot;&gt;&gt;&lt;span @class=&quot;&#39;sc-icon sc-&#39; + $args.raw&quot; alt=&quot;&#39; + $args.raw + &#39;&quot;&gt;&lt;/span&gt;&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;rdmstone&quot;&gt;&gt;
&lt;&lt;set _rdmstone to [&quot;沙子&quot;,&quot;沙币&quot;,&quot;沙子&quot;,&quot;沙币&quot;,&quot;贝壳&quot;,&quot;贝壳&quot;,&quot;海螺壳&quot;,&quot;沙币&quot;,&quot;鹅卵石&quot;,&quot;沙金&quot;,&quot;沙子&quot;,&quot;沙币&quot;,&quot;沙子&quot;,&quot;沙币&quot;,&quot;贝壳&quot;,&quot;贝壳&quot;,&quot;海螺壳&quot;,&quot;沙子&quot;,&quot;鹅卵石&quot;].random()&gt;&gt;&lt;&lt;pickup $item _rdmstone 1&gt;&gt;
是一枚_rdmstone！你把它放进了口袋】
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &#39;material&#39;&gt;&gt;
&lt;&lt;if _args.length &lt;= 0&gt;&gt;
&lt;&lt;run throw new Error(&quot;请提供object&quot;)&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;capture _obj&gt;&gt;
  &lt;&lt;set _obj = _args[0]&gt;&gt;
  &lt;&lt;if typeof _obj !== &#39;object&#39; || _obj === null&gt;&gt;
    &lt;&lt;run throw new Error(&quot;请提供一个有效的object，实际的提供的是: &quot;+ typeof obj)&gt;&gt;
  &lt;&lt;/if&gt;&gt;
  &lt;&lt;for _name, _value range  _obj&gt;&gt;
      _name: _value 
  &lt;&lt;/for&gt;&gt;
&lt;&lt;/capture&gt;&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;sxdkind&quot;&gt;&gt;
&lt;&lt;if _sxd &lt;= 0&gt;&gt;并不信任你
&lt;&lt;elseif _sxd &lt;= 5&gt;&gt;对你没什么看法
&lt;&lt;elseif _sxd &lt; 25&gt;&gt;认为你是一个不错的岛民
&lt;&lt;elseif _sxd &lt; 65&gt;&gt;已经将你作为朋友相称
&lt;&lt;elseif _sxd &lt; 90&gt;&gt;对你十分信任
&lt;&lt;else&gt;&gt;会为你而死
&lt;&lt;/if&gt;&gt;&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;sxdnormal&quot;&gt;&gt;
&lt;&lt;if _sxd &lt;= 15&gt;&gt;对你没什么看法
&lt;&lt;elseif _sxd &lt; 45&gt;&gt;认为你是一个不错的岛民
&lt;&lt;elseif _sxd &lt; 85&gt;&gt;对你颇有赞赏
&lt;&lt;else&gt;&gt;会传颂你的故事
&lt;&lt;/if&gt;&gt;&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;sxdgod&quot;&gt;&gt;
&lt;&lt;if _sxd &lt;= -5&gt;&gt;觉得你令人生厌
&lt;&lt;elseif _sxd &lt; 10&gt;&gt;并不信任你
&lt;&lt;elseif _sxd &lt; 30&gt;&gt;对你没什么看法
&lt;&lt;elseif _sxd &lt; 50&gt;&gt;开始承认你的存在
&lt;&lt;elseif _sxd &lt; 75&gt;&gt;认为你有一个不错的灵魂
&lt;&lt;elseif _sxd &lt; 100&gt;&gt;似乎在找机会和你独处
&lt;&lt;else&gt;&gt;想品尝你的灵魂....
&lt;&lt;/if&gt;&gt;&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;dated&quot;&gt;&gt;
&lt;&lt;if $date &lt;= 1&gt;&gt;你刚刚来到永无乡, 抛弃了过去的身份. 
&lt;&lt;else&gt;&gt;你来到永无乡已有$date日, &lt;&lt;/if&gt;&gt;
&lt;&lt;if $fame == 0&gt;&gt;默默无闻是对你最好的形容词. 
&lt;&lt;elseif $fame &lt;= 2&gt;&gt;你的所作所为也许没那么出众, 但已经有了欣赏你的目光.  
&lt;&lt;elseif $fame &lt;= 4&gt;&gt;你的所作所为也许没那么出众, 但已经有了欣赏你的目光.  
&lt;&lt;/if&gt;&gt;&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;npcwaves&quot;&gt;&gt;
@@.loveblur;&lt;div class=&quot;logo is-animetion&quot;&gt;&lt;span&gt;❥ &lt;/span&gt;&lt;&lt;if $npc == &quot;Era&quot;&gt;&gt;&lt;span&gt;E&lt;/span&gt;&lt;span&gt;r&lt;/span&gt;&lt;span&gt;a&lt;/span&gt;&lt;&lt;elseif $npc == &quot;奥里&quot;&gt;&gt;&lt;span&gt;奥&lt;/span&gt;&lt;span&gt;里&lt;/span&gt;&lt;&lt;elseif $npc == &quot;琥珀夫人&quot;&gt;&gt;&lt;span&gt;琥&lt;/span&gt;&lt;span&gt;珀&lt;/span&gt;&lt;span&gt;夫&lt;/span&gt;&lt;span&gt;人&lt;/span&gt;&lt;&lt;elseif $npc == &quot;安德森&quot;&gt;&gt;&lt;span&gt;安&lt;/span&gt;&lt;span&gt;德&lt;/span&gt;&lt;span&gt;森&lt;/span&gt;&lt;&lt;/if&gt;&gt;&lt;span&gt;对&lt;/span&gt;&lt;span&gt;你&lt;/span&gt;&lt;span&gt;的&lt;/span&gt;&lt;span&gt;好&lt;/span&gt;&lt;span&gt;感&lt;/span&gt;&lt;span&gt;增&lt;/span&gt;&lt;span&gt;加&lt;/span&gt;&lt;span&gt;了&lt;/span&gt;
&lt;/div&gt;@@
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;NPCloc&quot;&gt;&gt;
&lt;&lt;if $eraloc == $loc&gt;&gt;&lt;br&gt;&lt;&lt;link &quot;✣「Era」&quot;&gt;&gt;&lt;&lt;set $loct = $loc, $npc to &quot;Era&quot;&gt;&gt;&lt;&lt;run Dialog.setup($npc);
  Dialog.wiki(Story.get(&quot;NPC&quot;).processText());
  Dialog.open();&gt;&gt;&lt;&lt;redo&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;&lt;/if&gt;&gt;

&lt;&lt;if $oriloc == $loc&gt;&gt;&lt;br&gt;&lt;&lt;link &quot;✣「 奥里」&quot;&gt;&gt;&lt;&lt;set $loct = $loc, $npc to &quot;奥里&quot;&gt;&gt;&lt;&lt;run Dialog.setup($npc);
  Dialog.wiki(Story.get(&quot;NPC&quot;).processText());
  Dialog.open();&gt;&gt;&lt;&lt;redo&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;&lt;/if&gt;&gt;

&lt;&lt;if $amberloc == $loc&gt;&gt;&lt;br&gt;&lt;&lt;link &quot;✣「琥珀夫人」&quot;&gt;&gt;&lt;&lt;set $loct = $loc, $npc to &quot;琥珀夫人&quot;&gt;&gt;&lt;&lt;run Dialog.setup($npc);
  Dialog.wiki(Story.get(&quot;NPC&quot;).processText());
  Dialog.open();&gt;&gt;&lt;&lt;redo&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;&lt;/if&gt;&gt;

&lt;&lt;if $spafirstc == 1 &amp;&amp; $spaloc == $loc&gt;&gt;&lt;br&gt;&lt;&lt;link &quot;✣「 萨巴夫人」&quot;&gt;&gt;&lt;&lt;set $loct = $loc, $npc to &quot;萨巴夫人&quot;&gt;&gt;&lt;&lt;run Dialog.setup($npc);
  Dialog.wiki(Story.get(&quot;NPC&quot;).processText());
  Dialog.open();&gt;&gt;&lt;&lt;redo&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;&lt;/if&gt;&gt;

&lt;&lt;if $jofirstc == 1 &amp;&amp; $joloc == $loc&gt;&gt;&lt;br&gt;✣&lt;&lt;link &quot;✣「琼」&quot;&gt;&gt;&lt;&lt;set $loct = $loc, $npc to &quot;琼&quot;&gt;&gt;&lt;&lt;run Dialog.setup($npc);
  Dialog.wiki(Story.get(&quot;NPC&quot;).processText());
  Dialog.open();&gt;&gt;&lt;&lt;redo&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;&lt;/if&gt;&gt;

&lt;&lt;if $tretloc == $loc&gt;&gt;&lt;br&gt;✣&lt;&lt;link &quot;✣「Tret」&quot;&gt;&gt;&lt;&lt;set $loct = $loc, $npc to &quot;Tret&quot;&gt;&gt;&lt;&lt;run Dialog.setup($npc);
  Dialog.wiki(Story.get(&quot;NPC&quot;).processText());
  Dialog.open();&gt;&gt;&lt;&lt;redo&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;&lt;/if&gt;&gt;

&lt;&lt;if $nmfirstc == 1 &amp;&amp; $nmloc == $loc&gt;&gt;&lt;br&gt;&lt;&lt;link &quot;✣「 安德森」&quot;&gt;&gt;&lt;&lt;set $loct = $loc, $npc to &quot;安德森&quot;&gt;&gt;&lt;&lt;run Dialog.setup($npc);
  Dialog.wiki(Story.get(&quot;NPC&quot;).processText());
  Dialog.open();&gt;&gt;&lt;&lt;redo&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;&lt;/if&gt;&gt;

&lt;&lt;if $maryloc == $loc&gt;&gt;&lt;br&gt;&lt;&lt;link &quot;✣「 玛丽亚小姐」&quot;&gt;&gt;&lt;&lt;set $loct = $loc, $npc to &quot;玛丽亚小姐&quot;&gt;&gt;&lt;&lt;run Dialog.setup($npc);
  Dialog.wiki(Story.get(&quot;NPC&quot;).processText());
  Dialog.open();&gt;&gt;&lt;&lt;redo&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;&lt;/if&gt;&gt;
&lt;br&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;sociald&quot;&gt;&gt;
&lt;&lt;if $social &lt;= 5&gt;&gt;居民将你看作无关紧要的陌生人. 
&lt;&lt;elseif $social &lt;= 15&gt;&gt;居民似乎在近日的相处中对你略有印象
&lt;&lt;elseif $social &lt;= 25&gt;&gt;多数居民已经记住了你的名字, 遇见你时会主动的向你问好
&lt;&lt;elseif $social &lt;= 35&gt;&gt;多数居民已经记住了你的名字, 遇见你时会主动的向你问好
&lt;&lt;/if&gt;&gt;&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;prey&quot;&gt;&gt;
&lt;&lt;set $minute to $minute+ random(3,10)&gt;&gt;&lt;&lt;set _s to random(1,63)&gt;&gt;
&lt;&lt;if $loc == &quot;草甸&quot;&gt;&gt;
&lt;&lt;if _s &lt;= 14&gt;&gt;【一只灰兔出现在你的视野里, 你举起手里的枪】&lt;&lt;set $tmpprey to &quot;灰兔&quot;&gt;&gt;
&lt;&lt;elseif _s &lt;= 30&gt;&gt;【一只田鼠出现在你的视野里, 你举起手里的枪】&lt;&lt;set $tmpprey to &quot;田鼠&quot;&gt;&gt;
&lt;&lt;elseif _s &lt;= 35&gt;&gt;【一只黄鼬出现在你的视野里, 你举起手里的枪】&lt;&lt;set $tmpprey to &quot;黄鼬&quot;&gt;&gt;
&lt;&lt;elseif _s &lt;= 37&gt;&gt;【一只罕见的白鼬出现在你的视野里, 你犹豫片刻, 举起了手里的枪】&lt;&lt;set $tmpprey to &quot;白鼬&quot;&gt;&gt;
&lt;&lt;elseif _s &lt;= 43&gt;&gt;【一群野马出现在你的视野里, 你辨认出这是居住在岛屿的马群, 岛主明令禁止狩猎】&lt;br&gt;⋙⋙⋙⋙⋙⋙⋘⋘⋘⋘⋘⋘&lt;br&gt;▷「打猎野马」&lt;br&gt;▷「离开」
&lt;&lt;set $tmpprey to &quot;野马&quot;&gt;&gt;
&lt;&lt;elseif _s &lt;= 53&gt;&gt;【一只红狐出现在你的视野里, 看来这里不止有你一个猎手. 你举起手里的枪, 对准了红狐】&lt;&lt;set $tmpprey to &quot;红狐&quot;&gt;&gt;
&lt;&lt;else&gt;&gt;【一群狍子出现在你的视野里, 他们似乎毫无察觉猎手的存在. 你举起手里的枪】&lt;&lt;set $tmpprey to &quot;狍子&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;
&lt;&lt;elseif $loc == &quot;秋毛岗&quot;&gt;&gt;
&lt;&lt;if _s &lt;= 16&gt;&gt;【一只灰兔出现在你的视野里, 你举起手里的枪】&lt;&lt;set $tmpprey to &quot;灰兔&quot;&gt;&gt;
&lt;&lt;elseif _s &lt;= 23&gt;&gt;【一只田鼠出现在你的视野里, 你举起手里的枪】&lt;&lt;set $tmpprey to &quot;田鼠&quot;&gt;&gt;
&lt;&lt;elseif _s &lt;= 34&gt;&gt;【一只黄鼬出现在你的视野里, 你举起手里的枪】&lt;&lt;set $tmpprey to &quot;黄鼬&quot;&gt;&gt;
&lt;&lt;elseif _s &lt;= 36&gt;&gt;【一只罕见的白鼬出现在你的视野里, 你犹豫片刻, 举起了手里的枪】&lt;&lt;set $tmpprey to &quot;白鼬&quot;&gt;&gt;
&lt;&lt;elseif _s &lt;= 39&gt;&gt;【一只松貂出现在你的视野里, 黑夜里很难看清它在树枝间的身影. 你举起手里的枪, 静静等待着】&lt;&lt;set $tmpprey to &quot;松貂&quot;&gt;&gt;
&lt;&lt;elseif _s &lt;= 47&gt;&gt;【一只松鸡出现在你的视野里, 你举起手里的枪】&lt;&lt;set $tmpprey to &quot;松鸡&quot;&gt;&gt;
&lt;&lt;elseif _s &lt;= 50&gt;&gt;【一群马鹿出现在你的视野里, 如果你要狩猎这种体型的动物, 光有耐心和技术是远远不够的】&lt;&lt;set $tmpprey to &quot;马鹿&quot;&gt;&gt;
&lt;&lt;elseif _s &lt;= 53&gt;&gt;【一只红狐出现在你的视野里, 看来这里不止有你一个猎手. 你举起手里的枪, 对准了红狐】&lt;&lt;set $tmpprey to &quot;红狐&quot;&gt;&gt;
&lt;&lt;else&gt;&gt;【一群狍子出现在你的视野里, 他们似乎毫无察觉猎手的存在. 你举起手里的枪】&lt;&lt;set $tmpprey to &quot;狍子&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;
&lt;&lt;elseif $loc == &quot;贝雷河&quot; || $loc == &quot;罗索伦特湖&quot;&gt;&gt;
&lt;&lt;if _s &lt;= 14&gt;&gt;【一只灰兔出现在你的视野里, 你举起手里的枪】&lt;&lt;set $tmpprey to &quot;灰兔&quot;&gt;&gt;
&lt;&lt;elseif _s &lt;= 21&gt;&gt;【一只田鼠出现在你的视野里, 你举起手里的枪】&lt;&lt;set $tmpprey to &quot;田鼠&quot;&gt;&gt;
&lt;&lt;elseif _s &lt;= 32&gt;&gt;【一群野鸭出现在你的视野里, 你举起手里的枪】&lt;&lt;set $tmpprey to &quot;野鸭&quot;&gt;&gt;
&lt;&lt;elseif _s &lt;= 43&gt;&gt;【一只鹌鹑出现在你的视野里, 你举起手里的枪】&lt;&lt;set $tmpprey to &quot;鹌鹑&quot;&gt;&gt;
&lt;&lt;elseif _s &lt;= 47&gt;&gt;【一只松貂出现在你的视野里, 黑夜里很难看清它在树枝间的身影. 你举起手里的枪, 静静等待着】&lt;&lt;set $tmpprey to &quot;松貂&quot;&gt;&gt;
&lt;&lt;elseif _s &lt;= 56&gt;&gt;【一只松鸡出现在你的视野里, 你举起手里的枪】&lt;&lt;set $tmpprey to &quot;松鸡&quot;&gt;&gt;
&lt;&lt;else&gt;&gt;【一只水獭出现在你的视野里, 你犹豫片刻, 举起了手里的枪】&lt;&lt;set $tmpprey to &quot;水獭&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;
&lt;&lt;elseif $loc == &quot;高地&quot;&gt;&gt;
&lt;&lt;if _s &lt;= 18&gt;&gt;【一只灰兔出现在你的视野里, 你举起手里的枪】&lt;&lt;set $tmpprey to &quot;灰兔&quot;&gt;&gt;
&lt;&lt;elseif _s &lt;= 23&gt;&gt;【一只田鼠出现在你的视野里, 你举起手里的枪】&lt;&lt;set $tmpprey to &quot;田鼠&quot;&gt;&gt;
&lt;&lt;elseif _s &lt;= 34&gt;&gt;【一只黄鼬出现在你的视野里, 你举起手里的枪】&lt;&lt;set $tmpprey to &quot;黄鼬&quot;&gt;&gt;
&lt;&lt;elseif _s &lt;= 36&gt;&gt;【一只罕见的白鼬出现在你的视野里, 你犹豫片刻, 举起了手里的枪】&lt;&lt;set $tmpprey to &quot;白鼬&quot;&gt;&gt;
&lt;&lt;elseif _s &lt;= 40&gt;&gt;【一群雷鸟出现在你的视野里, 你举起手里的枪】&lt;&lt;set $tmpprey to &quot;雷鸟&quot;&gt;&gt;
&lt;&lt;elseif _s &lt;= 47&gt;&gt;【一只松鸡出现在你的视野里, 你举起手里的枪】&lt;&lt;set $tmpprey to &quot;松鸡&quot;&gt;&gt;
&lt;&lt;elseif _s &lt;= 50&gt;&gt;【一群山羊出现在你的视野里, 如果你要狩猎这种体型的动物, 光有耐心和技术是远远不够的】&lt;&lt;set $tmpprey to &quot;山羊&quot;&gt;&gt;
&lt;&lt;elseif _s &lt;= 53&gt;&gt;【一只红狐出现在你的视野里, 看来这里不止有你一个猎手. 你举起手里的枪, 对准了红狐】&lt;&lt;set $tmpprey to &quot;红狐&quot;&gt;&gt;
&lt;&lt;else&gt;&gt;【一群狍子出现在你的视野里, 他们似乎毫无察觉猎手的存在. 你举起手里的枪】&lt;&lt;set $tmpprey to &quot;狍子&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;

&lt;&lt;/if&gt;&gt;&lt;&lt;/widget&gt;&gt;</tw-passagedata><tw-passagedata pid="36" name="咖啡馆" tags="nobr" position="400,400" size="100,100">&lt;b&gt;咖啡馆&lt;/b&gt;&lt;br&gt;
【营业时间 06: 00~20: 00】&lt;br&gt;
&lt;&lt;if $dn == 0&gt;&gt;【咖啡馆的门紧闭着, 门口的牌子写着休息中. 换个时间再来吧】&lt;br&gt;

&lt;&lt;link ▷「离开」 小镇&gt;&gt;&lt;&lt;set $npc to 0&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;&lt;else&gt;&gt;&lt;&lt;if $loc != &quot;咖啡馆&quot;&gt;&gt;&lt;&lt;set $loc = &quot;咖啡馆&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;&lt;&lt;if $ssd.has(&#39;【已完成】点心代送&#39;) || $dxdsstat &gt;= 1 || $date &lt;= 2&gt;&gt;//你踏进这家精致的小店, 咖啡的醇香扑面而来，店内的灯光明亮而温暖. &quot;欢迎光临! &quot; 老板娘小小的身影在柜台后忙碌着，但还是不忘热情地欢迎进店的客人//&lt;br&gt;

&lt;br&gt;地点活动&lt;br&gt;
&lt;&lt;link ❖「查看菜单」&gt;&gt;&lt;&lt;run
  Dialog.setup(&quot;咖啡馆商品&quot;);
  Dialog.wiki(Story.get(&quot;兑换&quot;).processText());
  Dialog.open();
&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;br&gt;
[[❖「打工」|打工]]  (⏳01: 00 )
&lt;br&gt;
&lt;br&gt;离开&lt;br&gt;
&lt;&lt;link ▷「回到小镇」 小镇&gt;&gt;&lt;&lt;/link&gt;&gt;
&lt;&lt;elseif $dxdsstat == 0 &amp;&amp; $ss.has(&#39;点心代送&#39;)&gt;&gt;【&quot;你回来了! &quot;老板娘朝你招招手, &quot;再次感谢你, 一定很辛苦. 给, 这是一点犒劳. &quot;她递给你一个朗姆葡萄酥卷, 甜甜的笑起来: &quot;还有这里的一整盒! &quot;】&lt;&lt;pickup $ssd &quot;【已完成】点心代送&quot; 1&gt;&gt;&lt;&lt;drop $ss &quot;【派送】点心代送&quot; 1&gt;&gt;
&lt;&lt;pickup $food &quot;朗姆葡萄酥卷&quot; 1 &quot;黑巧小蛋糕&quot; 2 &quot;朗姆冰淇淋&quot; 2&gt;&gt;【你获得朗姆葡萄酥卷*1，黑巧小蛋糕*4，朗姆冰淇淋*2】

&lt;&lt;link ▷「继续」 咖啡馆&gt;&gt;&lt;&lt;/link&gt;&gt;
&lt;&lt;elseif $date &gt;= 2&gt;&gt;【老板娘小小的身影在后厨后忙碌着，几乎顾不上帮你点餐. 你站在店内有些踌躇的等待着, 直到她终于拎着四盒点心回到了柜台. &quot;欢迎光临, 你想来点什么? &quot;】

⋙⋙⋙⋙⋙⋙⋘⋘⋘⋘⋘⋘
&lt;&lt;link ▷「这是什么」 支线选项&gt;&gt;&lt;&lt;set $choice to &quot;四盒点心&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;
&lt;&lt;link ▷「有什么推荐」 支线选项&gt;&gt;&lt;&lt;set $choice to &quot;有什么推荐&quot;, $abs +=1&gt;&gt;&lt;&lt;/link&gt;&gt;(这个选项会直接结束事件)&lt;&lt;/if&gt;&gt;

&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="37" name="噩梦" tags="" position="1200,300" size="100,100">&lt;&lt;set $HP to $HP+ 38&gt;&gt;&lt;&lt;set $san to $san- 3&gt;&gt;【你从睡眠中醒来. 刚刚梦境的内容开始在你脑海中浮现. 曾经的那些恐惧与痛苦通过梦境再度重现, 过去的回忆似乎并没有打算放过你. 你试着忘掉这场不愉快的梦】

&lt;&lt;link ▷「继续」&gt;&gt;&lt;&lt;goto &quot;家&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;</tw-passagedata><tw-passagedata pid="38" name="图书馆" tags="" position="500,400" size="100,100">&lt;&lt;if $dn == 0&gt;&gt;【图书馆里的门上挂着关门的牌子, 尽管里面还在不断闪烁着温暖的烛光, 你决定还是不要在这时候打扰, 等到白天再来吧】&lt;&lt;else&gt;&gt;&lt;&lt;if $loc != &quot;图书馆&quot;&gt;&gt;&lt;&lt;set $loc = &quot;图书馆&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;【图书馆木制的书架上堆满了陈旧的书籍, 空气中弥漫着墨水和灰尘的气味, 角落里, 一个矮胖的中年猫坐在书桌旁, 四周堆满了未完成的手稿和甜点, 他在你推门而入时抬起毛绒绒的脑袋看了你一眼, 很快又埋头继续写着他手里的文章. &quot;欢迎来到镇图书馆, 我的朋友, 不过我现在很忙, 请随意翻阅吧&quot;】


✣&lt;&lt;link&quot; 「NPC Otis」 &quot; &quot;图书馆&quot;&gt;&gt;&lt;&lt;set $loct = $loc, $npc to &quot;Otis&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;

✧[[「翻阅书架」|地点活动]]&lt;&lt;/if&gt;&gt;


▷&lt;&lt;link 「离开」 小镇&gt;&gt;&lt;&lt;set $npc to 0&gt;&gt;&lt;&lt;/link&gt;&gt;</tw-passagedata><tw-passagedata pid="39" name="地点活动" tags="nobr" position="1100,100" size="100,100">&lt;br&gt;
&lt;&lt;if $loc == &quot;花田&quot;&gt;&gt;&lt;&lt;set $HP -= 4&gt;&gt;&lt;&lt;set _rpe = [&quot;【你沿着花田里不明显的小径慢步走着, 尽量确保每一块田地都受到了浇灌. 等你走完最后一片花田时, 水壶里的酸性水恰好用完】&quot;,&quot;【你埋身繁密的花丛中, 努力辨识着不该存在的杂草, 那些顽固而毫无用处的植物被你一株株连根拔起】&quot;].random()&gt;&gt;_rpe &lt;br&gt;&lt;br&gt;
&lt;&lt;if $choice == &quot;浇花&quot;&gt;&gt;&lt;&lt;set $gzcs to $gzcs- 1&gt;&gt;&lt;&lt;link ▷「回到木屋」 拓荒者木屋&gt;&gt;&lt;&lt;/link&gt;&gt;
&lt;&lt;else&gt;&gt;&lt;&lt;link ▷「返回」 花田&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;&lt;/if&gt;&gt;

&lt;&lt;elseif $loc == &quot;泡泡布提&quot;&gt;&gt;没写&lt;br&gt;&lt;br&gt;&lt;&lt;link ▷「返回」 泡泡布提&gt;&gt;&lt;&lt;/link&gt;&gt;

&lt;&lt;elseif $loc == &quot;沙地&quot;&gt;&gt;【你用
&lt;&lt;set _rpe1 = [&quot;红色的&quot;,&quot;黑色的&quot;,&quot;金色的&quot;,&quot;橙色的&quot;,&quot;靛蓝色的&quot;,&quot;红黄相间的&quot;,&quot;红黑相间的&quot;,&quot;黄白相间的&quot;,&quot;五颜六色的&quot;].random()&gt;&gt;_rpe1
沙子堆了一个
&lt;&lt;set _rpe2 =[&quot;古典城堡&quot;,&quot;林间小屋&quot;,&quot;金字塔&quot;,&quot;大教堂&quot;,&quot;永无乡&quot;,&quot;地上古墓&quot;,&quot;魔法城堡&quot;,&quot;地下城&quot;,&quot;豪华别墅&quot;].random()&gt;&gt;_rpe2
&lt;&lt;set _s to random(1,20)&gt;&gt;
! 你做得
&lt;&lt;if _s &lt;=3&gt;&gt;
很好, 你的作品是整个沙地最亮眼的!】
&lt;&lt;elseif _s &lt;=12&gt;&gt;
还不错, 你很满意你的作品】
&lt;&lt;else&gt;&gt;
不太好, 但这仍很有趣】&lt;&lt;/if&gt;&gt;

&lt;&lt;elseif $loc == &quot;鱼铺&quot;&gt;&gt;【Tret收下押金, 带你到渔船停靠的岸边, 有$boat条木船停泊在此, Tret把其中一只推进海浪里. &quot;今天之内, 她都是你的了,&quot; 他浓厚的口音让你差点没听清接下来的话, &quot;六点之前回来, 夜里的海上不安全. &quot;】&lt;br&gt;&lt;br&gt;
&lt;&lt;set $bboat = 1, $boat -=1, $feather -=50&gt;&gt;&lt;&lt;redo&gt;&gt;
&lt;&lt;link ▷「返回」 副港口&gt;&gt;&lt;&lt;set $npc = 0&gt;&gt;&lt;&lt;/link&gt;&gt;

&lt;&lt;elseif $loc == &quot;副港口&quot;&gt;&gt;【你远远的就看到Tret已经把你的押金放到了鱼铺的橱窗上, 直到你离开, 渔夫还在昏暗的屋子里干着活】&lt;br&gt;&lt;br&gt;
&lt;&lt;set $bboat = 0, $boat +=1, $feather +=50&gt;&gt;&lt;&lt;redo&gt;&gt;
&lt;&lt;link ▷「返回」 副港口&gt;&gt;&lt;&lt;/link&gt;&gt;

&lt;&lt;elseif $loc == &quot;天上人间&quot;&gt;&gt;【你远远的就看到Tret已经把你的押金放到了鱼铺的橱窗上, 直到你离开, 渔夫还在昏暗的屋子里干着活】&lt;br&gt;&lt;br&gt;
&lt;&lt;set $bboat = 0, $boat +=1, $feather +=50&gt;&gt;&lt;&lt;redo&gt;&gt;
&lt;&lt;link ▷「返回」 副港口&gt;&gt;&lt;&lt;/link&gt;&gt;

&lt;&lt;elseif $loc == &quot;图书馆&quot;&gt;&gt;&lt;&lt;set $minute += random(3,15)&gt;&gt;【不大的图书馆为了存放书籍, 几乎没留出多少转身的空间, 你在层层叠叠的书架间寻找着感兴趣的内容】&lt;br&gt;&lt;br&gt;&lt;&lt;set _s to random(1,100)&gt;&gt;
&lt;&lt;if _s &lt;=12&gt;&gt;&lt;&lt;set $choice = [&quot;布尔芬奇故事集&quot;,&quot;缠结之森的故事&quot;,&quot;变形记&quot;,&quot;奥德赛&quot;,&quot;伊利亚特&quot;,&quot;尼伯龙根之歌&quot;,&quot;诗体埃达&quot;,&quot;吉尔伽美什史诗&quot;,&quot;卢加尔班达史诗&quot;].random()&gt;&gt;
&lt;&lt;elseif _s &lt;=17&gt;&gt;&lt;&lt;set $choice = [&quot;霍诺里乌斯的宣誓&quot;,&quot;智者的正道&quot;,&quot;赫耳墨斯文集&quot;,&quot;所罗门之钥&quot;,&quot;自然的至高奥秘&quot;,&quot;恶魔伪君主制&quot;,&quot;大阿尔伯特&quot;,&quot;小阿尔伯特&quot;,&quot;黑母鸡&quot;,&quot;真魔法书&quot;,&quot;红色巨龙&quot;].random()&gt;&gt;
&lt;&lt;elseif _s &lt;=25&gt;&gt;&lt;&lt;set $choice = [&quot;历史绪论&quot;,&quot;来自金色草地&quot;].random()&gt;&gt;
&lt;&lt;elseif _s &lt;=80&gt;&gt;&lt;&lt;set $choice = [&quot;英国民间故事&quot;,&quot;德国民间故事&quot;,&quot;波兰民间故事&quot;,&quot;匈牙利民间故事&quot;,&quot;浮士德博士的生死悲剧史&quot;,&quot;十日谈&quot;,&quot;爱丽丝梦游仙境&quot;,&quot;一千零一夜&quot;].random()&gt;&gt;
&lt;&lt;elseif _s &lt;=98&gt;&gt;&lt;&lt;set $choice = [&quot;兰巴丹的女士们&quot;,&quot;罗兰之歌&quot;,&quot;贝奥武甫&quot;,&quot;牧歌&quot;,&quot;农事诗&quot;,&quot;埃涅阿斯纪&quot;].random()&gt;&gt;
&lt;&lt;else&gt;&gt;特殊&lt;&lt;/if&gt;&gt;&lt;&lt;pickup $book $choice 1&gt;&gt;
&lt;&lt;timed 3s t8n&gt;&gt;你找到了一本《$choice》&lt;br&gt;&lt;br&gt;
❖&lt;&lt;link 阅读&gt;&gt;&lt;&lt;set $page =1, $pageS=&quot;on&quot;&gt;&gt;&lt;&lt;run Dialog.setup($choice);Dialog.wiki(Story.get(&quot;阅读&quot;).processText());Dialog.open();&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;br&gt;
❖借书&lt;br&gt;
▷&lt;&lt;link 「返回」 图书馆&gt;&gt;&lt;&lt;drop $book $choice 1&gt;&gt;&lt;&lt;set $choice =0&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;&lt;/timed&gt;&gt;

&lt;&lt;elseif $loc == &quot;酒馆&quot;&gt;&gt;&lt;&lt;set _s to random(1,20)&gt;&gt;
&lt;&lt;if $choice == &quot;唱歌&quot; &amp;&amp; _s &lt;20&gt;&gt;
&lt;&lt;set _rpl= [&quot;【你清唱了一首你最熟悉的歌。大家似乎对此不太感兴趣，仍然是各聊各的，只不过声音压低了些。但表演结束时，几乎每个人都跟着琥珀夫人鼓起了掌】&quot;,&quot;【你抱着弦琴唱了一首民谣，尽管你的声音算不上天籁，但平和的旋律与质朴的歌词不同程度地触动了在场的酒客。这次的表演是以独唱开始，以合唱结束。曲毕的时候，几乎每个人都在鼓掌，几乎每个人都在向你致意】&quot;,&quot;【你歌颂了也许未获得的，也许已拥有的，也许错过了的爱。一开始进行得很顺利，你感情饱满，观众也乐意听下去。但到快结尾的副歌部分时，有些喝高了的猫开始扯着嗓子和你一起唱，导致你差点找不到正确的调子。不过，表演还算是比较圆满地结束了，看起来大家并不在意那鬼哭狼嚎般的小插曲，姑且把这当作是赞扬吧】&quot;,&quot;【你的歌曲中充满了希望，自由，痛苦和爱等理想事物。这次的表演看起来并没有激起什么反响，甚至在结束时没有任何猫为之鼓掌。你回到座位，正琢磨着是哪个环节出现问题时，突然发现整个酒馆明显地安静了许多，就连一向健谈的琥珀夫人也是沉默的】&quot;,&quot;【你唱了首歌，反响平平】&quot;,&quot;【你唱了首对技巧要求极高的歌，虽然大家都惊讶于你的唱法，但最后反响平平】&quot;].random()&gt;&gt;_rpl
&lt;&lt;elseif $choice == &quot;唱歌&quot;&gt;&gt;【不知为何，你还是怯场了。喉头上下滚动，可你就是一句话都说不出来。有几个人在喝倒彩。你窘迫极了，灰溜溜地跑下舞台，找了个角落里的位置缩在里面】&lt;br&gt;
&lt;&lt;timed 2s t8n&gt;&gt;【“你这是怎么了？”琥珀夫人挨着你坐下来。由于微妙的灯光，你还是看不见她的眼睛。“我能理解，在众目睽睽之下就算只是说句话也不是什么容易的事，何况还是表演呢。再说了，那些喝倒彩的东西并不完全是因为你表现差才这么做的，这些没教养的家伙为了给自己找些乐子可以对最优秀的表演者丢臭鸡蛋。我敢打赌，到了第二天他们根本不会记得今晚他们对谁喝了倒彩！好啦，别把这样的人放在心上，我相信你下次一定没问题的。喏，这杯麦芽汁算我请的，敬爱与音乐！”】&lt;br&gt;&lt;&lt;/timed&gt;&gt;
&lt;&lt;timed 5s t8n&gt;&gt;【“我要回吧台去啦，这么大个酒馆没人去管理可不行。有什么事的话就来吧台找我吧！别太消沉了，听到没有？”】&lt;br&gt;&lt;&lt;pickup $food &quot;麦芽酒&quot; 1&gt;&gt;&lt;font color=#4E84BA&gt;✧你获得麦芽酒 * 1✧&lt;/font&gt;&lt;&lt;/timed&gt;&gt;
&lt;&lt;elseif $choice == &quot;演奏&quot; &amp;&amp; _s &lt;20&gt;&gt;
&lt;&lt;set _rpl= [&quot;【你弹了一支钢琴曲。曲毕，你从琥珀夫人那里接过赞美和一小碟点心坐回座位。正在她重新打开留声机的当儿，有个客人私下向你抗议起来：“这里是酒馆，不是什么高级餐厅！下次你得搞点带劲儿的东西给我们听听，那才像话呢！好好考虑我的建议，伙计！”】&quot;,&quot;【你拉起了手风琴，沉浸在轻快的节奏，回旋式的韵律和乐器独特的音色里。曲毕，琥珀夫人带头鼓起了掌，尽管有些人对你自我陶醉式的演奏并不怎么上心，而你确实错弹了几个音】&quot;,&quot;【你把挂在墙上的弦琴拿了下来。你完全认不出它到底是个什么乐器，这家伙一共有十二根弦，整个琴身看上去就像是连着脊柱的胸腔。你试着拨了个和弦，最后选择弹首你最有把握但是又谁都知道的老歌】&quot;,&quot;【遗憾的是，你实在是没法从酒馆里这几件看起来有些陈旧的乐器里挑出一个比较称手的出来。比起真正能够演奏的乐器，它们看起来更像是琥珀夫人从哪个古董店里淘来的收藏品——尤其是那把极富“异域风情”的弦琴。你面露难色，看看观众，又看看琥珀夫人，然后默默地走了回去。还好，下面的客人很快就把这名只是走了走台的怪人抛到脑后，就像是什么都没发生过一样】&quot;,&quot;【你表演了一首钢琴曲，反响平平】&quot;,&quot;【你表演了一首手风琴曲，反响平平】&quot;].random()&gt;&gt;_rpl
&lt;&lt;elseif $choice == &quot;演奏&quot;&gt;&gt;【不知为何，你还是怯场了。你手指突然变得不那么利索了，僵硬得连根弦都拨不动，但大家可都在看着你呢！在三件乐器前面转了几圈后，你试探性地按下一个琴键——在可怕的寂静中，这声音甚至显得有些震耳欲聋。你窘迫极了，灰溜溜地在不怀好意的笑声中跑下舞台，找了个角落里的位置缩在里面】&lt;br&gt;
&lt;&lt;timed 2s t8n&gt;&gt;【“你这是怎么了？”琥珀夫人挨着你坐下来。由于微妙的灯光，你还是看不见她的眼睛。“我能理解，在众目睽睽之下就算只是说句话也不是什么容易的事，何况还是表演呢。再说了，那些喝倒彩的东西并不完全是因为你表现差才这么做的，这些没教养的家伙为了给自己找些乐子可以对最优秀的表演者丢臭鸡蛋。我敢打赌，到了第二天他们根本不会记得今晚他们对谁喝了倒彩！好啦，别把这样的人放在心上，我相信你下次一定没问题的。喏，这杯麦芽汁算我请的，敬爱与音乐！”】&lt;br&gt;&lt;&lt;/timed&gt;&gt;
&lt;&lt;timed 5s t8n&gt;&gt;【“我要回吧台去啦，这么大个酒馆没人去管理可不行。有什么事的话就来吧台找我吧！别太消沉了，听到没有？”】&lt;br&gt;&lt;&lt;pickup $food &quot;麦芽酒&quot; 1&gt;&gt;&lt;font color=#4E84BA&gt;✧你获得麦芽酒 * 1✧&lt;/font&gt;&lt;&lt;/timed&gt;&gt;
&lt;&lt;else&gt;&gt;
【“噢，看样子你要和我的留声机抢饭碗啦？不，没关系的，舞台在那边，如果你没有带乐器的话可以用我们酒馆里的，希望你不会嫌弃——别怯场！我很期待你的表演哦！” 琥珀夫人关掉留声机，目送你站上了舞台。酒馆内的嘈杂声渐渐停止了，你在众目睽睽之下拿起了麦克】&lt;br&gt;【你吞了吞口水，努力镇定下来。要表演些什么？】&lt;br&gt;&lt;br&gt;
 ⋙⋙⋙⋙⋙⋙⋘⋘⋘⋘⋘⋘&lt;br&gt;
&lt;&lt;link ▷「唱歌」 地点活动&gt;&gt;&lt;&lt;set $choice to &quot;唱歌&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;br&gt;
&lt;&lt;link ▷「演奏」 地点活动&gt;&gt;&lt;&lt;set $choice to &quot;演奏&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;br&gt;&lt;br&gt;&lt;&lt;link ▷「离开」 酒馆&gt;&gt;&lt;&lt;set $choice to 0&gt;&gt;&lt;&lt;/link&gt;&gt;

&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="40" name="坐船" tags="nobr" position="1000,400" size="100,100">&lt;&lt;if $choice == &quot;回到湖边&quot;&gt;&gt;
【你拉起船桨, 往来时的方向划去, 湖边小屋显眼的红色很快就出现在你的视野里】&lt;br&gt; &lt;br&gt; &lt;&lt;set $choice to 0&gt;&gt;
[[♢「上岸」|罗索伦特湖]]
&lt;&lt;elseif $HP lt 12&gt;&gt;【你感到些许疲惫, 做事情力不从心. 你最好去吃点东西休息一下, 充足的睡眠没有坏处】&lt;br&gt;&lt;br&gt;
&lt;&lt;link ▷「返回」 $loc&gt;&gt;&lt;&lt;/link&gt;&gt;
&lt;&lt;elseif $weather == &quot;有雾&quot; || $weather == &quot;暴雨&quot;&gt;&gt;【今天的天气不适宜在湖上坐船】&lt;br&gt;&lt;br&gt;
&lt;&lt;link ▷「返回」 $loc&gt;&gt;&lt;&lt;/link&gt;&gt;
&lt;&lt;else&gt;&gt;
&lt;&lt;set $HP to $HP- 12&gt;&gt;【你将湖边小屋门前轻巧的小木舟推下水, 开始向湖心划去】&lt;br&gt;&lt;br&gt;&lt;&lt;set _s to random(1,100)&gt;&gt;&lt;&lt;set _t to random(1,100)&gt;&gt;
【你来到了湖中央, 接下来要做点什么?】&lt;br&gt; &lt;br&gt; 
[[✧「钓鱼」|钓鱼]]&lt;br&gt;
[[✧「潜水」|潜水]]&lt;br&gt;  
&lt;&lt;if $erablues ==1&gt;&gt;&lt;&lt;link ♢「寻找蓝宝石」 潜水&gt;&gt;&lt;&lt;set $choice to &quot;寻找蓝宝石&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;&lt;/if&gt;&gt;
&lt;&lt;link ♢「回到湖边」 坐船&gt;&gt;&lt;&lt;set $choice to &quot;回到湖边&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="41" name="壁炉" tags="nobr" position="1200,500" size="100,100">&lt;&lt;if $fpfirst !=1&gt;&gt;
【你坐到了你的火炉前, 看上去不久前刚有人在这里生过火, 留下了一些打火石和燃烧未尽的木柴. 岛上的气温算不上寒冷, 但温暖的夜晚总不会太糟, 说不定常亮的炉火还能避免野兽的靠近】&lt;br&gt;&lt;br&gt;
&lt;&lt;link ✧生火 添加燃料&gt;&gt;&lt;&lt;/link&gt;&gt;

&lt;&lt;else&gt;&gt;
&lt;&lt;if $fireplace.addD == $date&gt;&gt;
&lt;&lt;set _T = $hour - $fireplace.addT&gt;&gt;
&lt;&lt;else&gt;&gt;
&lt;&lt;set _T =$hour - $fireplace.addT + 24*($date - $fireplace.addD)&gt;&gt;
&lt;&lt;/if&gt;&gt;
【你坐到了你的火炉前, 自你上次添加燃料已经过去_T小时了
&lt;&lt;set _LT = $fireplace.fuelT - _T&gt;&gt;
&lt;&lt;if _LT &lt;= 0&gt;&gt;
火焰似乎已经熄灭. 岛上的气温算不上寒冷, 但温暖的夜晚总不会太糟, 说不定常亮的炉火还能避免野兽的靠近】
&lt;&lt;elseif _LT &lt;= 1&gt;&gt;
壁炉里只剩下微弱的火星】
&lt;&lt;elseif _LT &lt;= 2&gt;&gt;
壁炉里所剩无几的火苗看上去毫无活力】
&lt;&lt;elseif _LT &lt;= 4&gt;&gt;
火焰时不时闪烁一下, 看上去随时有熄灭的危险】
&lt;&lt;elseif _LT &lt;= 8&gt;&gt;
火焰仍在平稳的跃动着】
&lt;&lt;elseif _LT &lt;= 16&gt;&gt;
火焰在富裕的燃料的供养下生机勃勃, 你几乎能感受到...它的喜悦? 】
&lt;&lt;elseif _LT &lt;= 32&gt;&gt;
它仍算得上是熊熊烈火, 几乎就要跃出你的壁炉了】
&lt;&lt;else&gt;&gt;
火焰在你成吨燃料的助长下变得势不可挡, 从壁炉蔓延到了各个地方, 家具, 墙壁, 你的双臂, 饥饿的火舌舔舐着它能触及到的一切. 或许你不该喂它这么多】&lt;br&gt;
✧灭火
&lt;&lt;/if&gt;&gt;
&lt;br&gt;&lt;&lt;link ✧添加燃料 添加燃料&gt;&gt;&lt;&lt;/link&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;br&gt;&lt;br&gt;&lt;&lt;link ▷「离开」 家&gt;&gt;&lt;&lt;set $choice to 0&gt;&gt;&lt;&lt;/link&gt;&gt;</tw-passagedata><tw-passagedata pid="42" name="天上人间" tags="nobr" position="700,200" size="100,100">&lt;&lt;if $choice == &quot;指名&quot;&gt;&gt;
&lt;&lt;if $HP lt 22&gt;&gt;【你感到些许疲惫, 做事情力不从心. 你最好去吃点东西休息一下, 充足的睡眠没有坏处】&lt;br&gt;&lt;br&gt;

&lt;&lt;else&gt;&gt;▸▹ ✾ ✾ ✾ ✾ ✾ ✾ ✾ ✾ ✾ ✾◃◂&lt;br&gt;
 ◈玛姬·菲斯坎   200鸟羽   &lt;&lt;link &quot;指名&quot;&gt;&gt;&lt;&lt;if $feather &gt;= 200&gt;&gt;&lt;&lt;set $feather -= 200, $choice to &quot;玛姬&quot;, $HP -=22&gt;&gt;&lt;&lt;redo&gt;&gt;&lt;&lt;else&gt;&gt;&lt;&lt;set $choice to &quot;钱不够&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;&lt;&lt;goto &quot;天上人间&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;  &lt;br&gt;
 ◈安妮·罗涅菲茨   250鸟羽   &lt;&lt;link &quot;指名&quot;&gt;&gt;&lt;&lt;if $feather &gt;= 250&gt;&gt;&lt;&lt;set $feather -= 250, $choice to &quot;安妮&quot;, $HP -=22&gt;&gt;&lt;&lt;redo&gt;&gt;&lt;&lt;else&gt;&gt;&lt;&lt;set $choice to &quot;钱不够&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;&lt;&lt;goto &quot;天上人间&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;  &lt;br&gt;
 ◈克里斯蒂娜·埃里希菲诺   300鸟羽   &lt;&lt;link &quot;指名&quot;&gt;&gt;&lt;&lt;if $feather &gt;= 300&gt;&gt;&lt;&lt;set $feather -= 300, $choice to &quot;克里斯蒂娜&quot;, $HP -=22&gt;&gt;&lt;&lt;redo&gt;&gt;&lt;&lt;else&gt;&gt;&lt;&lt;set $choice to &quot;钱不够&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;&lt;&lt;goto &quot;天上人间&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;  &lt;br&gt;
  ◈安洁莉娜·维拉南   350鸟羽   &lt;&lt;link &quot;指名&quot;&gt;&gt;&lt;&lt;if $feather &gt;= 350&gt;&gt;&lt;&lt;set $feather -= 350, $choice to &quot;安洁莉娜&quot;, $HP -=22&gt;&gt;&lt;&lt;redo&gt;&gt;&lt;&lt;else&gt;&gt;&lt;&lt;set $choice to &quot;钱不够&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;&lt;&lt;goto &quot;天上人间&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;  &lt;br&gt;
 ◈菲比·贝尔   400鸟羽   &lt;&lt;link &quot;指名&quot;&gt;&gt;&lt;&lt;if $feather &gt;= 300&gt;&gt;&lt;&lt;set $feather -= 400, $choice to &quot;菲比&quot;, $HP -=22&gt;&gt;&lt;&lt;redo&gt;&gt;&lt;&lt;else&gt;&gt;&lt;&lt;set $choice to &quot;钱不够&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;&lt;&lt;goto &quot;天上人间&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;  &lt;br&gt;
▸▹ ✾ ✾ ✾ ✾ ✾ ✾ ✾ ✾ ✾ ✾◃◂&lt;&lt;/if&gt;&gt;&lt;br&gt;&lt;br&gt;
&lt;&lt;link ▷「返回」 天上人间&gt;&gt;&lt;&lt;set $choice to 0&gt;&gt;&lt;&lt;/link&gt;&gt;

&lt;&lt;elseif $choice == &quot;钱不够&quot;&gt;&gt;【“啊，钱有些不太够呢~”老板悠闲的倚靠到椅子上，微笑的看着你“存够钱再来吧？我这里随时欢迎哦？”】&lt;br&gt;&lt;br&gt;
&lt;&lt;link ▷「返回」 天上人间&gt;&gt;&lt;&lt;set $choice to 0&gt;&gt;&lt;&lt;/link&gt;&gt;

&lt;&lt;elseif $choice == &quot;玛姬&quot;&gt;&gt;&lt;&lt;if $eraloc == &quot;天上人间&quot;&gt;&gt;【“抱歉啊，那孩子已经被指名了. ”糯米一副无可奈何的样子，然后又说道“看看其他人如何？各有千秋哦？”】&lt;br&gt;&lt;br&gt;
&lt;&lt;link ▷「返回」 天上人间&gt;&gt;&lt;&lt;/link&gt;&gt;

&lt;&lt;else&gt;&gt;【红发的女孩从里屋走出, 挽住你的手臂, 带你进了房间】
&lt;&lt;timed 3s&gt;&gt;&lt;&lt;set $choice to &quot;结束&quot;, $san +=20&gt;&gt;&lt;&lt;goto &quot;天上人间&quot;&gt;&gt;&lt;&lt;/timed&gt;&gt;&lt;&lt;/if&gt;&gt;

&lt;&lt;elseif $choice == &quot;安妮&quot;&gt;&gt;【“哎？要选我吗？”她不安的攥着裙角，有些胆怯的走到了你的身边，试探着捏住了你的袖子，或许你的默许让她安心了许多，她舒了口气，对你露出了个腼腆的微笑“谢谢你......我会努力不让你失望的......！”】&lt;&lt;timed 3s&gt;&gt;&lt;&lt;set $choice to &quot;结束&quot;, $san +=25&gt;&gt;&lt;&lt;goto &quot;天上人间&quot;&gt;&gt;&lt;&lt;/timed&gt;&gt;

&lt;&lt;elseif $choice == &quot;克里斯蒂娜&quot;&gt;&gt;【听到了自己的名字之后，姿态优雅的女性站起身走到了你的身旁，她没有过于贴近你，只是用手环住了你的手臂，随后扭过头对你露出了一个笑容，凑近你的耳边，轻声的对你说道“请多指教...”说着还轻笑了两声“相信我们一定会相处的很愉快。”】&lt;&lt;timed 3s&gt;&gt;&lt;&lt;set $choice to &quot;结束&quot;, $san +=30&gt;&gt;&lt;&lt;goto &quot;天上人间&quot;&gt;&gt;&lt;&lt;/timed&gt;&gt;

&lt;&lt;elseif $choice == &quot;安洁莉娜&quot;&gt;&gt;【“要选我吗？”身形娇小的女性直接向你扑过来，并环住你的手臂“谢谢哦——”接着对你露出了个甜美的笑容“人家是你有品位的证明哦？所以要对人家温柔一些哦！”说着就以一副依赖的姿态将脸靠在了你的手臂上】&lt;&lt;timed 3s&gt;&gt;&lt;&lt;set $choice to &quot;结束&quot;, $san +=35&gt;&gt;&lt;&lt;goto &quot;天上人间&quot;&gt;&gt;&lt;&lt;/timed&gt;&gt;

&lt;&lt;elseif $choice == &quot;菲比&quot;&gt;&gt;【没有表情的女性听到你的指名后就站了起来，走到了你的身边，她直接环住了你的腰抱住你，并将自己埋进了你的怀里，她紧紧的拥抱着你，随后抬起头，闭着眼靠近了你的脸，之后将自己的嘴唇凑近了你的嘴唇，她亲吻了你，接着对你说“谢谢。”语调平平，但你发现她的脸颊与耳朵泛起了可爱的粉红】&lt;&lt;timed 3s&gt;&gt;&lt;&lt;set $choice to &quot;结束&quot;, $san +=40&gt;&gt;&lt;&lt;goto &quot;天上人间&quot;&gt;&gt;&lt;&lt;/timed&gt;&gt;

&lt;&lt;elseif $choice == &quot;结束&quot;&gt;&gt;【你和你的床伴度过了愉快的几个小时, 她收下钱就先行离开了. 如果你要在此过夜的话, 要付上更多的钱】&lt;&lt;set _tname = &quot;享乐&quot;, _tlevel = 2&gt;&gt;&lt;&lt;traitaddwaves&gt;&gt;&lt;br&gt;&lt;br&gt;&lt;&lt;link ▷「返回」 天上人间&gt;&gt;&lt;&lt;/link&gt;&gt;

&lt;&lt;else&gt;&gt;
&lt;&lt;set $loc = &quot;天上人间&quot;&gt;&gt;【你穿过街角的小巷，走向一个建筑的后门，随后拉开门，走进了名为天上人间的店铺，室内充斥的女孩们的嬉笑与香甜的味道】&lt;br&gt;【“欢迎——”懒散的趴在前台的少年和你打了声招呼“这次想要什么类型？”说着对你露出了笑容】&lt;br&gt;

&lt;&lt;NPCloc&gt;&gt;&lt;br&gt;

&lt;&lt;link ▷「指名」 天上人间&gt;&gt;&lt;&lt;set $choice to &quot;指名&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;br&gt;&lt;br&gt;
&lt;&lt;link ▷「离开」 小镇&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="43" name="奥里互动" tags="" position="1500,100" size="100,100"></tw-passagedata><tw-passagedata pid="44" name="守夜者灯塔" tags="" position="0,600" size="100,100">&lt;&lt;set $loc = &quot;守夜者灯塔&quot;&gt;&gt;&lt;&lt;timeWidget&gt;&gt;&lt;&lt;set $minute to $minute+ random(5,10)&gt;&gt;【守夜者礼貌地请你离开】

&lt;&lt;link ▷「离开」 深林边缘&gt;&gt;&lt;&lt;/link&gt;&gt;</tw-passagedata><tw-passagedata pid="45" name="家" tags="nobr" position="1200,0" size="100,100">&lt;&lt;if !$home&gt;&gt;【你还没有自己的住所】&lt;br&gt;&lt;br&gt;

&lt;&lt;link ▷「返回」 $loc&gt;&gt;&lt;&lt;/link&gt;&gt;

&lt;&lt;elseif $choice == &quot;苗圃&quot;&gt;&gt;
【你来到后院】&lt;br&gt;&lt;br&gt;
&lt;&lt;link♢「苗圃1」 种地&gt;&gt;&lt;&lt;set $choice to &quot;land1&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;br&gt;
&lt;&lt;link♢「苗圃2」 种地&gt;&gt;&lt;&lt;set $choice to &quot;land2&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;br&gt;
&lt;&lt;link♢「苗圃3」 种地&gt;&gt;&lt;&lt;set $choice to &quot;land3&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;
&lt;br&gt;&lt;br&gt;&lt;&lt;link ▷「离开」 家&gt;&gt;&lt;&lt;set $choice to 0&gt;&gt;&lt;&lt;/link&gt;&gt;

&lt;&lt;elseif $home == &quot;旅店&quot;&gt;&gt;
&lt;&lt;audio &quot;mainBGM&quot; mute&gt;&gt;
&lt;&lt;audio &quot;homeBGM&quot; loop play&gt;&gt;
【你走进了你在旅店的临时住所】&lt;br&gt;
&lt;br&gt;
◈浴缸&lt;br&gt;
&lt;&lt;linkreplace◈睡觉&gt;&gt;
&lt;span class=&quot;sleepc&quot;&gt;
&lt;&lt;set _sleepcs to [1,2,3,4,5,6,7,8,9,10]&gt;&gt;◈睡&lt;&lt;listbox &quot;$sleepc&quot;&gt;&gt; &lt;&lt;optionsfrom _sleepcs&gt;&gt; &lt;&lt;/listbox&gt;&gt;&lt;/span&gt;小时   
&lt;&lt;button &quot;确认&quot;&gt;&gt;&lt;&lt;goto &quot;睡觉&quot;&gt;&gt;&lt;&lt;/button&gt;&gt;
&lt;br&gt;&lt;&lt;link ◈随它吧 睡觉&gt;&gt;&lt;&lt;set $sleepc to random(1,10)&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;&lt;/linkreplace&gt;&gt;&lt;br&gt;
&lt;&lt;link ◈休息 家&gt;&gt;&lt;&lt;set $HP to $HP+ 2&gt;&gt;&lt;&lt;set $hour to $hour+ 1&gt;&gt;&lt;&lt;/link&gt;&gt;(01: 00)&lt;br&gt;
&lt;br&gt;
&lt;&lt;link ▷「离开」 小镇&gt;&gt;&lt;&lt;audio &quot;homeBGM&quot; stop&gt;&gt;&lt;&lt;/link&gt;&gt;

&lt;&lt;else&gt;&gt;&lt;&lt;set $loc to &quot;你的小屋&quot;&gt;&gt;
&lt;&lt;audio &quot;mainBGM&quot; mute&gt;&gt;
&lt;&lt;audio &quot;homeBGM&quot; loop play&gt;&gt;
【你打开房门, 踏进你在$home的小屋. 欢迎回家! 】&lt;br&gt;
&lt;&lt;link ◈壁炉 壁炉&gt;&gt;&lt;&lt;set $choice to &quot;壁炉&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;br&gt;
♢「信箱」&lt;br&gt;
&lt;&lt;link ◈苗圃 家&gt;&gt;&lt;&lt;set $choice to &quot;苗圃&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;br&gt;
&lt;&lt;link ◈书柜 家&gt;&gt;&lt;&lt;set $choice to &quot;书柜&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;br&gt;
&lt;&lt;link ◈鱼缸 家&gt;&gt;&lt;&lt;set $choice to &quot;鱼缸&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;br&gt;
&lt;br&gt;
◈烹饪&lt;br&gt;
◈浴缸&lt;br&gt;
&lt;&lt;linkreplace◈睡觉&gt;&gt;
&lt;span class=&quot;sleepc&quot;&gt;
&lt;&lt;set _sleepcs to [1,2,3,4,5,6,7,8,9,10]&gt;&gt;◈睡&lt;&lt;listbox &quot;$sleepc&quot;&gt;&gt; &lt;&lt;optionsfrom _sleepcs&gt;&gt; &lt;&lt;/listbox&gt;&gt;&lt;/span&gt;小时   
&lt;&lt;button &quot;确认&quot;&gt;&gt;&lt;&lt;goto &quot;睡觉&quot;&gt;&gt;&lt;&lt;/button&gt;&gt;
&lt;br&gt;&lt;&lt;link ◈随它吧 睡觉&gt;&gt;&lt;&lt;set $sleepc to random(1,10)&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;&lt;/linkreplace&gt;&gt;&lt;br&gt;
&lt;&lt;link ◈休息 家&gt;&gt;&lt;&lt;set $HP to $HP+ 2&gt;&gt;&lt;&lt;set $hour to $hour+ 1&gt;&gt;&lt;&lt;/link&gt;&gt;(⏳01: 00)
&lt;br&gt;&lt;br&gt;
&lt;&lt;link ▷「离开」 $home&gt;&gt;&lt;&lt;/link&gt;&gt;
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="46" name="小镇" tags="nobr" position="600,200" size="100,100">&lt;&lt;if $loc != &quot;小镇&quot;&gt;&gt;&lt;&lt;set $loc = &quot;小镇&quot;&gt;&gt;&lt;&lt;timeWidget&gt;&gt;&lt;&lt;set $minute to $minute+ random(5,10)&gt;&gt;&lt;&lt;set $HP to $HP- 1&gt;&gt;&lt;&lt;/if&gt;&gt;

&lt;&lt;if $hour &gt;= 5 &amp;&amp; $hour &lt;= 22&gt;&gt;
&lt;&lt;if $orifirstc != 1&gt;&gt;&lt;&lt;set $loct = $loc, $npc to &quot;奥里&quot;&gt;&gt;&lt;&lt;goto &quot;交谈&quot;&gt;&gt;
&lt;&lt;elseif $mss == &quot;主线第一天&quot;&gt;&gt;&lt;&lt;goto &quot;主线第一天&quot;&gt;&gt;
&lt;&lt;elseif $mss == &quot;主线第一天结束&quot; &amp;&amp; $msstat == &quot;新的开始3&quot; &amp;&amp; $date &gt;=2 &amp;&amp; $hour &gt;=6 &amp;&amp; $hour &lt;=12&gt;&gt;&lt;&lt;set $choice to 0&gt;&gt;&lt;&lt;goto &quot;主线第二天&quot;&gt;&gt;
&lt;&lt;elseif $mss == &quot;主线第二天结束&quot; &amp;&amp; $msstat == 0 &amp;&amp; $date &gt;=3 &amp;&amp; $hour &gt;=6 &amp;&amp; $hour &lt;=12&gt;&gt;&lt;&lt;set $choice to 0&gt;&gt;&lt;&lt;goto &quot;主线第三天&quot;&gt;&gt;

&lt;&lt;else&gt;&gt;
&lt;&lt;audio &quot;mainBGM&quot; unmute&gt;&gt;

&lt;img src=&quot;https://f2.toyhou.se/file/f2-toyhou-se/images/87543238_2HNM8SE1A9tkwRc.jpg&quot; width=100% class=&quot;pic&quot;&gt;
&lt;font color=#D4A34C&gt;//永无乡的小镇由Nix的祖父当年亲自选址规划建立, 选址于贝雷河下游的平原河谷中, 平均海拔高度122英尺. 岛上的居民大多居住在此, 店铺和重要建筑, 如银行、医院都聚集于此, 集市也只在小镇的广场上举行//&lt;/font&gt;

&lt;br&gt;
&lt;&lt;NPCloc&gt;&gt;
&lt;br&gt;你正位于小镇广场&lt;br&gt;
[[◈「喂食鸟群」|地点活动]]&lt;br&gt;
&lt;&lt;wanderWidget&gt;&gt;&lt;&lt;link ◈「随便逛逛」 $tlocs&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;br&gt;
&lt;&lt;if $lostsheep[0] == 1&gt;&gt;[[✧「找羊」|era互动]]&lt;br&gt;&lt;&lt;/if&gt;&gt;
&lt;br&gt;北向建筑&lt;br&gt;
[[✧「教堂」|教堂]]&lt;br&gt;
[[✧「花店」|花店]]&lt;br&gt;
[[✧「医院」|医院]]&lt;br&gt;
&lt;br&gt;东向建筑&lt;br&gt;
[[✧「酒馆」|酒馆]]&lt;br&gt;
[[✧「旅店」|旅店]]&lt;br&gt;
[[✧「工坊」|工坊]]&lt;br&gt;
[[✧「杂货铺」|杂货铺]]&lt;br&gt;
&lt;br&gt;西向建筑&lt;br&gt;
[[✧「咖啡馆」|咖啡馆]]&lt;br&gt;
[[✧「图书馆」|图书馆]]&lt;br&gt;
[[✧「泡泡布提」|泡泡布提]]&lt;br&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;else&gt;&gt;【现在是夜间, 镇子里一片寂静, 大家都休息了, 你也应该回家了】&lt;br&gt;
&lt;br&gt;继续前往&lt;br&gt;
&lt;&lt;link ♢「回家」&gt;&gt;&lt;&lt;if $home == &quot;旅店&quot;&gt;&gt;&lt;&lt;goto &quot;旅店&quot;&gt;&gt;&lt;&lt;else&gt;&gt;&lt;&lt;goto &quot;home&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;br&gt;♢[[「酒馆」|酒馆]]&lt;br&gt;
&lt;&lt;if $item.has(&#39;粉红色小卡片&#39;)&gt;&gt;&lt;&lt;link ♢「天上人间」 天上人间&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;br&gt;&lt;&lt;/if&gt;&gt;
&lt;br&gt;
&lt;&lt;link ♢「随便逛逛」 随便逛逛&gt;&gt;&lt;&lt;/link&gt;&gt;

&lt;&lt;/if&gt;&gt;
&lt;br&gt;离开小镇&lt;br&gt;
[[♢「沙地」|沙地]]&lt;br&gt;
[[♢「贝雷河」|贝雷河]]&lt;br&gt;
[[♢「主港口」|主港口]]</tw-passagedata><tw-passagedata pid="47" name="属性" tags="widget nobr" position="600,0" size="100,100">&lt;&lt;widget &quot;addkexpWidget&quot;&gt;&gt;
&lt;&lt;set $oldk = $player.knowledge&gt;&gt;
&lt;&lt;for $knowledgeexp gte $player.knowledge&gt;&gt;
	&lt;&lt;if $knowledgeexp gte $player.knowledge&gt;&gt;
	&lt;&lt;set $player.knowledge to $player.knowledge+ 1&gt;&gt;
	&lt;&lt;set $knowledgeexp to $knowledgeexp- $player.knowledge&gt;&gt;	&lt;&lt;/if&gt;&gt;
&lt;&lt;/for&gt;&gt;
&lt;&lt;run UI.update()&gt;&gt;
&lt;&lt;if $oldk lt $player.knowledge&gt;&gt;&lt;&lt;set _l to $player.knowledge- $oldk&gt;&gt;
@@.goodblur;&lt;div class=&quot;logo is-animetion&quot;&gt;&lt;span&gt;你&lt;/span&gt;&lt;span&gt;的&lt;/span&gt;&lt;span&gt;学&lt;/span&gt;&lt;span&gt;识&lt;/span&gt;&lt;span&gt;提&lt;/span&gt;&lt;span&gt;升&lt;/span&gt;&lt;span&gt;了&lt;/span&gt;&lt;span&gt;_l&lt;/span&gt;&lt;span&gt;级&lt;/span&gt;&lt;/div&gt;@@
&lt;&lt;/if&gt;&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;addsexpWidget&quot;&gt;&gt;
&lt;&lt;set $olds = $player.strength&gt;&gt;
&lt;&lt;for $strengthexp gte $player.strength&gt;&gt;
	&lt;&lt;if $strengthexp gte $player.strength&gt;&gt;
    &lt;&lt;set $player.strength to $player.strength+ 1&gt;&gt;
    &lt;&lt;set $strengthexp to $strengthexp- $player.strength&gt;&gt;		
    &lt;&lt;/if&gt;&gt;
&lt;&lt;/for&gt;&gt;
&lt;&lt;run UI.update()&gt;&gt;
&lt;&lt;if $olds lt $player.strength&gt;&gt;&lt;&lt;set _l to $player.strength- $olds&gt;&gt;
@@.goodblur;&lt;div class=&quot;logo is-animetion&quot;&gt;&lt;span&gt;你&lt;/span&gt;&lt;span&gt;的&lt;/span&gt;&lt;span&gt;力&lt;/span&gt;&lt;span&gt;量&lt;/span&gt;&lt;span&gt;提&lt;/span&gt;&lt;span&gt;升&lt;/span&gt;&lt;span&gt;了&lt;/span&gt;&lt;span&gt;_l&lt;/span&gt;&lt;span&gt;级&lt;/span&gt;&lt;/div&gt;@@
&lt;&lt;/if&gt;&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;addoexpWidget&quot;&gt;&gt;
&lt;&lt;set $oldo = $player.observation&gt;&gt;
&lt;&lt;for $observationexp gte $player.observation&gt;&gt;
	&lt;&lt;if $observationexp gte $player.observation&gt;&gt;
    &lt;&lt;set $player.observation to $player.observation+ 1&gt;&gt;
    &lt;&lt;set $observationexp to $observationexp- $player.observation&gt;&gt;
    &lt;&lt;/if&gt;&gt;
&lt;&lt;/for&gt;&gt;
&lt;&lt;run UI.update()&gt;&gt;
&lt;&lt;if $oldo lt $player.observation&gt;&gt;&lt;&lt;set _l to $player.observation- $oldo&gt;&gt;
@@.goodblur;&lt;div class=&quot;logo is-animetion&quot;&gt;&lt;span&gt;你&lt;/span&gt;&lt;span&gt;的&lt;/span&gt;&lt;span&gt;观&lt;/span&gt;&lt;span&gt;察&lt;/span&gt;&lt;span&gt;提&lt;/span&gt;&lt;span&gt;升&lt;/span&gt;&lt;span&gt;了&lt;/span&gt;&lt;span&gt;_l&lt;/span&gt;&lt;span&gt;级&lt;/span&gt;&lt;/div&gt;@@
&lt;&lt;/if&gt;&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;addpexpWidget&quot;&gt;&gt;
&lt;&lt;set $oldp = $player.persuasive&gt;&gt;
&lt;&lt;for $persuasiveexp gte $player.persuasive&gt;&gt;
	&lt;&lt;if $persuasiveexp gte $player.persuasive&gt;&gt;
		&lt;&lt;set $player.persuasive to $player.persuasive+ 1&gt;&gt;
		&lt;&lt;set $persuasiveexp to $persuasiveexp- $player.persuasive&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/for&gt;&gt;
&lt;&lt;run UI.update()&gt;&gt;
&lt;&lt;if $oldp lt $player.persuasive&gt;&gt;&lt;&lt;set _l to $player.persuasive- $oldp&gt;&gt;
@@.goodblur;&lt;div class=&quot;logo is-animetion&quot;&gt;&lt;span&gt;你&lt;/span&gt;&lt;span&gt;的&lt;/span&gt;&lt;span&gt;话&lt;/span&gt;&lt;span&gt;术&lt;/span&gt;&lt;span&gt;提&lt;/span&gt;&lt;span&gt;升&lt;/span&gt;&lt;span&gt;了&lt;/span&gt;&lt;span&gt;_l&lt;/span&gt;&lt;span&gt;级&lt;/span&gt;&lt;/div&gt;@@
&lt;&lt;/if&gt;&gt;
&lt;&lt;/widget&gt;&gt;


&lt;&lt;widget &quot;reduceexpWidget&quot;&gt;&gt;
111


&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;traitaddwaves&quot;&gt;&gt;
&lt;center&gt;
@@.traitblur;&lt;div class=&quot;logo is-animetion&quot;&gt;&lt;span&gt;你&lt;/span&gt;&lt;span&gt;的&lt;/span&gt;&lt;&lt;if _tname == &quot;谨慎&quot;&gt;&gt;&lt;&lt;set $player.cautious += _tlevel&gt;&gt;&lt;span&gt;谨&lt;/span&gt;&lt;span&gt;慎&lt;/span&gt;&lt;&lt;elseif _tname == &quot;无情&quot;&gt;&gt;&lt;&lt;set $player.heartless += _tlevel&gt;&gt;&lt;span&gt;无&lt;/span&gt;&lt;span&gt;情&lt;/span&gt;&lt;&lt;elseif _tname == &quot;嗜血&quot;&gt;&gt;&lt;&lt;set $player.bloody += _tlevel&gt;&gt;&lt;span&gt;嗜&lt;/span&gt;&lt;span&gt;血&lt;/span&gt;&lt;&lt;elseif _tname == &quot;自信&quot;&gt;&gt;&lt;&lt;set $player.confidence  += _tlevel&gt;&gt;&lt;span&gt;自&lt;/span&gt;&lt;span&gt;信&lt;/span&gt;&lt;&lt;elseif _tname == &quot;慷慨&quot;&gt;&gt;&lt;&lt;set $player.generous  += _tlevel&gt;&gt;&lt;span&gt;慷&lt;/span&gt;&lt;span&gt;慨&lt;/span&gt;&lt;&lt;elseif _tname == &quot;享乐&quot;&gt;&gt;&lt;&lt;set $player.enjoy  += _tlevel&gt;&gt;&lt;span&gt;享&lt;/span&gt;&lt;span&gt;乐&lt;/span&gt;&lt;&lt;/if&gt;&gt;&lt;span&gt;增&lt;/span&gt;&lt;span&gt;加&lt;/span&gt;&lt;span&gt;了&lt;/span&gt;&lt;span&gt;_tlevel&lt;/span&gt;&lt;span&gt;级&lt;/span&gt;
&lt;/div&gt;@@
&lt;/center&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;addsocial&quot;&gt;&gt;&lt;&lt;set $social += _slevel&gt;&gt;
@@.goodblur;&lt;div class=&quot;logo is-animetion&quot;&gt;&lt;span&gt;你&lt;/span&gt;&lt;span&gt;的&lt;/span&gt;&lt;span&gt;社&lt;/span&gt;&lt;span&gt;会&lt;/span&gt;&lt;span&gt;属&lt;/span&gt;&lt;span&gt;性&lt;/span&gt;&lt;span&gt;提&lt;/span&gt;&lt;span&gt;升&lt;/span&gt;&lt;span&gt;了&lt;/span&gt;&lt;span&gt;_slevel&lt;/span&gt;&lt;span&gt;级&lt;/span&gt;
&lt;/div&gt;@@
&lt;&lt;/widget&gt;&gt;


&lt;&lt;widget &quot;checkWidget&quot;&gt;&gt;
&lt;&lt;set _S = random(1,100)&gt;&gt;
&lt;&lt;set _b = _a/6&gt;&gt;
&lt;&lt;if _b &gt;=5 &amp;&amp; _S &lt;= _b&gt;&gt;
&lt;&lt;set _rst = &quot;大成功&quot;&gt;&gt;
&lt;&lt;elseif _S &lt;= 5&gt;&gt;
&lt;&lt;set _rst = &quot;大成功&quot;&gt;&gt;
&lt;&lt;elseif _S lt _a&gt;&gt;
&lt;&lt;set _rst = &quot;成功&quot;&gt;&gt;
&lt;&lt;elseif _S lt 95&gt;&gt;
&lt;&lt;set _rst = &quot;失败&quot;&gt;&gt;
&lt;&lt;else&gt;&gt;
&lt;&lt;set _rst = &quot;大失败&quot;&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;/widget&gt;&gt;</tw-passagedata><tw-passagedata pid="48" name="属性分配" tags="" position="400,1175" size="100,100">&lt;h2&gt;属性分配&lt;/h2&gt;&lt;font size=1&gt;总数16点, 携带上岛的资金按1: 10转化为岛内货币&lt;font color=#FFAA00&gt;鸟羽&lt;/font&gt;&lt;/font&gt;
&lt;&lt;if $nn == &quot;Nix&quot;&gt;&gt;&lt;&lt;set $soul = &quot;金色&quot;&gt;&gt;&lt;&lt;elseif $blood == &quot;dragus&quot;&gt;&gt;&lt;&lt;set $soul = &quot;红色&quot;&gt;&gt;&lt;&lt;else&gt;&gt;&lt;&lt;set $soul = &quot;蓝色&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;
&lt;&lt;do&gt;&gt;〖&lt;span class=&quot;tooltip&quot;&gt;学识&lt;div class=&quot;tooltiptext&quot;&gt;知识, 阅历, 智慧&lt;/div&gt;&lt;/span&gt;〗：$player.knowledge  &lt;&lt;link&quot; +1 &quot;&gt;&gt;&lt;&lt;if $points gt 0&gt;&gt;&lt;&lt;set $player.knowledge to $player.knowledge+ 1&gt;&gt;&lt;&lt;set $points to $points - 1&gt;&gt;&lt;&lt;/if&gt;&gt;&lt;&lt;redo&gt;&gt;&lt;&lt;/link&gt;&gt;  &lt;&lt;link&quot; -1 &quot;&gt;&gt;&lt;&lt;if $player.knowledge gt 0&gt;&gt;&lt;&lt;set $player.knowledge -= 1&gt;&gt;&lt;&lt;set $points += 1&gt;&gt;&lt;&lt;/if&gt;&gt;&lt;&lt;redo&gt;&gt;&lt;&lt;/link&gt;&gt;
〖&lt;span class=&quot;tooltip&quot;&gt;力量&lt;span class=&quot;tooltiptext&quot;&gt;体魄, 蛮力, 战斗&lt;/span&gt;&lt;/span&gt;〗：$player.strength  &lt;&lt;link&quot; +1 &quot;&gt;&gt;&lt;&lt;if $points gt 0&gt;&gt;&lt;&lt;set $player.strength to $player.strength+ 1&gt;&gt;&lt;&lt;set $points to $points - 1&gt;&gt;&lt;&lt;/if&gt;&gt;&lt;&lt;redo&gt;&gt;&lt;&lt;/link&gt;&gt;  &lt;&lt;link&quot; -1 &quot;&gt;&gt;&lt;&lt;if $player.strength gt 0&gt;&gt;&lt;&lt;set $player.strength -= 1&gt;&gt;&lt;&lt;set $points += 1&gt;&gt;&lt;&lt;/if&gt;&gt;&lt;&lt;redo&gt;&gt;&lt;&lt;/link&gt;&gt;
〖&lt;span class=&quot;tooltip&quot;&gt;观察&lt;span class=&quot;tooltiptext&quot;&gt;敏锐, 狡黠, 觉察&lt;/span&gt;&lt;/span&gt;〗：$player.observation  &lt;&lt;link&quot; +1 &quot;&gt;&gt;&lt;&lt;if $points gt 0&gt;&gt;&lt;&lt;set $player.observation to $player.observation+ 1&gt;&gt;&lt;&lt;set $points to $points - 1&gt;&gt;&lt;&lt;/if&gt;&gt;&lt;&lt;redo&gt;&gt;&lt;&lt;/link&gt;&gt;  &lt;&lt;link&quot; -1 &quot;&gt;&gt;&lt;&lt;if $player.observation gt 0&gt;&gt;&lt;&lt;set $player.observation -= 1&gt;&gt;&lt;&lt;set $points += 1&gt;&gt;&lt;&lt;/if&gt;&gt;&lt;&lt;redo&gt;&gt;&lt;&lt;/link&gt;&gt;
〖&lt;span class=&quot;tooltip&quot;&gt;话术&lt;span class=&quot;tooltiptext&quot;&gt;诡辩, 智慧, 思维&lt;/span&gt;&lt;/span&gt;〗：$player.persuasive  &lt;&lt;link&quot; +1 &quot;&gt;&gt;&lt;&lt;if $points gt 0&gt;&gt;&lt;&lt;set $player.persuasive to $player.persuasive+ 1&gt;&gt;&lt;&lt;set $points to $points - 1&gt;&gt;&lt;&lt;/if&gt;&gt;&lt;&lt;/link&gt;&gt;  &lt;&lt;link&quot; -1 &quot;&gt;&gt;&lt;&lt;if $player.persuasive gt 0&gt;&gt;&lt;&lt;set $player.persuasive -= 1&gt;&gt;&lt;&lt;set $points += 1&gt;&gt;&lt;&lt;/if&gt;&gt;&lt;&lt;redo&gt;&gt;&lt;&lt;/link&gt;&gt;
〖资金〗：$feather  &lt;&lt;link&quot; +1 &quot;&gt;&gt;&lt;&lt;if $points gt 0&gt;&gt;&lt;&lt;set $feather to $feather+ 10&gt;&gt;&lt;&lt;set $points to $points - 1&gt;&gt;&lt;&lt;/if&gt;&gt;&lt;&lt;redo&gt;&gt;&lt;&lt;/link&gt;&gt;  &lt;&lt;link&quot; -1 &quot;&gt;&gt;&lt;&lt;if $feather gt 0&gt;&gt;&lt;&lt;set $feather -= 10&gt;&gt;&lt;&lt;set $points += 1&gt;&gt;&lt;&lt;/if&gt;&gt;&lt;&lt;redo&gt;&gt;&lt;&lt;/link&gt;&gt;

剩余点数: $points&lt;&lt;/do&gt;&gt;


&lt;&lt;button[[开始故事]]&gt;&gt;&lt;&lt;/button&gt;&gt;</tw-passagedata><tw-passagedata pid="49" name="工坊" tags="nobr" position="0,500" size="100,100">&lt;&lt;if $choice == &quot;左侧门&quot;&gt;&gt;//推门进去，看到门口堆着整整齐齐的小酒坛子，而后一眼看到宽敞的房间里被各式各样的木头堆得满满的，刨锯斧锉摆在一张大木头台子上，窗台上摆着一排可爱的木头小摆件，能看见漆成红顶子的小灯塔和被旁边敲锤子的震动弄得晃晃悠悠的摇摇马摆件。窗边的工作台上，工坊的木匠安山——一只高大健壮的狸花猫——正一手握着凿子一手拿着锤子凿一块木头，对你的到来浑然不觉//
&lt;br&gt;&lt;br&gt;
&lt;&lt;link&quot; ✣「NPC 安山」 &quot; &quot;工坊&quot;&gt;&gt;&lt;&lt;set $loct = $loc, $npc to &quot;安山&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;
&lt;br&gt;&lt;br&gt;
&lt;&lt;link ✧「查看菜单」 兑换&gt;&gt;&lt;&lt;/link&gt;&gt;
&lt;br&gt;&lt;br&gt;
&lt;&lt;link ▷「离开」 工坊&gt;&gt;&lt;&lt;set $choice to 0&gt;&gt;&lt;&lt;/link&gt;&gt;

&lt;&lt;elseif $choice == &quot;右侧门&quot;&gt;&gt;//推门进去，你看到铁匠王铁牛正从炉子中夹出一个烧红的铁块，放在铁砧上，抡起锤子敲打起来。她发觉你进来了，但是只是看了你一眼，自顾自打铁。你看到门边有一张桌子，上面放着一摞空白单据，墙上贴着“自己填单，钱放桌上”//&lt;br&gt;&lt;br&gt;

&lt;&lt;link&quot; ✣「NPC 王铁牛」 &quot; &quot;工坊&quot;&gt;&gt;&lt;&lt;set $loct = $loc, $npc to &quot;王铁牛&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;br&gt;&lt;br&gt;

&lt;&lt;link ✧「查看菜单」 兑换&gt;&gt;&lt;&lt;/link&gt;&gt;
&lt;br&gt;&lt;br&gt;
&lt;&lt;link ▷「离开」 工坊&gt;&gt;&lt;&lt;set $choice to 0&gt;&gt;&lt;&lt;/link&gt;&gt;

&lt;&lt;else&gt;&gt;
&lt;&lt;set $loc = &quot;工坊&quot;&gt;&gt;
//还没进门就能听见里面传出来叮叮咣咣的响声。推开工坊的门是一个小厅，左右各有一扇门。左手边是一扇雕花的楠木门，右手边是一个金属铁艺栅栏门，有滚滚的热气冒出来//
&lt;br&gt;&lt;br&gt;
&lt;&lt;link ♢「左侧门」 工坊&gt;&gt;&lt;&lt;set $choice to &quot;左侧门&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;br&gt;
&lt;&lt;link ♢「右侧门」 工坊&gt;&gt;&lt;&lt;set $choice to &quot;右侧门&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;br&gt;
&lt;br&gt;&lt;br&gt;
[[✧「制作」|兑换]]
&lt;br&gt;&lt;br&gt;
&lt;&lt;link ▷「离开」 小镇&gt;&gt;&lt;&lt;/link&gt;&gt;

&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="50" name="已完成" tags="" position="1900,100" size="100,100">&lt;&lt;inv $msd   inspect&gt;&gt;
&lt;&lt;inv $ssd   inspect&gt;&gt;</tw-passagedata><tw-passagedata pid="51" name="开始故事" tags="nobr" position="500,1175" size="100,100">&lt;font color=#FFAA00&gt; Seisinofoaga&lt;/font&gt;: &lt;br&gt;
&lt;&lt;if $choice == &quot;明白&quot;&gt;&gt;
&lt;&lt;type-wp 45ms element &quot;span&quot;&gt;&gt;这不是做得很好吗, 他们还跟我下注你要失败个四五次才能找到门道&lt;br&gt;
&lt;br&gt;
永无乡上的故事大多都是这样推进的, 你要做出自己的选择, 他们通往不同的发展, 后果不论好坏, 都是你自己承担. 还有, 别说我没告诉过你, 有些时候, 你别无选择&lt;br&gt;
&lt;br&gt;
当然, 重要的不光是你的选择, 还有结果的成功与否. 还记得你登记时填写的四个属性吗, 他们关系到你在永无乡上的各方各面, 最关键的就是选项的成功&lt;br&gt;
&lt;br&gt;
成功的判定有两种方式, 【成功条件】需要你的数值达到要求以上, 【成功难度】则要温柔的多, 即使没达到要求也有几率通过. 只有影响较大的选择会标出成功要求, 所以那些什么都没有的选项, 尽量安心的去选择他们吧&lt;br&gt;
&lt;br&gt;
[[▷「继续」|提问]]&lt;&lt;/type-wp&gt;&gt;
&lt;&lt;else&gt;&gt;
&lt;&lt;type-wp 45ms element &quot;span&quot;&gt;&gt;看上去你完成了登记, 回顾自己过去的日子一定不是件易事, 难到值得一些奖励, 除非你填了假信息, 那样我们就得把你丢回海里了&lt;br&gt;
&lt;br&gt;
开个玩笑, 真或假, 在这里都不重要, 这里是梦想之地, 你想的话, 它也能是妄想之地&lt;br&gt;
&lt;br&gt;
但即使是叫永无乡, 这里也不是提供免费午餐的地方, 你要自己赚取他们, 午餐、住所、名誉, 甚至权力.  哦, 有时候也许还有友情. 谁知道你在这个小到不起眼的小岛上会遇到什么. 你可以跟他们建立关系, 互换礼物, 等时机到了, 他们中的有些说不定还会为你付出生命&lt;br&gt;
&lt;br&gt;
听着就没兴致了, 不是吗. 不管怎样, 在你开始那些故事之前, 我们先来看看你对这个游戏有多上手. 现在, 选择下面的一项&lt;br&gt;
&lt;br&gt;
&lt;&lt;line&gt;&gt;
&lt;&lt;link ▷「明白」 开始故事&gt;&gt;&lt;&lt;set $choice to &quot;明白&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;(☜选这个)&lt;br&gt;
&lt;&lt;linkreplace ▷「不明白」(别选这个,我没心情给你再讲一遍)&gt;&gt;【Seisi仿佛没听懂一样, 一动不动地盯着你】&lt;&lt;/linkreplace&gt;&gt;&lt;br&gt;
&lt;&lt;linkreplace ▷「你是谁」&gt;&gt;&lt;br&gt;愚昧的凡间生物, 居然连我庇护之神Seisinofoaga的名讳都不曾听过? 真是可惜, 你没机会见到万人称颂我的名字的场面了. 我是岛主的唯一的导师, 也是你的指引者，岛主不在的时候，这里一切听我的&lt;&lt;/linkreplace&gt;&gt;&lt;&lt;/type-wp&gt;&gt;
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="52" name="开枪" tags="nobr" position="1000,300" size="100,100">&lt;&lt;set _m to random(1,10)&gt;&gt;&lt;&lt;if _m == 10&gt;&gt;&lt;&lt;set _rpe = [&quot;【真可惜, 你错过了时机】&quot;,&quot;【真可惜, 你打偏了】&quot;,&quot;【看起来它觉得你决定放它一马, 飞快地从你的视线里消失了】&quot;].random()&gt;&gt;_rpe
&lt;&lt;elseif $tmpprey == &quot;灰兔&quot;&gt;&gt;&lt;&lt;set $preycollect.pushUnique(&quot;灰兔&quot;)&gt;&gt;&lt;&lt;pickup $prey &quot;兔皮&quot; 1 &quot;兽肉&quot; 1&gt;&gt;【短暂的瞄准后, 你击中了灰兔】&lt;br&gt;
【你获得兔皮*1 兽肉*1】
&lt;&lt;elseif  $tmpprey == &quot;田鼠&quot;&gt;&gt;&lt;&lt;set $preycollect.pushUnique(&quot;田鼠&quot;)&gt;&gt;111
&lt;&lt;elseif $tmpprey == &quot;鹌鹑&quot;&gt;&gt;&lt;&lt;set $preycollect.pushUnique(&quot;鹌鹑&quot;)&gt;&gt;&lt;&lt;pickup $prey &quot;禽肉&quot; 1 &quot;羽毛&quot; 1&gt;&gt;【短暂的瞄准后, 你击中了鹌鹑】&lt;br&gt;
【你获得禽肉*1 羽毛*1】
&lt;&lt;elseif $tmpprey == &quot;雷鸟&quot;&gt;&gt;&lt;&lt;set $preycollect.pushUnique(&quot;雷鸟&quot;)&gt;&gt;&lt;&lt;pickup $prey &quot;禽肉&quot; 1 &quot;羽毛&quot; 1&gt;&gt;【短暂的瞄准后, 你击中了雷鸟】&lt;br&gt;
【你获得禽肉*1 羽毛*1】
&lt;&lt;elseif $tmpprey == &quot;山羊&quot;&gt;&gt;&lt;&lt;set $preycollect.pushUnique(&quot;山羊&quot;)&gt;&gt;&lt;&lt;pickup $prey &quot;羊毛&quot; 3 &quot;兽肉&quot; 5&gt;&gt;【漫长的等待后, 你终于扣下了扳机】&lt;br&gt;
【你获得羊毛*1 兽肉*1】
&lt;&lt;elseif $tmpprey == &quot;野鸭&quot;&gt;&gt;&lt;&lt;set $preycollect.pushUnique(&quot;野鸭&quot;)&gt;&gt;&lt;&lt;pickup $prey &quot;禽肉&quot; 1 &quot;鸭绒&quot; 1&gt;&gt;【短暂的瞄准后, 你击中了野鸭】&lt;br&gt;
【你获得禽肉*1 鸭绒*1】
&lt;&lt;elseif $tmpprey == &quot;水獭&quot;&gt;&gt;&lt;&lt;set $preycollect.pushUnique(&quot;水獭&quot;)&gt;&gt;&lt;&lt;pickup $prey &quot;獭皮&quot; 1 &quot;兽肉&quot; 2&gt;&gt;【短暂的观察后, 你击中了水獭】&lt;br&gt;
【你获得獭皮*1 兽肉*2】
&lt;&lt;elseif $tmpprey == &quot;松貂&quot;&gt;&gt;&lt;&lt;set $preycollect.pushUnique(&quot;松貂&quot;)&gt;&gt;&lt;&lt;pickup $prey &quot;貂皮&quot; 1 &quot;兽肉&quot; 1&gt;&gt;【耐心的等待后, 你击中了松貂】&lt;br&gt;
【你获得貂皮*1 兽肉*1】
&lt;&lt;elseif $tmpprey == &quot;狍子&quot;&gt;&gt;&lt;&lt;set $preycollect.pushUnique(&quot;狍子&quot;)&gt;&gt;&lt;&lt;pickup $prey &quot;狍皮&quot; 1 &quot;兽肉&quot; 4&gt;&gt;【精准的瞄准后, 你击中了一只狍子, 它的同伴在原地茫然地嗅着它的尸体】&lt;br&gt;
【你获得狍皮*1 兽肉*4】
&lt;&lt;elseif $tmpprey == &quot;红狐&quot;&gt;&gt;&lt;&lt;set $preycollect.pushUnique(&quot;红狐&quot;)&gt;&gt;&lt;&lt;pickup $prey &quot;狐皮&quot; 1 &quot;兽肉&quot; 3&gt;&gt;【短暂的瞄准后, 你击中了红狐】&lt;br&gt;
【你获得狐皮*1 兽肉*3】
&lt;&lt;elseif $tmpprey == &quot;马鹿&quot;&gt;&gt;&lt;&lt;set $preycollect.pushUnique(&quot;马鹿&quot;)&gt;&gt;&lt;&lt;pickup $prey &quot;鹿皮&quot; 1 &quot;兽肉&quot; 5&gt;&gt;【漫长的等待后, 你终于扣下了扳机, 看着它的同伴惊恐地从枪响下逃离】&lt;br&gt;
【你获得鹿皮*1 兽肉*5】
&lt;&lt;elseif $tmpprey == &quot;松鸡&quot;&gt;&gt;&lt;&lt;set $preycollect.pushUnique(&quot;松鸡&quot;)&gt;&gt;&lt;&lt;pickup $prey &quot;禽肉&quot; 1 &quot;羽毛&quot; 2&gt;&gt;【短暂的瞄准后, 你击中了松鸡】&lt;br&gt;
【你获得禽肉*1 羽毛*2】
&lt;&lt;elseif $tmpprey == &quot;黄鼬&quot;&gt;&gt;&lt;&lt;set $preycollect.pushUnique(&quot;黄鼬&quot;)&gt;&gt;&lt;&lt;pickup $prey &quot;鼬皮&quot; 1 &quot;兽肉&quot; 1&gt;&gt;【短暂的瞄准后, 你击中了黄鼬】&lt;br&gt;
【你获得鼬皮*1 兽肉*1】
&lt;&lt;elseif $tmpprey == &quot;白鼬&quot;&gt;&gt;&lt;&lt;set $preycollect.pushUnique(&quot;白鼬&quot;)&gt;&gt;&lt;&lt;pickup $prey &quot;白鼬皮&quot; 1 &quot;兽肉&quot; 1&gt;&gt;【短暂的瞄准后, 你击中了红狐】&lt;br&gt;
【你获得白鼬皮*1 兽肉*1】
&lt;&lt;/if&gt;&gt;
&lt;&lt;set $tmpprey to 0&gt;&gt;
&lt;br&gt;&lt;&lt;link ▷「继续」 $loc&gt;&gt;&lt;&lt;/link&gt;&gt;</tw-passagedata><tw-passagedata pid="53" name="得失" tags="widget nobr" position="500,100" size="100,100">&lt;&lt;widget &quot;itemobtain&quot;&gt;&gt;
&lt;span id=&quot;obtain&quot;&gt;✧ 你获得了_itemobtain &amp;nbsp;✧&lt;/span&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;buy&quot;&gt;&gt;
    &lt;&lt;set _item to _args[0]&gt;&gt;
    &lt;&lt;set _price to setup.item.get(_item) || 1&gt;&gt;
    &lt;p @data-item=&quot;_item&quot; class=&quot;buy-listing&quot;&gt;
        &lt;span&gt;_item&lt;/span&gt;
        &lt;span&gt;_price鸟羽&lt;/span&gt;  
        &lt;span class=&quot;buy-link&quot;&gt;
            &lt;&lt;capture _item, _amount, _price&gt;&gt;
                &lt;&lt;button &quot;购买&quot;&gt;&gt;
                    &lt;&lt;if $feather &lt; _price&gt;&gt;
                        &lt;&lt;run UI.alert(&quot;你的鸟羽不足&quot;)&gt;&gt;
                    &lt;&lt;else&gt;&gt;
                        &lt;&lt;set $feather -= _price&gt;&gt;&lt;&lt;redo&gt;&gt;
                        &lt;&lt;if Item.get(_item).hasTag(&quot;物品&quot;)&gt;&gt;&lt;&lt;pickup $item _item 1&gt;&gt;
                        &lt;&lt;elseif Item.get(_item).hasTag(&quot;食物&quot;)&gt;&gt;&lt;&lt;pickup $food _item 1&gt;&gt;&lt;&lt;/if&gt;&gt;
                    &lt;&lt;/if&gt;&gt;
                &lt;&lt;/button&gt;&gt;
            &lt;&lt;/capture&gt;&gt;
        &lt;/span&gt;
    &lt;/p&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;sellfish&quot;&gt;&gt;
    &lt;&lt;set _item to _args[0]&gt;&gt;
    &lt;&lt;set _amount to _args[1]&gt;&gt;
    &lt;&lt;set _price to setup.prices.get(_item) || 1&gt;&gt;
    &lt;p @data-item=&quot;_item&quot; class=&quot;sell-listing&quot;&gt;
        &lt;span&gt;◈_item      价格：_price鸟羽&lt;/span&gt;&lt;span class=&quot;count&quot;&gt;拥有：_amount&lt;/span&gt;
        &lt;span class=&quot;sell-link&quot;&gt;
            &lt;&lt;capture _item, _amount, _price&gt;&gt;
                &lt;&lt;button &quot;出售&quot;&gt;&gt;
                    &lt;&lt;set $feather to $feather+ _price&gt;&gt;&lt;&lt;redo&gt;&gt;&lt;&lt;drop $fish _item 1&gt;&gt;
                    &lt;&lt;set _amount --&gt;&gt;
                    &lt;&lt;if _amount &gt; 0&gt;&gt;
                        &lt;&lt;replace `&quot;p.sell-listing[data-item=\&quot;&quot; + _item + &quot;\&quot;] &gt; .count&quot;`&gt;&gt;拥有：_amount&lt;&lt;/replace&gt;&gt;
                    &lt;&lt;else&gt;&gt;
                        &lt;&lt;remove `&quot;p.sell-listing[data-item=\&quot;&quot; + _item + &quot;\&quot;]&quot;`&gt;&gt;
                    &lt;&lt;/if&gt;&gt;
                &lt;&lt;/button&gt;&gt;
            &lt;&lt;/capture&gt;&gt;
        &lt;/span&gt;
    &lt;/p&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;chopfish&quot;&gt;&gt;
    &lt;&lt;set _item to _args[0]&gt;&gt;
    &lt;&lt;set _amount to _args[1]&gt;&gt;
    &lt;&lt;set _price to setup.chop.get(_item) || 1&gt;&gt;
    &lt;p @data-item=&quot;_item&quot; class=&quot;sell-listing&quot;&gt;
        &lt;span&gt;◈_item    获得：_price鱼肉&lt;/span&gt; 
        &lt;span class=&quot;count&quot;&gt;拥有：_amount&lt;/span&gt;
        &lt;span class=&quot;sell-link&quot;&gt;
            &lt;&lt;capture _item, _amount, _price&gt;&gt;
                &lt;&lt;button &quot;剁鱼&quot;&gt;&gt;
                    &lt;&lt;set $chop to $chop+ _price&gt;&gt;&lt;&lt;pickup $food &quot;鱼肉&quot; $chop&gt;&gt;&lt;&lt;set $chop = 0&gt;&gt;&lt;&lt;drop $fish _item 1&gt;&gt;
                    &lt;&lt;set _amount --&gt;&gt;
                    &lt;&lt;if _amount &gt; 0&gt;&gt;
                        &lt;&lt;replace `&quot;p.sell-listing[data-item=\&quot;&quot; + _item + &quot;\&quot;] &gt; .count&quot;`&gt;&gt;拥有：_amount&lt;&lt;/replace&gt;&gt;
                    &lt;&lt;else&gt;&gt;
                        &lt;&lt;remove `&quot;p.sell-listing[data-item=\&quot;&quot; + _item + &quot;\&quot;]&quot;`&gt;&gt;
                    &lt;&lt;/if&gt;&gt;
                &lt;&lt;/button&gt;&gt;
            &lt;&lt;/capture&gt;&gt;
        &lt;/span&gt;
    &lt;/p&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;lessitem&quot;&gt;&gt;
&lt;&lt;run Dialog.setup(&quot;制作&quot;);Dialog.wiki(&quot;【你的材料不足】&quot;);Dialog.open();&gt;&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;lessfeather&quot;&gt;&gt;
&lt;&lt;run Dialog.setup(&quot;制作&quot;);Dialog.wiki(&quot;【你的鸟羽不足】&quot;);Dialog.open();&gt;&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;seed&quot;&gt;&gt;
&lt;&lt;set $minute += 15&gt;&gt;
&lt;&lt;set _itemn2 = setup.items[_itemn].name&gt;&gt;
&lt;&lt;if $choice == &quot;land1&quot;&gt;&gt;&lt;&lt;set $land1[0].name = _itemn2, $land1[0].stat = 1&gt;&gt;
&lt;&lt;set $needt1 = $nt + random(50,20000)&gt;&gt;

&lt;&lt;elseif $choice == &quot;land2&quot;&gt;&gt;&lt;&lt;set $land2[0].name = _itemn2, $land2[0].stat = 1&gt;&gt;
&lt;&lt;set $needm2 = $minute + random(20,120)&gt;&gt;
&lt;&lt;for $needm2 &gt;= 60&gt;&gt;&lt;&lt;if $needm2 &gt;= 60&gt;&gt;&lt;&lt;set $needm2 -= 60, $needh2 = $hour+1&gt;&gt;&lt;&lt;/if&gt;&gt;&lt;&lt;/for&gt;&gt;&lt;&lt;for $needh2 &gt;= 24&gt;&gt;&lt;&lt;if $needh2 &gt;= 24&gt;&gt;&lt;&lt;set $needh2 -= 24, $needd2 = $date+1&gt;&gt;&lt;&lt;/if&gt;&gt;&lt;&lt;/for&gt;&gt;

&lt;&lt;elseif $choice == &quot;land3&quot;&gt;&gt;&lt;&lt;set $land3[0].name = _itemn2, $land3[0].stat = 1&gt;&gt;
&lt;&lt;set $needm3 = $minute + random(20,120)&gt;&gt;
&lt;&lt;for $needm3 &gt;= 60&gt;&gt;&lt;&lt;if $needm3 &gt;= 60&gt;&gt;&lt;&lt;set $needm3 -= 60, $needh3 = $hour+1&gt;&gt;&lt;&lt;/if&gt;&gt;&lt;&lt;/for&gt;&gt;&lt;&lt;for $needh3 &gt;= 24&gt;&gt;&lt;&lt;if $needh3 &gt;= 24&gt;&gt;&lt;&lt;set $needh3 -= 24, $needd3 = $date+1&gt;&gt;&lt;&lt;/if&gt;&gt;&lt;&lt;/for&gt;&gt;

&lt;&lt;elseif $choice == &quot;land4&quot;&gt;&gt;&lt;&lt;set $land4[0].name = _itemn2, $land4[0].stat = 1&gt;&gt;
&lt;&lt;set $needm4 = $minute + random(20,120)&gt;&gt;
&lt;&lt;for $needm4 &gt;= 60&gt;&gt;&lt;&lt;if $needm4 &gt;= 60&gt;&gt;&lt;&lt;set $needm4 -= 60, $needh4 = $hour+1&gt;&gt;&lt;&lt;/if&gt;&gt;&lt;&lt;/for&gt;&gt;&lt;&lt;for $needh4 &gt;= 24&gt;&gt;&lt;&lt;if $needh4 &gt;= 24&gt;&gt;&lt;&lt;set $needh4 -= 24, $needd4 = $date+1&gt;&gt;&lt;&lt;/if&gt;&gt;&lt;&lt;/for&gt;&gt;

&lt;&lt;elseif $choice == &quot;land5&quot;&gt;&gt;&lt;&lt;set $land5[0].name = _itemn2, $land5[0].stat = 1&gt;&gt;
&lt;&lt;set $needm5 = $minute + random(20,120)&gt;&gt;
&lt;&lt;for $needm5 &gt;= 60&gt;&gt;&lt;&lt;if $needm5 &gt;= 60&gt;&gt;&lt;&lt;set $needm5 -= 60, $needh5 = $hour+1&gt;&gt;&lt;&lt;/if&gt;&gt;&lt;&lt;/for&gt;&gt;
&lt;&lt;elseif $choice == &quot;land6&quot;&gt;&gt;&lt;&lt;set $land6[0].name = _itemn2, $land6[0].stat = 1&gt;&gt;
&lt;&lt;set $needm6 = $minute + random(20,120)&gt;&gt;
&lt;&lt;for $needm6 &gt;= 60&gt;&gt;&lt;&lt;if $needm6 &gt;= 60&gt;&gt;&lt;&lt;set $needm6 -= 60, $needh6 = $hour+1&gt;&gt;&lt;&lt;/if&gt;&gt;&lt;&lt;/for&gt;&gt;&lt;&lt;/if&gt;&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;lost&quot;&gt;&gt;
&lt;&lt;set _s= random(1,5)&gt;&gt;

&lt;&lt;if _s ==1&gt;&gt;
&lt;&lt;set _num to $item.uniqueLength&gt;&gt;
&lt;&lt;for _i to random(0, _num)&gt;&gt;
&lt;&lt;set _itemn = $item.list[_i]&gt;&gt;
&lt;&lt;if Item.get(_itemn).hasTag(&quot;cantlose&quot;)&gt;&gt;&lt;&lt;else&gt;&gt;
&lt;&lt;drop $item _itemn 1&gt;&gt;&lt;&lt;pickup $nest _itemn 1&gt;&gt;
&lt;&lt;break&gt;&gt;&lt;&lt;/if&gt;&gt;&lt;&lt;/for&gt;&gt;

&lt;&lt;elseif  _s ==2&gt;&gt;
&lt;&lt;set _num to $food.uniqueLength&gt;&gt;
&lt;&lt;for _i to random(0, _num)&gt;&gt;
&lt;&lt;set _itemn = $food.list[_i]&gt;&gt;
&lt;&lt;if Item.get(_itemn).hasTag(&quot;cantlose&quot;)&gt;&gt;&lt;&lt;else&gt;&gt;
&lt;&lt;drop $food _itemn 1&gt;&gt;&lt;&lt;pickup $nest _itemn 1&gt;&gt;
&lt;&lt;break&gt;&gt;&lt;&lt;/if&gt;&gt;&lt;&lt;/for&gt;&gt;

&lt;&lt;elseif  _s ==3&gt;&gt;
&lt;&lt;set _num to $book.uniqueLength&gt;&gt;
&lt;&lt;for _i to random(0, _num)&gt;&gt;
&lt;&lt;set _itemn = $book.list[_i]&gt;&gt;
&lt;&lt;if Item.get(_itemn).hasTag(&quot;cantlose&quot;)&gt;&gt;&lt;&lt;else&gt;&gt;
&lt;&lt;drop $book _itemn 1&gt;&gt;&lt;&lt;pickup $nest _itemn 1&gt;&gt;
&lt;&lt;break&gt;&gt;&lt;&lt;/if&gt;&gt;&lt;&lt;/for&gt;&gt;

&lt;&lt;elseif  _s ==4&gt;&gt;
&lt;&lt;set _num to $prey.uniqueLength&gt;&gt;
&lt;&lt;for _i to random(0, _num)&gt;&gt;
&lt;&lt;set _itemn = $prey.list[_i]&gt;&gt;
&lt;&lt;if Item.get(_itemn).hasTag(&quot;cantlose&quot;)&gt;&gt;&lt;&lt;else&gt;&gt;
&lt;&lt;drop $prey _itemn 1&gt;&gt;&lt;&lt;pickup $nest _itemn 1&gt;&gt;
&lt;&lt;break&gt;&gt;&lt;&lt;/if&gt;&gt;&lt;&lt;/for&gt;&gt;
&lt;&lt;elseif  _s ==5&gt;&gt;

&lt;&lt;set _num to $fish.uniqueLength&gt;&gt;
&lt;&lt;for _i to random(0, _num)&gt;&gt;
&lt;&lt;set _itemn = $fish.list[_i]&gt;&gt;
&lt;&lt;if Item.get(_itemn).hasTag(&quot;cantlose&quot;)&gt;&gt;&lt;&lt;else&gt;&gt;
&lt;&lt;drop $fish _itemn 1&gt;&gt;&lt;&lt;pickup $nest _itemn 1&gt;&gt;
&lt;&lt;break&gt;&gt;&lt;&lt;/if&gt;&gt;&lt;&lt;/for&gt;&gt;

&lt;&lt;/if&gt;&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;lockedhouse&quot;&gt;&gt;
【你走到了一户&lt;&lt;set $housedes1= [&quot;干净整洁&quot;,&quot;小巧精致&quot;,&quot;风格简朴&quot;,&quot;门前堆满杂物&quot;,&quot;田地里作物茂盛&quot;,&quot;被鲜花簇拥&quot;].random()&gt;&gt;$housedes1的房屋前, 门在紧闭着, 屋里看起来&lt;&lt;set $housedes2= [&quot;非常安静&quot;,&quot;主人在家&quot;].random()&gt;&gt;$housedes2】&lt;br&gt;&lt;br&gt;
&lt;&lt;link ✧「搜寻四周」 偷窃&gt;&gt;&lt;&lt;set $choice to &quot;搜寻四周&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;br&gt;
&lt;&lt;link ✧「撬锁」 偷窃&gt;&gt;&lt;&lt;set $choice to &quot;撬锁&quot;, $stoleloc = &quot;居民的家&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;br&gt;
&lt;&lt;link ▷「离开」 小镇&gt;&gt;&lt;&lt;/link&gt;&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;cluecheck&quot;&gt;&gt;
&lt;&lt;for _i to 0; _i lt $clue.length;  _i++&gt;&gt;
&lt;&lt;if $clue[_i].name == _cluename &amp;&amp; $clue[_i].dscr == _cluedscr&gt;&gt;&lt;&lt;set _cluecheck =1&gt;&gt;
&lt;&lt;break&gt;&gt;&lt;&lt;/for&gt;&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;itemcheck&quot;&gt;&gt;
&lt;&lt;if _item == &quot;鸟羽&quot;&gt;&gt;&lt;&lt;set $feather +=_m&gt;&gt;&lt;&lt;replace &quot;#feather&quot;&gt;&gt;&lt;&lt;= $feather&gt;&gt;&lt;&lt;/replace&gt;&gt;
&lt;&lt;elseif Item.get(_item).hasTag(&quot;物品&quot;)&gt;&gt;&lt;&lt;pickup $item _item _n&gt;&gt;
&lt;&lt;elseif Item.get(_item).hasTag(&quot;食物&quot;)&gt;&gt;&lt;&lt;pickup $food _item _n&gt;&gt;
&lt;&lt;elseif Item.get(_item).hasTag(&quot;书籍&quot;)&gt;&gt;&lt;&lt;pickup $book _item _n&gt;&gt;
&lt;&lt;elseif Item.get(_item).hasTag(&quot;猎物&quot;)&gt;&gt;&lt;&lt;pickup $prey _item _n&gt;&gt;
&lt;&lt;elseif Item.get(_item).hasTag(&quot;渔获&quot;)&gt;&gt;&lt;&lt;pickup $fish _item _n&gt;&gt;
&lt;&lt;/if&gt;&gt;&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;stoleall&quot;&gt;&gt;
&lt;&lt;set _q to random(1,100)&gt;&gt;
&lt;&lt;if _q &lt;= 48&gt;&gt;你找到了一些价值_m的鸟羽&lt;&lt;set _item = &quot;鸟羽&quot;&gt;&gt;
&lt;&lt;elseif _q &lt;= 66&gt;&gt;你找到了几瓶未开封的柿子酒&lt;&lt;set _item = &quot;柿子酒&quot;&gt;&gt;
&lt;&lt;else&gt;&gt;你找到了一些空瓶子&lt;&lt;set _item = &quot;玻璃瓶&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;&lt;&lt;/widget&gt;&gt;</tw-passagedata><tw-passagedata pid="54" name="成就" tags="" position="1800,200" size="100,100">&lt;&lt;achievementspopup&gt;&gt;</tw-passagedata><tw-passagedata pid="55" name="打工" tags="nobr" position="1100,400" size="100,100">&lt;&lt;set _s to random(1,8)&gt;&gt;&lt;&lt;set _m to random(5,15)&gt;&gt;&lt;&lt;set _n to random(8,20)&gt;&gt;
&lt;&lt;if $HP lt 8&gt;&gt;【你感到些许疲惫, 做事情力不从心. 你最好去吃点东西休息一下, 充足的睡眠没有坏处】&lt;br&gt;&lt;br&gt;
&lt;&lt;link ▷「返回」 $loc&gt;&gt;&lt;&lt;/link&gt;&gt;

&lt;&lt;elseif $gzcs == 0 &amp;&amp; $loc == &quot;拓荒者木屋&quot;&gt;&gt;【今天已经做了很多事了】&lt;br&gt;&lt;br&gt;
&lt;&lt;link ▷「返回」 $loc&gt;&gt;&lt;&lt;/link&gt;&gt;

&lt;&lt;elseif $dgcs == 0&gt;&gt;【今天已经做了很多事了】&lt;br&gt;&lt;br&gt;
&lt;&lt;link ▷「返回」 $loc&gt;&gt;&lt;&lt;/link&gt;&gt;

&lt;&lt;elseif $choice == &quot;打扫小路&quot;&gt;&gt;&lt;&lt;set $gzcs -= 1&gt;&gt;&lt;&lt;set $HP to $HP- 3&gt;&gt;【你在木屋里找到扫帚, 开始清理起门口的小路. &lt;&lt;set _rpe = [&quot;【一旁的无花果树时不时飘落几片树叶, 似乎很不给你面子】&quot;,&quot;【几只乌鸦沉默地飞过, 只留下了振翅声】&quot;,&quot;几个面生的猫绕过正在打扫的你, 敲响了木屋的门】&quot;].random()&gt;&gt;_rpe
&lt;br&gt;&lt;br&gt;&lt;&lt;link ▷「返回」 拓荒者木屋&gt;&gt;&lt;&lt;/link&gt;&gt;

&lt;&lt;elseif $choice == &quot;遛seisi&quot;&gt;&gt;&lt;&lt;set $gzcs -= 1&gt;&gt;&lt;&lt;set $HP to $HP- 6&gt;&gt;【你在&lt;&lt;set _rpe1 = [&quot;壁炉上&quot;,&quot;藤椅上&quot;,&quot;鸟窝里&quot;].random()&gt;&gt;_rpe1找到&lt;&lt;set _rpe2 = [&quot;还在打盹&quot;,&quot;在玩玻璃珠&quot;,&quot;撕咬肉干&quot;].random()&gt;&gt;_rpe2的Seisi, 祂看起来&lt;&lt;set _rpe3 = [&quot;并不愿意跟你出门&quot;,&quot;更想待在木屋里&quot;,&quot;能把你整个吞掉&quot;].random()&gt;&gt;_rpe3. 而当你终于说服祂走出木屋后, &lt;&lt;set _rpe4 = [&quot;祂趴在你的头顶度过了一整个散步环节&quot;,&quot;祂一出门就飞得不见踪影. 你四处寻找无果, 只能再次回到木屋, 却看见Seisi站在门口的无花果树枝上取笑你&quot;,&quot;Seisi时不时用爪子和尖喙殴打你以表达自己的不满&quot;].random()&gt;&gt;_rpe4. 真是愉快的一天】
&lt;br&gt;&lt;br&gt;&lt;&lt;link ▷「返回」 拓荒者木屋&gt;&gt;&lt;&lt;/link&gt;&gt;

&lt;&lt;elseif $loc == &quot;拓荒者木屋&quot;&gt;&gt;
&lt;&lt;if _s &lt;= 3&gt;&gt;【Nix安排你去打扫木屋外的小路. 每天都会有不少岛民经过这里, 小路的整洁美观是不可忽视的】
&lt;br&gt;&lt;br&gt;&lt;&lt;link ✧打扫小路 打工&gt;&gt;&lt;&lt;set $choice to &quot;打扫小路&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;

&lt;&lt;elseif _s &lt;= 6&gt;&gt;【Nix拜托你去照顾高地另一头的花田. 你从木屋门口拿上园艺工具就出门了】
&lt;br&gt;&lt;br&gt;&lt;&lt;link ✧去花田 花田&gt;&gt;&lt;&lt;set $choice to &quot;浇花&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;

&lt;&lt;elseif _s &lt;= 8&gt;&gt;【Nix拜托你帮她带Seisi出门透透气, 一些户外活动对祂没有坏处】
&lt;br&gt;&lt;br&gt;&lt;&lt;link ✧带Seisi出门 打工&gt;&gt;&lt;&lt;set $choice to &quot;遛seisi&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;&lt;/if&gt;&gt;

&lt;&lt;elseif $loc == &quot;咖啡馆&quot;&gt;&gt;
&lt;&lt;set $dgcs -= 1, $HP -=8&gt;&gt;&lt;&lt;set $hour to $hour+ 1&gt;&gt;&lt;&lt;set _rpe = [&quot;【你在老板娘的安排下打磨起了咖啡】&quot;,&quot;【你拿起点餐单, 准备好向顾客推荐店里的招牌点心了】&quot;].random()&gt;&gt;_rpe
&lt;br&gt;&lt;br&gt;
&lt;&lt;timed 3s&gt;&gt;&lt;&lt;set _t to random(15,40)&gt;&gt;&lt;&lt;set _r to setup.getStat(&quot;strength&quot;)*_t/10&gt;&gt;&lt;&lt;set _a to setup.getStat(&quot;strength&quot;)/_r*100&gt;&gt;&lt;&lt;set _b to _a/6&gt;&gt;&lt;&lt;checkWidget&gt;&gt;
&lt;br&gt;&lt;br&gt;
&lt;&lt;if _rst == &quot;大成功&quot;&gt;&gt;【你出色的完成了在咖啡馆的打工】&lt;br&gt;
&lt;&lt;set $feather to $feather+ _n&gt;&gt;&lt;&lt;set $strengthexp to $strengthexp+ 1&gt;&gt;&lt;&lt;addsexpWidget&gt;&gt;
【你获得_n枚鸟羽】&lt;&lt;redo&gt;&gt;
&lt;&lt;elseif _rst == &quot;大失败&quot;&gt;&gt;【你在工作的时候出于疏忽, 打碎了一个咖啡杯. 老板娘叹着气说你的工资只能拿来赔偿了】
&lt;&lt;else&gt;&gt;【你顺利完成了在咖啡店的打工】&lt;br&gt;
&lt;&lt;set $feather to $feather+ _m&gt;&gt;
【你获得_m枚鸟羽】&lt;&lt;redo&gt;&gt;&lt;&lt;/if&gt;&gt;
&lt;br&gt;&lt;br&gt;
&lt;&lt;link ▷「返回」 咖啡馆&gt;&gt;&lt;&lt;if $msstat == &quot;新的开始2&quot; &amp;&amp; $feather &gt;= 200&gt;&gt;&lt;&lt;set $msstat = &quot;新的开始3&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;&lt;/timed&gt;&gt;

&lt;&lt;elseif $loc == &quot;酒馆&quot;&gt;&gt;
&lt;&lt;audio &quot;整理杯子&quot; play&gt;&gt;
&lt;&lt;set $dgcs -= 1, $HP -=8&gt;&gt;&lt;&lt;set $hour to $hour+ 1&gt;&gt;&lt;&lt;set _rpe = [&quot;【琥珀夫人微笑着委托给你洗餐具的工作】&quot;,&quot;【琥珀夫人微笑着委托给你上餐的工作】&quot;,&quot;【琥珀夫人微笑着委托给你打扫酒馆的工作】&quot;].random()&gt;&gt;_rpe
&lt;br&gt;&lt;br&gt;
&lt;&lt;timed 2s t8n&gt;&gt;&lt;&lt;audio &quot;diceroll&quot; play&gt;&gt;&lt;&lt;set _t to random(15,40)&gt;&gt;&lt;&lt;set _r to setup.getStat(&quot;strength&quot;)*_t/10&gt;&gt;&lt;&lt;set _a to setup.getStat(&quot;strength&quot;)/_r*100&gt;&gt;&lt;&lt;set _b to _a/6&gt;&gt;&lt;&lt;checkWidget&gt;&gt;&lt;&lt;/timed&gt;&gt;
&lt;&lt;timed 3s t8n&gt;&gt;&lt;&lt;if _rst == &quot;大成功&quot;&gt;&gt;【你出色的完成了在酒馆的打工】&lt;br&gt;
&lt;&lt;set $feather to $feather+ _n&gt;&gt;&lt;&lt;set $strengthexp to $strengthexp+ 1&gt;&gt;&lt;&lt;addsexpWidget&gt;&gt;
&lt;font color=#4E84BA&gt;✧你获得_n枚鸟羽✧&lt;/font&gt;&lt;&lt;redo&gt;&gt;
&lt;&lt;elseif _rst == &quot;成功&quot;&gt;&gt;【你顺利完成了在酒馆的打工】&lt;br&gt;
&lt;&lt;set $feather to $feather+ _m&gt;&gt;
&lt;font color=#4E84BA&gt;✧你获得_m枚鸟羽✧&lt;/font&gt;&lt;&lt;redo&gt;&gt;
&lt;&lt;else&gt;&gt;&lt;&lt;audio &quot;整理杯子&quot; stop&gt;&gt;&lt;&lt;audio &quot;摔碎杯子&quot; play&gt;&gt;【你在工作的时候出于疏忽, 打碎了一个酒瓶. 琥珀夫人看上去有些生气了】&lt;&lt;/if&gt;&gt;&lt;&lt;/timed&gt;&gt;
&lt;br&gt;&lt;br&gt;
&lt;&lt;timed 4s t8n&gt;&gt;&lt;&lt;link ▷「返回」 酒馆&gt;&gt;&lt;&lt;if $msstat == &quot;新的开始2&quot; &amp;&amp; $feather &gt;= 200&gt;&gt;&lt;&lt;set $msstat = &quot;新的开始3&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;&lt;/timed&gt;&gt;

&lt;&lt;elseif $loc == &quot;花店&quot;&gt;&gt;&lt;&lt;set $dgcs -= 1&gt;&gt;&lt;&lt;set $hour to $hour+ 1&gt;&gt;&lt;&lt;set _rpe = [&quot;【你在Nix的指导下尝试着给生长中的幼苗换花盆】&quot;,&quot;【你拿起了清扫工具, 开始清理店里的泥土】&quot;,&quot;【你拿出喷壶和花园铲, 开始给店里的盆栽浇水松土】&quot;].random()&gt;&gt;_rpe

&lt;&lt;timed 3s&gt;&gt;&lt;&lt;set _t to random(15,40)&gt;&gt;&lt;&lt;set _r to setup.getStat(&quot;strength&quot;)*_t/10&gt;&gt;&lt;&lt;set _a to setup.getStat(&quot;strength&quot;)/_r*100&gt;&gt;&lt;&lt;set _b to _a/6&gt;&gt;&lt;&lt;checkWidget&gt;&gt;&lt;&lt;if _rst == &quot;大成功&quot;&gt;&gt;【你出色的完成了在花店的工作, 花儿们在你的照料下看起来更鲜嫩了】
&lt;&lt;set $feather to $feather+ _n&gt;&gt;&lt;&lt;set $strengthexp to $strengthexp+ 1&gt;&gt;&lt;&lt;addsexpWidget&gt;&gt;
&lt;font color=#4E84BA&gt;✧你获得_n枚鸟羽✧&lt;/font&gt;&lt;&lt;redo&gt;&gt;
&lt;&lt;elseif _rst == &quot;成功&quot;&gt;&gt;【你顺利完成了在花店的工作, 花儿们看起来精神了不少】
&lt;&lt;set $feather to $feather+ _m&gt;&gt;
&lt;font color=#4E84BA&gt;✧你获得_m枚鸟羽✧&lt;/font&gt;&lt;&lt;redo&gt;&gt;
&lt;&lt;else&gt;&gt;【你在工作的时候出于疏忽, 折断了一些枝叶. Nix安慰你说, 植物的生命还要更顽强】&lt;&lt;/if&gt;&gt;

&lt;&lt;link ▷「返回」 花店&gt;&gt;&lt;&lt;if $msstat == &quot;新的开始2&quot; &amp;&amp; $feather &gt;= 200&gt;&gt;&lt;&lt;set $msstat = &quot;新的开始3&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;&lt;/timed&gt;&gt;

&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="56" name="打猎" tags="nobr" position="1000,200" size="100,100">&lt;&lt;if $toolSlot != &quot;猎枪&quot;&gt;&gt;【你没有装备上衬手的打猎武器, 去猎户小屋看看吧】&lt;br&gt;&lt;br&gt;
&lt;&lt;link ▷「离开」 $loc&gt;&gt;&lt;&lt;/link&gt;&gt;
&lt;&lt;elseif $HP lt 2&gt;&gt;【你感到些许疲惫, 做事情力不从心. 你最好去吃点东西休息一下, 充足的睡眠没有坏处】&lt;br&gt;&lt;br&gt;
&lt;&lt;link ▷「离开」 $loc&gt;&gt;&lt;&lt;/link&gt;&gt;
&lt;&lt;elseif $item.count(&#39;火药&#39;) &lt;= 0&gt;&gt;【你的枪膛空空如也, 去猎户小屋看看吧】&lt;br&gt;&lt;br&gt;
&lt;&lt;link ▷「离开」 $loc&gt;&gt;&lt;&lt;/link&gt;&gt;
&lt;&lt;else&gt;&gt;
&lt;&lt;set $HP to $HP- 3&gt;&gt;&lt;&lt;drop $item &quot;火药&quot; 1&gt;&gt;&lt;&lt;set _s to random(1,12)&gt;&gt;【你在$loc寻着猎物】&lt;br&gt;&lt;br&gt;
&lt;&lt;timed 2s t8n&gt;&gt;&lt;&lt;if _s ==12&gt;&gt;【在你目光所及之处没有一只活物. 也许下次会更幸运些】&lt;br&gt;&lt;br&gt;

&lt;&lt;else&gt;&gt;&lt;&lt;prey&gt;&gt;&lt;br&gt;
&lt;&lt;link ▷「开枪」 开枪&gt;&gt;&lt;&lt;/link&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;br&gt;
&lt;&lt;link ▷「离开」 $loc&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;&lt;/timed&gt;&gt;
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="57" name="找个座位" tags="nobr" position="1100,300" size="100,100">&lt;&lt;set _s to random(1,100)&gt;&gt;
&lt;&lt;if $loc == &quot;酒馆&quot;&gt;&gt;
&lt;&lt;if $jofirstc !=1 &amp;&amp; $joloc == &quot;酒馆&quot;&gt;&gt;&lt;&lt;set $npc to &quot;琼&quot;&gt;&gt;&lt;&lt;goto &quot;交谈&quot;&gt;&gt;
&lt;&lt;elseif _s &lt;= 40 &amp;&amp; !$conifirstc&gt;&gt;
&lt;&lt;set $conifirstc to 1&gt;&gt;【你还没来得及坐稳,  一只毛发凌乱的灰猫不知道从哪个角落出现, 就要爬上你的木桌. 你认出来了他, 这是一直在岛上无业的流浪猫, 你记得他们称他为Coni. 你想赶在彻底扫兴之前换一处座位, Coni却抓住你的肩膀, 用因饮酒过度而嘶哑的嗓音对你低吼着:&quot;酒, 布尔盖酒, 你有吗... &quot;醉汉的话语酒气熏天, 而你也从未在岛上见到过什么布尔盖酒】&lt;br&gt;&lt;br&gt;
 ⋙⋙⋙⋙⋙⋙⋘⋘⋘⋘⋘⋘&lt;br&gt;
&lt;&lt;link ▷「推开」 初见对话&gt;&gt;&lt;&lt;set $choice to &quot;推开&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;br&gt;
&lt;&lt;link ▷「询问布尔盖酒」 初见对话&gt;&gt;&lt;&lt;set $choice to &quot;询问布尔盖酒&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;
&lt;&lt;else&gt;&gt;
【你在吧台找了个座位坐下, 酒馆里还有不少猫在喝酒, 其中有一些你熟悉的身影】
&lt;br&gt;
&lt;&lt;NPCloc&gt;&gt;&lt;&lt;/if&gt;&gt;
&lt;&lt;elseif $loc == &quot;教堂&quot;&gt;&gt;【你在教堂里找了个座位坐下】
&lt;&lt;if $hour &lt;= 11 &amp;&amp; $minute &lt;= 40 &amp;&amp; $week == 7&gt;&gt;
没写
&lt;&lt;/if&gt;&gt;

&lt;&lt;/if&gt;&gt;
&lt;&lt;link ▷「离开」 $loc&gt;&gt;&lt;&lt;/link&gt;&gt;</tw-passagedata><tw-passagedata pid="58" name="拓荒者木屋" tags="nobr" position="300,300" size="100,100">&lt;&lt;set $loc = &quot;拓荒者木屋&quot;&gt;&gt;&lt;&lt;timeWidget&gt;&gt;&lt;&lt;set $minute to $minute+ random(5,10)&gt;&gt;&lt;&lt;if $choice == &quot;打扫小路&quot; || $choice == &quot;浇花&quot; || $choice == &quot;遛seisi&quot; || $choice == &quot;送货&quot;&gt;&gt;等你回到木屋, Nix已经准备好了你的报酬&lt;br&gt;
&lt;&lt;set _m to random(1,25)&gt;&gt;&lt;&lt;set _n to random(5,15)&gt;&gt;
&lt;&lt;if _m &lt;= 14&gt;&gt;&lt;font color=#4E84BA&gt;✧你获得了_n枚鸟羽✧&lt;/font&gt;&lt;&lt;set $feather += _n&gt;&gt;&lt;&lt;redo&gt;&gt;&lt;&lt;if $msstat == &quot;新的开始2&quot; &amp;&amp; $feather &gt;= 200&gt;&gt;&lt;&lt;set $msstat = &quot;新的开始3&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;
&lt;&lt;elseif _m &lt;=22&gt;&gt;&lt;&lt;set _a = [&quot;鲜花饼&quot;,&quot;浆果馅饼&quot;,&quot;红茶&quot;].random()&gt;&gt;&lt;font color=#4E84BA&gt;✧你获得了_a * 1✧&lt;/font&gt;&lt;&lt;pickup $food _a 1&gt;&gt;
&lt;&lt;else&gt;&gt;&lt;font color=#4E84BA&gt;✧你获得了红玫瑰 * 1✧&lt;/font&gt;&lt;&lt;pickup $item &quot;红玫瑰&quot; 1&gt;&gt;&lt;&lt;/if&gt;&gt;&lt;&lt;set $choice to 0&gt;&gt;&lt;br&gt;&lt;br&gt;&lt;&lt;link ▷「继续」 拓荒者木屋&gt;&gt;&lt;&lt;/link&gt;&gt;

&lt;&lt;else&gt;&gt;
&lt;&lt;audio &quot;mainBGM&quot; unmute&gt;&gt;

&lt;img src=&quot;https://f2.toyhou.se/file/f2-toyhou-se/images/87543090_MgvNmETrLnnkikY.jpg&quot; width=100% class=&quot;pic&quot;&gt;
//&quot;这里原本是当年第一批到来者初登岛时临时搭建的一间小木屋, 由于远离水源, 在小镇建成后便成了储物室. 你可以把这里看做一个路标, 一个歇脚处, 木屋随时欢迎你的拜访, 但就目前来说, 她同时还是我的家, 我会在这里迎接每一个登岛的居民. &quot;//
&lt;br&gt;
&lt;&lt;NPCloc&gt;&gt;
&lt;br&gt;要进木屋看看吗?&lt;br&gt;
&lt;&lt;link ✧「敲门」 木屋内部&gt;&gt;&lt;&lt;audio &quot;轻敲门&quot; play&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;br&gt;
&lt;br&gt;地点活动&lt;br&gt;
&lt;&lt;if $lostsheep[0] == 1&gt;&gt;[[✧「找羊」|era互动]]&lt;br&gt;&lt;&lt;/if&gt;&gt;
[[✧「采摘无花果」|地点活动]]&lt;br&gt;
&lt;br&gt;前往其他地点&lt;br&gt;
[[✧「花田」|花田]]&lt;br&gt;
[[♢「高地」|高地]]&lt;br&gt;
[[♢「秋毛岗」|秋毛岗]]&lt;br&gt;
[[♢「贝雷河」|贝雷河]]&lt;br&gt;
[[♢「主港口」|主港口]]


&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="59" name="描述" tags="nobr" position="700,0" size="100,100">/***花***/
&lt;&lt;set setup.items[&#39;蒲公英种子&#39;] to {name: &#39;蒲公英&#39;}&gt;&gt;
&lt;&lt;set setup.items[&#39;玫瑰花种子&#39;] to {name: &#39;玫瑰花&#39;}&gt;&gt;
&lt;&lt;set setup.items[&#39;向日葵种子&#39;] to {name: &#39;向日葵&#39;}&gt;&gt;
&lt;&lt;set setup.items[&#39;勿忘我种子&#39;] to {name: &#39;勿忘我&#39;}&gt;&gt;
&lt;&lt;set setup.items[&#39;鸢尾花种子&#39;] to {name: &#39;鸢尾花&#39;}&gt;&gt;
&lt;&lt;set setup.items[&#39;附子花种子&#39;] to {name: &#39;附子花&#39;}&gt;&gt;
&lt;&lt;set setup.items[&#39;紫罗兰种子&#39;] to {name: &#39;紫罗兰&#39;}&gt;&gt;
&lt;&lt;set setup.items[&#39;金盏花种子&#39;] to {name: &#39;金盏花&#39;}&gt;&gt;
&lt;&lt;set setup.items[&#39;土豆种子&#39;] to {name: &#39;土豆&#39;}&gt;&gt;
&lt;&lt;set setup.items[&#39;洋葱种子&#39;] to {name: &#39;洋葱&#39;}&gt;&gt;
&lt;&lt;set setup.items[&#39;胡萝卜种子&#39;] to {name: &#39;胡萝卜&#39;}&gt;&gt;
&lt;&lt;set setup.items[&#39;玉米种子&#39;] to {name: &#39;玉米&#39;}&gt;&gt;
&lt;&lt;set setup.items[&#39;甜菜种子&#39;] to {name: &#39;甜菜&#39;}&gt;&gt;
&lt;&lt;set setup.items[&#39;辣椒种子&#39;] to {name: &#39;辣椒&#39;}&gt;&gt;
&lt;&lt;set setup.items[&#39;番茄种子&#39;] to {name: &#39;番茄&#39;}&gt;&gt;

/*装备*/
&lt;&lt;set setup.items[&#39;无&#39;] to {name: &#39;无&#39;,
    description: &#39;//无, 没有, 不//&#39;,
       function: &#39;&#39;
}&gt;&gt;
&lt;&lt;set setup.items[&#39;鱼竿&#39;] to {name: &#39;鱼竿&#39;,
    description: &#39;简易的自制鱼竿，能看出制作者手法熟练&#39;,
    function: &#39;观察+1 可进行//钓鱼//&#39;
}&gt;&gt;
&lt;&lt;set setup.items[&#39;玫瑰花环&#39;] to {name: &#39;玫瑰花环&#39;,
    description: &#39;盛开的玫瑰花制成的花环, 佩戴时要小心她们的棘刺&#39;,
    function: &#39;观察+1 享乐+1&#39;
}&gt;&gt;
&lt;&lt;set setup.items[&#39;皮革手套&#39;] to {name: &#39;皮革手套&#39;,
    description: &#39;皮质的手套, 保护你在工作时候不受伤&#39;,
    function: &#39;力量+2&#39;
}&gt;&gt;
&lt;&lt;set setup.items[&#39;毛皮大衣&#39;] to {name: &#39;毛皮大衣&#39;,
    description: &#39;动物皮毛制成的大衣, 防水防寒&#39;,
    function: &#39;力量+2 话术+1 观察-1&#39;
}&gt;&gt;
&lt;&lt;set setup.items[&#39;貂皮大衣&#39;] to {name: &#39;貂皮大衣&#39;,
    description: &#39;野生水貂皮制成的毛皮大衣, 有着世间最奢侈的触感, 可以在外面的世界买个好价钱&#39;,
    function: &#39;话术+2 观察+1&#39;
}&gt;&gt;
&lt;&lt;set setup.items[&#39;羊毛围巾&#39;] to {name: &#39;羊毛围巾&#39;,
    description: &#39;普通的围巾, 只是...充满羊味&#39;,
    function: &#39;学识+1 噩梦-1&#39;
}&gt;&gt;
&lt;&lt;set setup.items[&#39;猎枪&#39;] to {name: &#39;猎枪&#39;,
    description: &#39;当下最常见的型号, 足以射杀中小型猎物&#39;,
    function: &#39;力量+1&amp;emsp;可进行//打猎//&#39;
}&gt;&gt;
&lt;&lt;set setup.items[&#39;星夜晚礼服&#39;] to {name: &#39;星夜晚礼服&#39;,
    description: &#39;仿佛有群星流淌&#39;,
    function: &#39;话术+4 自信+4 享乐+2&#39;
}&gt;&gt;
&lt;&lt;set setup.items[&#39;关节指环&#39;] to {name: &#39;关节指环&#39;,
    description: &#39;做工精致的手部装饰品，金属的指套可以将手指包裹而不失美感，镂空与花纹也彰显着完美主义者的执着，关节处的弹簧互相衔接着，最后来到腕部皮质的手环，相互嵌套，将武器与饰品完美融合&#39;,
    function: &#39;力量+2 观察+2&#39;
}&gt;&gt;
&lt;&lt;set setup.items[&#39;蛇骷戒指&#39;] to {name: &#39;蛇骷戒指&#39;,
    description: &#39;由拉浮闪石锻造成的戒指, 按原任所有者的要求做成了猫族头骨与两根交叉骨的样式, 一条毒蛇盘绕其中, 内部刻着 &quot;Memento Mori&quot;&#39;,
    function: &#39;学识+6 观察+6 噩梦+3 无情+3 可有效防止//图拉特//的接近&#39;
}&gt;&gt;
&lt;&lt;set setup.items[&#39;贝壳项链&#39;] to {name: &#39;贝壳项链&#39;,
    description: &#39;海边贝壳串成的项链, 简单的美丽!&#39;,
    function: &#39;话术+1&#39;}&gt;&gt;
&lt;&lt;set setup.items[&#39;短镰&#39;] to {name: &#39;短镰&#39;,
    description: &#39;Nix干活时用的短柄镰刀, 收割作物最称手的工具, 镰刃上的划痕看上去仿佛经历过几场战争&#39;,
    function: &#39;力量+8 嗜血+4&#39;}&gt;&gt;
    
&lt;&lt;set setup.items[&#39;拥抱之盔&#39;] to {name: &#39;拥抱之盔&#39;,
    description: &#39;&quot;Glittering worm, thy hissing was great, And hard didst show thy heart; But hatred more | have the sons of men For him who owns the helm.&quot;&#39;}&gt;&gt;
&lt;&lt;set setup.items[&#39;雷鸣腰带&#39;] to {name: &#39;雷鸣腰带&#39;,
    description: &#39;质地粗糙的皮质腰带，其上雕刻的暗纹精美到甚至不能够出自任何最了不起的工匠之手. 但无论怎么摆弄, 似乎都没有雷电&#39;}&gt;&gt;
&lt;&lt;set setup.items[&#39;七里靴&#39;] to {name: &#39;七里靴&#39;,
    description: &#39;他们说，穿上它你就能一步走出七里，实践精神告诉你，这些人只是想看到你穿着这双笨重的靴子出糗&#39;}&gt;&gt;
&lt;&lt;set setup.items[&#39;红虎皮衣&#39;] to {name: &#39;红虎皮衣&#39;,
    description: &#39;也许它曾经有过如同名字一样艳丽的色彩，但如今它暗淡且肮脏，散发出令人不安的腐败气味. 很难想象有谁真的愿意穿上它&#39;}&gt;&gt;
&lt;&lt;set setup.items[&#39;宝石镜&#39;] to {name: &#39;宝石镜&#39;,
    description: &#39;镶嵌着宝石的铜镜. 也许你不该拥有它&#39;}&gt;&gt;
&lt;&lt;set setup.items[&#39;女仆制服&#39;] to {name: &#39;女仆制服&#39;,
    description: &#39;这不是一名自由的永无乡居民该穿的东西, 他们会忽视你, 但不会尊重你&#39;,
    function: &#39;观察+3 话术-1&#39;}&gt;&gt;
&lt;&lt;set setup.items[&#39;朴素的连衣裙&#39;] to {name: &#39;朴素的连衣裙&#39;,
    description: &#39;没人会想多看一眼这些廉价布料上顶着的是谁的面孔&#39;}&gt;&gt;
&lt;&lt;set setup.items[&#39;贝雷帽&#39;] to {name: &#39;贝雷帽&#39;,
    description: &#39;坚硬的帽檐紧抓着你的脑袋. 你并没有觉得有知识从里面长出来&#39;}&gt;&gt;
&lt;&lt;set setup.items[&#39;船长帽&#39;] to {name: &#39;船长帽&#39;,
    description: &#39;传统的皮质三角船长帽. 别让Era看到你戴着它&#39;}&gt;&gt;
&lt;&lt;set setup.items[&#39;羽毛帽&#39;] to {name: &#39;羽毛帽&#39;,
    description: &#39;用不下十根野鸟的尾羽制成, 你看上去就像一个滑稽的怪鸟&#39;}&gt;&gt;
&lt;&lt;set setup.items[&#39;草帽&#39;] to {name: &#39;草帽&#39;,
    description: &#39;简单，实用，永不过时&#39;}&gt;&gt;
    
    
//随机文案
&lt;&lt;set setup.items[&#39;永无乡&#39;] to {name: &#39;永无乡&#39;,
    description: &#39;&lt;&lt;set $textm= [&quot;漂浮在地中海某处的小岛，终年气候温和&lt;br&gt;永无乡欢迎所有人的到来&quot;,&quot;在这座被玫瑰和蜡烛环绕的小岛上, 花朵们似乎永不枯萎&quot;].random()&gt;&gt;$textm&#39;
}&gt;&gt;
&lt;&lt;set setup.items[&#39;雪&#39;] to {name: &#39;雪&#39;,
    description: &#39;“雪? 永无乡上只有一种雪, 至于你想的那种, 真是抱歉, 永无乡上没有冬天. ”&#39;
}&gt;&gt;
&lt;&lt;set setup.items[&#39;龙裔&#39;] to {name: &#39;龙裔&#39;,
    description: &#39;拥有魔法血统的猫族, 称为龙裔(Dragus), 这类特殊血脉的猫族并非自然存在, 而是来自后天制作, 本质上是对基因的附魔, 因此不被巫师社会承认为一支独立民族. 龙裔拥有与生俱来的魔法天赋, 即施展一种特定的能力, 他们在施展天赋时无需咒语, 仅通过意念便能完成施法, 在此之外, 龙裔对魔法整体的掌握和使用要比普通猫族轻松, 且只有龙裔才能使用拉浮闪石制成的物品而不被侵蚀&#39;
}&gt;&gt;
&lt;&lt;set setup.items[&#39;巫师&#39;] to {name: &#39;巫师&#39;,
    description: &#39;使用魔法的猫族, 不以民族或国家相称, 历史上因为多方面利益冲突问题, 成为了遭受排挤和压迫的一类群体, 至今仍是需要隐藏身份以进行正常社会活动. 巫师内部为了自救发展出了多个组织和团体, 其中漆冬合议会是存在时间最久、包容性最强的巫师组织&#39;
}&gt;&gt;
&lt;&lt;set setup.items[&#39;猫族&#39;] to {name: &#39;猫族&#39;,
    description: &#39;猫族, 猫兽人, 总称Feline, 世界观内凡间的主要智慧生物, 等同现实世界的人类, 以现实人类的种族命名, 不以现实猫品种称呼. 习性上不存在现实猫科的大部分特征, 外型上有现实世界中猫亚科里一些中小型猫, 有猫属、豹猫属、虎猫属、纹猫属、薮猫、狞猫、兔狲, 体型近似于人类, 以猫属为标准, 缩小了不同属之间的体型差比例&#39;
}&gt;&gt;
&lt;&lt;set setup.items[&#39;月亮&#39;] to {name: &#39;月亮&#39;,
    description: &#39;&lt;&lt;set $textm= [&quot;“是的，它碎掉了，我还没瞎. 都这么些年了，你又不是第一次看到，别像个小崽子一样大惊小怪，况且这样对这里一点影响都没有, 有什么可担心的. ”&quot;,&quot;月亮在四年前的战争中碎裂了四分之一，碎片至今仍漂浮在太空中，却不知为何对地球毫无影响&quot;].random()&gt;&gt;$textm&#39;
}&gt;&gt;
&lt;&lt;set setup.items[&#39;骨头&#39;] to {name: &#39;骨头&#39;,
    description: &#39;“在我这里就是些食物残渣. 但我知道有谁出高价买这些玩意儿, 尤其是那些稀罕来历的. ”&#39;
}&gt;&gt;
&lt;&lt;set setup.items[&#39;沃土&#39;] to {name: &#39;沃土&#39;,
    description: &#39;“那里是我们的家, 或者本该是, 直到上帝带着祂那群乳臭未干的羽毛崽子把祂造的法则贴满了砖头. 沃土最不需要的就是统治者. 但即使现在上帝不在了, 我们也没法回家, 改写法则可需要一笔不小的代价. ”&#39;
}&gt;&gt;
&lt;&lt;set setup.items[&#39;蠕虫&#39;] to {name: &#39;蠕虫&#39;,
    description: &#39;//“阴魂不散的玩意, 牠们是真正的邪恶, 地狱, 魔鬼! 你要跟这东西扯上关系, 我会第一时间飞去解决你. ”//&#39;
}&gt;&gt;
&lt;&lt;set setup.items[&#39;花店&#39;] to {name: &#39;花店&#39;,
    description: &#39;“这是你们的岛主开的花店. 你敢相信开店之前她有多兴奋吗, 说什么她一直都想开家花店, 现在倒好, 一周就开一天门, 其余的时候甚至都不会进店看一眼. 里面那些可怜的花儿哦, 还能活着已经是奇迹了. ”&#39;
}&gt;&gt;
&lt;&lt;set setup.items[&#39;东风&#39;] to {name: &#39;东风&#39;,
    description: &#39;那首萦绕在你脑海中的歌是什么...?&#39;
}&gt;&gt;
&lt;&lt;set setup.items[&#39;法则&#39;] to {name: &#39;法则&#39;,
    description: &#39;据说它们被写在虚无的表层, 远在世界存在之前, 远在上帝出现之前.没有法则来框定如何修改法则, 上帝也只因权能可以编写新的法则, 但永远——以至永远, 都不会有谁能改变它们&#39;
}&gt;&gt;
&lt;&lt;set setup.items[&#39;律韵&#39;] to {name: &#39;律韵&#39;,
    description: &#39;用法则组成的语言, 无法被记载和转述, 要使用或理解它你得熟知每一条法则, 而这几乎, 不, 根本不可能&#39;
}&gt;&gt;
&lt;&lt;set setup.items[&#39;拉浮闪石&#39;] to {name: &#39;拉浮闪石&#39;,
    description: &#39;呈短柱状或板状, 横切面为近于菱形的六边形, 深红至黑色, 表面呈玻璃光泽. 因为通过拉浮闪石施放的魔法会被正向增益强化, 又被称为导魔金属, 在巫师中主要被用来制作施法媒介与附魔道具&#39;
}&gt;&gt;
&lt;&lt;set setup.items[&#39;神明&#39;] to {name: &#39;神明&#39;,
    description: &#39;&lt;&lt;set $textm= [&quot;相比于凡间生灵, 祂们不朽而强大, 有着非物质的、意识般的实体, 是一种更高层面的存在. 神明通常代表着某种自然力量或思维, 普遍有着构建或修改世界的能力, 是凡间生物信仰流向的对象&quot;,&quot;神明形为各类现实动物和传统传说生物, 自然状态为兽形. 按照来源可把神明分为依附自然事物的自然神(原生神)和诞生自凡间生物神话传说中的神话神&quot;].random()&gt;&gt;$textm&#39;
}&gt;&gt;
&lt;&lt;set setup.items[&#39;天堂的入口&#39;] to {name: &#39;天堂的入口&#39;,
    description: &#39;天堂的入口隐秘而晦, 要想找到它需要杀死几条鱼, 学会一门古老的语言, 在夜间的沙漠里跳上一段舞蹈, 这之中又有不可计数的步骤被虚造或遗忘, 也未曾有过证据表明有尘世的生灵打开过通往天堂的大门. 据说那扇向内打开的双门由红宝石制成, 在其两侧布有60万名守卫天使, 没有上帝的指引, 任何灵魂都会在寻找天堂入口的路途中迷失&#39;
}&gt;&gt;
&lt;&lt;set setup.items[&#39;乌柿树&#39;] to {name: &#39;乌柿树&#39;,
    description: &#39;乌柿树, 非物质非实体, 扎根于第一天, 贯穿天堂生长的一颗柿子树, 天使们会在其上栖息, 而上帝的御座被置于冠顶. 乌柿树七年生一次新芽, 七年开一次花期, 七年结一次树果, 七年枯一次落叶. 其果被称为黑莲, 天使们使用黑莲制成的果酒洗刷灵魂. 在上方, 乌柿树接受着上帝的荣光, 在下方, 乌柿树被灌注者自身的果酒&#39;
}&gt;&gt;
&lt;&lt;set setup.items[&#39;柿子酒&#39;] to {name: &#39;柿子酒&#39;,
    description: &#39;乌黑醇香的家酿酒, 似乎是永无乡上的特产, 几乎每家每户都会在家中准备上这些口感甘甜的果酒, 也是赠礼的最佳选择&#39;
}&gt;&gt;
&lt;&lt;set setup.items[&#39;鸢尾花&#39;] to {name: &#39;鸢尾花&#39;,
    description: &#39;彩虹是由鸢尾花铺成? 你很确定你从没听过这种说法, 很明显也没有任何文字记载过这些&#39;
}&gt;&gt;
&lt;&lt;set setup.items[&#39;灵魂&#39;] to {name: &#39;灵魂&#39;,
    description: &#39;不知为何, 灵魂在永无乡似乎没那么容易消散, 你甚至可以用容器去储存它, 但千万别带在身边&#39;
}&gt;&gt;
&lt;&lt;set setup.items[&#39;没药&#39;] to {name: &#39;没药&#39;,
    description: &#39;太阳底下最好的香料&#39;
}&gt;&gt;
&lt;&lt;set setup.items[&#39;附子花&#39;] to {name: &#39;附子花&#39;,
    description: &#39;即使作为毒剂在历史与故事中臭名昭著, 附子仍是一种美丽的花. 在永无乡上没有花不会被欢迎&#39;
}&gt;&gt;
&lt;&lt;set setup.items[&#39;鸟羽&#39;] to {name: &#39;鸟羽&#39;,
    description: &#39;&lt;&lt;set $textm= [&quot;“喏, 我给你的就是. 鸟羽就是这里的钱, 明白了吗? 你可以用它买到这个岛上所有的东西, 但是出了岛嘛...哈, 我想也不会有那么一天 ”&quot;,&quot;鸟羽是永无乡独有的货币, 虽然叫做鸟羽, 其实只是印有羽毛图案的小型硬币. 鸟羽可以用来在岛内自由交易, 而在岛外的话, 鸟羽会自动变成所处的国家通用货币, 反过来也一样&quot;].random()&gt;&gt;$textm&#39;
}&gt;&gt;
&lt;&lt;set setup.items[&#39;Seisinofoaga&#39;] to {name: &#39;Seisinofoaga&#39;,
    description: &#39;脾气暴躁的金色鹩哥，自称为岛主的导师，聒噪又自大，最爱吹嘘自己过去的伟大，表现得看不起所有人，也许献上一点食物能让祂少对你叨叨几句&#39;
}&gt;&gt;
&lt;&lt;set setup.items[&#39;羽墨&#39;] to {name: &#39;羽墨&#39;,
    description: &#39;研磨自特殊饲养的家鸽羽毛, 由这种墨水写就的文字只在燃烧时显现&#39;
}&gt;&gt;
&lt;&lt;set setup.items[&#39;荆棘灰&#39;] to {name: &#39;荆棘灰&#39;,
    description: &#39;值得制作过程中的一点小痛苦, 只是千万不要让它沾染上你的猎物的鲜血&#39;
}&gt;&gt;
&lt;&lt;set setup.items[&#39;荒野&#39;] to {name: &#39;荒野&#39;,
    description: &#39;黑暗而冰冷的土地, 如其名称一般的荒芜, 似乎绵延永无尽头&#39;
}&gt;&gt;</tw-passagedata><tw-passagedata pid="60" name="提问" tags="" position="600,1175" size="100,100">&lt;font color=#FFAA00&gt; Seisinofoaga&lt;/font&gt;: 
&lt;&lt;set _q = 0&gt;&gt;&lt;&lt;do&gt;&gt;&lt;&lt;if _q == 0&gt;&gt;&lt;&lt;type-wp 45ms element &quot;span&quot;&gt;&gt;&gt;还有什么问题都快提出来, 我还要去接待下个新居民

⋙⋙⋙⋙⋙⋙⋘⋘⋘⋘⋘⋘
&lt;&lt;link▷「地图」&gt;&gt;&lt;&lt;set _q = 1&gt;&gt;&lt;&lt;redo&gt;&gt;&lt;&lt;/link&gt;&gt;
&lt;&lt;link▷「时间」&gt;&gt;&lt;&lt;set _q = 2&gt;&gt;&lt;&lt;redo&gt;&gt;&lt;&lt;/link&gt;&gt;
&lt;&lt;link▷「剧情」&gt;&gt;&lt;&lt;set _q = 3&gt;&gt;&lt;&lt;redo&gt;&gt;&lt;&lt;/link&gt;&gt;
&lt;&lt;link▷「属性值」&gt;&gt;&lt;&lt;set _q = 4&gt;&gt;&lt;&lt;redo&gt;&gt;&lt;&lt;/link&gt;&gt;
&lt;&lt;link▷「物品使用」&gt;&gt;&lt;&lt;set _q = 5&gt;&gt;&lt;&lt;redo&gt;&gt;&lt;&lt;/link&gt;&gt;
&lt;&lt;link▷「没问题了」&gt;&gt;&lt;&lt;set _q =6&gt;&gt;&lt;&lt;redo&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;&lt;/type-wp&gt;&gt;
&lt;&lt;elseif _q == 1&gt;&gt;搬到一个新地方生活最关键的还是清楚你的位置, 岛上给你们这些新居民都准备了一份地图, 平时多用用它来确定你的目的地吧, 毕竟这儿的地名也没那么好记&lt;br&gt;&lt;&lt;set $map = 1&gt;&gt;
等你登上岛，使用左下方的「地图」就能查看它, 点击内部地名就能实现在岛上的位移. 每个地点都有自己独特的功能和事件, 多多去探索它们. 等你有了住所, 使用「回家」即可回到家中
&lt;&lt;link ▷「返回」&gt;&gt;&lt;&lt;set _q = 0&gt;&gt;&lt;&lt;redo&gt;&gt;&lt;&lt;/link&gt;&gt;
&lt;&lt;elseif _q == 2&gt;&gt;永无乡上日常的时间流逝随着事件的进行而推进, 日期的更新影响着许多行动, 包括主线的剧情推进
&lt;&lt;link ▷「返回」&gt;&gt;&lt;&lt;set _q = 0&gt;&gt;&lt;&lt;redo&gt;&gt;&lt;&lt;/link&gt;&gt; 
&lt;&lt;elseif _q == 3&gt;&gt;这才是你该问的. 永无乡上的剧情分为日常、支线、NPC剧情和主线. 日常是用于改善你在岛上生活的事情, 而很多支线的开端都埋藏在日常活动中, 其他的则要更加隐秘. 大部分的支线结局都不会影响主线剧情&lt;br&gt;
岛上共有6名可攻略的NPC, 只有他们的好感度可以提升, 好感度提升的规则都各不相同, 最后获得的剧情和结局也都依靠你的选择. 若在某名NPC的攻略剧情中做出错误选择, 他们很可能就此与你形同陌路&lt;br&gt;
主线剧情的推进才是这个游戏最关键的内容. 不要被枯燥的日常和繁琐的支线迷昏了眼, 主线进展才该是你的第一目标. 随着主线推进, 会有新的支线解锁, NPC的攻略剧情也能进展到下一阶段, 岛上的环境也会有所改变
&lt;&lt;link ▷「返回」&gt;&gt;&lt;&lt;set _q = 0&gt;&gt;&lt;&lt;redo&gt;&gt;&lt;&lt;/link&gt;&gt;
&lt;&lt;elseif _q == 4&gt;&gt;永无乡上的居民拥有四种基础属性, 也就是创建角色时分配的技能点, 与四种只有在异常时才会显示的负面属性, 以及随机获取的各种特质. 简单来说, 选项的成功与失败都会对你的属性值产生影响, 你的所有物也会提供额外的属性值, 在做出相应要求的选择前, 你有充分的时间更换他们
&lt;&lt;link ▷「返回」&gt;&gt;&lt;&lt;set _q = 0&gt;&gt;&lt;&lt;redo&gt;&gt;&lt;&lt;/link&gt;&gt;
&lt;&lt;elseif _q == 5&gt;&gt;物品一共有食物、猎物、服装、鱼篓、物品五大分类, 其中不属于其他四种的物品都会存入物品的分类中&lt;br&gt;
食物可以在店铺中购买, 也可以在「家」中通过「烹饪」制作, 在左侧物品栏中使用食物；猎物分类为打猎获得的、未经烹饪或加工的材料, 通过「烹饪」或「制作」来使用；服装通过右侧「装备」穿戴, 每种服装都有不同的属性加成；渔获是钓鱼和出海获得的物品,  可以「烹饪」或在副港口的鱼铺「卖鱼」&lt;br&gt;
特殊物品的获取通常都来之不易, 所以你能很容易察觉到它们的重要性, 但Nix还是要求我提醒你们, 要是在错误的时机使用了这些物品, 它们中的一些会永久消耗, 这不会影响什么, 只是你的一丝丝努力被浪费了. 但更没劲的是, 会消耗的物品也意味着它们能再次获得. 要我说这还是太过仁慈
&lt;&lt;link ▷「返回」&gt;&gt;&lt;&lt;set _q = 0&gt;&gt;&lt;&lt;redo&gt;&gt;&lt;&lt;/link&gt;&gt;
&lt;&lt;elseif _q == 6&gt;&gt;&lt;&lt;type-wp 45ms element &quot;span&quot;&gt;&gt;你也该问够了. 安排都差点被你的问题打乱, 给, 这是最后一项了. 这些是岛上先到的居民给你准备的礼物, 但不能贪心, 你只能拿其中一个, 做好你的第一个选择&lt;br&gt;
⋙⋙⋙⋙⋙⋙⋘⋘⋘⋘⋘⋘
&lt;&lt;link ▷「鲜花诗集」&gt;&gt;&lt;&lt;goto &quot;初始选择&quot;&gt;&gt;&lt;&lt;set $choice to &quot;鲜花诗集&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;(赠自Nix, 首次阅读后获得学识点数10)
&lt;&lt;link ▷「火漆印章」&gt;&gt;&lt;&lt;goto &quot;初始选择&quot;&gt;&gt;&lt;&lt;set $choice to &quot;火漆印章&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;(赠自奥里, 首次使用后获得观察点数10)
&lt;&lt;link ▷「关节指环」&gt;&gt;&lt;&lt;goto &quot;初始选择&quot;&gt;&gt;&lt;&lt;set $choice to &quot;关节指环&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;(赠自Andersen, 装备后力量+2, 话术+2))
&lt;&lt;/type-wp&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;/do&gt;&gt;</tw-passagedata><tw-passagedata pid="61" name="提问2" tags="" position="1000,1175" size="100,100">&lt;&lt;set _q = 0&gt;&gt;&lt;&lt;do&gt;&gt;&lt;&lt;if _q == 0&gt;&gt;【&quot;他们说, 你总能在永无乡找到你想要的. 我希望你也会找到你想要的生活. &quot;她最后总结道, 满怀期望的冲你眨眨眼. 你谢过她的祝福, 但仍有疑问】

⋙⋙⋙⋙⋙⋙⋘⋘⋘⋘⋘⋘
&lt;&lt;link▷「我能找到什么」&gt;&gt;&lt;&lt;set _q = 1&gt;&gt;&lt;&lt;redo&gt;&gt;&lt;&lt;/link&gt;&gt;
&lt;&lt;link▷「永无乡的历史」&gt;&gt;&lt;&lt;set _q = 2&gt;&gt;&lt;&lt;redo&gt;&gt;&lt;&lt;/link&gt;&gt;
&lt;&lt;link▷「永无乡的居民」&gt;&gt;&lt;&lt;set _q = 3&gt;&gt;&lt;&lt;redo&gt;&gt;&lt;&lt;/link&gt;&gt;
&lt;&lt;link▷「永无乡的职业」&gt;&gt;&lt;&lt;set _q = 4&gt;&gt;&lt;&lt;redo&gt;&gt;&lt;&lt;/link&gt;&gt;
&lt;&lt;link▷「生活条件」&gt;&gt;&lt;&lt;set _q = 5&gt;&gt;&lt;&lt;redo&gt;&gt;&lt;&lt;/link&gt;&gt;
&lt;&lt;link▷「居住条件」&gt;&gt;&lt;&lt;set _q = 6&gt;&gt;&lt;&lt;redo&gt;&gt;&lt;&lt;/link&gt;&gt;
&lt;&lt;link▷「还有其他事吗」&gt;&gt;&lt;&lt;set _q = 7&gt;&gt;&lt;&lt;redo&gt;&gt;&lt;&lt;/link&gt;&gt;(这个选项会结束提问环节, 确保你没有问题后再选择)
&lt;&lt;elseif _q == 1&gt;&gt;【&quot;任何你想要的, 亲爱的. 这里是一个实现梦想的地方, 无论它是什么. &quot;】
&lt;&lt;link▷「返回」&gt;&gt;&lt;&lt;set _q = 0&gt;&gt;&lt;&lt;redo&gt;&gt;&lt;&lt;/link&gt;&gt;
&lt;&lt;elseif _q == 2&gt;&gt;【&quot;我相信你来岛上之前一定有所耳闻. 永无乡最初是由我的祖父建立, 用来收留落难者, 在几年后便荒废. 战争之后我想找个安静的地方修养, 没有比这里更合适的地方了, 不是吗? 等搬过来之后我又开始想, 为何不重建永无乡, 让她回到她本应有的样子呢? 接下来的事你就知道了, 你们来了, 永无乡上的生活又开始了. 她的历史还在继续, 如今你也参与其中. &quot;】
&lt;&lt;link▷「返回」&gt;&gt;&lt;&lt;set _q = 0&gt;&gt;&lt;&lt;redo&gt;&gt;&lt;&lt;/link&gt;&gt;
&lt;&lt;elseif _q == 3&gt;&gt;【&quot;我们这里欢迎任何人居住, 不论他们的过去如何. 你可以把这看作是生命的第二次机会, 抛下过去, 在永无乡开启新生活. 岛上的居民, 我必须得说, 在享受生活上很懂一套, 也很乐意和新居民做朋友, 即使初来乍到你也不必拘谨, 我很期待你能收获一段真挚的友谊, 但同时也要记住, 永无乡的居民都是平等的. &quot;】
&lt;&lt;link▷「返回」&gt;&gt;&lt;&lt;set _q = 0&gt;&gt;&lt;&lt;redo&gt;&gt;&lt;&lt;/link&gt;&gt;
&lt;&lt;elseif _q == 4&gt;&gt;【&quot;岛上必需的职业并不多, 但偶尔会有职位空缺, 你可以询问Seisi关于某个职业来了解它们的工作内容 , 或用职位名单来获知现在还有哪些地方需要人手. 不过在你正式拥有一份工作之前, 你得先当一阵子的学徒, 到时候会有可供选择的老师, 等你通过考核, 我们才会认为你在永无乡上能独当一面, 胜任工作了. &quot;】
&lt;&lt;link▷「返回」&gt;&gt;&lt;&lt;set _q = 0&gt;&gt;&lt;&lt;redo&gt;&gt;&lt;&lt;/link&gt;&gt;
&lt;&lt;elseif _q == 5&gt;&gt;【&quot;这里的生活基本上能够自给自足. 岛上的资源很是丰富, 鱼类和小型猎物足够居民们的日常饮食, 而且大多数住房都附带有小片土地, 可以随意种植; 牲畜有专门的职位来照料, 成熟后以较低的价格向居民出售. 除此之外, 还有每月靠岸两次的货轮, 带来邮件和额外的物资. &quot;】

【&quot;岛上建有最基础的供电系统, 但日常照明更常用的仍是煤油灯, 灯塔也还在使用自然的燃料, 以确保夜间常亮. &quot;】

【&quot;为了保护岛上的生态, 永无乡的出行基本靠徒步, 但这是个很小的岛屿, 来来往往之间也不会花上多久. &quot;】
&lt;&lt;link▷「返回」&gt;&gt;&lt;&lt;set _q = 0&gt;&gt;&lt;&lt;redo&gt;&gt;&lt;&lt;/link&gt;&gt;
&lt;&lt;elseif _q == 6&gt;&gt;【&quot;大多数居民都安家在小镇上. 小镇依河而建, 所有的重要建筑也都集中在那儿, 但总有猫喜欢居住在远离热闹的地区, 湖边是个不错的选择. 这间木屋是永无乡最南端的居住点, 再往南方的山区禁止前往和居住, 深林也是一片未开发的地区, 为了确保大家的安全, 我只能把这些地方封锁起来. &quot;】
&lt;&lt;link▷「返回」&gt;&gt;&lt;&lt;set _q = 0&gt;&gt;&lt;&lt;redo&gt;&gt;&lt;&lt;/link&gt;&gt;
&lt;&lt;elseif _q == 7&gt;&gt;&lt;&lt;if $book.has(&#39;鲜花诗集&#39;)&gt;&gt;【&quot;我注意到你在登岛时选了鲜花诗集, &quot;年轻的岛主像是有意略过了你的问题, &quot;那是我用花园里自己种出来的花做的, 希望你还喜欢. 永无乡有着恰好的温度, 不会过于炎热, 也能让花儿们健康生长, 这是我一直以来都很喜欢的一点. 我猜你不会介意我送你一些花种吧, 等你安顿下来, 可以开拓一片自己的小花园, 体验体验养育植物的乐趣&quot;】

&lt;&lt;timed 3s t8n&gt;&gt;【她起身从柜橱里翻出来一袋黑色的种子, 递到了你面前】
&lt;&lt;pickup $item &quot;玫瑰花种子&quot; 15&gt;&gt;&lt;font color=#4E84BA&gt;✧你获得玫瑰花种子*15✧&lt;/font&gt;&lt;&lt;/timed&gt;&gt; 

&lt;&lt;timed 4s t8n&gt;&gt;[[▷「继续」|住房安排]]&lt;&lt;/timed&gt;&gt;
&lt;&lt;else&gt;&gt;&lt;&lt;goto &quot;住房安排&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;/do&gt;&gt;</tw-passagedata><tw-passagedata pid="62" name="摘花" tags="nobr" position="1300,600" size="100,100">&lt;&lt;set _n to random(1,3)&gt;&gt;
&lt;&lt;if $flower == &quot;玫瑰花&quot;&gt;&gt;&lt;&lt;set _flower= [&quot;红玫瑰&quot;,&quot;白玫瑰&quot;,&quot;蓝玫瑰&quot;,&quot;黄玫瑰&quot;].random()&gt;&gt;&lt;&lt;pickup $item _flower _n&gt;&gt;【你小心翼翼的摘下盛开的$flower】&lt;br&gt;
&lt;font color=#4E84BA&gt;✧你获得_flower * _n✧&lt;/font&gt;&lt;br&gt;&lt;br&gt;
&lt;&lt;elseif  $flower == &quot;鸢尾花&quot;&gt;&gt;&lt;&lt;set _flower= [&quot;红色鸢尾花&quot;,&quot;橙色鸢尾花&quot;,&quot;蓝色鸢尾花&quot;,&quot;紫色鸢尾花&quot;,&quot;红色鸢尾花&quot;,&quot;青色鸢尾花&quot;,&quot;蓝色鸢尾花&quot;,&quot;紫色鸢尾花&quot;,&quot;绿色鸢尾花&quot;,&quot;红色鸢尾花&quot;,&quot;橙色鸢尾花&quot;,&quot;青色鸢尾花&quot;,&quot;蓝色鸢尾花&quot;,&quot;紫色鸢尾花&quot;,&quot;绿色鸢尾花&quot;].random()&gt;&gt;&lt;&lt;pickup $item _flower _n&gt;&gt;
【你小心翼翼的摘下盛开的$flower】&lt;br&gt;
&lt;font color=#4E84BA&gt;✧你获得_flower * 1✧&lt;/font&gt;&lt;br&gt;&lt;br&gt;
&lt;&lt;elseif Item.get($flower).hasTag(&quot;flower&quot;)&gt;&gt;【你小心翼翼的摘下盛开的$flower】&lt;br&gt;&lt;&lt;pickup $item $flower _n&gt;&gt;
&lt;font color=#4E84BA&gt;✧你获得$flower * _n✧&lt;/font&gt;&lt;br&gt;&lt;br&gt;
&lt;&lt;else&gt;&gt;&lt;&lt;pickup $food $flower _n&gt;&gt;
&lt;font color=#4E84BA&gt;✧你收获了$flower * _n✧&lt;/font&gt;&lt;br&gt;&lt;br&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;set _m to random(1,3)&gt;&gt;
&lt;&lt;if _flower ==&quot;红玫瑰&quot; &amp;&amp; _m ==3&gt;&gt;
&lt;&lt;set _a to setup.getStat(&quot;observation&quot;)/70*100&gt;&gt;&lt;&lt;checkWidget&gt;&gt;
&lt;&lt;if _rst == &quot;大成功&quot; || _rst == &quot;成功&quot;&gt;&gt;&lt;&lt;pickup $food &quot;黑蜂蜂蜜&quot; 1&gt;&gt;
【你的红玫瑰似乎吸引到了一群不同寻常的蜜蜂, 它们通体发黑, 但毫无敌意, 勤勤恳恳的在花丛间采着蜜. 你跟着它们回到蜂巢, 收集到了一些黑蜂蜂蜜! 】&lt;br&gt;&lt;font color=#4E84BA&gt;✧你获得黑蜂蜂蜜 * _n✧&lt;/font&gt;&lt;br&gt;&lt;br&gt;&lt;&lt;else&gt;&gt;【你的红玫瑰似乎吸引到了一群不同寻常的蜜蜂, 它们通体发黑, 但毫无敌意, 勤勤恳恳的在花丛间采着蜜. 你试着跟着它们回到蜂巢, 但这些奇妙的小动物不是那么容易跟上的，你徒劳而返】&lt;br&gt;&lt;br&gt;&lt;&lt;/if&gt;&gt;
&lt;&lt;elseif _m==3&gt;&gt;&lt;&lt;pickup $food &quot;蜂蜜&quot; _n&gt;&gt;【你跟着和你一样寻觅花儿的蜜蜂来到了蜂巢, 收集到了一些蜂蜜! 】&lt;br&gt;&lt;font color=#4E84BA&gt;✧你获得蜂蜜 * _n✧&lt;/font&gt;&lt;br&gt;&lt;br&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;link ▷「返回」 家&gt;&gt;&lt;&lt;/link&gt;&gt;</tw-passagedata><tw-passagedata pid="63" name="支线选项" tags="nobr" position="800,300" size="100,100">&lt;&lt;if $loc == &quot;咖啡馆&quot;&gt;&gt;

/*支线点心代送*/
&lt;&lt;if $choice == &quot;有什么推荐&quot;&gt;&gt;&lt;&lt;pickup $missed &quot;【派送】点心代送&quot; 1&gt;&gt;&lt;&lt;set $choice to 0&gt;&gt;
【&quot;朗姆葡萄酥卷! 那是我的最爱. &quot;她放下了点心盒, 向你推荐起来】&lt;br&gt;&lt;&lt;link ✧「查看菜单」 兑换&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;br&gt;&lt;&lt;link ▷「离开」 小镇&gt;&gt;&lt;&lt;/link&gt;&gt;
&lt;&lt;elseif $choice == &quot;四盒点心&quot;&gt;&gt;
【&quot;什么? 哦, 你是说这些. &quot;老板娘看起来差点忘了手里还拎着点心盒, &quot;这是要给岛上居民送去的, 但我现在太忙了, 所以打算先放在柜台, 等晚上关门再去....哎呀, 到时候应该都会凉了吧...&quot;她像是第一次意识到这个问题, 声音渐渐小了下去】&lt;br&gt;&lt;br&gt;
⋙⋙⋙⋙⋙⋙⋘⋘⋘⋘⋘⋘&lt;br&gt;
&lt;&lt;link ▷「我可以帮忙」 支线选项&gt;&gt;&lt;&lt;set $choice to &quot;我可以帮忙&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;br&gt;
&lt;&lt;link ▷「那太糟了」 支线选项&gt;&gt;&lt;&lt;set $choice to &quot;那太糟了&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;
&lt;&lt;elseif $choice == &quot;我可以帮忙&quot;&gt;&gt;&lt;&lt;pickup $ss &quot;点心代送&quot; 1&gt;&gt;&lt;&lt;set $choice to 0&gt;&gt;&lt;&lt;set $dxdsstat = 4&gt;&gt;
【老板娘的眼睛瞬间闪烁起来, 蓬松的尾巴也不受控制的开始摇晃. &quot;真的吗? 这真是太好了, 这是我今天听到的最好的消息! 他们住的离这里都不远, 有些就在小镇上. &quot;她飞快地写下订单的地址, 塞进对应的点心盒里, 检查一番后, 把盒子交给了你, 愉快的说道: &quot;等你回来, 今后三天的点餐都免费! &quot;】&lt;br&gt;〖开启任务【派送】点心代送〗&lt;br&gt;
&lt;&lt;button &quot;查看详情&quot;&gt;&gt;&lt;&lt;run Dialog.setup(&quot;任务&quot;);
  Dialog.wiki(Story.get(&quot;quest&quot;).processText());
  Dialog.open();&gt;&gt;&lt;&lt;/button&gt;&gt;
&lt;&lt;elseif $choice == &quot;那太糟了&quot;&gt;&gt;
【老板娘的眼睛不知所措的闪烁了几下, 最终定格在你身上. &quot;亲爱的, 能请你帮忙代我送去吗, 等你回来, 今天内的点餐我都免费. &quot;】&lt;br&gt;
&lt;br&gt;⋙⋙⋙⋙⋙⋙⋘⋘⋘⋘⋘⋘&lt;br&gt;
&lt;&lt;link ▷「接受」 支线选项&gt;&gt;&lt;&lt;set $choice to &quot;接受&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;br&gt;
&lt;&lt;link ▷「拒绝」 支线选项&gt;&gt;&lt;&lt;set $choice to &quot;拒绝&quot;, $abs +=1&gt;&gt;&lt;&lt;/link&gt;&gt;(这个选项会直接结束事件)
&lt;&lt;elseif $choice == &quot;接受&quot;&gt;&gt;&lt;&lt;pickup $ss &quot;点心代送&quot; 1&gt;&gt;&lt;&lt;set $choice to 0&gt;&gt;&lt;&lt;set $dxdsstat = 4&gt;&gt;
【&quot;万分感谢! 他们住的离这里都不远, 有些就在小镇上. &quot;她飞快地写下订单的地址, 塞进对应的点心盒里, 检查一番后, 把盒子交给了你】&lt;br&gt;〖开启任务【派送】点心代送〗&lt;br&gt;
&lt;&lt;button &quot;查看详情&quot;&gt;&gt;&lt;&lt;run Dialog.setup(&quot;任务&quot;);
  Dialog.wiki(Story.get(&quot;quest&quot;).processText());
  Dialog.open();&gt;&gt;&lt;&lt;/button&gt;&gt;
&lt;&lt;elseif $choice == &quot;拒绝&quot;&gt;&gt;&lt;&lt;pickup $missed &quot;点心代送&quot; 1&gt;&gt;&lt;&lt;set $choice to 0&gt;&gt;
【&quot;没关系, 这个要求是太过分了. &quot;她放下了点心盒, 换上了营业时候的微笑, &quot;你还没有看过点单吧, 我非常推荐朗姆葡萄酥卷哦! &quot;】&lt;br&gt;&lt;&lt;link ✧「查看菜单」 购入&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;br&gt;&lt;&lt;link ▷「离开」 小镇&gt;&gt;&lt;&lt;/link&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;elseif $dxdsstat == 4&gt;&gt;【他这才从吊床上起身, 很难说不是在偷懒, 但看在他年纪的份上, 你觉得也不能过于责怪. 你把属于Perramo的那盒放到桌上, 他简单的说了句&quot;谢谢&quot;便没有下文. 他看上去急着把你送出门】&lt;br&gt;&lt;&lt;set $dxdsstat = 3&gt;&gt;【你送达了第一盒点心, 查看任务获得提示】&lt;br&gt;&lt;br&gt;
&lt;&lt;link ▷「返回」 医院&gt;&gt;&lt;&lt;set $npc to 0&gt;&gt;&lt;&lt;/link&gt;&gt;
&lt;&lt;elseif $dxdsstat == 3&gt;&gt;【Era接过盒子, 什么也没说的直接打开了包装, 拿起一块咬了上去, 接着把盒子递到你面前: &quot;尝一块吗? 我很喜欢这个口味. &quot;】&lt;br&gt;&lt;&lt;pickup $food &quot;黑巧小蛋糕&quot; 1&gt;&gt;&lt;&lt;set $dxdsstat = 2&gt;&gt;&lt;font color=#4E84BA&gt;✧你获得黑巧小蛋糕*1✧&lt;/font&gt;&lt;br&gt;【你送达了第二盒点心, 查看任务获得提示】&lt;br&gt;&lt;br&gt;
&lt;&lt;link ▷「返回」 草甸&gt;&gt;&lt;&lt;set $npc to 0&gt;&gt;&lt;&lt;/link&gt;&gt;
&lt;&lt;elseif $dxdsstat == 2&gt;&gt;
&lt;&lt;if $loc == &quot;鱼铺&quot;&gt;&gt;【Tret不紧不慢的切完手上的鱼, 摘掉满是鱼鳞和血迹的手套才来拿走点心, 他白翳覆盖的眼睛居高临下的看了你一眼, 你以为自己会被吓到, 但感受到的只有谢意】&lt;br&gt;&lt;&lt;set $dxdsstat = 1&gt;&gt;【你送达了第三盒点心, 查看任务获得提示】
&lt;&lt;else&gt;&gt;【Tret不紧不慢的收起鱼钩上的鱼才来拿走点心, 他白翳覆盖的眼睛居高临下的看了你一眼, 你以为自己会被吓到, 但感受到的只有谢意】&lt;br&gt;&lt;&lt;set $dxdsstat = 1&gt;&gt;【你送达了第三盒点心, 查看任务获得提示】
&lt;&lt;/if&gt;&gt;&lt;br&gt;&lt;br&gt;
&lt;&lt;link ▷「返回」 $loc&gt;&gt;&lt;&lt;set $npc to 0&gt;&gt;&lt;&lt;/link&gt;&gt;
&lt;&lt;elseif $dxdsstat == 1&gt;&gt;【&quot;哦! 是我定的点心, 怎么现在才到, 我都快饿死了. &quot;他二话不说的打开包装开始享用, 丝毫不顾及这里是图书馆, 而他是管理员. 你忍住了提醒他咖啡馆就在图书馆隔壁这件事】&lt;br&gt;&lt;&lt;set $dxdsstat = 0&gt;&gt;【你送达了第四盒点心, 查看任务获得提示】&lt;br&gt;&lt;br&gt;
&lt;&lt;link ▷「返回」 图书馆&gt;&gt;&lt;&lt;set $npc to 0&gt;&gt;&lt;&lt;/link&gt;&gt;

&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="64" name="收杆" tags="nobr" position="1000,100" size="100,100">&lt;&lt;set $minute to $minute+ random(3,10)&gt;&gt;&lt;&lt;set _m to random(1,10)&gt;&gt;&lt;&lt;set _s to random(1,100)&gt;&gt;&lt;&lt;set _n to random(1,10)&gt;&gt;&lt;&lt;nobr&gt;&gt;
&lt;&lt;if _s &lt;= 5&gt;&gt;【你钓到了一本书, 里面的内容已经模糊不清了. 没用的东西, 只能扔掉了】
&lt;&lt;if _m &lt;=3&gt;&gt;&lt;&lt;set $feather to $feather+ _n&gt;&gt;【等等...书里居然夹着些硬币. 你获得_n枚鸟羽】&lt;&lt;elseif _m ==4&gt;&gt;&lt;&lt;pickup $book &quot;笔记残页&quot; 1&gt;&gt;【等等...书里掉出来一页怪异的纸张, 上面有清晰但你无法阅读的字迹】&lt;&lt;if $msstat == &quot;新的开始2&quot; &amp;&amp; $feather &gt;= 200&gt;&gt;&lt;&lt;set $msstat = &quot;新的开始3&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;&lt;&lt;/if&gt;&gt;
&lt;&lt;elseif _s &lt;=13&gt;&gt;&lt;&lt;if _m &lt;=5&gt;&gt;&lt;&lt;pickup $item &quot;易拉罐&quot; 1&gt;&gt;&lt;&lt;set $hdylg += 1&gt;&gt;【你钓到了一个易拉罐, 不知道是谁在这里乱丢垃圾】
&lt;&lt;else&gt;&gt;&lt;&lt;pickup $item &quot;鱼骨&quot; 1&gt;&gt;【你钓到了一个鱼骨, 看起来有其他家伙先饱餐一顿了】&lt;&lt;/if&gt;&gt;
&lt;&lt;elseif _s &lt;=18&gt;&gt;【鱼钩上空空如也, 你什么都没有钓到】
&lt;&lt;elseif _s &lt;=20&gt;&gt;&lt;&lt;set $feather to $feather+ _n&gt;&gt;【你钓到了_n枚鸟羽】&lt;&lt;if $msstat == &quot;新的开始2&quot; &amp;&amp; $feather &gt;= 200&gt;&gt;&lt;&lt;set $msstat = &quot;新的开始3&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;
&lt;&lt;elseif _s &lt;=22&gt;&gt;&lt;&lt;set $feather to $feather- _n&gt;&gt;【鱼太强了 你失去了_n枚鸟羽】
&lt;&lt;elseif _s &lt;=26&gt;&gt;【鱼钩仿佛跟你开玩笑似的松开了已经咬钩的鱼, 转头飞向你, 精准的从你的背包里钓出一个%e%抛进了水里】\n【你失去了】
&lt;&lt;elseif _s &gt;=96 &amp;&amp; $loc == &quot;罗索伦特湖&quot;&gt;&gt;&lt;&lt;pickup $fish &quot;鳗鱼&quot; 1&gt;&gt;【你钓到了鳗鱼】
&lt;&lt;elseif $loc == &quot;贝雷河&quot; || $loc == &quot;罗索伦特湖&quot;&gt;&gt;&lt;&lt;if _s &lt;= 35&gt;&gt;&lt;&lt;pickup $fish &quot;泥鳅&quot; 1&gt;&gt;【你钓到了泥鳅】
&lt;&lt;elseif _s &lt;= 43&gt;&gt;&lt;&lt;pickup $fish &quot;欧鳊&quot; 1&gt;&gt;&lt;&lt;set $fishcollect.pushUnique(&quot;欧鳊&quot;)&gt;&gt;【你钓到了欧鳊】
&lt;&lt;elseif _s &lt;= 51&gt;&gt;&lt;&lt;pickup $fish &quot;黑鲈鱼&quot; 1&gt;&gt;&lt;&lt;set $fishcollect.pushUnique(&quot;黑鲈鱼&quot;)&gt;&gt;【你钓到了黑鲈鱼】
&lt;&lt;elseif _s &lt;= 60&gt;&gt;&lt;&lt;pickup $fish &quot;雅罗鱼&quot; 1&gt;&gt;&lt;&lt;set $fishcollect.pushUnique(&quot;雅罗鱼&quot;)&gt;&gt;【你钓到了雅罗鱼】
&lt;&lt;elseif _s &lt;= 69&gt;&gt;&lt;&lt;pickup $fish &quot;鲤鱼&quot; 1&gt;&gt;&lt;&lt;set $fishcollect.pushUnique(&quot;鲤鱼&quot;)&gt;&gt;【你钓到了鲤鱼】
&lt;&lt;elseif _s &lt;= 78&gt;&gt;&lt;&lt;pickup $fish &quot;虾虎鱼&quot; 1&gt;&gt;&lt;&lt;set $fishcollect.pushUnique(&quot;虾虎鱼&quot;)&gt;&gt;【你钓到了虾虎鱼】
&lt;&lt;elseif _s &lt;= 83&gt;&gt;&lt;&lt;pickup $fish &quot;白鲑鱼&quot; 1&gt;&gt;&lt;&lt;set $fishcollect.pushUnique(&quot;白鲑鱼&quot;)&gt;&gt;【你钓到了白鲑鱼】
&lt;&lt;elseif _s &lt;= 88&gt;&gt;&lt;&lt;pickup $fish &quot;虹鳟鱼&quot; 1&gt;&gt;&lt;&lt;set $fishcollect.pushUnique(&quot;虹鳟鱼&quot;)&gt;&gt;【你钓到了虹鳟鱼】
&lt;&lt;else&gt;&gt;【特殊】&lt;&lt;/if&gt;&gt;
&lt;&lt;elseif $loc == &quot;沙地&quot; || $loc == &quot;断桥&quot; || $loc == &quot;主港口&quot; || $loc == &quot;副港口&quot; || $loc == &quot;礁岩区&quot; || $loc == &quot;栈桥&quot;&gt;&gt;&lt;&lt;if _s &lt;= 31&gt;&gt;&lt;&lt;pickup $fish &quot;鹦哥鱼&quot; 1&gt;&gt;&lt;&lt;set $fishcollect.pushUnique(&quot;鹦哥鱼&quot;)&gt;&gt;【你钓到了鹦哥鱼, 就像鹦鹉一样颜色艳丽】
&lt;&lt;elseif _s &lt;= 35&gt;&gt;&lt;&lt;pickup $fish &quot;红蝎鱼&quot; 1&gt;&gt;&lt;&lt;set $fishcollect.pushUnique(&quot;红蝎鱼&quot;)&gt;&gt;【你钓到了红蝎鱼, 在被它刺到之前快丢回水里吧】
&lt;&lt;elseif _s &lt;= 40&gt;&gt;&lt;&lt;pickup $fish &quot;鲻鱼&quot; 1&gt;&gt;&lt;&lt;set $fishcollect.pushUnique(&quot;鲻鱼&quot;)&gt;&gt;【你钓到了鲻鱼】
&lt;&lt;elseif _s &lt;= 45&gt;&gt;&lt;&lt;pickup $fish &quot;鳕鱼&quot; 1&gt;&gt;&lt;&lt;set $fishcollect.pushUnique(&quot;鳕鱼&quot;)&gt;&gt;【你钓到了鳕鱼, 今晚用它做炸鱼薯条吧! 】
&lt;&lt;elseif _s &lt;= 57&gt;&gt;&lt;&lt;pickup $fish &quot;沙丁鱼&quot; 1&gt;&gt;&lt;&lt;set $fishcollect.pushUnique(&quot;沙丁鱼&quot;)&gt;&gt;【你钓到了沙丁鱼, 是亿分之一的缘分!】
&lt;&lt;elseif _s &lt;= 62&gt;&gt;&lt;&lt;pickup $fish &quot;比目鱼&quot; 1&gt;&gt;&lt;&lt;set $fishcollect.pushUnique(&quot;比目鱼&quot;)&gt;&gt;【你钓到了比目鱼, 看上去有谁刚刚踩了它一脚】
&lt;&lt;elseif _s &lt;= 68&gt;&gt;&lt;&lt;pickup $fish &quot;龙虾&quot; 1&gt;&gt;&lt;&lt;set $fishcollect.pushUnique(&quot;龙虾&quot;)&gt;&gt;【你钓到了龙虾, 小心它的钳子!】
&lt;&lt;elseif _s &lt;= 74&gt;&gt;&lt;&lt;pickup $fish &quot;乌贼&quot; 1&gt;&gt;&lt;&lt;set $fishcollect.pushUnique(&quot;乌贼&quot;)&gt;&gt;【你钓到了乌贼, 它瞪着你的眼神让你有些心虚】
&lt;&lt;elseif _s &lt;= 77&gt;&gt;&lt;&lt;pickup $fish &quot;凤尾鱼&quot; 1&gt;&gt;&lt;&lt;set $fishcollect.pushUnique(&quot;凤尾鱼&quot;)&gt;&gt;【你钓到了凤尾鱼, 它能做成一道精致的晚餐】
&lt;&lt;elseif _s &lt;= 80&gt;&gt;&lt;&lt;pickup $fish &quot;彩虹濑鱼&quot; 1&gt;&gt;&lt;&lt;set $fishcollect.pushUnique(&quot;彩虹濑鱼&quot;)&gt;&gt;【你钓到了彩虹濑鱼, 他们会成群结队的穿梭在珊瑚中间】
&lt;&lt;elseif _s &lt;= 83&gt;&gt;&lt;&lt;pickup $fish &quot;纹首鮨&quot; 1&gt;&gt;&lt;&lt;set $fishcollect.pushUnique(&quot;纹首鮨&quot;)&gt;&gt;【你钓到了纹首鮨, 漂亮的花纹值得耐心的等待】
&lt;&lt;elseif _s &lt;= 86&gt;&gt;&lt;&lt;pickup $fish &quot;鲱鱼&quot; 1&gt;&gt;&lt;&lt;set $fishcollect.pushUnique(&quot;鲱鱼&quot;)&gt;&gt;【你钓到了鲱鱼】
&lt;&lt;else&gt;&gt;【特殊】&lt;&lt;/if&gt;&gt;

&lt;&lt;elseif $loc == &quot;海域&quot;&gt;&gt;&lt;&lt;if _s &lt;= 31&gt;&gt;&lt;&lt;pickup $fish &quot;鳕鱼&quot; 1&gt;&gt;&lt;&lt;set $fishcollect.pushUnique(&quot;鳕鱼&quot;)&gt;&gt;【你钓到了鳕鱼, 今晚用它做炸鱼薯条吧! 】
&lt;&lt;elseif _s &lt;= 41&gt;&gt;&lt;&lt;pickup $fish &quot;沙丁鱼&quot; 1&gt;&gt;&lt;&lt;set $fishcollect.pushUnique(&quot;沙丁鱼&quot;)&gt;&gt;【你钓到了沙丁鱼, 是亿分之一的缘分!】
&lt;&lt;elseif _s &lt;= 42&gt;&gt;&lt;&lt;pickup $fish &quot;蓝鳍金枪鱼&quot; 1&gt;&gt;【你钓到了蓝鳍金枪鱼, 说实话, 它大得有点吓人】
&lt;&lt;elseif _s &lt;= 50&gt;&gt;&lt;&lt;pickup $fish &quot;无须鳕鱼&quot; 1&gt;&gt;【你钓到了无须鳕鱼, 跟鳕鱼并没有关系】
&lt;&lt;elseif _s &lt;= 56&gt;&gt;&lt;&lt;pickup $fish &quot;海鳌虾&quot; 1&gt;&gt;【你钓到了海鳌虾, 别看它个头小, 要小心点拿】
&lt;&lt;elseif _s &lt;= 62&gt;&gt;&lt;&lt;pickup $fish &quot;龙虾&quot; 1&gt;&gt;【你钓到了龙虾, 小心它的钳子!】
&lt;&lt;elseif _s &lt;= 68&gt;&gt;&lt;&lt;pickup $fish &quot;鲯鳅鱼&quot; 1&gt;&gt;【你钓到了鲯鳅鱼, 奇怪的长相和奇怪的名字】
&lt;&lt;elseif _s &lt;= 69&gt;&gt;&lt;&lt;pickup $fish &quot;大西洋狐鲣&quot; 1&gt;&gt;【你钓到了大西洋狐鲣】
&lt;&lt;elseif _s &lt;= 75&gt;&gt;&lt;&lt;pickup $fish &quot;军曹鱼&quot; 1&gt;&gt;【你钓到了军曹鱼, 用来做刺身再合适不过了】
&lt;&lt;elseif _s &lt;= 80&gt;&gt;&lt;&lt;pickup $fish &quot;乌贼&quot; 1&gt;&gt;【你钓到了乌贼, 它瞪着你的眼神让你有些心虚】
&lt;&lt;elseif _s &lt;= 86&gt;&gt;&lt;&lt;pickup $fish &quot;大比目鱼&quot; 1&gt;&gt;【你钓到了大比目鱼, 跟比目鱼比起来要更大更扁】
&lt;&lt;else&gt;&gt;【特殊】&lt;&lt;/if&gt;&gt;

&lt;&lt;/if&gt;&gt;&lt;&lt;/nobr&gt;&gt;

&lt;&lt;link ▷「继续」 钓鱼&gt;&gt;&lt;&lt;/link&gt;&gt;
&lt;&lt;link ▷「离开」 $loc&gt;&gt;&lt;&lt;/link&gt;&gt;</tw-passagedata><tw-passagedata pid="65" name="教堂" tags="nobr" position="300,400" size="100,100">&lt;&lt;if $dn == 0&gt;&gt;【教堂的门紧闭着, 换个时间再来吧】&lt;br&gt;&lt;br&gt;&lt;&lt;link ▷「离开」 小镇&gt;&gt;&lt;&lt;set $npc to 0&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;&lt;else&gt;&gt;
&lt;&lt;if $loc != &quot;教堂&quot;&gt;&gt;&lt;&lt;set $loc = &quot;教堂&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;
//教堂位于镇中心, 是岛上最早建立起来的一批建筑物, 比起这个称呼它看上去更像一座石堡. 起初这里并不是用来信奉任何神明的, 由当年那些巫师中的顶尖工匠建造, 因为当时是战争年代,岛上的人们焦虑无法安定下来,所以内部比较宽大, 采光性好, 让任何去教堂礼拜的人都能感到舒适安逸. 之后镇上的建筑都是围绕她建造//&lt;br&gt;&lt;br&gt;
&lt;&lt;if $hour &lt;= 11 &amp;&amp; $minute &lt;= 40 &amp;&amp; $week == 7&gt;&gt;&lt;&lt;timed 2s t8n&gt;&gt;【你在圣坛的一侧看到一只裹着黑色修女服的高个子白猫，站在主教的斜前方，沉默地垂着眼睛面对着明亮的大厅，白猫站在那里清唱，歌声让整个六边形的教堂笼罩在静谧圣洁的气氛里】&lt;br&gt;
&lt;&lt;if $jofirstcexp != 1&gt;&gt;
&lt;&lt;set _a to setup.getStat(&quot;knowledge&quot;)/12*100&gt;&gt;&lt;&lt;checkWidget&gt;&gt;
&lt;&lt;if _rst == &quot;大成功&quot; || _rst == &quot;成功&quot;&gt;&gt;【你能听出这童声一样的嗓子并非普通歌手所能拥有的】&lt;br&gt;&lt;&lt;set $knowledgeexp to $knowledgeexp+1&gt;&gt;&lt;&lt;addkexpWidget&gt;&gt;&lt;&lt;else&gt;&gt;【你觉得它比以往所听过的所有圣歌更清越】&lt;br&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;&lt;&lt;/timed&gt;&gt;
&lt;&lt;timed 4s t8n&gt;&gt;&lt;br&gt;【一曲唱罢了白猫从圣坛旁边走下来，坐到第一排的空位上安静地做礼拜，并不因为中午的到来离开去用餐或者怎么样】&lt;br&gt;
&lt;&lt;if $jofirstcexp != 1&gt;&gt;&lt;&lt;set $jofirstcexp = 1&gt;&gt;
&lt;&lt;set _a to setup.getStat(&quot;observation&quot;)/12*100&gt;&gt;&lt;&lt;set _b to _a/6&gt;&gt;&lt;&lt;checkWidget&gt;&gt;
&lt;&lt;if _rst == &quot;大成功&quot; || _rst == &quot;成功&quot;&gt;&gt;【你注意到白猫有着一张男性化的面孔】&lt;br&gt;&lt;&lt;set $observationexp to $observationexp+1&gt;&gt;&lt;&lt;addoexpWidget&gt;&gt;&lt;br&gt;
&lt;&lt;/if&gt;&gt;&lt;br&gt;
&lt;&lt;/if&gt;&gt;&lt;&lt;/timed&gt;&gt;
&lt;&lt;timed 5s t8n&gt;&gt;&lt;br&gt;&lt;&lt;if $jofirstc == 1&gt;&gt;&lt;&lt;link&quot; ✣「NPC 琼」 &quot; &quot;教堂&quot;&gt;&gt;&lt;&lt;set $loct = $loc, $npc to &quot;琼&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;br&gt;&lt;&lt;/if&gt;&gt;&lt;&lt;link&quot; ✣「NPC Daisy」 &quot; &quot;教堂&quot;&gt;&gt;&lt;&lt;set $loct = $loc, $npc to &quot;Daisy&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;
&lt;br&gt;&lt;br&gt;
[[✧「找个座位」|找个座位]]&lt;br&gt;
✧「查看约柜」
&lt;br&gt;
&lt;&lt;set _m to random(1,10)&gt;&gt;
&lt;&lt;link ▷「离开」&gt;&gt;&lt;&lt;set $loc = &quot;小镇&quot;&gt;&gt;&lt;&lt;if $jofirstc != 1 &amp;&amp; _m &lt;= 2&gt;&gt;&lt;&lt;set $loct = $loc, $npc to &quot;琼&quot;&gt;&gt;&lt;&lt;goto &quot;交谈&quot;&gt;&gt;&lt;&lt;else&gt;&gt;&lt;&lt;goto &quot;小镇&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;&lt;/timed&gt;&gt;

&lt;&lt;else&gt;&gt;
&lt;&lt;link&quot; ✣「NPC Daisy」 &quot; &quot;教堂&quot;&gt;&gt;&lt;&lt;set $loct = $loc, $npc to &quot;Daisy&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;
&lt;br&gt;&lt;br&gt;
[[✧「找个座位」|找个座位]]&lt;br&gt;
✧「查看约柜」
&lt;br&gt;&lt;br&gt;
&lt;&lt;link ▷「离开」 小镇&gt;&gt;&lt;&lt;set $npc to 0&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="66" name="散步" tags="nobr" position="900,0" size="100,100">&lt;&lt;if $weather == &quot;暴雨&quot;&gt;&gt;
【现在的雨太大了, 不是散步的好天气】
&lt;&lt;elseif $HP lt 1&gt;&gt;
【你感到些许疲惫, 做事情力不从心. 你最好去吃点东西休息一下, 充足的睡眠没有坏处】
&lt;&lt;else&gt;&gt;
&lt;&lt;set $HP to $HP- 1&gt;&gt;&lt;&lt;set _wlkr to random(1,100)&gt;&gt;
&lt;&lt;if _wlkr lt 40&gt;&gt;
&lt;&lt;goto &quot;散步风景&quot;&gt;&gt;

&lt;&lt;elseif _wlkr lt 60&gt;&gt;
&lt;&lt;fadeout 1s 2s&gt;&gt;&lt;&lt;if $loc == &quot;草甸&quot;&gt;&gt;【你沿着草甸上的小径散步, 路旁的草丛与野花都追随着你的脚步】&lt;&lt;elseif $loc == &quot;贝雷河&quot;&gt;&gt;【你沿着贝雷河边散步, 河水仿佛跟着你的步伐一般不紧不慢地流动着】&lt;&lt;elseif $loc == &quot;罗索伦特湖&quot;&gt;&gt;【你沿着湖畔散步, 湖水的浪潮声渐渐充斥了你的思绪】&lt;&lt;elseif $loc == &quot;秋毛岗&quot;&gt;&gt;【你踏过秋毛岗的每一寸起伏, 无数灌木和树林被你抛在身后】&lt;&lt;elseif $loc == &quot;高地&quot;&gt;&gt;【你在高地的岩地上散步, 雾气与冷风对你似乎并无挽留】&lt;&lt;elseif $loc == &quot;沙地&quot;&gt;&gt;【你在松软的沙地上散步, 蔓延开来的沙滩似乎永无尽头】&lt;&lt;/if&gt;&gt;&lt;&lt;/fadeout&gt;&gt;&lt;&lt;wanderWidget&gt;&gt;&lt;br&gt;
&lt;&lt;fadeout 2s 2s&gt;&gt;&lt;&lt;if $locs == &quot;白雾&quot;&gt;&gt;【不知不觉间, 你迷了路. 前面是一片白雾吗? 】
&lt;&lt;else&gt;&gt;【不知不觉间，你来到了$locs】&lt;&lt;/if&gt;&gt;&lt;&lt;/fadeout&gt;&gt;
&lt;&lt;timed 4s&gt;&gt;&lt;&lt;set $loc to $locs&gt;&gt;&lt;&lt;goto $loc&gt;&gt;&lt;&lt;/timed&gt;&gt;

&lt;&lt;elseif _wlkr lt 85&gt;&gt;&lt;&lt;goto &quot;散步掉落&quot;&gt;&gt;
&lt;&lt;elseif _wlkr lt 92&gt;&gt;&lt;&lt;goto &quot;散步遭遇事件&quot;&gt;&gt;
&lt;&lt;elseif _wlkr &lt;=100&gt;&gt;&lt;&lt;goto &quot;散步特殊事件&quot;&gt;&gt;
&lt;&lt;/if&gt;&gt;&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="67" name="散步掉落" tags="nobr" position="900,150" size="100,100">&lt;&lt;set $minute to $minute+ random(1,3)&gt;&gt;&lt;&lt;set _m to random(1,10)&gt;&gt;&lt;&lt;set _s to random(1,100)&gt;&gt;&lt;&lt;set _n to random(1,5)&gt;&gt;&lt;&lt;set _o to random(3,10)&gt;&gt;【你在$loc散步】&lt;br&gt;&lt;br&gt;

&lt;&lt;if _s &lt;= 20 &amp;&amp; $item.count(&#39;粉红色小卡片&#39;) == 0&gt;&gt;
【有什么东西晃过你的眼前, 你停步去寻找, 从角落里捡起了一张粉红色小卡片, 上面似乎写着什么】&lt;br&gt;&lt;font color=#4E84BA&gt;✧你获得了粉红色小卡片*1✧&lt;/font&gt;&lt;&lt;pickup $item &quot;粉红色小卡片&quot; 1&gt;&gt;
&lt;&lt;elseif _s &lt;= 28&gt;&gt;
&lt;&lt;if _m &lt;= 7&gt;&gt;
&lt;&lt;set _stuff = [&quot;蒲公英种子&quot;,&quot;向日葵种子&quot;,&quot;玫瑰花种子&quot;,&quot;勿忘我种子&quot;,&quot;百合花种子&quot;,&quot;牡丹花种子&quot;,&quot;金盏花种子&quot;,&quot;紫罗兰种子&quot;].random()&gt;&gt;&lt;&lt;pickup $item _stuff 1&gt;&gt;【有什么东西沾在了你的衣服上, 你低头去摘掉它】&lt;br&gt;【哦, 是一颗_stuff! 你把它放进背包】&lt;br&gt;&lt;br&gt;
&lt;&lt;link ▷「继续」 $loc&gt;&gt;&lt;&lt;/link&gt;&gt;
&lt;&lt;elseif _m &lt;=9&gt;&gt;【有什么东西晃过你的眼前, 你停步去寻找, 却什么也没发现】&lt;br&gt;&lt;br&gt;
&lt;&lt;link ▷「继续」 $loc&gt;&gt;&lt;&lt;/link&gt;&gt;
&lt;&lt;else&gt;&gt;&lt;&lt;set _stuff = [&quot;蛾子&quot;,&quot;蜜蜂&quot;,&quot;蜘蛛&quot;,&quot;蚂蚁&quot;].random()&gt;&gt;【有什么东西沾在了你的衣服上, 你低头去摘掉它】&lt;br&gt;【呀! 是一只_stuff 真是讨厌】&lt;br&gt;⋙⋙⋙⋙⋙⋙⋘⋘⋘⋘⋘⋘&lt;br&gt;
&lt;&lt;link ▷「捏死」 日常行动&gt;&gt;&lt;&lt;set $choice to &quot;捏死&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;br&gt;
&lt;&lt;link ▷「拍掉」 日常行动&gt;&gt;&lt;&lt;set $choice to &quot;拍掉&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;br&gt;
&lt;&lt;link ▷「放进口袋」 日常行动&gt;&gt;&lt;&lt;set $choice to &quot;_stuff&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;elseif _s &lt;= 45&gt;&gt;
&lt;&lt;if $weather == &quot;中雨&quot; || $weather == &quot;雷阵雨&quot; || $weather == &quot;小雨&quot;&gt;&gt;
&lt;&lt;if _m &lt;= 5&gt;&gt;&lt;&lt;pickup $food &quot;蘑菇&quot; _n&gt;&gt;
【沿路的蘑菇在这阴雨天里生长茂盛, 你顺手摘了_n个带走】&lt;br&gt;&lt;br&gt;
&lt;&lt;link ▷「继续」 $loc&gt;&gt;&lt;&lt;/link&gt;&gt;
&lt;&lt;elseif _m &lt;=8&gt;&gt;【沿路的蘑菇正在这阴雨天里迅速生长, 你试驻足欣赏了一会儿这些生命的蓬勃, 又回到了你的散步中】&lt;br&gt;&lt;br&gt;
&lt;&lt;link ▷「继续」 $loc&gt;&gt;&lt;&lt;/link&gt;&gt;
&lt;&lt;else&gt;&gt;
【沿路的蘑菇在这阴雨天里生长茂盛, 你试图摘走一些, 却意识到你手里的那些蘑菇有着异样色彩的菌盖】⋙⋙⋙⋙⋙⋙⋘⋘⋘⋘⋘⋘&lt;br&gt;
&lt;&lt;link ▷「拿走」 日常行动&gt;&gt;&lt;&lt;set $choice to &quot;毒蘑菇&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;br&gt;
&lt;&lt;link ▷「丢掉」 日常行动&gt;&gt;&lt;&lt;set $choice to &quot;丢掉&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;else&gt;&gt;
【一丛果实繁茂的灌木出现在你面前. 你试着去采摘, 
&lt;&lt;set _t to random(15,20)&gt;&gt;&lt;&lt;set _r to $strength*_t/10&gt;&gt;&lt;&lt;set _a to $strength/_r*100&gt;&gt;
&lt;&lt;checkWidget&gt;&gt;
&lt;&lt;if _rst == &quot;大失败&quot;&gt;&gt;
却不小心划伤了自己】&lt;&lt;set $player.wound to $player.wound+ 1&gt;&gt;
&lt;&lt;else&gt;&gt;得到了_n个浆果】&lt;&lt;pickup $food &quot;浆果&quot; _n&gt;&gt;&lt;br&gt;&lt;br&gt;
&lt;&lt;link ▷「继续」 $loc&gt;&gt;&lt;&lt;/link&gt;&gt;
&lt;&lt;/if&gt;&gt;&lt;&lt;/if&gt;&gt;

&lt;&lt;elseif _s &lt;= 68&gt;&gt;
&lt;&lt;if _m &lt;= 5&gt;&gt;
【你发现了_n枚散落的羽毛, 把它们加入了你的收藏】&lt;&lt;pickup $item &quot;羽毛&quot; _n&gt;&gt;&lt;br&gt;&lt;br&gt;
&lt;&lt;link ▷「继续」 $loc&gt;&gt;&lt;&lt;/link&gt;&gt;
&lt;&lt;else&gt;&gt;【隐约间看到一个扎窝在灌木里的鸟巢, 里面躺着几枚鸟蛋, 没附近没看到大鸟的踪影】&lt;br&gt;&lt;br&gt;
⋙⋙⋙⋙⋙⋙⋘⋘⋘⋘⋘⋘&lt;br&gt;
&lt;&lt;link ▷「拿走」 日常行动&gt;&gt;&lt;&lt;set $choice to &quot;鸟蛋&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;br&gt;
&lt;&lt;link ▷「离开」 $loc&gt;&gt;&lt;&lt;/link&gt;&gt;
▷「离开」&lt;&lt;/if&gt;&gt;

&lt;&lt;elseif _s &lt;= 78&gt;&gt;
&lt;&lt;set _t to random(25,40)&gt;&gt;&lt;&lt;set _r to $luck*_t/10&gt;&gt;&lt;&lt;set _a to $luck/_r*100&gt;&gt;&lt;&lt;checkWidget&gt;&gt;
&lt;&lt;if _m &lt;= 4&gt;&gt;【不知道哪个粗心鬼丢了一堆硬币在地上, 不过没有关系, 你会给它们一个新家的】&lt;br&gt;
&lt;font color=#4E84BA&gt;✧你获得&lt;&lt;if _rst == &quot;大成功&quot; || _rst == &quot;成功&quot;&gt;&gt;_o&lt;&lt;set $feather += _o&gt;&gt;&lt;&lt;else&gt;&gt;_n&lt;&lt;set $feather to $feather+ _n&gt;&gt;&lt;&lt;/if&gt;&gt;枚鸟羽✧&lt;/font&gt;&lt;&lt;redo&gt;&gt;
&lt;&lt;elseif _m &lt;= 9&gt;&gt;【有什么东西晃过你的眼前, 你停步去寻找, 却什么也没发现】
&lt;&lt;else&gt;&gt;
&lt;&lt;if _rst == &quot;大成功&quot; || _rst == &quot;成功&quot;&gt;&gt;_n枚鸟羽从你的衣兜里滑出, 迅速消失在了阴影里】&lt;&lt;set $feather to $feather- _n&gt;&gt;&lt;&lt;redo&gt;&gt;
&lt;&lt;else&gt;&gt;_o枚鸟羽从你的衣兜里滑出, 迅速消失在了阴影里】&lt;&lt;set $feather to $feather- _o&gt;&gt;&lt;&lt;/if&gt;&gt;&lt;&lt;/if&gt;&gt;
&lt;br&gt;&lt;br&gt;
&lt;&lt;link ▷「继续」 $loc&gt;&gt;&lt;&lt;if $msstat == &quot;新的开始2&quot; &amp;&amp; $feather &gt;= 200&gt;&gt;&lt;&lt;set $msstat = &quot;新的开始3&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;&lt;&lt;/link&gt;&gt;

&lt;&lt;elseif _s &lt;= 84&gt;&gt;捡到东西&lt;br&gt;&lt;br&gt;
&lt;&lt;link ▷「继续」 $loc&gt;&gt;&lt;&lt;/link&gt;&gt;
&lt;&lt;elseif _s &lt;= 90&gt;&gt;&lt;&lt;lost&gt;&gt;
&lt;&lt;set _stuff =random(1,3)&gt;&gt;&lt;&lt;if _stuff ==1 &gt;&gt; 【一只巨大的蟾蜍不知从何处出现, 用充满泥泞和腥臭的身躯疯狂撞向你, 无奈之下你只好将_itemn交给它. 谁会相信你被一只蟾蜍打劫了呢】
&lt;&lt;elseif _stuff ==2 &gt;&gt; 【你花了些时间才意识到你的_itemn少了一个. 你找遍全身上下还有来时的路, 但它就这样神秘消失了】
&lt;&lt;elseif _stuff ==3 &gt;&gt;【你被绊倒, 一个_itemn从你的兜里滑出, 迅速消失在阴影里】&lt;&lt;/if&gt;&gt; &lt;br&gt;【你失去了_itemn*1】
&lt;br&gt;&lt;br&gt;
&lt;&lt;link ▷「继续」 $loc&gt;&gt;&lt;&lt;/link&gt;&gt;
&lt;&lt;else&gt;&gt;特殊&lt;br&gt;&lt;br&gt;
&lt;&lt;link ▷「继续」 $loc&gt;&gt;&lt;&lt;/link&gt;&gt;
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="68" name="散步特殊事件" tags="nobr" position="900,300" size="100,100">&lt;&lt;set $minute to $minute+ random(1,5)&gt;&gt;&lt;&lt;set _s to random(1,100)&gt;&gt;&lt;&lt;set _n to random(1,50)&gt;&gt;

&lt;&lt;if $loc == &quot;贝雷河&quot;&gt;&gt;【你沿着贝雷河岸散步】&lt;br&gt;&lt;br&gt;
【地上一个闪闪发光的东西吸引了你的目光, &lt;&lt;rdmstone&gt;&gt;
&lt;br&gt;&lt;br&gt;&lt;&lt;link ▷「继续」 $loc&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;&lt;/if&gt;&gt;

&lt;&lt;if $loc == &quot;沙地&quot;&gt;&gt;【你沿着永无乡的海岸散步】&lt;br&gt;&lt;br&gt;
&lt;&lt;if _s &lt;= 20 &amp;&amp; $tretloc ==&quot;钓鱼&quot;&gt;&gt;【海岸边一个壮硕却老迈的身影引起了你的注意, 等靠近些, 你终于确定那是在夜钓的Tret. 老猫和他的鱼竿沉默的坐在晚风里, 看起来似乎不想被打搅】&lt;br&gt;&lt;br&gt;
&lt;&lt;link&quot; ✣「NPC Tret」 &quot; &quot;鱼铺&quot;&gt;&gt;&lt;&lt;set $npc to &quot;Tret&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;br&gt;&lt;br&gt;
[[✧「离开」|沙地]]
&lt;&lt;else&gt;&gt;【地上一个闪闪发光的东西吸引了你的目光, &lt;&lt;rdmstone&gt;&gt;
&lt;br&gt;&lt;br&gt;&lt;&lt;link ▷「继续」 $loc&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;&lt;/if&gt;&gt;&lt;&lt;/if&gt;&gt;

&lt;&lt;if $loc == &quot;草甸&quot;&gt;&gt;&lt;&lt;if _s &lt;= 60 &amp;&amp; $nmfirstc !=1&gt;&gt;
【你遇到了一只戴着兜帽的神秘猫, 他就在你不远处静静站着. 要上前搭话吗?】&lt;br&gt; &lt;br&gt;⋙⋙⋙⋙⋙⋙⋘⋘⋘⋘⋘⋘&lt;br&gt;
&lt;&lt;link ▷「离开」 $loc&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;br&gt;
&lt;&lt;link ▷「上前搭话」 交谈&gt;&gt;&lt;&lt;set $npc to &quot;安德森&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;&lt;else&gt;&gt;没写&lt;&lt;/if&gt;&gt;&lt;&lt;/if&gt;&gt;

&lt;&lt;if $loc == &quot;秋毛岗&quot;&gt;&gt;&lt;&lt;if _s &lt;= 60 &amp;&amp; $nmfirstc !=1&gt;&gt;【你遇到了一只戴着兜帽的神秘猫, 他就在你不远处静静站着. 要上前搭话吗?】&lt;br&gt; &lt;br&gt;⋙⋙⋙⋙⋙⋙⋘⋘⋘⋘⋘⋘&lt;br&gt;
&lt;&lt;link ▷「离开」 $loc&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;br&gt;
&lt;&lt;link ▷「上前搭话」 交谈&gt;&gt;&lt;&lt;set $npc to &quot;安德森&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;&lt;else&gt;&gt;没写&lt;&lt;link ▷「继续」 $loc&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;&lt;/if&gt;&gt;&lt;&lt;/if&gt;&gt;

&lt;&lt;if $loc == &quot;高地&quot;&gt;&gt;没写&lt;&lt;link ▷「继续」 $loc&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;&lt;/if&gt;&gt;

&lt;&lt;if $loc == &quot;罗索伦特湖&quot;&gt;&gt;&lt;&lt;if _s &lt;= 60 &amp;&amp; $nmfirstc !=1&gt;&gt;【你遇到了一只戴着兜帽的神秘猫, 他就在你不远处静静站着. 要上前搭话吗?】&lt;br&gt; &lt;br&gt;⋙⋙⋙⋙⋙⋙⋘⋘⋘⋘⋘⋘&lt;br&gt;
&lt;&lt;link ▷「离开」 $loc&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;br&gt;
&lt;&lt;link ▷「上前搭话」 交谈&gt;&gt;&lt;&lt;set $npc to &quot;安德森&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;&lt;else&gt;&gt;没写&lt;&lt;link ▷「继续」 $loc&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;&lt;/if&gt;&gt;&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="69" name="散步遭遇事件" tags="nobr" position="900,225" size="100,100">&lt;&lt;set _s to random(1,100)&gt;&gt;&lt;&lt;set _m to random(1,100)&gt;&gt;&lt;&lt;set _n to random(1,8)&gt;&gt;
没写完
&lt;br&gt;
【你在$loc散步】&lt;br&gt;
&lt;&lt;if _s&lt;=30&gt;&gt;【不知道从什么地方窜出一只红狐, 它神色凶猛的扑向你, 
&lt;&lt;set _t to random(19,29)&gt;&gt;&lt;&lt;set _r to setup.getStat(&quot;strength&quot;)*_t/10&gt;&gt;&lt;&lt;set _a to setup.getStat(&quot;strength&quot;)/_r*100&gt;&gt;&lt;&lt;set _b to _a/6&gt;&gt;
&lt;&lt;checkWidget&gt;&gt;
&lt;&lt;if _rst == &quot;大成功&quot; || _rst == &quot;成功&quot;&gt;&gt;但你强于这个狡黠的生物, 你将它从身上甩开, 并夺走了它的

&lt;&lt;set _t to random(20,40)&gt;&gt;&lt;&lt;set _r to setup.getStat(&quot;observation&quot;)*_t/10&gt;&gt;&lt;&lt;set _a to setup.getStat(&quot;observation&quot;)/_r*100&gt;&gt;&lt;&lt;set _b to _a/6&gt;&gt;
&lt;&lt;checkWidget&gt;&gt;

&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;link ▷「继续」 $loc&gt;&gt;&lt;&lt;/link&gt;&gt;</tw-passagedata><tw-passagedata pid="70" name="散步风景" tags="nobr" position="900,75" size="100,100">&lt;&lt;set $minute to $minute+ random(1,5)&gt;&gt;&lt;&lt;set _m to random(1,50)&gt;&gt;&lt;&lt;set _n to random(1,50)&gt;&gt;
&lt;&lt;if $loc == &quot;草甸&quot;&gt;&gt;【你在草甸上散步】&lt;br&gt;&lt;br&gt;
&lt;&lt;if $weather == &quot;中雨&quot; || $weather == &quot;雷阵雨&quot; || $weather == &quot;小雨&quot;&gt;&gt;
&lt;&lt;if $hour &gt;=6 &amp;&amp; $hour &lt;=17&gt;&gt;
&lt;&lt;if _m &lt;= 28&gt;&gt;【雨天的永无乡有着一种说不出的阴蔼. 草地又湿又重, 野花软软地低垂着, 你把外套裹紧, 在泥泞的土地上艰难渡步, 耳边中满是沉重的雨滴敲击地面的声音, 雨水的寒意似乎能渗入你的骨头. 尽管景象凄凉, 但雨水拍打下的花朵似乎是在提醒你, 即使在最黑暗的时刻, 生活仍在继续】
&lt;&lt;if _n &lt;= 30&gt;&gt;&lt;&lt;set $san to $san- 1&gt;&gt;&lt;&lt;/if&gt;&gt;
&lt;&lt;else&gt;&gt;【雨天的永无乡有着一种说不出的阴蔼. 草地又湿又重, 野花软软地低垂着, 你把外套裹紧, 在泥泞的土地上艰难渡步, 耳边中满是沉重的雨滴敲击地面的声音, 雨水的寒意似乎能渗入你的骨头. 一声惊雷在上方响起, 你能感到身上的毛发因受惊而竖立, 你加快了脚步. 这不是一个散步的好天气】
&lt;&lt;if _n &lt;= 40&gt;&gt;&lt;&lt;set $san to $san- 2&gt;&gt;&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;else&gt;&gt;【雨天夜间】
&lt;&lt;/if&gt;&gt;
&lt;&lt;elseif $hour &gt;=20 &amp;&amp; $hour &lt;=5&gt;&gt;
&lt;&lt;set _dscrb = [&quot;【现在是夜间, 四周除开你的脚步声外, 只有野生动物穿过草甸时发出的悉索声. 空气中满是冷冽, 碎月的光芒让远处的一切都变得朦胧起来】&quot;,&quot;【繁星点亮了夜空, 即是只有部分光芒, 月光还是足以使得夜间的草甸小路也能清晰可见. 横穿岛屿的海风让野草轻抚着你, 自然与海浪的气息充斥着空气】&quot;,&quot;【一些也许是由夜行性的鸟和昆虫合奏发出的微弱旋律从各处传来, 你一时间忘却了前行的步伐, 深深的沉迷在这节奏中】&quot;].random()&gt;&gt;_dscrb
&lt;&lt;elseif $weather == &quot;晴天&quot; || $weathers == &quot;少云&quot; || $weathers == &quot;晴转多云&quot;&gt;&gt;
&lt;&lt;set _t to random(20,40)&gt;&gt;&lt;&lt;set _r to setup.getStat(&quot;observation&quot;)*_t/10&gt;&gt;&lt;&lt;set _a to setup.getStat(&quot;observation&quot;)/_r*100&gt;&gt;&lt;&lt;set _b to _a/6&gt;&gt;
&lt;&lt;checkWidget&gt;&gt;
&lt;&lt;if _rst == &quot;大成功&quot;&gt;&gt;
&lt;&lt;set $san to $san+ 3&gt;&gt;【一片片沐浴在阳光柔和光线中的草叶随风摇曳，野花点缀着其中, 空气中弥漫着花香，你呼吸着新鲜的空气, 让温暖的阳光照耀着你，为这美丽的时刻而感激,. 但即使在这田园诗般的场景中, 你也有一种不安的感觉. 一切都出奇的寂静而沉寂, 只有草丛偶尔发出的沙沙声. 你无法摆脱被注视的感觉, 你发现自己正匆匆穿过草地, 急切地想离开这个地方】
&lt;&lt;elseif  _rst == &quot;成功&quot;&gt;&gt;
&lt;&lt;set $san to $san+ 1&gt;&gt;【一片片沐浴在阳光柔和光线中的草叶随风摇曳, 野花点缀其中, 空气中弥漫着花香，你呼吸着新鲜的空气, 让温暖的阳光落在你身上, 你为这美丽的时刻而感激】&lt;&lt;else&gt;&gt;【一片片沐浴在阳光柔和光线中的草叶随风摇曳, 野花点缀其中, 空气中弥漫着花香，你呼吸着新鲜的空气, 让温暖的阳光落在你身上】
&lt;&lt;/if&gt;&gt;
&lt;&lt;else&gt;&gt;
【阴天白天】
&lt;&lt;/if&gt;&gt;&lt;&lt;/if&gt;&gt;

&lt;&lt;if $loc == &quot;沙地&quot;&gt;&gt;【你在沙地上散步】&lt;br&gt;&lt;br&gt;
&lt;&lt;if $weather == &quot;中雨&quot; || $weather == &quot;雷阵雨&quot; || $weather == &quot;小雨&quot;&gt;&gt;
&lt;&lt;if $hour &gt;=6 &amp;&amp; $hour &lt;=17&gt;&gt;
&lt;&lt;set _dscrb = [&quot;【天空呈现一种失衡的灰色, 与大海在海岸线处融为一体. 湿滑的沙子让你每一步都陷得更深, 伴随着嘎吱嘎吱的声音】&quot;,&quot;【海风夹杂着雨丝穿过你的所在, 只有寒冷和潮湿被留下来, 雨点淅淅沥沥地打在海面上, 在微弱的光亮下泛起细小的波纹】&quot;,&quot;【在你不远处, 一对夫妇正撑着雨伞在漫步, 他们的孩子欢快地在一旁跑来跑去, 边走边溅起水花】&quot;,&quot;【海藻和盐的气味充满了你的鼻孔, 海浪拍打岩石的声音以其无尽的节奏抚慰着你的灵魂. 你停下来, 观察每一滴雨滴如何在广阔的海洋中找到与其他雨滴汇合的方式】&quot;].random()&gt;&gt;_dscrb
&lt;&lt;else&gt;&gt;
【雨天的永无乡有着一种说不出的阴蔼. 你把外套裹紧, 在泥泞的土地上艰难渡步, 耳边中满是沉重的雨滴敲击地面的声音, 雨水的寒意似乎能渗入你的骨头. 一声惊雷在上方响起, 你能感到身上的毛发因受惊而竖立, 你加快了脚步. 这不是一个散步的好天气】
&lt;&lt;/if&gt;&gt;
&lt;&lt;elseif $hour &gt;=20 &amp;&amp; $hour &lt;=5&gt;&gt;
&lt;&lt;set _dscrb = [&quot;【碎月如旧的闪烁着她的银光, 在海面上投下了漂浮不定的虚影. 海浪似乎不愿打破月光一般平静的起伏着, 发出舒缓的浪潮声. 你觉得自己进入了一个纯粹宁静的世界】&quot;,&quot;【你在沙地上散步, 阵阵海浪涌上岸来, 伴着海风与鸟鸣, 时间仿佛永远停止在这里】&quot;].random()&gt;&gt;_dscrb
&lt;&lt;elseif $weather == &quot;晴天&quot; || $weathers == &quot;少云&quot; || $weathers == &quot;晴转多云&quot;&gt;&gt;
&lt;&lt;set _dscrb = [&quot;【被阳光烤得炽热的沙子灼痛着你的双脚. 真应该带上遮阳蓬来这里睡上一觉】&quot;,&quot;【海藻和盐的气味充满了你的鼻孔, 海浪拍打岩石的声音以其无尽的节奏抚慰着你的灵魂. 你享受这宁静与自然】&quot;].random()&gt;&gt;_dscrb
&lt;&lt;else&gt;&gt;
&lt;&lt;set _dscrb = [&quot;【海藻和盐的气味充满了你的鼻孔, 海浪拍打岩石的声音以其无尽的节奏抚慰着你的灵魂. 你享受这宁静与自然】&quot;,&quot;【你感觉到来自海洋的凉爽薄雾在你的皮毛上翻滚, 并在空气中尝到它的滋味. 你看着远处的海鸥掠过水面, 产生的涟漪消失在海岸线】&quot;].random()&gt;&gt;_dscrb
&lt;&lt;/if&gt;&gt;&lt;&lt;/if&gt;&gt;

&lt;&lt;if $loc == &quot;贝雷河&quot;&gt;&gt;
【你沿着贝雷河岸散步】&lt;br&gt;&lt;br&gt;
&lt;&lt;if $weather == &quot;中雨&quot; || $weather == &quot;雷阵雨&quot; || $weather == &quot;小雨&quot;&gt;&gt;
&lt;&lt;if _m &lt;= 28&gt;&gt;【雨天的永无乡有着一种说不出的阴蔼. 草地又湿又重, 野花软软地低垂着, 你把外套裹紧, 在泥泞的土地上艰难渡步, 耳边中满是沉重的雨滴敲击地面的声音, 雨水的寒意似乎能渗入你的骨头. 尽管景象凄凉, 但雨水拍打下的花朵似乎是在提醒你, 即使在最黑暗的时刻, 生活仍在继续】
&lt;&lt;if _n &lt;= 30&gt;&gt;&lt;&lt;set $san to $san- 1&gt;&gt;&lt;&lt;/if&gt;&gt;&lt;&lt;else&gt;&gt;【雨天的永无乡有着一种说不出的阴蔼. 草地又湿又重, 野花软软地低垂着, 你把外套裹紧, 在泥泞的土地上艰难渡步, 耳边中满是沉重的雨滴敲击地面的声音, 雨水的寒意似乎能渗入你的骨头. 一声惊雷在上方响起, 你能感到身上的毛发因受惊而竖立, 你加快了脚步. 这不是一个散步的好天气】
&lt;&lt;if _n &lt;= 40&gt;&gt;&lt;&lt;set $san to $san- 2&gt;&gt;&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;elseif $hour &gt;=20 &amp;&amp; $hour &lt;=5&gt;&gt;
&lt;&lt;set _dscrb = [&quot;【你走在河岸上, 双脚时不时发出轻微的溅水声. 你欣赏着从河面反射出如碎银般的月光, 群星在其两侧黯淡的闪烁】&quot;,&quot;【碎月的光芒零零散散的洒在河水上, 营造出迷人的氛围, 树枝被月光勾勒出轮廓, 像华尔兹舞者一般伸展出去, 萤火虫环绕着它们, 用其微弱的闪光照亮了片刻的黑暗】&quot;,&quot;【一群鹿毫不忌惮的从你面前经过, 几只獾伴着一阵沙沙声穿过灌木. 水中的飞溅声提醒你一只海狸刚游过, 可能是在寻找晚餐. 夜晚就这样继续下去】&quot;].random()&gt;&gt;_dscrb
&lt;&lt;elseif $weather == &quot;晴天&quot; || $weathers == &quot;少云&quot; || $weathers == &quot;晴转多云&quot;&gt;&gt;
&lt;&lt;set _dscrb = [&quot;【沿着贝雷河的流向漫步向下, 阳光投下树影打在你的肩头, 树叶在风中沙沙作响, 河水沉默而又无尽的流淌着, 一切都是那么平静而安宁】&quot;,&quot;【没走出几步, 就见一群鹿在长满青草的河岸边小憩, 还有几只野鸭在水中慢慢地顺流而下, 你几乎能看到河水里的鱼儿在起伏游动. 生命的活力遍布岛屿】&quot;,&quot;【阳光毫不吝啬地照耀着岸边的林地, 沿岸的植株上仍沾着露水, 在阳光下闪烁如钻石, 野花点缀在岩石间, 构成一种简单而独特的美】&quot;].random()&gt;&gt;_dscrb
&lt;&lt;else&gt;&gt;
【没走出几步, 就见一群鹿在长满青草的河岸边小憩, 还有几只野鸭在水中慢慢地顺流而下, 你几乎能看到河水里的鱼儿在起伏游动. 生命的活力遍布岛屿】
&lt;&lt;/if&gt;&gt;&lt;&lt;/if&gt;&gt;

&lt;&lt;if $loc == &quot;罗索伦特湖&quot;&gt;&gt;
【你沿着罗索伦特湖畔散步】&lt;br&gt;&lt;br&gt;
&lt;&lt;if $weather == &quot;中雨&quot; || $weather == &quot;雷阵雨&quot; || $weather == &quot;小雨&quot;&gt;&gt;&lt;&lt;if $hour &gt;=6 &amp;&amp; $hour &lt;=17&gt;&gt;
&lt;&lt;set _dscrb = [&quot;【天空本就阴沉的灰色蒙上一层雨雾后看起来更加的沉闷, 满是涟漪的湖水上倒映着你的蓝绿相间的阴影】&quot;,&quot;【雨天的永无乡有着一种说不出的阴蔼. 草地又湿又重, 野花软软地低垂着, 你把外套裹紧, 在泥泞的土地上艰难渡步, 耳边中满是沉重的雨滴敲击地面的声音, 雨水的寒意似乎能渗入你的骨头】&quot;,&quot;【每一滴落在湖面上的雨滴都发出叮当作响的声音, 就像一百万个微小的乐器在湖底演奏. 凉风不时吹过, 带起了黑色的水浪打湿了你的脚】&quot;].random()&gt;&gt;_dscrb
&lt;&lt;else&gt;&gt;
&lt;&lt;set _dscrb = [&quot;【连续数小时的雨让四处都空无一猫, 月光此时也无法与你为伴, 有的只是无尽的雨声和黑夜】&quot;,&quot;【雨天夜间的湖面像是一种可触及的黑暗, 让可能存在的任何颜色都变得暗淡无光, 湖边看不到任何灯光, 当你跌跌撞撞地走过湖畔时，黑暗似乎把你吞没】&quot;].random()&gt;&gt;_dscrb
&lt;&lt;/if&gt;&gt;
&lt;&lt;elseif $hour &gt;=20 &amp;&amp; $hour &lt;=5&gt;&gt;
&lt;&lt;set _dscrb = [&quot;【夜间的湖水漆黑如墨, 只有淡淡的月光反射在湖面上】&quot;,&quot;【夜间的空气凉爽而潮湿, 淡淡的雾气从湖中升起, 让一切都开始变得模糊不清】&quot;,&quot;【空气中弥漫着浓重的腥味, 浓雾从水里滚滚而来, 盘绕在芦苇丛中, 拂过你的脸庞. 是时候回家了】&quot;].random()&gt;&gt;_dscrb
&lt;&lt;elseif $weather == &quot;晴天&quot; || $weathers == &quot;少云&quot; || $weathers == &quot;晴转多云&quot;&gt;&gt;
&lt;&lt;set _dscrb = [&quot;【湖面在阳光下闪耀的亮光充盈着你的视野, 湖水轻拍岸边的水波声在周围回荡, 微风吹拂着草丛和树梢, 你深吸一口气，感受到平和与安宁包裹着你】&quot;,&quot;【阳光照在湖面上如玻璃般清澈的湖面上，凉爽的微风吹拂着岸边的芦苇，偶尔有鱼儿破水而出, 在水面激起涟漪. 一群鸭子懒洋洋地划过，一只苍鹭像雕像一样单腿站立，寻找下一餐】&quot;,&quot;【阳光毫不吝啬地照耀着岸边的林地, 沿岸的植株上仍沾着露水, 在阳光下闪烁如钻石, 野花点缀在岩石间, 构成一种简单而独特的美】&quot;].random()&gt;&gt;_dscrb
&lt;&lt;else&gt;&gt;
【湖水轻拍岸边的水波声在周围回荡, 微风拂过湖面, 带走了一些雾气, 你深吸一口气，感受到平和与安宁包裹着你】
&lt;&lt;/if&gt;&gt;&lt;&lt;/if&gt;&gt;

&lt;&lt;if $loc == &quot;秋毛岗&quot;&gt;&gt;
【你在秋毛岗上散步】&lt;br&gt;&lt;br&gt;
&lt;&lt;if $weather == &quot;中雨&quot; || $weather == &quot;雷阵雨&quot; || $weather == &quot;小雨&quot;&gt;&gt;&lt;&lt;if $hour &gt;=6 &amp;&amp; $hour &lt;=17&gt;&gt;
没写
&lt;&lt;else&gt;&gt;
【雨天的永无乡有着一种说不出的阴蔼. 草地又湿又重, 野花软软地低垂着, 你把外套裹紧, 在泥泞的土地上艰难渡步, 耳边中满是沉重的雨滴敲击地面的声音, 雨水的寒意似乎能渗入你的骨头. 一声惊雷在上方响起, 你能感到身上的毛发因受惊而竖立, 你加快了脚步. 这不是一个散步的好天气】
&lt;&lt;/if&gt;&gt;
&lt;&lt;elseif $hour &gt;=20 &amp;&amp; $hour &lt;=5&gt;&gt;
&lt;&lt;set _dscrb = [&quot;【山岗上很黑, 但月光尽力地透过树丛照了进来. 在下方, 你注意到几只萤火虫在围绕着你飞行——他们柔和的光芒照亮了你前行的小路】&quot;,&quot;【星空在枝叶的缝隙间微弱的闪烁着. 不时有猫头鹰鸣叫响起, 在夜空中回荡, 它们正在寻找迷路的猎物】&quot;].random()&gt;&gt;_dscrb
&lt;&lt;elseif $weather == &quot;晴天&quot; || $weathers == &quot;少云&quot; || $weathers == &quot;晴转多云&quot;&gt;&gt;
【阳光透过树木在地面上洒下金斑, 树叶在风中沙沙作响, 鸟儿唱着甜美的旋律. 从长在原木上的蘑菇到在树枝间跳跃的松鼠, 山岗上的生机被你尽收眼底】
&lt;&lt;else&gt;&gt;
没写
&lt;&lt;/if&gt;&gt;&lt;&lt;/if&gt;&gt;

&lt;&lt;if $loc == &quot;高地&quot;&gt;&gt;
【你在高地上散步】&lt;br&gt;&lt;br&gt;
&lt;&lt;if $weather == &quot;中雨&quot; || $weather == &quot;雷阵雨&quot; || $weather == &quot;小雨&quot;&gt;&gt;&lt;&lt;if $hour &gt;=6 &amp;&amp; $hour &lt;=17&gt;&gt;
没写
&lt;&lt;else&gt;&gt;
【雨天的永无乡有着一种说不出的阴蔼. 草地又湿又重, 野花软软地低垂着, 你把外套裹紧, 在泥泞的土地上艰难渡步, 耳边中满是沉重的雨滴敲击地面的声音, 雨水的寒意似乎能渗入你的骨头. 一声惊雷在上方响起, 你能感到身上的毛发因受惊而竖立, 你加快了脚步. 这不是一个散步的好天气】
&lt;&lt;/if&gt;&gt;
&lt;&lt;elseif $hour &gt;=20 &amp;&amp; $hour &lt;=5&gt;&gt;
没写
&lt;&lt;elseif $weather == &quot;晴天&quot; || $weathers == &quot;少云&quot; || $weathers == &quot;晴转多云&quot;&gt;&gt;
没写
&lt;&lt;else&gt;&gt;
没写
&lt;&lt;/if&gt;&gt;&lt;&lt;/if&gt;&gt;

&lt;br&gt;&lt;br&gt;
&lt;&lt;link ▷「继续」 $loc&gt;&gt;&lt;&lt;/link&gt;&gt;</tw-passagedata><tw-passagedata pid="71" name="断桥" tags="nobr" position="400,300" size="100,100">&lt;&lt;set $loc = &quot;断桥&quot;&gt;&gt;&lt;&lt;timeWidget&gt;&gt;&lt;&lt;set $minute to $minute+ random(5,10)&gt;&gt;//位于沙地的最北端, 永无乡西北角的断桥, 是一座未完成也永远不会被完成的桥, 它延伸出去的模样仿佛伸开的臂膀. 现在没有谁知道它究竟是通向何处, 也不知为何从未完成, 顺着断桥建造下去只会达到海底//&lt;br&gt;
&lt;&lt;NPCloc&gt;&gt;
&lt;br&gt;
&lt;&lt;if $lostsheep[0] == 1&gt;&gt;[[✧「找羊」|era互动]]&lt;br&gt;&lt;&lt;/if&gt;&gt;
[[✧「钓鱼」|钓鱼]]&lt;br&gt;
&lt;br&gt;&lt;br&gt;
&lt;&lt;link ▷「离开」 沙地&gt;&gt;&lt;&lt;/link&gt;&gt;</tw-passagedata><tw-passagedata pid="72" name="旅店" tags="nobr" position="100,500" size="100,100">&lt;&lt;if $loc != &quot;旅店&quot;&gt;&gt;&lt;&lt;set $loc = &quot;旅店&quot;&gt;&gt;&lt;&lt;set $minute to $minute+ random(1,3)&gt;&gt;&lt;&lt;/if&gt;&gt;&lt;&lt;if $item.has(&#39;旅店钥匙&#39;) &amp;&amp; $home != &quot;旅店&quot;&gt;&gt;
【前台的女孩在漫不经心的翻着手里的时尚杂志, 见到你进门也只是问了句: &quot;几号房? &quot; 你看了看钥匙, 读出了上面的数字, 女孩离开座位准备带你去你的房间】&lt;br&gt; ⋙⋙⋙⋙⋙⋙⋘⋘⋘⋘⋘⋘&lt;br&gt;&lt;&lt;link ▷「进房」 主线第一天结束&gt;&gt;&lt;&lt;set $choice to &quot;进房&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;br&gt;
&lt;&lt;link ▷「再想想」 主线第一天结束&gt;&gt;&lt;&lt;set $choice to &quot;再想想&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;
&lt;&lt;elseif $home == &quot;旅店&quot; &amp;&amp; $choice == &quot;付钱&quot;&gt;&gt;
【你交付了10鸟羽，女孩离开座位准备带你去你的房间】&lt;&lt;set $feather -= 10&gt;&gt;&lt;&lt;redo&gt;&gt;&lt;&lt;set $innpay = 1&gt;&gt;&lt;&lt;set $choice to 0&gt;&gt;&lt;br&gt;
[[▷「进房」|家]]
&lt;&lt;elseif $home == &quot;旅店&quot; &amp;&amp; $innpay == 1&gt;&gt;
【前台的女孩在漫不经心的翻着手里的时尚杂志, 见到你进门也只是问了句: &quot;几号房? &quot; 你看了看钥匙, 读出了上面的数字, 女孩离开座位准备带你去你的房间】&lt;br&gt;
[[▷「进房」|家]]&lt;br&gt;
[[▷「离开」|小镇]]
&lt;&lt;elseif $home == &quot;旅店&quot;&gt;&gt;【前台的女孩在漫不经心的翻着手里的时尚杂志, 见到你进门也只是问了句: &quot;几号房? &quot; 你看了看钥匙, 读出了上面的数字, 女孩示意了一下登记表上的日期】
&lt;&lt;if $feather &lt;= 9&gt;&gt;&lt;br&gt;【你意识到你付不起今天的房钱】
&lt;&lt;else&gt;&gt;&lt;br&gt;
&lt;&lt;link ▷「付钱」 旅店&gt;&gt;&lt;&lt;set $choice to &quot;付钱&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;(10鸟羽)&lt;&lt;/if&gt;&gt;&lt;br&gt;
[[▷「离开」|小镇]]
&lt;&lt;else&gt;&gt;【前台的女孩在漫不经心的翻着手里的时尚杂志, 见到你进门也只是问了句: &quot;几号房? &quot; 你并没有旅店的钥匙, 只能一脸窘迫的离开了这里, 幸运的是, 直到你出门前台的姑娘都没正眼看过你】&lt;br&gt;
[[▷「离开」|小镇]]
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="73" name="日常行动" tags="nobr" position="1100,0" size="100,100">/*散步*/
&lt;&lt;if $choice == &quot;捏死&quot;&gt;&gt;
【你把虫子从身上摘下来, 用手指轻轻挤压, 毫不费力地压扁了这个小家伙. 又一场胜利】
&lt;&lt;elseif $choice == &quot;拍掉&quot;&gt;&gt;
【你轻弹衣服, 虫子沿着一道抛物线飞了出去, 紧接着一个完美落地. 祈祷你们俩不会再碰面了】
&lt;&lt;elseif $choice ==&quot;蟑螂&quot; || $choice ==&quot;蜈蚣&quot; || $choice ==&quot;蜘蛛&quot; || $choice ==&quot;蚂蚁&quot;&gt;&gt;&lt;&lt;pickup $item $choice 1&gt;&gt;
【你把虫子从身上摘下来, 装进了口袋】&lt;br&gt;
&lt;font color=#4E84BA&gt;✧你获得$choice * 1✧&lt;/font&gt;
&lt;&lt;elseif $choice == &quot;丢掉&quot;&gt;&gt;
【你丢掉了手里的毒蘑菇, 继续着自己的事情】
&lt;&lt;elseif $choice == &quot;鸟蛋&quot;&gt;&gt;&lt;&lt;pickup $food 鸟蛋 1&gt;&gt;
【离你最近的那枚鸟蛋成为了你的幸运儿】
&lt;font color=#4E84BA&gt;✧你获得鸟蛋 * 1✧&lt;/font&gt;
&lt;&lt;elseif $choice == &quot;毒蘑菇&quot;&gt;&gt;&lt;&lt;pickup $food 毒蘑菇 1&gt;&gt;
【毒蘑菇也有毒蘑菇的用途】
&lt;font color=#4E84BA&gt;✧你获得毒蘑菇 * 1✧&lt;/font&gt;

/*打猎*/





&lt;&lt;/if&gt;&gt;
&lt;br&gt;&lt;br&gt;&lt;&lt;link ▷「继续」 $loc&gt;&gt;&lt;&lt;/link&gt;&gt;</tw-passagedata><tw-passagedata pid="74" name="日志" tags="nobr" position="1800,0" size="100,100">&lt;div id=&quot;idcard&quot;&gt;&lt;table style=&quot;width:100%; border-style: none;&quot;&gt;
&lt;tbody align=&quot;center&quot;&gt;
  &lt;tr&gt;&lt;td rowspan=7 style=&quot;width:60%&quot;&gt;&lt;&lt;if $nn == &quot;Nix&quot;&gt;&gt;&lt;img src=&quot;https://f2.toyhou.se/file/f2-toyhou-se/images/95512775_jgcolbTxzr46GdO.png&quot; width=100% class=&quot;pic&quot;&gt;&lt;&lt;else&gt;&gt;你是谁? 你不属于这里&lt;&lt;/if&gt;&gt;&lt;/td&gt;&lt;/tr&gt;
  &lt;tr&gt;&lt;td&gt;$name&lt;/td&gt;&lt;/tr&gt;
    &lt;tr&gt;&lt;td&gt;年龄：$age&lt;/td&gt;&lt;/tr&gt;
  &lt;tr&gt;&lt;td&gt;来自：$hometown&lt;/td&gt;&lt;/tr&gt;
  &lt;tr&gt;&lt;td&gt;身份：$id&lt;/td&gt;&lt;/tr&gt;
  &lt;tr&gt;&lt;td&gt;住所：$home&lt;/td&gt;&lt;/tr&gt;
  &lt;tr&gt;&lt;td&gt;工作：$job&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/div&gt;
&lt;br&gt;
&lt;div id=&quot;chatextcard&quot;&gt;
&lt;center&gt;&lt;b&gt;灵魂状态&lt;/b&gt;&lt;br&gt;&lt;&lt;if $soul == &quot;蓝色&quot;&gt;&gt;
&lt;font color=#449DD6&gt; 猫族&lt;/font&gt;
&lt;&lt;elseif $soul == &quot;红色&quot;&gt;&gt;
&lt;font color=#EC450A&gt; 龙裔&lt;/font&gt;
&lt;&lt;elseif setup.getStat(&quot;heartless&quot;) &gt;= 50&gt;&gt;
&lt;font color=#7BCDDC&gt; 寒冷&lt;/font&gt;
&lt;&lt;elseif setup.getStat(&quot;bloody&quot;) &gt;= 50&gt;&gt;
&lt;font color=#82140C&gt; 染血&lt;/font&gt;
&lt;&lt;elseif setup.getStat(&quot;confidence&quot;) &gt;= 50&gt;&gt;
&lt;font color=#CD6DBB&gt; 凝固&lt;/font&gt;
&lt;&lt;elseif setup.getStat(&quot;enjoy&quot;) &gt;= 50&gt;&gt;
&lt;font color=#ABC29A&gt; 发酵&lt;/font&gt;
&lt;&lt;elseif $hunger &gt;= 50&gt;&gt;
&lt;font color=#4B4B4B&gt; 饥饿&lt;/font&gt;
&lt;&lt;elseif $abs &gt;= 50&gt;&gt;
&lt;font color=#777777&gt; 无光&lt;/font&gt;
&lt;&lt;elseif $soul == &quot;金色&quot;&gt;&gt;
&lt;font color=#FFD151&gt; 融合神&lt;/font&gt;&lt;&lt;/if&gt;&gt;的灵魂&lt;/center&gt;
&lt;br&gt;
&lt;center&gt;&lt;b&gt;属性值&lt;/b&gt;&lt;br&gt;
•&amp;nbsp;学识：&lt;&lt;=setup.getStat(&quot;knowledge&quot;)&gt;&gt;
&amp;emsp;•&amp;nbsp;力量：&lt;&lt;=setup.getStat(&quot;strength&quot;)&gt;&gt;&lt;br&gt;
•&amp;nbsp;观察：&lt;&lt;=setup.getStat(&quot;observation&quot;)&gt;&gt;
&amp;emsp;•&amp;nbsp;话术：&lt;&lt;=setup.getStat(&quot;persuasive&quot;)&gt;&gt;
&lt;&lt;if setup.getStat(&quot;cautious&quot;) &gt; 0&gt;&gt;&lt;br&gt;&amp;nbsp;•&amp;nbsp;谨慎：&lt;&lt;=setup.getStat(&quot;cautious&quot;)&gt;&gt;&lt;&lt;/if&gt;&gt;
&lt;&lt;if setup.getStat(&quot;heartless&quot;) &gt; 0&gt;&gt;&lt;br&gt;&amp;nbsp;•&amp;nbsp;无情：&lt;&lt;=setup.getStat(&quot;heartless&quot;)&gt;&gt;&lt;&lt;/if&gt;&gt;
&lt;&lt;if setup.getStat(&quot;bloody&quot;) &gt; 0&gt;&gt;&lt;br&gt;&amp;nbsp;•&amp;nbsp;嗜血：&lt;&lt;=setup.getStat(&quot;bloody&quot;)&gt;&gt;&lt;&lt;/if&gt;&gt;
&lt;&lt;if setup.getStat(&quot;confidence&quot;) &gt; 0&gt;&gt;&lt;br&gt;&amp;nbsp;•&amp;nbsp;自信：&lt;&lt;=setup.getStat(&quot;confidence&quot;)&gt;&gt;&lt;&lt;/if&gt;&gt;
&lt;&lt;if setup.getStat(&quot;generous&quot;) &gt; 0&gt;&gt;&lt;br&gt;&amp;nbsp;•&amp;nbsp;慷慨：&lt;&lt;=setup.getStat(&quot;generous&quot;)&gt;&gt;&lt;&lt;/if&gt;&gt;
&lt;&lt;if setup.getStat(&quot;enjoy&quot;) &gt; 0&gt;&gt;&lt;br&gt;&amp;nbsp;•&amp;nbsp;享乐：&lt;&lt;=setup.getStat(&quot;enjoy&quot;)&gt;&gt;&lt;&lt;/if&gt;&gt;&lt;/center&gt;
&lt;/div&gt;&lt;br&gt;
&lt;b&gt;收集进度&lt;/b&gt;&lt;br&gt;
🐟钓鱼图鉴：&lt;&lt;=$fishcollect.length&gt;&gt; / 32&lt;br&gt;
🦌狩猎图鉴：&lt;&lt;=$preycollect.length&gt;&gt; / 37&lt;br&gt;
🍷酿酒配方：0 / 6&lt;br&gt;
🥞烹饪配方：0 / 48
&lt;br&gt;&lt;br&gt;
&lt;b&gt;即将到来的事件&lt;/b&gt;&lt;br&gt;
&lt;&lt;if $date &lt;= 4&gt;&gt;⭐礼拜三  20: 00  拓荒者木屋  篝火晚会&lt;br&gt;&lt;&lt;/if&gt;&gt;
&lt;&lt;if $date &lt;= 5 &amp;&amp; $numbfirstc == 1&gt;&gt;⭐礼拜四  15: 00  LSS马场  赛马&lt;br&gt;&lt;&lt;/if&gt;&gt;

&lt;&lt;if !$soul&gt;&gt;
&lt;&lt;else&gt;&gt;
 &lt;&lt;set _progress1 to setup.getStat(&quot;heartless&quot;)/50, _progress01 to setup.getStat(&quot;heartless&quot;)&gt;&gt; 
&lt;&lt;set _progress2 to setup.getStat(&quot;bloody&quot;)/50, _progress02 to setup.getStat(&quot;bloody&quot;)&gt;&gt;
&lt;&lt;set _progress3 to setup.getStat(&quot;confidence&quot;)/50, _progress03 to setup.getStat(&quot;confidence&quot;)&gt;&gt;
&lt;&lt;set _progress4 to setup.getStat(&quot;enjoy&quot;)/50, _progress04 to setup.getStat(&quot;enjoy&quot;)&gt;&gt;
&lt;&lt;set _progress5 to $hunger/24, _progress05 to $hunger&gt;&gt;
&lt;&lt;set _progress6 to $abs/20, _progress06 to $abs&gt;&gt;

&lt;&lt;if setup.getStat(&quot;heartless&quot;) lt 50 &amp;&amp; setup.getStat(&quot;bloody&quot;) lt 50 &amp;&amp; setup.getStat(&quot;confidence&quot;) lt 50 &amp;&amp; setup.getStat(&quot;enjoy&quot;) lt 50 &amp;&amp; $hunger lt 24 &amp;&amp; $abs lt 20 &amp;&amp; $fame lt 24 &gt;&gt;
&lt;&lt;if $soul == &quot;蓝色&quot;&gt;&gt;
&lt;span id=&quot;bluesoul&quot;&gt;&lt;/span&gt;
&lt;&lt;elseif $soul == &quot;红色&quot;&gt;&gt;
&lt;span id=&quot;redsoul&quot;&gt;&lt;/span&gt;
&lt;&lt;elseif $soul == &quot;金色&quot;&gt;&gt;
&lt;span id=&quot;goldsoul&quot;&gt;&lt;/span&gt;&lt;&lt;/if&gt;&gt;
&lt;span id=&quot;coldsoul&quot; @style=&quot; &#39;z-index:&#39; +_progress01+&#39;;&#39; + &#39;opacity:&#39; +_progress1+&#39;;&#39;&quot;&gt;&lt;/span&gt;
&lt;span id=&quot;bloodsoul&quot; @style=&quot; &#39;opacity:&#39; +_progress2+&#39;;&#39; + &#39;z-index:&#39; +_progress02+&#39;;&#39; &quot;&gt;&lt;/span&gt;
&lt;span id=&quot;solidsoul&quot; @style=&quot; &#39;opacity:&#39; +_progress3+&#39;;&#39; + &#39;z-index:&#39; +_progress03+&#39;;&#39; &quot;&gt;&lt;/span&gt;
&lt;span id=&quot;fermentsoul&quot; @style=&quot; &#39;opacity:&#39; +_progress4+&#39;;&#39; + &#39;z-index:&#39; +_progress04+&#39;;&#39; &quot;&gt;&lt;/span&gt;
&lt;span id=&quot;hungersoul&quot; @style=&quot; &#39;opacity:&#39; +_progress5+&#39;;&#39; + &#39;z-index:&#39; +_progress05+&#39;;&#39; &quot;&gt;&lt;/span&gt;
&lt;span id=&quot;lightlesssoul&quot; @style=&quot; &#39;opacity:&#39; +_progress6+&#39;;&#39; + &#39;z-index:&#39; +_progress06+&#39;;&#39; &quot;&gt;&lt;/span&gt;
&lt;&lt;elseif $fame == 24&gt;&gt;
&lt;span id=&quot;goldsoul&quot;&gt;&lt;/span&gt;
&lt;&lt;elseif setup.getStat(&quot;heartless&quot;) &gt;= 50&gt;&gt;
&lt;span id=&quot;coldsoul&quot;&gt;&lt;/span&gt;
&lt;&lt;elseif setup.getStat(&quot;bloody&quot;) &gt;= 50&gt;&gt;
&lt;span id=&quot;bloodsoul&quot;&gt;&lt;/span&gt;
&lt;&lt;elseif setup.getStat(&quot;confidence&quot;) &gt;= 50&gt;&gt;
&lt;span id=&quot;solidsoul&quot;&gt;&lt;/span&gt;
&lt;&lt;elseif setup.getStat(&quot;enjoy&quot;) &gt;= 50&gt;&gt;
&lt;span id=&quot;fermentsoul&quot;&gt;&lt;/span&gt;
&lt;&lt;elseif $hunger &gt;= 50&gt;&gt;
&lt;span id=&quot;hungersoul&quot;&gt;&lt;/span&gt;
&lt;&lt;elseif $abs &gt;= 50&gt;&gt;
&lt;span id=&quot;lightlesssoul&quot;&gt;&lt;/span&gt;

&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="75" name="时间" tags="widget nobr" position="500,0" size="100,100">&lt;&lt;widget &quot;timeWidget&quot;&gt;&gt;
&lt;&lt;if $minute &gt;= 60&gt;&gt;
	&lt;&lt;set $hour += 1&gt;&gt;
	&lt;&lt;set $minute = $minute - 60&gt;&gt;
    &lt;&lt;if $drunk &gt; 0&gt;&gt;&lt;&lt;set $drunk -= 1&gt;&gt;&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;if $hour &gt;= 24&gt;&gt;
	&lt;&lt;set $hour = $hour - 24&gt;&gt;
	&lt;&lt;set $week +=1&gt;&gt;
    &lt;&lt;set $date +=1, $lny to 0, $day +=1&gt;&gt;&lt;&lt;set $dtr to 0, $dtr1 to 0, $dtr2 to 0&gt;&gt;&lt;&lt;set $sleept = 0&gt;&gt;&lt;&lt;set $dgcs = 6, $fycs = 3, $gzcs = 3&gt;&gt;&lt;&lt;set $innpay = 0&gt;&gt;&lt;&lt;set $eragift = 1&gt;&gt;&lt;&lt;set $origift = 1&gt;&gt;
    &lt;&lt;if $lostsheep[0] ==1&gt;&gt;&lt;&lt;set $lostsheep[0] = 2&gt;&gt;&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;if $month ==4 &amp;&amp; $day &gt;=31 || $month ==6 &amp;&amp; $day &gt;=31 || $month ==9 &amp;&amp; $day &gt;=31 || $month ==11 &amp;&amp; $day &gt;=31&gt;&gt;&lt;&lt;set $month +=1, $day =1&gt;&gt;
&lt;&lt;elseif $month ==2 &amp;&amp; $day &gt;=29 &gt;&gt;&lt;&lt;set $month +=1, $day =1&gt;&gt;
&lt;&lt;elseif $day&gt;=32&gt;&gt;&lt;&lt;set $month +=1, $day =1&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;if $minute &lt; 10&gt;&gt;
  &lt;&lt;set $showMinute = &#39;0&#39; + $minute&gt;&gt;
&lt;&lt;else&gt;&gt;
  &lt;&lt;set $showMinute = $minute&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;if $hour &lt; 10&gt;&gt;
  &lt;&lt;set $showHour = &#39;0&#39; + $hour&gt;&gt;
&lt;&lt;else&gt;&gt;
  &lt;&lt;set $showHour = $hour&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;if $day &lt; 10&gt;&gt;
  &lt;&lt;set $showday = &#39;0&#39; + $day&gt;&gt;
&lt;&lt;else&gt;&gt;
  &lt;&lt;set $showday = $day&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;if $month &lt; 10&gt;&gt;
  &lt;&lt;set $showmonth = &#39;0&#39; + $month&gt;&gt;
&lt;&lt;else&gt;&gt;
  &lt;&lt;set $showmonth = $month&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;if $week &gt;= 8&gt;&gt;
	&lt;&lt;set $week = 1&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;moonphase&quot;&gt;&gt;
&lt;&lt;if $day &lt;= 1 || $day &gt;=30&gt;&gt;
&lt;img src=&quot;https://f2.toyhou.se/file/f2-toyhou-se/images/88029813_2KxAXJVPUGOdFoa.png&quot; width=8%&gt;
&lt;&lt;elseif $day &lt;= 5 &amp;&amp; $day &gt;=3&gt;&gt;
&lt;img src=&quot;https://f2.toyhou.se/file/f2-toyhou-se/images/88029819_IbSue9ebfeyhSY7.png&quot; width=8%&gt;
&lt;&lt;elseif $day &lt;= 9 &amp;&amp; $day &gt;=6&gt;&gt;
&lt;img src=&quot;https://f2.toyhou.se/file/f2-toyhou-se/images/88029828_NyhG5dNeGXzBr5k.png&quot; width=8%&gt;
&lt;&lt;elseif $day &lt;= 13 &amp;&amp; $day &gt;=10&gt;&gt;
&lt;img src=&quot;https://f2.toyhou.se/file/f2-toyhou-se/images/88029833_VxVAqz2TEBbNcqL.png&quot; width=8%&gt;
&lt;&lt;elseif $day &lt;= 17 &amp;&amp; $day &gt;=14&gt;&gt;
&lt;img src=&quot;https://f2.toyhou.se/file/f2-toyhou-se/images/88029846_ILsTJ5Qyt2sI4as.png&quot; width=8%&gt;
&lt;&lt;elseif $day &lt;= 21 &amp;&amp; $day &gt;=18&gt;&gt;
&lt;img src=&quot;https://f2.toyhou.se/file/f2-toyhou-se/images/88029859_gnBx2FYX6ihH9Qp.png&quot; width=8%&gt;
&lt;&lt;elseif $day &lt;= 25 &amp;&amp; $day &gt;=22&gt;&gt;
&lt;img src=&quot;https://f2.toyhou.se/file/f2-toyhou-se/images/88029861_ltbMpd1qpcjAP3r.png&quot; width=8%&gt;
&lt;&lt;elseif $day &lt;= 29 &amp;&amp; $day &gt;=26&gt;&gt;
&lt;img src=&quot;https://f2.toyhou.se/file/f2-toyhou-se/images/88029872_VCUppna7ap8bfHY.png&quot; width=8%&gt;

&lt;&lt;/if&gt;&gt;
&lt;&lt;/widget&gt;&gt;</tw-passagedata><tw-passagedata pid="76" name="更换装备" tags="nobr" position="800,100" size="100,100">&lt;&lt;if _eqchoice == &quot;手持&quot;&gt;&gt;
&lt;&lt;for _tool range $tool.list&gt;&gt;
        &lt;&lt;capture _tool&gt;&gt;
            &lt;li&gt;&lt;&lt;button `_tool`&gt;&gt; 
                &lt;&lt;run Dialog.close()&gt;&gt;
                &lt;&lt;run setup.equip(&quot;tool&quot;, _tool)&gt;&gt;
                &lt;&lt;redo&gt;&gt;
            &lt;&lt;/button&gt;&gt;〖&lt;&lt;=setup.items[_tool].function&gt;&gt;〗&lt;/li&gt;
        &lt;&lt;/capture&gt;&gt;
    &lt;&lt;/for&gt;&gt;
    
&lt;&lt;elseif _eqchoice == &quot;头部&quot;&gt;&gt;
&lt;&lt;for _head range $head.list&gt;&gt;
        &lt;&lt;capture _head&gt;&gt;
            &lt;li&gt;&lt;&lt;button `_head`&gt;&gt;
                &lt;&lt;run Dialog.close()&gt;&gt;
                &lt;&lt;run setup.equip(&quot;head&quot;, _head)&gt;&gt;
                &lt;&lt;redo&gt;&gt;
            &lt;&lt;/button&gt;&gt;〖&lt;&lt;=setup.items[_head].function&gt;&gt;〗&lt;/li&gt;
        &lt;&lt;/capture&gt;&gt;
    &lt;&lt;/for&gt;&gt;
    
&lt;&lt;elseif _eqchoice == &quot;颈部&quot;&gt;&gt;
&lt;&lt;for _neck range $neck.list&gt;&gt;
        &lt;&lt;capture _neck&gt;&gt;
            &lt;li&gt;&lt;&lt;button `_neck`&gt;&gt;
                &lt;&lt;run Dialog.close()&gt;&gt;
                &lt;&lt;run setup.equip(&quot;neck&quot;, _neck)&gt;&gt;
                &lt;&lt;redo&gt;&gt;
            &lt;&lt;/button&gt;&gt;〖&lt;&lt;=setup.items[_neck].function&gt;&gt;〗&lt;/li&gt;
        &lt;&lt;/capture&gt;&gt;
    &lt;&lt;/for&gt;&gt;

&lt;&lt;elseif _eqchoice == &quot;上身&quot;&gt;&gt;
&lt;&lt;for _top range $top.list&gt;&gt;
        &lt;&lt;capture _top&gt;&gt;
            &lt;li&gt;&lt;&lt;button ` _top`&gt;&gt;
                &lt;&lt;run Dialog.close()&gt;&gt;
                &lt;&lt;run setup.equip(&quot;top&quot;, _top)&gt;&gt;
                &lt;&lt;redo&gt;&gt;
            &lt;&lt;/button&gt;&gt;〖&lt;&lt;=setup.items[_top].function&gt;&gt;〗&lt;/li&gt;
        &lt;&lt;/capture&gt;&gt;
    &lt;&lt;/for&gt;&gt;
    
&lt;&lt;elseif _eqchoice == &quot;手部&quot;&gt;&gt;
&lt;&lt;for _hand range $hand.list&gt;&gt;&lt;&lt;capture _hand&gt;&gt;&lt;li&gt;&lt;&lt;button `_hand`&gt;&gt;&lt;&lt;run Dialog.close()&gt;&gt;&lt;&lt;run setup.equip(&quot;hand&quot;, _hand)&gt;&gt;
&lt;&lt;redo&gt;&gt;&lt;&lt;/button&gt;&gt;〖&lt;&lt;=setup.items[_hand].function&gt;&gt;〗&lt;/li&gt;&lt;&lt;/capture&gt;&gt;&lt;&lt;/for&gt;&gt;

&lt;&lt;elseif _eqchoice == &quot;下身&quot;&gt;&gt;
&lt;&lt;for _pants range $pants.list&gt;&gt;
        &lt;&lt;capture _pants&gt;&gt;
            &lt;li&gt;&lt;&lt;button ` _pants`&gt;&gt;
                &lt;&lt;run Dialog.close()&gt;&gt;
                &lt;&lt;run setup.equip(&quot;pants&quot;, _pants)&gt;&gt;
                &lt;&lt;redo&gt;&gt;
            &lt;&lt;/button&gt;&gt;〖&lt;&lt;=setup.items[_pants].function&gt;&gt;〗&lt;/li&gt;
        &lt;&lt;/capture&gt;&gt;
    &lt;&lt;/for&gt;&gt;
    
&lt;&lt;elseif _eqchoice == &quot;脚部&quot;&gt;&gt;
&lt;&lt;for _foot range $foot.list&gt;&gt;&lt;&lt;capture _foot&gt;&gt;&lt;li&gt;&lt;&lt;button `_foot`&gt;&gt;&lt;&lt;run Dialog.close()&gt;&gt;&lt;&lt;run setup.equip(&quot;foot&quot;, _foot)&gt;&gt;
&lt;&lt;redo&gt;&gt;&lt;&lt;/button&gt;&gt;〖&lt;&lt;=setup.items[_foot].function&gt;&gt;〗&lt;/li&gt;&lt;&lt;/capture&gt;&gt;&lt;&lt;/for&gt;&gt;

&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="77" name="木屋内部" tags="nobr" position="300,500" size="100,100">&lt;&lt;timed 2s t8n&gt;&gt;&lt;&lt;if $nixloc == &quot;拓荒者木屋&quot;&gt;&gt;
&lt;&lt;audio &quot;mainBGM&quot; mute&gt;&gt;
&lt;&lt;audio &quot;NixBGM&quot; loop play&gt;&gt;

【你来到了拓荒者木屋, Nix给你开了门, 进去坐坐吧】&lt;br&gt;
&lt;br&gt;&lt;br&gt;

[[❖「今日工作」|打工]]  &lt;br&gt;
✧「做客」&lt;br&gt;
&lt;&lt;else&gt;&gt;【你来到了拓荒者木屋, 没有谁应门, 也许你该换个时间】&lt;&lt;/if&gt;&gt;&lt;&lt;/timed&gt;&gt;</tw-passagedata><tw-passagedata pid="78" name="木屋行动" tags="" position="1200,1175" size="100,100">&lt;&lt;nobr&gt;&gt;&lt;&lt;if !$clue&gt;&gt;&lt;&lt;set $clue = []&gt;&gt;&lt;&lt;/if&gt;&gt;&lt;&lt;if $choice == &quot;继续喝茶&quot;&gt;&gt;【你把注意力又放回到茶杯上, 这次你拿起了一块点心, 就着红茶塞进了嘴里】&lt;&lt;set $HP += 6, $san +=1&gt;&gt;&lt;&lt;pickup $food &quot;鲜花饼&quot; 15&gt;&gt;&lt;font color=#4E84BA&gt;✧你获得鲜花饼*1✧&lt;/font&gt;
&lt;&lt;elseif $choice == &quot;四处转转&quot;&gt;&gt;&lt;&lt;set _a to setup.getStat(&quot;observation&quot;)/12*100&gt;&gt;&lt;&lt;checkWidget&gt;&gt;&lt;&lt;if _rst == &quot;大成功&quot; || _rst == &quot;成功&quot;&gt;&gt;【未经主人同意在屋内参观似乎不太礼貌, 但你也没收到禁止. 你看向Nix消失的走廊, 木屋的另一头似乎还有两个房间, 你意识到尽管从外面看起来很是狭小, 木屋内部的空间却意外的充足】&lt;&lt;set $clue.push({name: &#39;拓荒者木屋&#39;, dscr: &#39;木屋的内部看起来比外面要大得多&#39;})&gt;&gt;&lt;&lt;notify 3s&gt;&gt;〖获得线索: 拓荒者木屋〗&lt;&lt;/notify&gt;&gt;
&lt;&lt;set $observationexp to $observationexp+4&gt;&gt;&lt;&lt;addoexpWidget&gt;&gt;&lt;&lt;else&gt;&gt;【未经主人同意在屋内参观似乎不太礼貌, 但你也没收到禁止. 你看向Nix消失的走廊, 木屋的另一头似乎还有两个房间, 而在你左手旁是在烧着水壶的厨房】&lt;&lt;/if&gt;&gt;
&lt;&lt;elseif $choice == &quot;什么也不做&quot;&gt;&gt;【光是坐在这个极度柔软的沙发上就让你感到满足了, 你向后躺下, 几乎整个陷进了沙发垫里】&lt;&lt;/if&gt;&gt;&lt;&lt;/nobr&gt;&gt;

&lt;&lt;timed 2s t8n&gt;&gt;【Nix拎着钥匙回来了, 胡须上粘到了一些灰尘, 她抖抖胡须, 把钥匙交给了你】
&lt;&lt;pickup $item &quot;旅店钥匙&quot; 1&gt;&gt;&lt;font color=#4E84BA&gt;✧你获得旅店钥匙*1✧&lt;/font&gt;&lt;&lt;/timed&gt;&gt;

&lt;&lt;timed 4s t8n&gt;&gt;【&quot;前台的姑娘看到你的钥匙就会让你进去了. 记得晚上要付上第二天的房费, 今天的就算我请客了. &quot;】&lt;&lt;if $nn == &quot;Nix&quot;&gt;&gt;&lt;&lt;set $home to &quot;拓荒者木屋&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;&lt;&lt;/timed&gt;&gt;

 &lt;&lt;timed 5s t8n&gt;&gt;⋙⋙⋙⋙⋙⋙⋘⋘⋘⋘⋘⋘
[[▷「去旅店」|旅店]]&lt;&lt;/timed&gt;&gt;</tw-passagedata><tw-passagedata pid="79" name="未完成" tags="" position="1900,0" size="100,100">&lt;&lt;inv $ms   inspect&gt;&gt;
&lt;&lt;inv $ss   inspect&gt;&gt;</tw-passagedata><tw-passagedata pid="80" name="杂货铺" tags="nobr" position="0,400" size="100,100">&lt;&lt;if $loc != &quot;杂货铺&quot;&gt;&gt;&lt;&lt;set $loc = &quot;杂货铺&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;
【你推开杂货铺陈旧的木门, 老板Jonh躺在柜台后的摇椅上, 看着像睡着了】
&lt;br&gt;&lt;br&gt;
&lt;&lt;link ✧「出售」 兑换&gt;&gt;&lt;&lt;set $choice = &quot;出售&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;br&gt;
&lt;&lt;link ✧「购物」 兑换&gt;&gt;&lt;&lt;set $choice = &quot;购物&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;br&gt;
&lt;br&gt;&lt;br&gt;
&lt;&lt;link ▷「离开」 小镇&gt;&gt;&lt;&lt;/link&gt;&gt;</tw-passagedata><tw-passagedata pid="81" name="栈桥" tags="nobr" position="700,400" size="100,100">&lt;&lt;if $loc != &quot;栈桥&quot;&gt;&gt;&lt;&lt;set $minute += random(2,5)&gt;&gt;&lt;&lt;set $loc = &quot;栈桥&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;
&lt;&lt;NPCloc&gt;&gt;

[[✧「钓鱼」|钓鱼]]&lt;br&gt;

&lt;br&gt;&lt;br&gt;
&lt;&lt;link ▷「离开」 副港口&gt;&gt;&lt;&lt;/link&gt;&gt;</tw-passagedata><tw-passagedata pid="82" name="死亡" tags="autosave nobr" position="400,100" size="100,100">&lt;&lt;if setup.getStat(&quot;wound&quot;) &gt;= 24&gt;&gt;流血致死&lt;&lt;/if&gt;&gt;

&lt;&lt;if setup.getStat(&quot;dread&quot;) &gt;= 24&gt;&gt;噩梦中被杀&lt;&lt;/if&gt;&gt;

&lt;&lt;if setup.getStat(&quot;nightmare&quot;) &gt;= 24&gt;&gt;心脏猝死&lt;&lt;/if&gt;&gt;

&lt;&lt;if setup.getStat(&quot;suspicion&quot;) &gt;= 24&gt;&gt;被公众投票处死&lt;&lt;/if&gt;&gt;

死亡结算</tw-passagedata><tw-passagedata pid="83" name="沙地" tags="nobr" position="200,200" size="100,100">&lt;&lt;if $loc != &quot;沙地&quot;&gt;&gt;&lt;&lt;set $loc = &quot;沙地&quot;&gt;&gt;&lt;&lt;timeWidget&gt;&gt;&lt;&lt;set $minute to $minute+ random(5,10)&gt;&gt;&lt;&lt;set $HP to $HP- 1&gt;&gt;&lt;&lt;/if&gt;&gt;
&lt;&lt;audio &quot;mainBGM&quot; unmute&gt;&gt;
&lt;img src=&quot;https://f2.toyhou.se/file/f2-toyhou-se/images/87543144_b65Wbr7Oe80ABO2.jpg&quot; width=100% class=&quot;pic&quot;&gt;
&lt;font color=#D4A34C&gt;//几乎整个永无乡北部的海岸线都可以被称作沙地, 虽统称沙地, 实际的地貌其实多种多样. 栖息在这里的鸟群独属于永无乡, 头领名为Glitrandi, 大洋与岛屿的信风之神, 守护着永无乡周边的船只, 为岛屿带来好天气//&lt;/font&gt;
&lt;br&gt;
&lt;&lt;NPCloc&gt;&gt;
&lt;br&gt;地点活动&lt;br&gt;
&lt;&lt;if $lostsheep[0] == 1&gt;&gt;[[✧「找羊」|era互动]]&lt;br&gt;&lt;&lt;/if&gt;&gt;
[[◈「钓鱼」|钓鱼]]  &lt;br&gt;
[[◈「散步」|散步]]&lt;br&gt;
[[◈「堆个沙堡」|地点活动]]&lt;br&gt;
&lt;br&gt;继续前往&lt;br&gt;
[[✧「断桥」|断桥]]&lt;br&gt;
&lt;br&gt;其他地区&lt;br&gt;
[[♢「小镇」|小镇]]&lt;br&gt;
[[♢「主港口」|主港口]]</tw-passagedata><tw-passagedata pid="84" name="沼泽" tags="" position="500,500" size="100,100">//罗索伦特湖湖靠近深林一侧的一处土质松软的土地, 在长久的湖水侵蚀下成为了如今的沼泽地, 真菌占据了植物们放弃的土壤, 让此地变得更加黏稠阴寒, 似乎在追随深林一般的摒弃了天空的存在, 只有萤火虫偶尔会在夜间闪烁//
&lt;&lt;NPCloc&gt;&gt;
[[❖「萤火虫」|萤火虫]] 
&lt;&lt;link ▷「离开」 罗索伦特湖&gt;&gt;&lt;&lt;/link&gt;&gt;</tw-passagedata><tw-passagedata pid="85" name="泡泡布提" tags="" position="200,500" size="100,100">&lt;b&gt;泡泡布提&lt;/b&gt;
【营业时间 09: 00~15: 00】
&lt;&lt;if $hour &gt;= 9 || $hour &lt;= 15&gt;&gt;&lt;&lt;if $loc != &quot;泡泡布提&quot;&gt;&gt;&lt;&lt;set $loc = &quot;泡泡布提&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;
&lt;img src=&quot;https://f2.toyhou.se/file/f2-toyhou-se/images/95411351_Zyz7Ffh4QP9rzkL.jpg&quot; width:100% class=&quot;pic&quot;&gt;
&lt;font color=#D4A34C&gt;//你推门踏入这家精致奢华到与岛上的气氛格格不入的小店里, 空气中弥漫着轻柔的香水味, 金色的烛光透过造型华丽的壁灯洒在陈列在四处的银镜和宝石上, 让店内恍如白日, 店主显然对时尚有着自己的追求//&lt;/font&gt;

&lt;&lt;link&quot; ✣「玛丽亚小姐」 &quot; &quot;泡泡布提&quot;&gt;&gt;&lt;&lt;set $loct = $loc, $npc to &quot;玛丽亚小姐&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;

&lt;&lt;link ✧「查看商品」 兑换&gt;&gt;&lt;&lt;/link&gt;&gt;
&lt;&lt;link ✧「照镜子」 地点活动&gt;&gt;&lt;&lt;/link&gt;&gt;
&lt;&lt;else&gt;&gt;【泡泡布提的门紧闭着, 换个时间再来吧】&lt;&lt;/if&gt;&gt;

&lt;&lt;link ▷「回到小镇」 小镇&gt;&gt;&lt;&lt;set $npc to 0&gt;&gt;&lt;&lt;/link&gt;&gt;</tw-passagedata><tw-passagedata pid="86" name="测试" tags="" position="2025,100" size="100,100">$needt1  $nt
&lt;&lt;if Item.get(&quot;玫瑰花种子&quot;).hasTag(&quot;seed&quot;)&gt;&gt;111&lt;&lt;/if&gt;&gt;
&lt;&lt;=Item.has(&quot;鲜花诗集&quot;)&gt;&gt;&lt;&lt;=$item.count(&#39;玫瑰花种子&#39;)&gt;&gt;

🌆🌙✨🪐🕯️💀

&lt;&lt;set _i =random(1, $item.uniqueLength)&gt;&gt;
&lt;&lt;= $item.list[_i]&gt;&gt;

&lt;div id=&quot;qte&quot;&gt;
&lt;&lt;button &amp;nbsp;&gt;&gt;&lt;&lt;/button&gt;&gt;
&lt;/div&gt;


[[随机设定]]

[[烹饪]]

[[壁炉]]

&lt;&lt;link 物品分类1&gt;&gt;&lt;&lt;set _tmpt = &quot;玫瑰花种子&quot;&gt;&gt;&lt;&lt;if Item.get(_tmpt).hasTag(&quot;seed&quot;)&gt;&gt;&lt;&lt;pickup $fish &quot;玫瑰花种子&quot; 1&gt;&gt;&lt;&lt;/if&gt;&gt;&lt;&lt;/link&gt;&gt;

&lt;&lt;link 物品分类2&gt;&gt;&lt;&lt;set _tmpt = &quot;fish&quot;&gt;&gt;&lt;&lt;if Item.get(&quot;玫瑰花种子&quot;).hasTag(&quot;seed&quot;)&gt;&gt;&lt;&lt;pickup $_tmpt &quot;玫瑰花种子&quot; 1&gt;&gt;&lt;&lt;/if&gt;&gt;&lt;&lt;/link&gt;&gt;

&lt;&lt;link 看书&gt;&gt;&lt;&lt;set $choice = &quot;百诗集&quot;, $page =1, $pageS=&quot;on&quot;&gt;&gt;&lt;&lt;run Dialog.setup($choice);Dialog.wiki(Story.get(&quot;阅读&quot;).processText());Dialog.open();&gt;&gt;&lt;&lt;/link&gt;&gt;

&lt;&lt;link 萤火虫 萤火虫&gt;&gt;&lt;&lt;set $qte to true&gt;&gt;&lt;&lt;set $succ = 0, $num to random(4,8)&gt;&gt;&lt;&lt;/link&gt;&gt;

咖啡因 &lt;&lt;link&quot; +1 &quot; &quot;测试&quot;&gt;&gt;&lt;&lt;set $coffin+= 1&gt;&gt;&lt;&lt;/link&gt;&gt;
无情 &lt;&lt;link&quot; +1 &quot; &quot;测试&quot;&gt;&gt;&lt;&lt;set $player.heartless += 1&gt;&gt;&lt;&lt;/link&gt;&gt;
嗜血 &lt;&lt;link&quot; +1 &quot; &quot;测试&quot;&gt;&gt;&lt;&lt;set $player.bloody += 1&gt;&gt;&lt;&lt;/link&gt;&gt;
享乐 &lt;&lt;link&quot; +1 &quot; &quot;测试&quot;&gt;&gt;&lt;&lt;set $player.enjoy += 1&gt;&gt;&lt;&lt;/link&gt;&gt;
自信 &lt;&lt;link&quot; +1 &quot; &quot;测试&quot;&gt;&gt;&lt;&lt;set $player.confidence += 1&gt;&gt;&lt;&lt;/link&gt;&gt;
饥饿 &lt;&lt;link&quot; +1 &quot; &quot;测试&quot;&gt;&gt;&lt;&lt;set $hunger += 1&gt;&gt;&lt;&lt;/link&gt;&gt;
放弃任务 &lt;&lt;link&quot; +1 &quot; &quot;测试&quot;&gt;&gt;&lt;&lt;set $abs += 1&gt;&gt;&lt;&lt;/link&gt;&gt;

【你来到后院】
&lt;&lt;link♢「苗圃1」 种地&gt;&gt;&lt;&lt;set $choice to &quot;land1&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;
&lt;&lt;link♢「苗圃2」 种地&gt;&gt;&lt;&lt;set $choice to &quot;land2&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;
&lt;&lt;link♢「苗圃3」 种地&gt;&gt;&lt;&lt;set $choice to &quot;land3&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;
&lt;br&gt;&lt;br&gt;
@@.pulse;这是弹出效果@@&lt;br&gt;
@@.shudder;这是左右晃动@@&lt;br&gt;
@@.rumble;这是上下晃动@@
@@.emboss;这是浮雕效果@@
@@.blur;This text should be blurred@@
@@.blurrier;This text should be blurrier@@
@@.goodblur;This text should be smeared@@
@@.mirror;This text should be mirrored@@
@@.upside-down;This text should be upside-down@@

&lt;&lt;set _now to new Date()&gt;&gt;

Year: &lt;&lt;= _now.getFullYear()&gt;&gt;
Month: &lt;&lt;= _now.getMonth()&gt;&gt;
Day: &lt;&lt;= _now.getDate()&gt;&gt;
Hour: &lt;&lt;= _now.getHours()&gt;&gt;
Minute: &lt;&lt;= _now.getMinutes()&gt;&gt;
Second: &lt;&lt;= _now.getSeconds()&gt;&gt;</tw-passagedata><tw-passagedata pid="87" name="海域" tags="nobr" position="700,600" size="100,100">&lt;&lt;if $choice == &quot;钓鱼&quot;&gt;&gt;【你在一片平静的海域, 接下来想怎么做?】&lt;br&gt;&lt;br&gt;
 &lt;&lt;link ✧「钓鱼」 钓鱼&gt;&gt;&lt;&lt;set $choice to &quot;钓鱼&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;br&gt;
&lt;&lt;link ✧「返航」 海域&gt;&gt;&lt;&lt;set $choice to &quot;返航&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;br&gt;
&lt;&lt;link ✧「驶向远方」 海域&gt;&gt;&lt;&lt;set $choice to &quot;驶向远方&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;br&gt;

&lt;&lt;elseif $choice == &quot;返航&quot;&gt;&gt;&lt;&lt;set $choice to 0, $loc = &quot;副港口&quot;&gt;&gt;【你拿起了船桨, 向着不远处的小岛划回去, 没一会, 就看到了进岛的港口】&lt;br&gt;&lt;br&gt;
【你回到了永无乡】&lt;br&gt;&lt;br&gt;
[[✧「出海」|海域]]&lt;br&gt;[[✧「还船」|地点活动]]&lt;br&gt;

&lt;&lt;elseif $choice == &quot;驶向远方&quot;&gt;&gt;【你拿起了船桨, 想继续往远处划去...】&lt;br&gt;&lt;br&gt;
&lt;&lt;timed 3s t8n&gt;&gt;【你似乎被什么力量阻挡, 无论你航行了多久, 身后的永无乡看起来都是一般大小. 是你从未走远, 还是她在追赶你?】&lt;br&gt;&lt;br&gt;
 &lt;&lt;link ✧「钓鱼」 钓鱼&gt;&gt;&lt;&lt;set $choice to &quot;钓鱼&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;br&gt;
&lt;&lt;link ✧「返航」 海域&gt;&gt;&lt;&lt;set $choice to &quot;返航&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;br&gt;&lt;&lt;/timed&gt;&gt;

&lt;&lt;elseif $bboat == 1 &amp;&amp; $bdate &lt; $date&gt;&gt;【你不应在使用这条船. 它在几天前就该被归还. 它拒绝了你的要求, 由内而外的裂出数十条裂痕. 永无乡永远失去了这条船】&lt;br&gt;&lt;br&gt;
&lt;&lt;link ▷「返回」 $loc&gt;&gt;&lt;&lt;/link&gt;&gt;
&lt;&lt;elseif $HP lt 50&gt;&gt;【你感到些许疲惫, 做事情力不从心. 你最好去吃点东西休息一下, 充足的睡眠没有坏处】&lt;br&gt;&lt;br&gt;
&lt;&lt;link ▷「返回」 $loc&gt;&gt;&lt;&lt;/link&gt;&gt;
&lt;&lt;elseif $bboat != 1&gt;&gt;【你还没有出海的船只, 去鱼铺那里租船吧】&lt;br&gt;&lt;br&gt;
&lt;&lt;link ▷「返回」 $loc&gt;&gt;&lt;&lt;/link&gt;&gt;
&lt;&lt;elseif $hour &gt;= 18 || $weather == &quot;中雨&quot; || $weather == &quot;有雾&quot; || $weather == &quot;暴雨&quot;&gt;&gt;【今天的天气不适宜出海】&lt;br&gt;&lt;br&gt;
&lt;&lt;link ▷「返回」 $loc&gt;&gt;&lt;&lt;/link&gt;&gt;
&lt;&lt;else&gt;&gt;&lt;&lt;set $HP -= 50, $loc = &quot;海域&quot;&gt;&gt;&lt;&lt;drop $item &quot;鱼饵&quot; 1&gt;&gt;&lt;&lt;set _ft to random(1,10)&gt;&gt;【你找到自己的租船, 将手头的东西都放上去, 解开缰绳, 把船推进水域, 准备出海了】
&lt;br&gt;&lt;br&gt;
&lt;&lt;timed 3s t8n&gt;&gt;【你到了一片平静的海域, 接下来想怎么做?】&lt;br&gt;&lt;br&gt;
 &lt;&lt;link ✧「钓鱼」 钓鱼&gt;&gt;&lt;&lt;set $choice to &quot;钓鱼&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;br&gt;
&lt;&lt;link ✧「返航」 海域&gt;&gt;&lt;&lt;set $choice to &quot;返航&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;br&gt;
&lt;&lt;link ✧「驶向远方」 海域&gt;&gt;&lt;&lt;set $choice to &quot;驶向远方&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;br&gt;&lt;&lt;/timed&gt;&gt;
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="88" name="深林边缘" tags="nobr" position="500,600" size="100,100">&lt;&lt;if $loc != &quot;深林边缘&quot;&gt;&gt;&lt;&lt;set $loc = &quot;深林边缘&quot;&gt;&gt;&lt;&lt;set $minute to $minute+ random(5,10)&gt;&gt;&lt;&lt;set $HP to $HP- 1&gt;&gt;&lt;&lt;/if&gt;&gt;//深林是一片庞大的温带森林, 占据着永无乡西部的大部分土地, 是守夜者们主要的巡逻区域. 深林常年白雾缭绕, 里面的树木繁密而高大, 似乎都已生长百年之久, 其中盘踞着数目可观的危险生物, 普通居民严禁进入深林. 深林边缘设有分界咒语, 禁止任何跨越//&lt;br&gt;
&lt;br&gt;
【你被屏障阻拦了脚步. 这里禁止进入】&lt;br&gt;
&lt;br&gt;
&lt;&lt;if  $wellfirst == 1&gt;&gt;[[♢「许愿井」|许愿井]]&lt;br&gt;&lt;&lt;/if&gt;&gt;
[[♢「守夜者灯塔」|守夜者灯塔]]&lt;br&gt;
&lt;br&gt;
&lt;&lt;link ▷「离开」 罗索伦特湖&gt;&gt;&lt;&lt;set _s to random(1,4)&gt;&gt;&lt;&lt;if $player.knowledge&gt;=18 &amp;&amp; _s &lt;=3 &amp;&amp; $wellfirst != 1&gt;&gt;&lt;&lt;goto &quot;许愿井&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;&lt;&lt;/link&gt;&gt;</tw-passagedata><tw-passagedata pid="89" name="添加燃料" tags="nobr" position="1300,500" size="100,100">&lt;&lt;if $fpfirst !=1&gt;&gt;
&lt;&lt;set $fireplace = {&quot;addD&quot;: 0, &quot;addT&quot;: 0, &quot;fuelT&quot;: 0, &quot;burningT&quot;: 0}&gt;&gt;
&lt;&lt;set $fpfirst = 1&gt;&gt;&lt;&lt;/if&gt;&gt;

&lt;&lt;for _i to 0; _i lt $item.uniqueLength;  _i++&gt;&gt;
&lt;&lt;set _itemn = $item.list[_i]&gt;&gt;
&lt;&lt;if Item.get(_itemn).hasTag(&quot;fuelS&quot;) || Item.get(_itemn).hasTag(&quot;fuelA&quot;) || Item.get(_itemn).hasTag(&quot;fuelB&quot;) || Item.get(_itemn).hasTag(&quot;fuelC&quot;) || Item.get(_itemn).hasTag(&quot;fuelD&quot;)&gt;&gt;
&lt;&lt;set _amount=$item.count(_itemn)&gt;&gt;
 &lt;p @data-item=&quot;_itemn&quot; class=&quot;sell-listing&quot;&gt;
        &lt;span&gt;◈_itemn&lt;/span&gt; 
        &lt;span class=&quot;count&quot;&gt;：_amount&lt;/span&gt;
        &lt;span class=&quot;sell-link&quot;&gt;
          &lt;&lt;capture _itemn, _amount&gt;&gt;
&lt;&lt;link &quot;添加&quot;&gt;&gt;&lt;br&gt;
&lt;&lt;if $item.count(_itemn) &gt;0&gt;&gt;
&lt;&lt;drop $item _itemn 1&gt;&gt;&lt;&lt;set $fireplace.addD = $date, $fireplace.addT = $hour&gt;&gt;
&lt;&lt;if Item.get(_itemn).hasTag(&quot;fuelS&quot;)&gt;&gt;
&lt;&lt;set $fireplace.fuelT += 4&gt;&gt;
&lt;&lt;elseif Item.get(_itemn).hasTag(&quot;fuelA&quot;)&gt;&gt;
&lt;&lt;set $fireplace.fuelT += 2&gt;&gt;
&lt;&lt;elseif Item.get(_itemn).hasTag(&quot;fuelB&quot;)&gt;&gt;
&lt;&lt;set $fireplace.fuelT += 1&gt;&gt;
&lt;&lt;elseif Item.get(_itemn).hasTag(&quot;fuelC&quot;)&gt;&gt;
&lt;&lt;set $fireplace.fuelT += 0.5&gt;&gt;
&lt;&lt;elseif Item.get(_itemn).hasTag(&quot;fuelD&quot;)&gt;&gt;
&lt;&lt;set $fireplace.fuelT += 0.2&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;set _amount --&gt;&gt;
                    &lt;&lt;if _amount &gt; 0&gt;&gt;
                        &lt;&lt;replace `&quot;p.sell-listing[data-item=\&quot;&quot; + _itemn + &quot;\&quot;] &gt; .count&quot;`&gt;&gt;拥有：_amount&lt;&lt;/replace&gt;&gt;
                    &lt;&lt;else&gt;&gt;
                        &lt;&lt;remove `&quot;p.sell-listing[data-item=\&quot;&quot; + _itemn + &quot;\&quot;]&quot;`&gt;&gt;
                    &lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;&lt;/capture&gt;&gt;&lt;/span&gt;&lt;/p&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;/for&gt;&gt;

&lt;&lt;for _i to 0; _i lt $book.uniqueLength;  _i++&gt;&gt;
&lt;&lt;set _itemn = $book.list[_i]&gt;&gt;
&lt;&lt;if Item.get(_itemn).hasTag(&quot;fuelS&quot;) || Item.get(_itemn).hasTag(&quot;fuelA&quot;) || Item.get(_itemn).hasTag(&quot;fuelB&quot;) || Item.get(_itemn).hasTag(&quot;fuelC&quot;) || Item.get(_itemn).hasTag(&quot;fuelD&quot;)&gt;&gt;
&lt;&lt;set _amount=$book.count(_itemn)&gt;&gt;
 &lt;p @data-item=&quot;_itemn&quot; class=&quot;sell-listing&quot;&gt;
        &lt;span&gt;◈_itemn&lt;/span&gt; 
        &lt;span class=&quot;count&quot;&gt;：_amount&lt;/span&gt;&lt;span class=&quot;sell-link&quot;&gt;&lt;&lt;capture _itemn, _amount&gt;&gt;&lt;&lt;link &quot;添加&quot;&gt;&gt;&lt;br&gt;
&lt;&lt;if $book.count(_itemn) &gt;0&gt;&gt;
&lt;&lt;drop $book _itemn 1&gt;&gt;&lt;&lt;set $fireplace.addD = $date, $fireplace.addT = $hour&gt;&gt;
&lt;&lt;if Item.get(_itemn).hasTag(&quot;fuelS&quot;)&gt;&gt;
&lt;&lt;set $fireplace.fuelT += 4&gt;&gt;
&lt;&lt;elseif Item.get(_itemn).hasTag(&quot;fuelA&quot;)&gt;&gt;
&lt;&lt;set $fireplace.fuelT += 2&gt;&gt;
&lt;&lt;elseif Item.get(_itemn).hasTag(&quot;fuelB&quot;)&gt;&gt;
&lt;&lt;set $fireplace.fuelT += 1&gt;&gt;
&lt;&lt;elseif Item.get(_itemn).hasTag(&quot;fuelC&quot;)&gt;&gt;
&lt;&lt;set $fireplace.fuelT += 0.5&gt;&gt;
&lt;&lt;elseif Item.get(_itemn).hasTag(&quot;fuelD&quot;)&gt;&gt;
&lt;&lt;set $fireplace.fuelT += 0.2&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;set _amount --&gt;&gt;
                    &lt;&lt;if _amount &gt; 0&gt;&gt;
                        &lt;&lt;replace `&quot;p.sell-listing[data-item=\&quot;&quot; + _itemn + &quot;\&quot;] &gt; .count&quot;`&gt;&gt;拥有：_amount&lt;&lt;/replace&gt;&gt;
                    &lt;&lt;else&gt;&gt;
                        &lt;&lt;remove `&quot;p.sell-listing[data-item=\&quot;&quot; + _itemn + &quot;\&quot;]&quot;`&gt;&gt;
                    &lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;&lt;/capture&gt;&gt;     &lt;/span&gt;
    &lt;/p&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;/for&gt;&gt;


&lt;br&gt;&lt;br&gt;&lt;&lt;link ▷「返回」 壁炉&gt;&gt;&lt;&lt;set $choice to 0&gt;&gt;&lt;&lt;/link&gt;&gt;</tw-passagedata><tw-passagedata pid="90" name="渔获" tags="" position="1700,400" size="100,100">&lt;&lt;inv $fish use drop inspect stack filter&gt;&gt;</tw-passagedata><tw-passagedata pid="91" name="湖边小屋" tags="" position="600,300" size="100,100">&lt;&lt;if $dn == 0&gt;&gt;【小屋的门紧闭着】&lt;&lt;else&gt;&gt;&lt;&lt;if $loc != &quot;湖边小屋&quot;&gt;&gt;&lt;&lt;set $loc = &quot;湖边小屋&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;&lt;img src=&quot;https://f2.toyhou.se/file/f2-toyhou-se/images/87543112_jMlVWsLI6wNIZxw.jpg&quot; width=100%&gt;

▸▹ ✾ ✾ ✾ ✾ ✾ ✾ ◃◂
 ◈&lt;&lt;link &quot;购买鱼竿&quot;&gt;&gt;&lt;&lt;if $feather &gt;= 12&gt;&gt;&lt;&lt;pickup $tool &quot;鱼竿&quot; 1&gt;&gt;&lt;&lt;set $feather -=12&gt;&gt;&lt;&lt;redo&gt;&gt;&lt;&lt;else&gt;&gt;&lt;&lt;run Dialog.setup(&quot;鸟羽不足&quot;);Dialog.wiki(&quot;【你的鸟羽不足】&quot;);Dialog.open();&gt;&gt;&lt;&lt;/if&gt;&gt;&lt;&lt;/link&gt;&gt;  12鸟羽
 ◈&lt;&lt;link &quot;购买鱼饵&quot;&gt;&gt;&lt;&lt;if $feather &gt;= 2&gt;&gt;&lt;&lt;pickup $item &quot;鱼饵&quot; 1&gt;&gt;&lt;&lt;set $feather -= 2&gt;&gt;&lt;&lt;redo&gt;&gt;&lt;&lt;else&gt;&gt;&lt;&lt;run Dialog.setup(&quot;鸟羽不足&quot;);Dialog.wiki(&quot;【你的鸟羽不足】&quot;);Dialog.open();&gt;&gt;&lt;&lt;/if&gt;&gt;&lt;&lt;/link&gt;&gt;  2鸟羽
▸▹ ✾ ✾ ✾ ✾ ✾ ✾ ◃◂
&lt;&lt;/if&gt;&gt;

&lt;&lt;link ▷「离开」 罗索伦特湖&gt;&gt;&lt;&lt;/link&gt;&gt;</tw-passagedata><tw-passagedata pid="92" name="溶洞" tags="nobr" position="600,600" size="100,100">&lt;&lt;if $loc != &quot;溶洞&quot;&gt;&gt;&lt;&lt;set $loc = &quot;溶洞&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;
//这里是Era的家, 或者说栖身之处, 因为溶洞的布置实在过于简陋, 只有一艘看起来很久没有下水的木舟和堆满角落的破损灯具, 洞顶的尖石上悬挂着一些易于储存的食材//&lt;br&gt;&lt;br&gt;

&lt;&lt;if $eraloc == &quot;溶洞&quot;&gt;&gt;
&lt;&lt;if $hour &lt;=5&gt;&gt;
【溶洞里一片黑暗和死寂, 但洞口多了一些刻意摆放的荆棘, 很明显, Era在家中, 但他并不想在这么晚的时候被打扰】
&lt;&lt;else&gt;&gt;
&lt;&lt;link&quot; ✣「NPC Era」 &quot; &quot;溶洞&quot;&gt;&gt;&lt;&lt;set $loct = $loc, $npc to &quot;Era&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;br&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;else&gt;&gt;
【看上去Era现在不在家】
&lt;br&gt;&lt;br&gt;
✧「帮忙整理」&lt;br&gt;
✧「赠送家具」&lt;br&gt;
✧「摆放蜡烛」
&lt;br&gt;&lt;br&gt;
&lt;&lt;link ▷「离开」 礁岩区&gt;&gt;&lt;&lt;/link&gt;&gt;
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="93" name="潜水" tags="nobr" position="1000,500" size="100,100">&lt;&lt;if $HP lt 6&gt;&gt;【你感到些许疲惫, 做事情力不从心. 你最好去吃点东西休息一下, 充足的睡眠没有坏处】&lt;br&gt;&lt;br&gt;
&lt;&lt;link ▷「返回」 $loc&gt;&gt;&lt;&lt;/link&gt;&gt;
&lt;&lt;else&gt;&gt;
&lt;&lt;set $HP to $HP- 6&gt;&gt;
【你固定好船身, 放好物品, 在一口深呼吸后跃入了漆黑的湖水中】&lt;br&gt;&lt;br&gt;
&lt;&lt;set _s to random(1,100)&gt;&gt;&lt;&lt;set _t to random(1,5)&gt;&gt;&lt;&lt;set $minute to $minute+ random(6,15)&gt;&gt;

&lt;&lt;timed 3s t8n&gt;&gt;
&lt;&lt;if _s &lt;=12&gt;&gt;【你除了腥臭的黑水外你什么也没带回船上】&lt;br&gt;&lt;br&gt;
[[✧「钓鱼」|钓鱼]]&lt;br&gt;
[[✧「潜水」|潜水]]&lt;br&gt;
&lt;&lt;link ♢「回到湖边」 坐船&gt;&gt;&lt;&lt;set $choice to &quot;回到湖边&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;
&lt;&lt;elseif _s &lt;=90&gt;&gt;&lt;&lt;set _fishes= [&quot;扇贝&quot;,&quot;虹鳟鱼&quot;,&quot;鳗鱼&quot;,&quot;鲤鱼&quot;,&quot;雅罗鱼&quot;,&quot;黑鲈鱼&quot;,&quot;螃蟹&quot;].random()&gt;&gt;&lt;&lt;pickup $fish _fishes _t&gt;&gt;
【你捞到了_t个_fishes】&lt;br&gt;&lt;br&gt;
[[✧「钓鱼」|钓鱼]]&lt;br&gt;
[[✧「潜水」|潜水]]&lt;br&gt;
&lt;&lt;link ♢「回到湖边」 坐船&gt;&gt;&lt;&lt;set $choice to &quot;回到湖边&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;
&lt;&lt;else&gt;&gt;

&lt;&lt;if setup.getStat(&quot;observation&quot;) &gt;= setup.getStat(&quot;strength&quot;)&gt;&gt;
【一股突如其来的暗流打乱了你的方向, 你失去了目标, 一心只有在氧气耗尽前返回水面】
&lt;&lt;set _t to random(13,40)&gt;&gt;&lt;&lt;set _r to setup.getStat(&quot;observation&quot;)*_t/10&gt;&gt;&lt;&lt;set _a to setup.getStat(&quot;observation&quot;)/_r*100&gt;&gt;
&lt;&lt;checkWidget&gt;&gt;
&lt;&lt;else&gt;&gt;
【你被水草缠住了脚踝, 这些坚韧的植物几乎将你吞没, 你拼尽全力试图从中解脱】
&lt;&lt;set _t to random(13,40)&gt;&gt;&lt;&lt;set _r to setup.getStat(&quot;strength&quot;)*_t/10&gt;&gt;&lt;&lt;set _a to setup.getStat(&quot;strength&quot;)/_r*100&gt;&gt;
&lt;&lt;checkWidget&gt;&gt;&lt;&lt;/if&gt;&gt;
&lt;br&gt;&lt;br&gt;
&lt;&lt;timed 6s t8n&gt;&gt;
&lt;&lt;if _rst == &quot;大成功&quot; || _rst == &quot;成功&quot;&gt;&gt;&lt;&lt;set $minute to $minute+ random(6,12)&gt;&gt;【你最终做到了. 你狼狈的爬回小船, 险些的溺水让你精疲力竭】&lt;&lt;set $HP to $HP- 12&gt;&gt;
&lt;br&gt;&lt;br&gt;
[[✧「钓鱼」|钓鱼]]&lt;br&gt;
[[✧「潜水」|潜水]]&lt;br&gt;
&lt;&lt;link ♢「回到湖边」 坐船&gt;&gt;&lt;&lt;set $choice to &quot;回到湖边&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;
&lt;&lt;elseif _rst == &quot;失败&quot;&gt;&gt;【遗憾的是, 你做的都只是徒劳. 你昏迷过去, 被发现并带回了医院, 这是需要一段时间才能恢复过来的创伤】&lt;&lt;set $minute += random(30,55)&gt;&gt;&lt;br&gt;
&lt;&lt;set $player.wound +=3&gt;&gt;&lt;font color=#BA3030&gt;你的伤口增加了3级&lt;/font&gt;&lt;br&gt;
&lt;&lt;set $player.dread +=2&gt;&gt;&lt;font color=#BA3030&gt;你的恐惧增加了2级&lt;/font&gt;&lt;br&gt;&lt;br&gt;
[[✧「继续」|医院]]
&lt;&lt;else&gt;&gt;【有什么古老而悲伤的东西从深处升起, 你看不到它, 但你知道它在那里. 你的视线拼命地想要冲破周围漆黑的洪流, 但四下只有绝望. 片刻后, 你意识到你身在别处. 这里有光】&lt;br&gt;【你在礁岩区的溶洞醒来, 在这个火光与燃料不允许存在的空间里, Era破例为你燃起了一小撮炭火, 温暖着你的脸庞. 你注意到Era小舟的船尾上放着还温热的羊奶和一些安神药, 而他本人却不见踪影】&lt;&lt;set $minute += random(30,55)&gt;&gt;&lt;br&gt;
&lt;&lt;set $player.wound +=2&gt;&gt;&lt;font color=#BA3030&gt;你的伤口增加了2级&lt;/font&gt;&lt;br&gt;
&lt;&lt;set $player.nightmare +=4&gt;&gt;&lt;font color=#BA3030&gt;你的噩梦增加了4级&lt;/font&gt;&lt;br&gt;&lt;br&gt;
【你意识到你的兜里装着什么东西. 那是一枚加工过的海螺, 你确信上面有Era的气味】&lt;&lt;pickup $item &quot;海螺号角&quot; 1&gt;&gt;&lt;br&gt;
&lt;font color=#4E84BA&gt;✧你获得海螺号角 * 1✧&lt;/font&gt;&lt;br&gt;&lt;br&gt;
[[✧「继续」|溶洞]]&lt;&lt;/if&gt;&gt;
&lt;&lt;/timed&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;/timed&gt;&gt;
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="94" name="灯塔" tags="" position="100,600" size="100,100">&lt;&lt;if $loc != &quot;主港口灯塔&quot;&gt;&gt;&lt;&lt;set $loc = &quot;主港口灯塔&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;
【灰色混凝土的灯塔矗立在海岸边上，最上头亮光的是一个黑色圆锥顶的小房子。灯塔光滑的外壁不像是任何生物能爬上去的样子，却不知道为什么留下了许多凹陷的痕迹。每到入夜或者风雨袭来的时候，灯塔里就会亮起一束刺破阴沉天空的明黄光芒】

【在灯塔脚下的小木屋里住着这座灯塔的看守Joan Esposito，他是一只白色的瘦高个儿猫咪。当你敲响小屋的门以后，看起来轻薄的木门吱呀一声打开了，里面走出来披着白袍的琼。他眨眼看着你，用孩童一样的嗓音说道：“你好？我是灯塔的看守琼，有什么事儿吗？”】


&lt;&lt;link&quot; ✣「NPC 琼」 &quot; &quot;主港口灯塔&quot;&gt;&gt;&lt;&lt;set $loct = $loc, $npc to &quot;琼&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;

♢「远眺」

&lt;&lt;link ▷「离开」 主港口&gt;&gt;&lt;&lt;set $npc to 0&gt;&gt;&lt;&lt;/link&gt;&gt;</tw-passagedata><tw-passagedata pid="95" name="烹饪" tags="nobr" position="1200,100" size="100,100">&lt;div class=&quot;lefthalf&quot;&gt;
你在过去的日子里学到了食谱&lt;br&gt;

&lt;&lt;filter_recipe `{unlock: true}`&gt;&gt;
&lt;&lt;for _i,_item range _result&gt;&gt;
&lt;&lt;= _item.id&gt;&gt;
&lt;&lt;capture _item.id&gt;&gt;
&lt;&lt;link 做饭&gt;&gt;
&lt;&lt;cook _item.id $food&gt;&gt;
&lt;&lt;if _result.success&gt;&gt;
&lt;&lt;run Dialog.setup(&quot;做饭&quot;);
  Dialog.wiki(&quot;你获得了_item.servings份_item.id&quot;);
  Dialog.open();&gt;&gt;
  &lt;&lt;else&gt;&gt;
&lt;&lt;run Dialog.setup(&quot;做饭&quot;);
  Dialog.wiki(&quot;_result.message&quot;);
  Dialog.open();&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;/cook&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;&lt;/capture&gt;&gt;
&lt;br&gt;
&lt;&lt;/for&gt;&gt;
&lt;&lt;/filter_recipe&gt;&gt;
&lt;/div&gt;

&lt;div class=&quot;righthalf&quot;&gt;
你也可以尽情尝试新的食谱&lt;br&gt;

&lt;&lt;set _tmp = {}&gt;&gt;
&lt;&lt;for _i to 0; _i lt $food.uniqueLength;  _i++&gt;&gt;
&lt;&lt;set _itemn = $food.list[_i]&gt;&gt;
&lt;&lt;if Item.get(_itemn).hasTag(&quot;食材&quot;)&gt;&gt;
◈_itemn:&lt;&lt;=$food.count(_itemn)&gt;&gt;&amp;nbsp;
&lt;&lt;capture _itemn&gt;&gt;
&lt;&lt;link &quot;+1&quot;&gt;&gt;
&lt;&lt;if $food.count(_itemn) &gt;0&gt;&gt;
&lt;&lt;drop $food _itemn 1&gt;&gt;
&lt;&lt;set _tmp[_itemn] = (_tmp[_itemn] ?? 0) + 1&gt;&gt;&lt;&lt;replace &quot;#showmtr&quot;&gt;&gt;&lt;&lt;material _tmp&gt;&gt;&lt;&lt;/replace&gt;&gt;
&lt;&lt;/if&gt;&gt;&lt;&lt;/link&gt;&gt;&amp;nbsp;
&lt;&lt;link &quot;-1&quot;&gt;&gt;
&lt;&lt;if _tmp[_itemn] gt 0&gt;&gt;
&lt;&lt;pickup $food _itemn 1&gt;&gt;
&lt;&lt;set _tmp[_itemn] = (_tmp[_itemn] ?? 0) - 1&gt;&gt;
&lt;&lt;replace &quot;#showmtr&quot;&gt;&gt;&lt;&lt;material _tmp&gt;&gt;&lt;&lt;/replace&gt;&gt;&lt;&lt;/if&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;&lt;/capture&gt;&gt;&lt;br&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;/for&gt;&gt;
&lt;br&gt;&lt;br&gt;
盘子里有：&lt;span id=&quot;showmtr&quot;&gt;&lt;/span&gt;

&lt;br&gt;&lt;br&gt;
&lt;&lt;link 做饭&gt;&gt;&lt;&lt;replace &quot;#showmtr&quot;&gt;&gt;&lt;&lt;material _tmp&gt;&gt;&lt;&lt;/replace&gt;&gt;
&lt;&lt;cook _tmp $food&gt;&gt;
&lt;&lt;if _result.success&gt;&gt;
&lt;&lt;run Dialog.setup(&quot;做饭&quot;);
  Dialog.wiki(&quot;你获得了_result.servings份_result.id&quot;);
  Dialog.open();&gt;&gt;
&lt;&lt;else&gt;&gt;
&lt;&lt;run Dialog.setup(&quot;做饭&quot;);
  Dialog.wiki(&quot;_result.message&quot;);
  Dialog.open();&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;/cook&gt;&gt;&lt;&lt;set _tmp = {}&gt;&gt;&lt;&lt;/link&gt;&gt;
&lt;/div&gt;

&lt;br&gt;
[[测试]]</tw-passagedata><tw-passagedata pid="96" name="物品" tags="" position="1700,0" size="100,100">&lt;&lt;inv $item use drop inspect stack filter&gt;&gt;</tw-passagedata><tw-passagedata pid="97" name="猎户小屋" tags="" position="500,300" size="100,100">&lt;&lt;if $dn == 0&gt;&gt;【小屋的门紧闭着】&lt;&lt;else&gt;&gt;&lt;&lt;set $loc = &quot;猎户小屋&quot;&gt;&gt;&lt;&lt;timeWidget&gt;&gt;&lt;&lt;set $minute to $minute+ random(5,10)&gt;&gt;&lt;&lt;set $HP to $HP- 1&gt;&gt;&lt;img src=&quot;https://f2.toyhou.se/file/f2-toyhou-se/images/87543075_TIdlSzs9pMDM0hD.jpg&quot; width=100%&gt;
//猎户小屋建在草甸的一处小林地上, 起初只用于民居, 在重建时出于便利改为了公共建筑, 存放岛上的肉食储蓄. 小屋的屋檐下整齐悬挂着烟熏肉, 一张毛色黯红的鹿皮作为装饰装订在木门上//


▸▹ ✾ ✾ ✾ ✾ ✾ ✾ ◃◂
 ◈猎枪   20鸟羽   &lt;&lt;link &quot;购买&quot;&gt;&gt;&lt;&lt;if $feather &gt;= 20&gt;&gt;&lt;&lt;pickup $tool &quot;猎枪&quot; 1&gt;&gt;&lt;&lt;set $feather -= 20&gt;&gt;&lt;&lt;redo&gt;&gt;&lt;&lt;else&gt;&gt;&lt;&lt;run Dialog.setup(&quot;鸟羽不足&quot;);Dialog.wiki(&quot;【你的鸟羽不足】&quot;);Dialog.open();&gt;&gt;&lt;&lt;/if&gt;&gt;&lt;&lt;/link&gt;&gt;  
 ◈火药   2鸟羽   &lt;&lt;link &quot;购买&quot;&gt;&gt;&lt;&lt;if $feather &gt;= 2&gt;&gt;&lt;&lt;pickup $item &quot;火药&quot; 1&gt;&gt;&lt;&lt;set $feather -= 2&gt;&gt;&lt;&lt;redo&gt;&gt;&lt;&lt;else&gt;&gt;&lt;&lt;run Dialog.setup(&quot;鸟羽不足&quot;);Dialog.wiki(&quot;【你的鸟羽不足】&quot;);Dialog.open();&gt;&gt;&lt;&lt;/if&gt;&gt;&lt;&lt;/link&gt;&gt;  
▸▹ ✾ ✾ ✾ ✾ ✾ ✾ ◃◂
&lt;&lt;/if&gt;&gt;

&lt;&lt;link ▷「离开」 贝雷河&gt;&gt;&lt;&lt;/link&gt;&gt;</tw-passagedata><tw-passagedata pid="98" name="猎物" tags="" position="1700,300" size="100,100">&lt;&lt;inv $prey use drop inspect stack filter&gt;&gt;</tw-passagedata><tw-passagedata pid="99" name="界面" tags="nobr UIBarhide" position="200,1175" size="100,100">&lt;center&gt;&lt;img src=&quot;https://f2.toyhou.se/file/f2-toyhou-se/images/87542752_OTAoFb7FjfGxA9I.png&quot; width=100%&gt;&lt;br&gt;
&lt;h1&gt;-NEVERLAND- 「永无乡」&lt;/h1&gt;&lt;br&gt;
是©Nix P. R. 创作的&lt;br&gt;
&lt;兽人&gt;&lt;现实半架空&gt;&lt;多元神话&gt;&lt;低魔&gt;世界观&lt;br&gt;
此游戏为基于-NEVERLAND- 世界观而开发的企划专属游戏, 禁止任何形式的私人传播&lt;br&gt;
&lt;br&gt;

&lt;div id=&quot;textcard&quot; style=&quot;max-width: 35%; padding:0em, 1em;     text-align: center;&quot;&gt;··-------✧✦✧✦✧-------··&lt;br&gt;
&lt;&lt;if Save.browser.size &gt; 0&gt;&gt;
&lt;&lt;button &quot;继续故事&quot;&gt;&gt;
&lt;&lt;script&gt;&gt;
Save.browser.continue()
        .then(() =&gt; {
            Engine.show();
        })
        .catch(error =&gt; {
            /* Failure.  Handle the error. */
            console.error(error);
            UI.alert(error);
        });
&lt;&lt;/script&gt;&gt;
&lt;&lt;/button&gt;&gt;------------✧✦✧✦✧------------&lt;br&gt;

&lt;&lt;button &quot;故事存储&quot;&gt;&gt;
&lt;&lt;run UI.buildSaves()&gt;&gt;
&lt;&lt;run Dialog.open()&gt;&gt;
&lt;&lt;/button&gt;&gt;------------✧✦✧✦✧------------&lt;br&gt;&lt;&lt;/if&gt;&gt;

&lt;&lt;button[[创建角色]]&gt;&gt;&lt;&lt;/button&gt;&gt;------------✧✦✧✦✧------------&lt;br&gt;

&lt;&lt;button &quot;系统设置&quot;&gt;&gt;
&lt;&lt;run UI.buildSetting()&gt;&gt;
&lt;&lt;run Dialog.open()&gt;&gt;
&lt;&lt;/button&gt;&gt;------------✧✦✧✦✧------------&lt;br&gt;

&lt;&lt;button 版本信息&gt;&gt;&lt;&lt;run
  Dialog.setup(&quot;版本信息&quot;);
  Dialog.wiki(Story.get(&quot;StoryRightSidebar&quot;).processText());
  Dialog.open();
&gt;&gt;&lt;&lt;/button&gt;&gt;------------✧✦✧✦✧------------
&lt;br&gt;
&lt;/div&gt;&lt;br&gt;
&lt;br&gt;&lt;br&gt;
&lt;div class=&quot;hidden&quot;&gt;Hiding a word is the glory of the Deity, revealing a word is the glory of the King&lt;/div&gt;&lt;/center&gt;</tw-passagedata><tw-passagedata pid="100" name="白雾" tags="nobr" position="700,500" size="100,100">&lt;&lt;set _s to random(1,18)&gt;&gt;
&lt;&lt;if $whm == 0&gt;&gt;
【你终于走出了白雾】&lt;&lt;set $choice to 0, $whm =6, $loc = &quot;深林边缘&quot;&gt;&gt;
&lt;&lt;elseif $choice == &quot;向北走&quot;&gt;&gt;
&lt;&lt;if _s == 12&gt;&gt;&lt;&lt;set $choice to 0, $whm = 6, $loc = &quot;你的小屋&quot;&gt;&gt;
&lt;&lt;fadeout 2s 2s&gt;&gt;【随着一阵寒冷的北风吹过, 清脆的鹿铃声兀然在你耳旁响起, 你意识到一头硕大的灰白驯鹿正站在你的身旁. 它刚才也在这儿吗? 驯鹿的模样在白雾里模糊不清, 但你确确实实的触碰到了它厚实的皮毛, 在你攀上它的脊背时也没有跌落下去. 几阵颠簸后, 你看到了家中熟悉的灯光和炉火】&lt;br&gt;【你现在安全了】&lt;&lt;/fadeout&gt;&gt;
&lt;&lt;timed 4s&gt;&gt;&lt;&lt;goto &quot;家&quot;&gt;&gt;&lt;&lt;/timed&gt;&gt;
&lt;&lt;else&gt;&gt;
【你似乎来到了一处新地点, 但雾气仍笼罩着一切】&lt;br&gt;&lt;br&gt;
 ⋙⋙⋙⋙⋙⋙⋘⋘⋘⋘⋘⋘&lt;br&gt;
&lt;&lt;link ▷「向北走」 白雾&gt;&gt;&lt;&lt;set $choice to &quot;向北走&quot;, $whm -= 1&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;br&gt;
&lt;&lt;link ▷「向南走」 白雾&gt;&gt;&lt;&lt;set $choice to &quot;向南走&quot;, $whm -= 1&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;br&gt;
▷「观察当前地点」&lt;br&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;elseif $choice == &quot;向南走&quot;&gt;&gt;
【你似乎来到了一处新地点, 但雾气仍笼罩着一切】&lt;br&gt;&lt;br&gt;
 ⋙⋙⋙⋙⋙⋙⋘⋘⋘⋘⋘⋘&lt;br&gt;
&lt;&lt;link ▷「向北走」 白雾&gt;&gt;&lt;&lt;set $choice to &quot;向北走&quot;, $whm -= 1&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;br&gt;
&lt;&lt;link ▷「向南走」 白雾&gt;&gt;&lt;&lt;set $choice to &quot;向南走&quot;, $whm -= 1&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;br&gt;
▷「观察当前地点」&lt;br&gt;

&lt;&lt;else&gt;&gt;
&lt;&lt;set $hunter=[&quot;Numb&quot;,&quot;Tret&quot;,&quot;翡翠小姐&quot;,&quot;玛丽亚小姐&quot;,&quot;Oma&quot;].random()&gt;&gt;&lt;&lt;set $loc = &quot;白雾&quot;&gt;&gt;
【不知不觉间, 你迷了路. 前面是一片白雾吗? 】&lt;br&gt;&lt;br&gt;
 ⋙⋙⋙⋙⋙⋙⋘⋘⋘⋘⋘⋘&lt;br&gt;
&lt;&lt;link ▷「向北走」 白雾&gt;&gt;&lt;&lt;set $choice to &quot;向北走&quot;, $whm = 6&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;br&gt;
&lt;&lt;link ▷「向南走」 白雾&gt;&gt;&lt;&lt;set $choice to &quot;向南走&quot;, $whm = 6&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;br&gt;
▷「观察当前地点」&lt;br&gt;
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="101" name="睡觉" tags="autosave" position="1200,200" size="100,100">&lt;&lt;if $sleept == 1&gt;&gt;【你不久前才从梦中醒来, 丝毫没有困意, 也许你该继续手头的工作】
&lt;&lt;link ▷「返回」 $home&gt;&gt;&lt;&lt;/link&gt;&gt;
&lt;&lt;else&gt;&gt;&lt;&lt;set _s to random(1,20)&gt;&gt;
&lt;&lt;set $hour = $hour + $sleepc&gt;&gt;
&lt;&lt;fadeout 3s 2s&gt;&gt;【你拉上窗帘, 拍软了枕头, 关掉桌灯, 钻进了被窝里】&lt;&lt;/fadeout&gt;&gt;&lt;&lt;set $sleept = 1&gt;&gt;
&lt;&lt;timed 6s&gt;&gt;&lt;&lt;if $san&gt;=85 || setup.getStat(&quot;nightmare&quot;) &lt;= 3&gt;&gt;
&lt;&lt;if _s &lt;= 12&gt;&gt;&lt;&lt;goto &quot;一般梦&quot;&gt;&gt;
&lt;&lt;elseif _s &lt;= 19&gt;&gt;&lt;&lt;goto &quot;美梦&quot;&gt;&gt;
&lt;&lt;else&gt;&gt;&lt;&lt;goto &quot;噩梦&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;
&lt;&lt;elseif $san&gt;=65 || setup.getStat(&quot;nightmare&quot;) &lt;= 7&gt;&gt;
&lt;&lt;if _s &lt;= 11&gt;&gt;&lt;&lt;goto &quot;一般梦&quot;&gt;&gt;
&lt;&lt;elseif _s &lt;= 17&gt;&gt;&lt;&lt;goto &quot;美梦&quot;&gt;&gt;
&lt;&lt;else&gt;&gt;&lt;&lt;goto &quot;噩梦&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;
&lt;&lt;elseif $san&gt;=45 || setup.getStat(&quot;nightmare&quot;) &lt;= 11&gt;&gt;
&lt;&lt;if _s &lt;= 9&gt;&gt;&lt;&lt;goto &quot;一般梦&quot;&gt;&gt;
&lt;&lt;elseif _s &lt;= 14&gt;&gt;&lt;&lt;goto &quot;美梦&quot;&gt;&gt;
&lt;&lt;else&gt;&gt;&lt;&lt;goto &quot;噩梦&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;

&lt;&lt;/if&gt;&gt;&lt;&lt;/timed&gt;&gt;
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="102" name="礁岩区" tags="nobr" position="0,300" size="100,100">&lt;&lt;if $loc != &quot;礁岩区&quot;&gt;&gt;&lt;&lt;set $loc = &quot;礁岩区&quot;&gt;&gt;&lt;&lt;set $minute to $minute+ random(5,10)&gt;&gt;&lt;&lt;/if&gt;&gt;//位于小岛东南方的一片礁石遍布的浅海, 礁岩海岸间隐藏着大大小小的海蚀洞穴//&lt;br&gt;
&lt;br&gt;
&lt;&lt;NPCloc&gt;&gt;
&lt;&lt;if $lostsheep[0] == 1&gt;&gt;[[✧「找羊」|era互动]]&lt;br&gt;&lt;&lt;/if&gt;&gt;
[[♢「溶洞」|溶洞]]&lt;br&gt;
&lt;br&gt;
[[♢「草甸」|草甸]]&lt;br&gt;
[[♢「副港口」|副港口]]</tw-passagedata><tw-passagedata pid="103" name="社交" tags="" position="1800,100" size="100,100">&lt;b&gt;&lt;center&gt;概况&lt;/center&gt;&lt;/b&gt;
&lt;&lt;dated&gt;&gt;&lt;&lt;sociald&gt;&gt;
&lt;br&gt;&lt;br&gt;
&lt;b&gt;&lt;center&gt;主要角色&lt;/center&gt;&lt;/b&gt;&lt;br&gt;
&lt;&lt;if $erafirstc == 1&gt;&gt;
&lt;table style=&quot;width:100%&quot;&gt;
  &lt;tr&gt;&lt;th colspan=2&gt;&lt;center&gt;Era&amp;nbsp;&amp;nbsp;&lt;font size=1px color=#ABA49B&gt;//船长//&lt;/font&gt;&lt;/center&gt;&lt;/th&gt;&lt;/tr&gt;
  &lt;tr&gt;&lt;td style=&quot;width:50%&quot;&gt;&lt;center&gt;❥&amp;nbsp;$erahgd&lt;/center&gt;&lt;/td&gt;
    &lt;td style=&quot;width:50%&quot;&gt;&lt;center&gt;--&lt;/center&gt;&lt;/td&gt;&lt;/tr&gt;
  &lt;tr&gt;&lt;td colspan=2 style=&quot;border-style: none;&quot;&gt;
  &lt;font size=2px&gt;&lt;&lt;if $erahgd &lt;=10&gt;&gt;不知是工作需要还是出于友善的本性, Era对岛上新来的居民都很关照, 有时甚至算得上过度关注了. 偶尔你会看到他在不远处, 一边驱赶着羊群, 一边不时侧头向你看来, 但当你真的走上前去问候, 他就开始谈论天气, 或不厌其烦的搬出他那些内容令人生疑的航海故事&lt;&lt;elseif $erahgd &lt;=20&gt;&gt;还没写&lt;&lt;/if&gt;&gt;&lt;/font&gt;&lt;/td&gt;&lt;/tr&gt;
&lt;/table&gt;&lt;br&gt;&lt;&lt;/if&gt;&gt;

&lt;&lt;if $orifirstc == 1&gt;&gt;
&lt;table style=&quot;width:100%&quot;&gt;
  &lt;tr&gt;&lt;th colspan=2&gt;&lt;center&gt;奥里&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;font size=2px&gt;&lt;&lt;if $oriid == 1&gt;&gt;//异世碎片//&lt;&lt;else&gt;&gt;&lt;&lt;/if&gt;&gt;&lt;/font&gt;&lt;/center&gt;&lt;/th&gt;&lt;/tr&gt;
  &lt;tr&gt;&lt;td style=&quot;width:50%&quot;&gt;&lt;center&gt;❥ $orihgd&lt;/center&gt;&lt;/td&gt;
    &lt;td style=&quot;width:50%&quot;&gt;&lt;center&gt;--&lt;/center&gt;&lt;/td&gt;&lt;/tr&gt;
  &lt;tr&gt;&lt;td colspan=2&gt;
  &lt;font size=2px&gt;&lt;&lt;if $orihgd &lt;=5&gt;&gt;她会对你露出礼貌的微笑，但也仅此而已。除非你引起了她的兴趣，否则她可能转眼就忘了你。毕竟你对她来说只是一个陌生人罢了。如果喊她的话，她只会回头疑惑的看你
  &lt;&lt;elseif $orihgd &lt;=10&gt;&gt;若是偶尔遇见会顺手帮上一把的程度，但要是事情太过麻烦，也会选择视而不见。会给你一些小提示，避免你这个有印象的人出事。如果喊她的话会回头，并向你微笑
  &lt;&lt;elseif $orihgd &lt;=20&gt;&gt;你成功的让她完全认识到了你的存在。你可以大胆的和她说话，她不会拒绝的。喊她帮忙的话大概率也会成功，但要是太过频繁的让她帮忙，她百分百会厌烦的。劝你珍惜她对你的好感和印象。如果喊她的话，她会保持着淡淡的微笑，向你挥手
  &lt;&lt;elseif $orihgd &lt;=30&gt;&gt;走在路上时要是感觉到莫名的视线，或许是她在观察你。如果你是有目的的在接近她，那你应该时刻警惕。一旦被她发现，后果会很惨。但如果你并无恶意，你会发现视线很快就消失了。要是你一不小心深陷麻烦，她会过来帮你一把。如果喊她的话，她会笑着问你怎么了
  &lt;&lt;elseif $orihgd &lt;=40&gt;&gt;她认可了你这个朋友，会把名字告诉你。你出门的时候有大概率的情况会遇到她，因为你时常出没的地点也被划入了她的散步道。你可以和她聊家常，或者随便聊点什么，她会安静的倾听的。既然是朋友，你可以尝试问她的过去，但很大概率会被扯开话题。如果喊她的话，她会开玩笑似的回应你
  &lt;&lt;elseif $orihgd &lt;=50&gt;&gt;她会尝试记住你的信息，也会和你透露一点她的过去。她在试图信任你，如果可以的话请用自己的办法向她表达相同的信任。一旦你表现出了一些对她来说过于危险的举动，她会立刻放弃信任你。你们的关系会回到朋友，但永远只是朋友
  &lt;&lt;elseif $orihgd &lt;=60&gt;&gt;你获得了她的信任，她会更加关注你。在你不知道的地方偶尔也会帮你个小忙，毕竟她确实是个很闲的人。你可以尝试询问她的过去，她会选择合适的回答。只要你和她待在一起，你完全可以放心自己的安危，她会保护你的
  &lt;&lt;elseif $orihgd &lt;=70&gt;&gt;你会发现她的与众不同，她很放心让你知道。她会将她真实的名字告诉你，也会警告你远离一些危险的事物。如果她看上去心情很好的话，或许还会给你表演一个奇迹。如果喊她的名字的话，她会对你露出真心的笑容
  &lt;&lt;elseif $orihgd &lt;=80&gt;&gt;你们的关系大概是亲友，她会将自己的本性完全暴露出来。如果她离开了这个地方，会给你留信，当然，她也会时不时回来看你。如果你想跟她一起离开，她也会带你走。但会记得把你再带回来就是了。你可以放心的依赖的她
  &lt;&lt;else&gt;&gt;你大概是被划入了属于她的范围内。老实说这样的关系更加的危险了，是的，或许你会在你不情愿的情况下知晓一些额外的特殊秘密。没办法拒绝，也没办法逃离。只需要知晓一件事——她不会伤害你，也不会放开你&lt;&lt;/if&gt;&gt;&lt;/font&gt;
  &lt;/td&gt;&lt;/tr&gt;
&lt;/table&gt;&lt;br&gt;&lt;&lt;/if&gt;&gt;

&lt;&lt;if $amberfirstc == 1&gt;&gt;
&lt;table style=&quot;width:100%&quot;&gt;
  &lt;tr&gt;&lt;th colspan=2&gt;&lt;center&gt;琥珀夫人&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;font size=2px&gt;&lt;&lt;if $amberid == 1&gt;&gt;//蜘蛛恶魔//&lt;&lt;else&gt;&gt;&lt;&lt;/if&gt;&gt;&lt;/font&gt;&lt;/center&gt;&lt;/th&gt;&lt;/tr&gt;
  &lt;tr&gt;&lt;td style=&quot;width:50%&quot;&gt;&lt;center&gt;❥ $amberhgd&lt;/center&gt;&lt;/td&gt;
    &lt;td style=&quot;width:50%&quot;&gt;&lt;center&gt;--&lt;/center&gt;&lt;/td&gt;&lt;/tr&gt;
  &lt;tr&gt;&lt;td colspan=2&gt;
  &lt;font size=2px&gt;
  &lt;&lt;if $amberhgd &lt;=5&gt;&gt;看起来你的存在对她来说是一种折磨……虽然她并没有明确地表明对你的厌恶。不知道你究竟做了些什么让她对你这么反感，但也许你该向她表示歉意，就算只是看在冰啤、鲜榨果汁、威士忌或者别的什么的份上
  &lt;&lt;elseif $amberhgd &lt;=15&gt;&gt;她记住了你的气味。但这并不代表什么，对她来说你仍然只是个普通的客人。就像大部分人一样，有些时候你会来酒馆坐坐，也许要点些什么，也许又什么都不点；有些时候甚至压根就没想到镇上还有个酒馆，毕竟还有那么多的地方可供消遣
  &lt;&lt;elseif $amberhgd &lt;=35&gt;&gt;她能喊出你的名字，乐于和你聊天，卖些或真或假的小道消息，说出你经常在什么时间段来，经常点些什么，偶尔还会偷偷给你透露些小点心的神秘配方。而每当看到她在酒吧里忙碌的身影时，你也总会有一股莫名的安心感，似乎只要她在，酒馆里就不会出什么差错
  &lt;&lt;elseif $amberhgd &lt;=50&gt;&gt;在经历过那种事情之后，你们已经在同一条船上了。你很清楚，没了琥珀夫人，过不了多久你就会被抓去接受审判。而琥珀夫人将你视作她得力的帮手，可信赖的合作伙伴。若你愿意，她会毫不犹豫地将重要的事务交给你。不只是酒馆的，“别的”事情也包含在内。也许你的良心偶尔作祟，但她的那双眼睛——那是你在这个世界上唯一无法抗拒的东西
  &lt;&lt;elseif $amberhgd &lt;=70&gt;&gt;与往常相比，琥珀夫人的双目中似乎多了一些难以捉摸的东西。当你们目光相接时，你的内心也随着那对猩红双目的呼召而变得模糊起来。你说不清楚那是什么。有时琥珀夫人留下一堆可疑的东西，想要你主动去了解她，她自己却对那些零零散散的故事和谣言不作任何解释。你们之间很难看到什么暧昧的举动，即使是在酒馆也少有交流，你却不由觉得自己与琥珀夫人的关系从没这么紧密过
  &lt;&lt;elseif $amberhgd &lt;=88&gt;&gt;我本应更了解我，我也想知道我是否爱你……
  &lt;&lt;elseif $amberhgd &lt;=92&gt;&gt;我总能弄清楚的。这会让我更心甘情愿一点
  &lt;&lt;elseif $amberhgd &lt;=97&gt;&gt;……
  &lt;&lt;else&gt;&gt;你听到她在上方呼唤你&lt;&lt;/if&gt;&gt;&lt;/font&gt;
  &lt;/td&gt;&lt;/tr&gt;
&lt;/table&gt;&lt;br&gt;&lt;&lt;/if&gt;&gt;

&lt;&lt;if $nmfirstc == 1&gt;&gt;
&lt;table style=&quot;width:100%&quot;&gt;
  &lt;tr&gt;&lt;th colspan=2&gt;&lt;center&gt;安德森&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;font size=2px&gt;&lt;&lt;if $nmid == 1&gt;&gt;//时空旅行者//&lt;&lt;else&gt;&gt;&lt;&lt;/if&gt;&gt;&lt;/font&gt;&lt;/center&gt;&lt;/th&gt;&lt;/tr&gt;
  &lt;tr&gt;&lt;td style=&quot;width:50%&quot;&gt;&lt;center&gt;❥ $nmhgd&lt;/center&gt;&lt;/td&gt;
    &lt;td style=&quot;width:50%&quot;&gt;&lt;center&gt;--&lt;/center&gt;&lt;/td&gt;&lt;/tr&gt;
  &lt;tr&gt;&lt;td colspan=2&gt;
  &lt;font size=2px&gt;
  &lt;&lt;if $nmhgd &lt;=5&gt;&gt;他对你没有任何印象，实际上，他甚至可能不知道你是谁，称不上讨厌你，也并不喜欢你——对他而言，你甚至不如路边的花草
  &lt;&lt;elseif $nmhgd &lt;=10&gt;&gt;可喜可贺，他终于知道你是谁了，但你发现，他对你的态度没有一分一毫的改变——他只是知道你是谁了，仅此而已
  &lt;&lt;elseif $nmhgd &lt;=20&gt;&gt;“是你啊”这大概就是他对你的想法，他记住你了，平时也会与你闲聊打诨，甚至对你恶作剧，他对你的态度表现的过于熟稔，仿佛你们的关系十分要好，但一定要注意不要被他哄骗
  &lt;&lt;elseif $nmhgd &lt;=30&gt;&gt;他与你已经相当熟识了，在路边与你相遇时还会主动过来与你打招呼，但还是再次强调——不要被他的态度欺骗，或许他转身就把你忘了
   &lt;&lt;elseif $nmhgd &lt;=40&gt;&gt;在某种程度上，他逐渐开始信任你，因为与你越发频繁的交流，他也对你越发的了解，相对的，你也更加的了解他了，他开始逐渐将一些任务拜托给你，这就是信任吗？
&lt;&lt;elseif $nmhgd &lt;=50&gt;&gt;你感觉他对你越发的亲近，但，是否有些过于没有距离感了呢？他开始把大量的任务交给了你，但你发现，这些都是你正好能够完成的
&lt;&lt;elseif $nmhgd &lt;=60&gt;&gt;你觉得有些不对劲......他越发不在意你的反应了，只是肆意妄为的做着他所想的一切——他不在你的面前遮掩他的本性了，这或许是好事？
  &lt;&lt;elseif $nmhgd &lt;=70&gt;&gt;他开始完全不在意你的想法了，似乎无论你怎样选择，最后只会如他所愿，你已经无法逃离，你该反抗吗？或许不该继续与他接触——但
  &lt;&lt;elseif $nmhgd &lt;=80&gt;&gt;你的本能在给予你警告
  &lt;&lt;elseif $nmhgd &lt;=90&gt;&gt;你就像是不要命了一样，忽视一切警告和危险也要站在他身边——他当然知道，他允许了
  &lt;&lt;else&gt;&gt;你几乎了解到他的一切，也对他的本性一清二楚，即便如此你也奋不顾身的投向他的怀抱——或许你已经变得不正常了，但这又如何&lt;&lt;/if&gt;&gt;&lt;/font&gt;
  &lt;/td&gt;&lt;/tr&gt;
&lt;/table&gt;&lt;br&gt;&lt;&lt;/if&gt;&gt;
&lt;br&gt;&lt;br&gt;

&lt;b&gt;&lt;center&gt;一般角色&lt;/center&gt;&lt;/b&gt;&lt;br&gt;

&lt;&lt;if $jofirstc == 1&gt;&gt;
&lt;table style=&quot;width:100%&quot;&gt;
  &lt;tr&gt;&lt;th&gt;&lt;center&gt;琼&amp;nbsp;&amp;nbsp;&lt;font size=1px color=#ABA49B&gt;&lt;&lt;if $joid == 1&gt;&gt;//纯白之罪//&lt;&lt;else&gt;&gt;&lt;&lt;/if&gt;&gt;&lt;/font&gt;&lt;/center&gt;&lt;/th&gt;&lt;/tr&gt;
  &lt;tr&gt;&lt;td&gt;
  &lt;font size=2px&gt;&lt;center&gt;琼&lt;&lt;set _sxd = $josxd&gt;&gt;&lt;&lt;sxdkind&gt;&gt;&lt;/center&gt;&lt;/font&gt;&lt;/td&gt;&lt;/tr&gt;
&lt;/table&gt;&lt;&lt;/if&gt;&gt;

&lt;&lt;if $tretfirstc == 1&gt;&gt;
&lt;table style=&quot;width:100%&quot;&gt;
  &lt;tr&gt;&lt;th&gt;&lt;center&gt;Tret&amp;nbsp;&amp;nbsp;&lt;font size=1px color=#ABA49B&gt;&lt;&lt;if $tretid == 1&gt;&gt;//三面之神//&lt;&lt;else&gt;&gt;//渔夫//&lt;&lt;/if&gt;&gt;&lt;/font&gt;&lt;/center&gt;&lt;/th&gt;&lt;/tr&gt;
  &lt;tr&gt;&lt;td&gt;
  &lt;font size=2px&gt;&lt;center&gt;Tret&lt;&lt;set _sxd = $tretsxd&gt;&gt;&lt;&lt;sxdgod&gt;&gt;&lt;/center&gt;&lt;/font&gt;&lt;/td&gt;&lt;/tr&gt;
&lt;/table&gt;&lt;&lt;/if&gt;&gt;

&lt;&lt;if $maryfirstc == 1&gt;&gt;
&lt;table style=&quot;width:100%&quot;&gt;
  &lt;tr&gt;&lt;th&gt;&lt;center&gt;玛丽亚小姐&amp;nbsp;&amp;nbsp;&lt;font size=1px color=#ABA49B&gt;&lt;&lt;if $maryid == 1&gt;&gt;//欲望泡沫//&lt;&lt;else&gt;&gt;&lt;&lt;/if&gt;&gt;&lt;/font&gt;&lt;/center&gt;&lt;/th&gt;&lt;/tr&gt;
  &lt;tr&gt;&lt;td&gt;
  &lt;font size=2px&gt;&lt;center&gt;玛丽亚小姐&lt;&lt;set _sxd = $marysxd&gt;&gt;&lt;&lt;sxdgod&gt;&gt;&lt;/center&gt;&lt;/font&gt;&lt;/td&gt;&lt;/tr&gt;
&lt;/table&gt;&lt;&lt;/if&gt;&gt;

&lt;&lt;if $otisfirstc == 1&gt;&gt;
&lt;table style=&quot;width:100%&quot;&gt;
  &lt;tr&gt;&lt;th&gt;&lt;center&gt;Otis&amp;nbsp;&amp;nbsp;&lt;font size=1px color=#ABA49B&gt;&lt;&lt;if $otisid == 1&gt;&gt;//真实之羽//&lt;&lt;else&gt;&gt;//图书管理员//&lt;&lt;/if&gt;&gt;&lt;/font&gt;&lt;/center&gt;&lt;/th&gt;&lt;/tr&gt;
  &lt;tr&gt;&lt;td&gt;
  &lt;font size=2px&gt;&lt;center&gt;Otis&lt;&lt;set _sxd = $otissxd&gt;&gt;&lt;&lt;sxdnormal&gt;&gt;&lt;/center&gt;&lt;/font&gt;&lt;/td&gt;&lt;/tr&gt;
&lt;/table&gt;&lt;&lt;/if&gt;&gt;

&lt;&lt;if $spafirstc == 1&gt;&gt;
&lt;table style=&quot;width:100%&quot;&gt;
  &lt;tr&gt;&lt;th&gt;&lt;center&gt;萨巴夫人&amp;nbsp;&amp;nbsp;&lt;font size=1px color=#ABA49B&gt;&lt;&lt;if $spaid == 1&gt;&gt;//欲望泡沫//&lt;&lt;else&gt;&gt;&lt;&lt;/if&gt;&gt;&lt;/font&gt;&lt;/center&gt;&lt;/th&gt;&lt;/tr&gt;
  &lt;tr&gt;&lt;td&gt;
  &lt;font size=2px&gt;&lt;center&gt;萨巴夫人&lt;&lt;set _sxd = $spasxd&gt;&gt;&lt;&lt;sxdnormal&gt;&gt;&lt;/center&gt;&lt;/font&gt;&lt;/td&gt;&lt;/tr&gt;
&lt;/table&gt;&lt;&lt;/if&gt;&gt;

&lt;&lt;if $perrafirstc == 1&gt;&gt;
&lt;table style=&quot;width:100%&quot;&gt;
  &lt;tr&gt;&lt;th&gt;&lt;center&gt;佩罗大夫&amp;nbsp;&amp;nbsp;&lt;font size=1px color=#ABA49B&gt;//大夫//&lt;/font&gt;&lt;/center&gt;&lt;/th&gt;&lt;/tr&gt;
  &lt;tr&gt;&lt;td&gt;
  &lt;font size=2px&gt;&lt;center&gt;佩罗大夫&lt;&lt;set _sxd = $perrasxd&gt;&gt;&lt;&lt;sxdkind&gt;&gt;&lt;/center&gt;&lt;/font&gt;&lt;/td&gt;&lt;/tr&gt;
&lt;/table&gt;&lt;&lt;/if&gt;&gt;

&lt;&lt;if $conifirstc == 1&gt;&gt;
&lt;table style=&quot;width:100%&quot;&gt;
  &lt;tr&gt;&lt;th&gt;&lt;center&gt;Coni&lt;/center&gt;&lt;/th&gt;&lt;/tr&gt;
  &lt;tr&gt;&lt;td&gt;
  &lt;font size=2px&gt;&lt;center&gt;Coni&lt;&lt;set _sxd = $conisxd&gt;&gt;&lt;&lt;sxdkind&gt;&gt;&lt;/center&gt;&lt;/font&gt;&lt;/td&gt;&lt;/tr&gt;
&lt;/table&gt;&lt;&lt;/if&gt;&gt;

&lt;br&gt;&lt;br&gt;
&lt;b&gt;&lt;center&gt;组织&lt;/center&gt;&lt;/b&gt;&lt;br&gt;</tw-passagedata><tw-passagedata pid="104" name="秋毛岗" tags="nobr" position="500,200" size="100,100">&lt;&lt;if $loc != &quot;秋毛岗&quot;&gt;&gt;&lt;&lt;set $loc = &quot;秋毛岗&quot;&gt;&gt;&lt;&lt;timeWidget&gt;&gt;&lt;&lt;set $minute to $minute+ random(5,10)&gt;&gt;&lt;&lt;/if&gt;&gt;//秋毛岗是永无乡高地上最高的一座山岗, 即使这样, 它的海拔也只有374.06英尺. 这里可以俯瞰小镇的全貌//
&lt;br&gt;
&lt;&lt;NPCloc&gt;&gt;
&lt;br&gt;地点活动
[[◈「散步」|散步]]&lt;br&gt;
[[◈「打猎」|打猎]]&lt;br&gt;
&lt;br&gt;其他地区
&lt;&lt;if $lostsheep[0] == 1&gt;&gt;[[✧「找羊」|era互动]]&lt;br&gt;&lt;&lt;/if&gt;&gt;
[[♢「高地」|高地]]&lt;br&gt;
[[♢「贝雷河」|贝雷河]]&lt;br&gt;
[[♢「罗索伦特湖」|罗索伦特湖]]</tw-passagedata><tw-passagedata pid="105" name="种地" tags="nobr" position="1200,600" size="100,100">&lt;&lt;if $choice == &quot;land1&quot; &amp;&amp; $land1[0].stat == 0 || $choice == &quot;land2&quot; &amp;&amp; $land2[0].stat == 0 || $choice == &quot;land3&quot; &amp;&amp; $land3[0].stat == 0 || $choice == &quot;land4&quot; &amp;&amp; $land4[0].stat == 0 || $choice == &quot;land5&quot; &amp;&amp; $land5[0].stat == 0 || $choice == &quot;land6&quot; &amp;&amp; $land6[0].stat == 0&gt;&gt;

▸▹ ✾ ✾ ✾ ✾ ✾ ✾ ✾ ✾ ✾ ✾ ✾ ✾ ✾ ✾◃◂&lt;br&gt;
&lt;&lt;for _i to 0; _i lt $item.uniqueLength;  _i++&gt;&gt;
&lt;&lt;set _itemn = $item.list[_i]&gt;&gt;
&lt;&lt;if Item.get(_itemn).hasTag(&quot;seed&quot;)&gt;&gt;
◈_itemn × &lt;&lt;=$item.count(_itemn)&gt;&gt;
&lt;&lt;capture _itemn&gt;&gt;
&lt;&lt;link &quot;种植&quot;&gt;&gt;&lt;&lt;drop $item _itemn 1&gt;&gt;&lt;&lt;seed&gt;&gt;
&lt;&lt;run Dialog.setup(&quot;种植&quot;);Dialog.wiki(&quot;【看到_itemn安静地躺在土壤里, 你感到充满决心】
&quot;);Dialog.open();&gt;&gt;&lt;&lt;goto &quot;种地&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;&lt;/capture&gt;&gt;&lt;br&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;/for&gt;&gt;
&lt;br&gt;▸▹ ✾ ✾ ✾ ✾ ✾ ✾ ✾ ✾ ✾ ✾ ✾ ✾ ✾ ✾◃◂&lt;&lt;/if&gt;&gt;

&lt;&lt;if $choice == &quot;land1&quot; &amp;&amp; $land1[0].stat !== 0&gt;&gt;&lt;&lt;set _itemn = $land1[0].name&gt;&gt;【这块地里种着_itemn】&lt;br&gt;
&lt;&lt;if $land1[0].stat == 1&gt;&gt;
&quot;哦, 你种了一株_itemn. 好好照料吧, 这些植物可不会自己生长&quot;
【看到_itemn安静地躺在土壤里, 你感到充满决心】&lt;br&gt;
&lt;&lt;elseif $land1[0].stat == 2&gt;&gt;
天哪, 它发芽了, 快看那几片小叶子, 它就是本世纪最伟大的_itemn&lt;br&gt;【想到它会成为一株伟大的】
&lt;&lt;elseif $land1[0].stat == 3&gt;&gt;
【±at %QQ%±%括号1%的%括号2%正在生长】\n别吵了我看到了. 我得说, 它长得比你都要健康\n【看到%括号2%在健康生长, 让你充满了决心】
&lt;&lt;elseif $land1[0].stat == 4&gt;&gt;
【±at %QQ%±%括号1%的%括号2%已经成株】
&lt;&lt;elseif $land1[0].stat == 5&gt;&gt;
&lt;&lt;if Item.get(_itemn).hasTag(&quot;flower&quot;)&gt;&gt;【结出了花蕾】
&lt;&lt;else&gt;&gt;
【已经开花】&lt;&lt;/if&gt;&gt;
&lt;&lt;elseif $land1[0].stat == 6&gt;&gt;
&lt;&lt;if Item.get(_itemn).hasTag(&quot;flower&quot;)&gt;&gt;【已经开花】
&lt;&lt;else&gt;&gt;
【已经结果】&lt;&lt;/if&gt;&gt;
&lt;&lt;link &quot;❖采摘&quot; 摘花&gt;&gt;&lt;&lt;set $flower=_itemn&gt;&gt;&lt;&lt;set $land1[0].name = &#39;无&#39;, $land1[0].stat = 0&gt;&gt;&lt;&lt;/link&gt;&gt;

&lt;&lt;/if&gt;&gt;&lt;&lt;/if&gt;&gt;

&lt;&lt;if $choice == &quot;land2&quot; &amp;&amp; $land2[0].stat !== 0&gt;&gt;&lt;&lt;set _itemn = $land1[0].name&gt;&gt;【这块地里种着$land1[0].name】&lt;br&gt;
&lt;&lt;if $land2[0].stat == 1&gt;&gt;
&quot;哦, 你种了一株_itemn. 好好照料吧, 这些植物可不会自己生长&quot;
【看到_itemn安静地躺在土壤里, 你感到充满决心】&lt;br&gt;
&lt;&lt;elseif $land2[0].stat == 2&gt;&gt;
天哪, 它发芽了, 快看那几片小叶子, 它就是本世纪最伟大的_itemn&lt;br&gt;【想到它会成为一株伟大的】
&lt;&lt;elseif $land2[0].stat == 3&gt;&gt;
【±at %QQ%±%括号1%的%括号2%正在生长】\n别吵了我看到了. 我得说, 它长得比你都要健康\n【看到%括号2%在健康生长, 让你充满了决心】
&lt;&lt;elseif $land2[0].stat == 4&gt;&gt;
【±at %QQ%±%括号1%的%括号2%已经成株】
&lt;&lt;elseif $land2[0].stat == 5&gt;&gt;
【±at %QQ%±%括号1%的%括号2%结出了花蕾】
&lt;&lt;elseif $land2[0].stat == 6&gt;&gt;
【±at %QQ%±%括号1%的%括号2%已经开花】
&lt;&lt;link &quot;❖采摘&quot; 摘花&gt;&gt;&lt;&lt;set $flower=_itemn&gt;&gt;&lt;&lt;set $land2[0].name = &#39;无&#39;, $land2[0].stat = 0&gt;&gt;&lt;&lt;/link&gt;&gt;

&lt;&lt;/if&gt;&gt;&lt;&lt;/if&gt;&gt;

&lt;&lt;if $choice == &quot;land3&quot; &amp;&amp; $land3[0].stat !== 0&gt;&gt;&lt;&lt;set _itemn = $land2[0].name&gt;&gt;【这块地里种着_itemn】&lt;br&gt;
&lt;&lt;if $land3[0].stat == 1&gt;&gt;
&quot;哦, 你种了一株_itemn. 好好照料吧, 这些植物可不会自己生长&quot;
【看到_itemn安静地躺在土壤里, 你感到充满决心】&lt;br&gt;
&lt;&lt;elseif $land3[0].stat == 2&gt;&gt;
天哪, 它发芽了, 快看那几片小叶子, 它就是本世纪最伟大的_itemn&lt;br&gt;【想到它会成为一株伟大的】
&lt;&lt;elseif $land3[0].stat == 3&gt;&gt;
【±at %QQ%±%括号1%的%括号2%正在生长】\n别吵了我看到了. 我得说, 它长得比你都要健康\n【看到%括号2%在健康生长, 让你充满了决心】
&lt;&lt;elseif $land3[0].stat == 4&gt;&gt;
【±at %QQ%±%括号1%的%括号2%已经成株】
&lt;&lt;elseif $land3[0].stat == 5&gt;&gt;
【±at %QQ%±%括号1%的%括号2%结出了花蕾】
&lt;&lt;elseif $land3[0].stat == 6&gt;&gt;
【±at %QQ%±%括号1%的%括号2%已经开花】
&lt;&lt;link &quot;❖采摘&quot; 摘花&gt;&gt;&lt;&lt;set $flower=_itemn&gt;&gt;&lt;&lt;set $land3[0].name = &#39;无&#39;, $land3
[0].stat = 0&gt;&gt;&lt;&lt;/link&gt;&gt;

&lt;&lt;/if&gt;&gt;&lt;&lt;/if&gt;&gt;


&lt;br&gt;&lt;br&gt;
&lt;&lt;link ▷「继续」 家&gt;&gt;&lt;&lt;set $choice to &quot;花圃&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;</tw-passagedata><tw-passagedata pid="106" name="线索" tags="" position="1800,300" size="100,100">&lt;&lt;if !$clue || $clue == []&gt;&gt;暂无线索&lt;&lt;else&gt;&gt;
&lt;center&gt;&lt;font size=5px&gt;&lt;&lt;for _i to 0; _i lt $clue.length;  _i++&gt;&gt;
&lt;div id=&quot;clue&quot; class=&quot;write&quot;&gt;&lt;br&gt;&amp;nbsp;•&amp;nbsp;&lt;&lt;= $clue[_i].name&gt;&gt;：&lt;&lt;= $clue[_i].dscr&gt;&gt;&lt;br&gt;&amp;nbsp;&lt;br&gt;&lt;/div&gt;
&lt;&lt;/for&gt;&gt;&lt;/font&gt;&lt;/center&gt;
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="107" name="罗索伦特湖" tags="nobr" position="0,200" size="100,100">&lt;&lt;if $loc != &quot;罗索伦特湖&quot;&gt;&gt;&lt;&lt;set $loc = &quot;罗索伦特湖&quot;&gt;&gt;&lt;&lt;audio &quot;mainBGM&quot; unmute&gt;&gt;
&lt;&lt;set $minute to $minute+ random(5,10)&gt;&gt;&lt;&lt;set $HP to $HP- 1&gt;&gt;&lt;&lt;/if&gt;&gt;//远古的湖水从深林流出, 经过无数岁月的沉积, 形成了如今宽广而幽黑的罗索伦特湖, 其储水是贝雷河能经久不断的保障, 也是岛上生机勃勃的源头//
&lt;br&gt;
&lt;&lt;NPCloc&gt;&gt;
&lt;br&gt;地点活动&lt;br&gt;
&lt;&lt;if $lostsheep[0] == 1&gt;&gt;[[✧「找羊」|era互动]]&lt;br&gt;&lt;&lt;/if&gt;&gt;
[[◈「钓鱼」|钓鱼]]&lt;br&gt;
[[◈「坐船」|坐船]]&lt;br&gt;
[[◈「散步」|散步]]&lt;br&gt;
[[◈「打猎」|打猎]]&lt;br&gt;
&lt;br&gt;继续前往&lt;br&gt;
[[✧「沼泽」|沼泽]]&lt;br&gt;
[[✧「湖边小屋」|湖边小屋]]&lt;br&gt;
[[✧「深林边缘」|深林边缘]]&lt;br&gt;
&lt;br&gt;其他地区&lt;br&gt;
[[♢「高地」|高地]]&lt;br&gt;
[[♢「贝雷河」|贝雷河]]&lt;br&gt;
[[♢「秋毛岗」|秋毛岗]]</tw-passagedata><tw-passagedata pid="108" name="美梦" tags="" position="1200,300" size="100,100">&lt;&lt;set $HP += 68&gt;&gt;【你从睡眠中醒来.刚刚梦境的内容开始在你脑海中浮现. 多么美好的一场梦, 你回味着梦中经历的那些, 甚至还想再度回到那个世界】

&lt;&lt;link ▷「继续」&gt;&gt;&lt;&lt;goto &quot;家&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;</tw-passagedata><tw-passagedata pid="109" name="花店" tags="nobr" position="100,400" size="100,100">&lt;b&gt;花店&lt;/b&gt;&lt;br&gt;
【营业时间 礼拜三 6:00~18:00】&lt;br&gt;

&lt;&lt;if $nixloc != &quot;花店&quot;&gt;&gt;花店的门紧闭着, Nix也不见踪影. 你看见门口的告示说花店仅在礼拜三开门&lt;br&gt;
&lt;&lt;else&gt;&gt;&lt;&lt;set $loc = &quot;花店&quot;&gt;&gt;//你踏进这家一周只开一天的店, 说不出名字的奇花异草堆满了室内有限的空间//&lt;br&gt;
&lt;br&gt;
地点活动&lt;br&gt;
[[❖「打工」|打工]]  (花费1小时) 
&lt;&lt;/if&gt;&gt;
&lt;br&gt;&lt;br&gt;
离开&lt;br&gt;
&lt;&lt;link ▷「前往花圃」 小镇&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;br&gt;
&lt;&lt;link ▷「回到小镇」 小镇&gt;&gt;&lt;&lt;/link&gt;&gt;

&lt;br&gt;&lt;br&gt;&lt;br&gt;
&lt;div class=&quot;hidden&quot;&gt;May the death of flowers perfume your life&lt;/div&gt;</tw-passagedata><tw-passagedata pid="110" name="花田" tags="" position="400,500" size="100,100">&lt;&lt;if $loc != &quot;花田&quot;&gt;&gt;&lt;&lt;set $loc = &quot;花田&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;

&lt;&lt;NPCloc&gt;&gt;

✧「赏花」
[[✧「照顾花田」|地点活动]]

&lt;&lt;link ▷「离开」 高地&gt;&gt;&lt;&lt;/link&gt;&gt;</tw-passagedata><tw-passagedata pid="111" name="草甸" tags="nobr" position="100,200" size="100,100">&lt;&lt;if $loc != &quot;草甸&quot;&gt;&gt;&lt;&lt;set $loc = &quot;草甸&quot;&gt;&gt;&lt;&lt;set $minute to $minute+ random(5,10)&gt;&gt;&lt;&lt;set $HP to $HP- 1&gt;&gt;&lt;&lt;/if&gt;&gt;&lt;&lt;set _n to random(5,15)&gt;&gt;
&lt;&lt;if $choice == &quot;拒绝&quot;&gt;&gt;故事的内容是他那亦真亦假的海盗生涯, 而你已经听过无数遍, 你有些不耐烦的拒绝了Era. 你更想要实质性的回报&lt;br&gt;
&lt;font color=#4E84BA&gt;✧你获得_n枚鸟羽✧&lt;/font&gt;&lt;&lt;set $feather += _n&gt;&gt;&lt;&lt;redo&gt;&gt;
&lt;&lt;elseif $lostsheep[0] == 2&gt;&gt;
你仍未找到前一天丢失的绵羊, 也许那可怜的家畜已经成为了某个猎手的晚餐. Era从羊圈里走出来, 脸上写满了失望&lt;br&gt;&lt;br&gt;⋙⋙⋙⋙⋙⋙⋘⋘⋘⋘⋘⋘&lt;br&gt;
&lt;&lt;link ▷「交罚金」 特殊选项&gt;&gt;&lt;&lt;set $choice to &quot;交罚金&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;
&lt;&lt;if $sin &gt;=50 || $player.heartless &gt;= 12&gt;&gt;&lt;br&gt;&lt;&lt;link ▷「无视他」 特殊选项&gt;&gt;&lt;&lt;set $choice to &quot;无视他&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;&lt;/if&gt;&gt;
&lt;&lt;elseif $choice == &quot;放羊&quot; &amp;&amp; $lostsheep[0] != 1&gt;&gt;
Era很感激你的帮忙, 
&lt;&lt;set _m to random(1,25)&gt;&gt;&lt;&lt;if _m &lt;= 10&gt;&gt;给了你_n枚鸟羽作为报酬】&lt;br&gt;
&lt;font color=#4E84BA&gt;✧你获得_n枚鸟羽✧&lt;/font&gt;&lt;&lt;set $feather to $feather+ _n&gt;&gt;
&lt;&lt;elseif _m &lt;=16&gt;&gt;&lt;&lt;set _a = [&quot;猫眼石&quot;,&quot;羊绒&quot;].random()&gt;&gt;&lt;&lt;pickup $item _a 1&gt;&gt;给了你_a作为报酬&lt;br&gt;
&lt;font color=#4E84BA&gt;✧你获得了_a*1✧&lt;/font&gt;
&lt;&lt;elseif _m &lt;=24&gt;&gt;&lt;&lt;pickup $food &quot;羊奶&quot; 1&gt;&gt;给了你羊奶作为报酬&lt;br&gt;
&lt;font color=#4E84BA&gt;✧你获得了羊奶*1✧&lt;/font&gt;&lt;br&gt;
&lt;&lt;elseif $erahgd &gt;= 16 &amp;&amp; $erahgd &lt;= 85&gt;&gt;打算给你讲了一个故事作为报酬&lt;br&gt;⋙⋙⋙⋙⋙⋙⋘⋘⋘⋘⋘⋘&lt;br&gt;
&lt;&lt;link ▷「接受」 era互动&gt;&gt;&lt;&lt;set $choice = &quot;接受&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;br&gt;
▷「拒绝」&lt;&lt;link ▷「拒绝」 草甸&gt;&gt;&lt;&lt;set $choice = &quot;拒绝&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;

&lt;&lt;/if&gt;&gt;
&lt;br&gt;
&lt;&lt;link ▷「继续」 草甸&gt;&gt;&lt;&lt;set $choice to 0&gt;&gt;&lt;&lt;/link&gt;&gt;

/*-------------主页面------------*/
&lt;&lt;else&gt;&gt;
&lt;&lt;audio &quot;mainBGM&quot; unmute&gt;&gt;
&lt;img src=&quot;https://f2.toyhou.se/file/f2-toyhou-se/images/87543119_kFc4jWGEE9lHRil.jpg&quot; width=100%  class=&quot;pic&quot;&gt;&lt;br&gt;
//尽管永无乡大部分面积都在被茂盛生长的草地覆盖着，但只有贝雷河南面临海的那面草地才是岛民俗称的草甸, 因为平坦且临海, 马场与风车都选址在此, Era的羊群也安置在这里//&lt;br&gt;
&lt;br&gt;
&lt;&lt;NPCloc&gt;&gt;
&lt;br&gt;地点行动&lt;br&gt;
&lt;&lt;if $lostsheep == 1&gt;&gt;[[✧「找羊」|era互动]]&lt;br&gt;&lt;&lt;/if&gt;&gt;
[[◈「散步」|散步]]&lt;br&gt;
[[◈「打猎」|打猎]]&lt;br&gt;
&lt;br&gt;继续前往&lt;br&gt;
[[✧「风车」|风车]]&lt;br&gt;
[[✧「LSS马场」|LSS马场]]&lt;br&gt;
&lt;br&gt;其他地点&lt;br&gt;
[[♢「高地」|高地]]&lt;br&gt;
[[♢「贝雷河」|贝雷河]]&lt;br&gt;
[[♢「副港口」|副港口]]&lt;br&gt;
[[♢「礁岩区」|礁岩区]]
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="112" name="萤火虫" tags="nobr night UIBarhide" position="800,500" size="100,100">&lt;div class=&quot;space&quot;&gt;&lt;div class=&quot;particle&quot;&gt;&lt;/div&gt;
&lt;div class=&quot;particle&quot;&gt;&lt;/div&gt;
&lt;div class=&quot;particle&quot;&gt;&lt;/div&gt;
&lt;div class=&quot;particle&quot;&gt;&lt;/div&gt;&lt;/div&gt;

&lt;script&gt;
      function qteChange() {
     const x = Math.floor(Math.random()*75);
     const z = Math.floor(Math.random()*75);
     const y = Math.floor(Math.random()*85);
     const w = Math.floor(Math.random()*85);
     qte.style.left = x + &quot;%&quot;;
     qte.style.right = z + &quot;%&quot;;
     qte.style.top = y + &quot;%&quot;;
     qte.style.bottom = w + &quot;%&quot;; }
    &lt;/script&gt;

&lt;&lt;if $num &gt;=1&gt;&gt;&lt;&lt;set _long to random(2,6)+&quot;s&quot;&gt;&gt;
&lt;div id=&quot;qte&quot;&gt;
&lt;button onclick=&quot;qteChange()&quot; style= &quot;background:none; border:none;&quot;&gt;&lt;&lt;button &amp;nbsp;&amp;nbsp;&gt;&gt;&lt;&lt;set $succ +=1&gt;&gt;&lt;&lt;set $num -=1&gt;&gt;&lt;&lt;/button&gt;&gt;&lt;&lt;timed _long&gt;&gt;&lt;&lt;set $num -=1&gt;&gt;&lt;&lt;goto &quot;萤火虫&quot;&gt;&gt;&lt;&lt;/timed&gt;&gt;&lt;/button&gt;
&lt;/div&gt;

&lt;&lt;else&gt;&gt;你收集到了$succ只萤火虫&lt;br&gt;
&lt;&lt;link 返回 沼泽&gt;&gt;&lt;&lt;/link&gt;&gt;

&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="113" name="补给包" tags="nobr" position="1400,0" size="100,100">&lt;&lt;do&gt;&gt;&lt;&lt;if $choice == &quot;鱼竿&quot;&gt;&gt;【Daisy将一些鱼饵连同鱼竿一同交给你, 将这些和之前的物品一起收纳好. 它们将会陪伴你度过接下来的几天】&lt;br&gt;&lt;&lt;pickup $tool &quot;鱼竿&quot; 1&gt;&gt;&lt;&lt;pickup $item &quot;鱼饵&quot; 20&gt;&gt;&lt;&lt;set _bjb to 1&gt;&gt;
&lt;&lt;set _itemobtain = &quot;鱼竿 * 1、鱼饵 * 20&quot;&gt;&gt;
&lt;&lt;itemobtain&gt;&gt;
&lt;&lt;link ▷「返回」 教堂&gt;&gt;&lt;&lt;/link&gt;&gt;
&lt;&lt;elseif $choice == &quot;猎枪&quot;&gt;&gt;【Daisy将一些火药连同猎枪一同交给你, 将这些和之前的物品一起收纳好. 它们将会陪伴你度过接下来的几天】&lt;br&gt;&lt;&lt;pickup $tool &quot;猎枪&quot; 1&gt;&gt;&lt;&lt;pickup $item &quot;火药&quot; 20&gt;&gt;
&lt;&lt;set _itemobtain = &quot;猎枪 * 1、火药 * 20&quot;&gt;&gt;
&lt;&lt;itemobtain&gt;&gt;
&lt;&lt;set _bjb to 1&gt;&gt;
&lt;&lt;link ▷「返回」 教堂&gt;&gt;&lt;&lt;/link&gt;&gt;
&lt;&lt;else&gt;&gt;&lt;&lt;set _a to random(0,6)&gt;&gt;&lt;&lt;set _b to random(0,4)&gt;&gt;&lt;&lt;set _c to random(0,4)&gt;&gt;&lt;&lt;set _d to random(1,8)&gt;&gt;&lt;&lt;set _e to random(1,6)&gt;&gt;&lt;&lt;set _f to random(0,1)&gt;&gt;【牧师听即便起身去了一旁的隔间, 等他再次出现时, 手里捧着一篮品相十分不错的点心和饮品. 你急忙去接过篮子】&lt;br&gt;
&lt;&lt;pickup $food &quot;苹果派&quot; _a&gt;&gt;&lt;&lt;pickup $food &quot;红茶&quot; _b&gt;&gt;&lt;&lt;pickup $food &quot;浆果馅饼&quot; _c&gt;&gt;&lt;&lt;pickup $food &quot;烤鸡腿&quot; _d&gt;&gt;&lt;&lt;pickup $food &quot;橙汁&quot; _e&gt;&gt;&lt;&lt;pickup $food &quot;柿子酒&quot; _f&gt;&gt;
&lt;&lt;timed 1s t8n&gt;&gt;&lt;font color=#4E84BA&gt;✧你获得了&lt;&lt;if _a != 0&gt;&gt;苹果派 * _a、&lt;&lt;/if&gt;&gt;&lt;&lt;if _b != 0&gt;&gt;红茶 * _b、&lt;&lt;/if&gt;&gt;&lt;&lt;if _c != 0&gt;&gt;浆果馅饼 * _c、&lt;&lt;/if&gt;&gt;&lt;&lt;if _d != 0&gt;&gt;烤鸡腿 * _d、&lt;&lt;/if&gt;&gt;&lt;&lt;if _e != 0&gt;&gt;橙汁 * _e&lt;&lt;/if&gt;&gt;&lt;&lt;if _f != 0&gt;&gt;、柿子酒 * _f&lt;&lt;/if&gt;&gt;✧&lt;/font&gt;&lt;&lt;/timed&gt;&gt;
&lt;br&gt;&lt;br&gt;
&lt;&lt;timed 3s t8n&gt;&gt;【你意识到篮子边还挂着什么, 那是一双崭新的皮革手套, 看起来也是为你准备的】&lt;br&gt;
&lt;&lt;pickup $hand &quot;皮革手套&quot; 1&gt;&gt;
&lt;font color=#4E84BA&gt;✧你获得皮革手套 * 1✧&lt;/font&gt;&lt;&lt;/timed&gt;&gt;
&lt;br&gt;&lt;br&gt;
&lt;&lt;timed 5s t8n&gt;&gt;【在你准备谢过牧师时, Daisy又拿出了两样工具, 摆在你面前. 鱼竿和猎枪, 这显然是单项选择】
&lt;br&gt;&lt;br&gt;
 ⋙⋙⋙⋙⋙⋙⋘⋘⋘⋘⋘⋘&lt;br&gt;
&lt;&lt;link ▷「鱼竿」&gt;&gt;&lt;&lt;set $choice to &quot;鱼竿&quot;&gt;&gt;&lt;&lt;redo&gt;&gt;&lt;&lt;/link&gt;&gt;
&lt;br&gt;&lt;&lt;link ▷「猎枪!」&gt;&gt;&lt;&lt;set $choice to &quot;猎枪&quot;&gt;&gt;&lt;&lt;redo&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;&lt;/timed&gt;&gt;&lt;&lt;/if&gt;&gt;&lt;&lt;/do&gt;&gt;
&lt;&lt;set _bjb to 1&gt;&gt;</tw-passagedata><tw-passagedata pid="114" name="装备" tags="" position="700,100" size="100,100">&lt;&lt;set setup.tool = new Map([
    [&quot;鱼竿&quot;, {knowledge : 0, strength : 0, observation : 1, persuasive : 0, wound : 0, dread : 0, nightmare : 0, suspicion : 0, cautious: 0, heartless: 0, bloody: 0, confidence : 0, generous: 0, enjoy : 0}],
    [&quot;猎枪&quot;, {knowledge : 0, strength : 1, observation : 0, persuasive : 0, wound : 0, dread : 0, nightmare : 0, suspicion : 0, cautious: 0, heartless: 0, bloody: 0, confidence : 0, generous: 0, enjoy : 0}],
	[&quot;短镰&quot;, {knowledge : 0, strength : 8, observation : 0, persuasive : 0, wound : 0, dread : 0, nightmare : 0, suspicion : 0, cautious: 0, heartless: 0, bloody: 4, confidence : 0, generous: 0, enjoy : 0}],
])&gt;&gt;

&lt;&lt;set setup.head = new Map([
    [&quot;玫瑰花环&quot;, {knowledge : 0, strength : 0, observation : 1, persuasive : 0, wound : 0, dread : 0, nightmare : 0, suspicion : 0, cautious: 0, heartless: 0, bloody: 0, confidence : 0, generous: 0, enjoy : 1}],
    [&quot;蜡染方巾&quot;, {knowledge : 2, strength : 0, observation : 4, persuasive : 0, wound : 0, dread : 0, nightmare : 0, suspicion : 2, cautious: 0, heartless: 0, bloody: 0, confidence : 0, generous: 0, enjoy : 0}],
])&gt;&gt;

&lt;&lt;set setup.neck = new Map([
    [&quot;贝壳项链&quot;, {knowledge : 0, strength : 0, observation : 0, persuasive : 1, wound : 0, dread : 0, nightmare : 0, suspicion : 0, cautious: 0, heartless: 0, bloody: 0, confidence : 0, generous: 0, enjoy : 0}],
    [&quot;吊坠项链&quot;, {knowledge : 0, strength : 0, observation : 2, persuasive : 4, wound : 0, dread : 0, nightmare : 0, suspicion : 2, cautious: 0, heartless: 0, bloody: 0, confidence : 0, generous: 0, enjoy : 0}],
])&gt;&gt;

&lt;&lt;set setup.top = new Map([
    [&quot;女仆制服&quot;, {knowledge : 0, strength : 0, observation : 3, persuasive : -1, wound : 0, dread : 0, nightmare : 0, suspicion : 0, cautious: 0, heartless: 0, bloody: 0, confidence : 0, generous: 0, enjoy : 0}],
    [&quot;星夜晚礼服&quot;, {knowledge : 0, strength : 0, observation : 0, persuasive : 4, wound : 0, dread : 0, nightmare : 0, suspicion : 0, cautious: 0, heartless: 0, bloody: 0, confidence : 4, generous: 0, enjoy : 2}],
    [&quot;皮革大衣&quot;, {knowledge : 0, strength : 2, observation : -1, persuasive : 1, wound : 0, dread : 0, nightmare : 0, suspicion : 0, cautious: 0, heartless: 0, bloody: 0, confidence : 0, generous: 0, enjoy : 0}],
    [&quot;珐琅胸针&quot;, {knowledge : 2, strength : 2, observation : 1, persuasive : 1, wound : 0, dread : 0, nightmare : 0, suspicion : 2, cautious: 0, heartless: 0, bloody: 0, confidence : 0, generous: 0, enjoy : 0}],
])&gt;&gt;

&lt;&lt;set setup.hand = new Map([
    [&quot;蛇骷戒指&quot;, {knowledge : 6, strength : 0, observation : 6, persuasive : 0, wound : 0, dread : 0, nightmare : 3, suspicion : 0, cautious: 0, heartless: 3, bloody: 0, confidence : 0, generous: 0, enjoy : 0}],
	[&quot;关节指环&quot;, {knowledge : 0, strength : 2, observation : 0, persuasive : 2, wound : 0, dread : 0, nightmare : 0, suspicion : 0, cautious: 0, heartless: 0, bloody: 0, confidence : 0, generous: 0, enjoy : 0}],
    [&quot;皮革手套&quot;, {knowledge : 0, strength : 2, observation : 0, persuasive : 0, wound : 0, dread : 0, nightmare : 0, suspicion : 0, cautious: 0, heartless: 0, bloody: 0, confidence : 0, generous: 0, enjoy : 0}],
    [&quot;铂金戒指&quot;, {knowledge : 4, strength : 0, observation : 0, persuasive : 2, wound : 0, dread : 0, nightmare : 0, suspicion : 2, cautious: 0, heartless: 0, bloody: 0, confidence : 0, generous: 0, enjoy : 0}],
])&gt;&gt;

&lt;&lt;set setup.pants = new Map([
    [&quot;雷鸣腰带&quot;, {knowledge : 0, strength : 8, observation : 0, persuasive : 0, wound : 0, dread : 0, nightmare : 0, suspicion : 0, cautious: 0, heartless: 0, bloody: 0, confidence : 5, generous: 0, enjoy : 0}],
])&gt;&gt;

&lt;&lt;set setup.foot = new Map([
    [&quot;七里靴&quot;, {knowledge : 0, strength : 2, observation : 1, persuasive : 0, wound : 0, dread : 0, nightmare : 0, suspicion : 0, cautious: 1, heartless: 0, bloody: 0, confidence : 0, generous: 0, enjoy : 0}],
    [&quot;铆钉马靴&quot;, {knowledge : 0, strength : 2, observation : 4, persuasive : 0, wound : 0, dread : 0, nightmare : 0, suspicion : 2, cautious: 0, heartless: 0, bloody: 0, confidence : 0, generous: 0, enjoy : 0}],
])&gt;&gt;</tw-passagedata><tw-passagedata pid="115" name="装备栏" tags="nobr" position="800,0" size="100,100">&lt;table style=&quot;border-style: none;&quot;&gt;
&lt;tbody font size=2px align=&quot;left&quot;&gt;

  &lt;tr&gt;&lt;td style=&quot;width:30%&quot;&gt;&amp;emsp;&amp;emsp;&lt;&lt;button &quot;手持&quot;&gt;&gt;&lt;&lt;set _eqchoice = &quot;手持&quot;&gt;&gt;&lt;&lt;run Dialog.setup(&quot;更换手持工具&quot;);Dialog.wiki(Story.get(&quot;更换装备&quot;).processText());Dialog.open()&gt;&gt;&lt;&lt;/button&gt;&gt;&amp;emsp;
&lt;span class=&quot;tip&quot;&gt;&lt;b&gt;&lt;&lt;= $toolSlot&gt;&gt;&lt;/b&gt;&lt;span class=&quot;tiptext&quot;&gt;&lt;b&gt;$toolSlot&lt;/b&gt;&lt;br&gt;&lt;font color=#FFAA00&gt;&lt;&lt;=setup.items[$toolSlot].function&gt;&gt;&lt;/font&gt;&lt;br&gt;&lt;&lt;=setup.items[$toolSlot].description&gt;&gt;&lt;/span&gt;&lt;/span&gt;
&lt;/td&gt;&lt;/tr&gt;
 
&lt;tr&gt;&lt;td style=&quot;width:30%&quot;&gt;&amp;emsp;&amp;emsp;&lt;&lt;button &quot;头部&quot;&gt;&gt;&lt;&lt;set _eqchoice = &quot;头部&quot;&gt;&gt;&lt;&lt;run Dialog.setup(&quot;更换头部装备&quot;);Dialog.wiki(Story.get(&quot;更换装备&quot;).processText());Dialog.open()&gt;&gt;&lt;&lt;/button&gt;&gt;&amp;emsp;
&lt;span class=&quot;tip&quot;&gt;&lt;b&gt;&lt;&lt;= $headSlot&gt;&gt;&lt;/b&gt;&lt;span class=&quot;tiptext&quot;&gt;&lt;b&gt;$headSlot&lt;/b&gt;&lt;br&gt;&lt;font color=#FFAA00&gt;&lt;&lt;=setup.items[$headSlot].function&gt;&gt;&lt;/font&gt;&lt;br&gt;&lt;&lt;=setup.items[$headSlot].description&gt;&gt;&lt;/span&gt;&lt;/span&gt;
&lt;/td&gt;&lt;/tr&gt;

&lt;tr&gt;&lt;td style=&quot;width:30%&quot;&gt;&amp;emsp;&amp;emsp;&lt;&lt;button &quot;颈部&quot;&gt;&gt;&lt;&lt;set _eqchoice = &quot;颈部&quot;&gt;&gt;&lt;&lt;run Dialog.setup(&quot;更换颈部装备&quot;);Dialog.wiki(Story.get(&quot;更换装备&quot;).processText());Dialog.open()&gt;&gt;&lt;&lt;/button&gt;&gt;&amp;emsp;
&lt;span class=&quot;tip&quot;&gt;&lt;b&gt;@@#neckSlot;&lt;&lt;= $neckSlot&gt;&gt;@@&lt;/b&gt;&lt;span class=&quot;tiptext&quot;&gt;&lt;b&gt;$neckSlot&lt;/b&gt;&lt;br&gt;&lt;font color=#FFAA00&gt;&lt;&lt;=setup.items[$neckSlot].function&gt;&gt;&lt;/font&gt;&lt;br&gt;&lt;&lt;=setup.items[$neckSlot].description&gt;&gt;&lt;/span&gt;&lt;/span&gt;
&lt;/td&gt;&lt;/tr&gt;

&lt;tr&gt;&lt;td style=&quot;width:30%&quot;&gt;&amp;emsp;&amp;emsp;&lt;&lt;button &quot;上身&quot;&gt;&gt;&lt;&lt;set _eqchoice = &quot;上身&quot;&gt;&gt;
&lt;&lt;run Dialog.setup(&quot;更换上身装备&quot;);Dialog.wiki(Story.get(&quot;更换装备&quot;).processText());Dialog.open()&gt;&gt;&lt;&lt;/button&gt;&gt;&amp;emsp;
&lt;span class=&quot;tip&quot;&gt;&lt;b&gt;@@#topSlot;&lt;&lt;= $topSlot&gt;&gt;@@&lt;/b&gt;&lt;span class=&quot;tiptext&quot;&gt;&lt;b&gt;$topSlot&lt;/b&gt;&lt;br&gt;&lt;font color=#FFAA00&gt;&lt;&lt;=setup.items[$topSlot].function&gt;&gt;&lt;/font&gt;&lt;br&gt;&lt;&lt;=setup.items[$topSlot].description&gt;&gt;&lt;/span&gt;&lt;/span&gt;
&lt;/td&gt;&lt;/tr&gt;

&lt;tr&gt;&lt;td style=&quot;width:30%&quot;&gt;&amp;emsp;&amp;emsp;&lt;&lt;button &quot;手部&quot;&gt;&gt;&lt;&lt;set _eqchoice = &quot;手部&quot;&gt;&gt;
&lt;&lt;run Dialog.setup(&quot;更换手部装备&quot;);Dialog.wiki(Story.get(&quot;更换装备&quot;).processText());Dialog.open()&gt;&gt;&lt;&lt;/button&gt;&gt;&amp;emsp;
&lt;span class=&quot;tip&quot;&gt;&lt;b&gt;@@#handSlot;&lt;&lt;= $handSlot&gt;&gt;@@&lt;/b&gt;&lt;span class=&quot;tiptext&quot;&gt;&lt;b&gt;$handSlot&lt;/b&gt;&lt;br&gt;&lt;font color=#FFAA00&gt;&lt;&lt;=setup.items[$handSlot].function&gt;&gt;&lt;/font&gt;&lt;br&gt;&lt;&lt;=setup.items[$handSlot].description&gt;&gt;&lt;/span&gt;&lt;/span&gt;
&lt;/td&gt;&lt;/tr&gt;

&lt;tr&gt;&lt;td style=&quot;width:30%&quot;&gt;&amp;emsp;&amp;emsp;&lt;&lt;button &quot;下身&quot;&gt;&gt;&lt;&lt;set _eqchoice = &quot;下身&quot;&gt;&gt;&lt;&lt;run Dialog.setup(&quot;更换下身装备&quot;);Dialog.wiki(Story.get(&quot;更换装备&quot;).processText());Dialog.open()&gt;&gt;&lt;&lt;/button&gt;&gt;&amp;emsp;
&lt;span class=&quot;tip&quot;&gt;&lt;b&gt;@@#pantsSlot;&lt;&lt;= $pantsSlot&gt;&gt;@@&lt;/b&gt;&lt;span class=&quot;tiptext&quot;&gt;&lt;b&gt;$pantsSlot&lt;/b&gt;&lt;br&gt;&lt;font color=#FFAA00&gt;&lt;&lt;=setup.items[$pantsSlot].function&gt;&gt;&lt;/font&gt;&lt;br&gt;&lt;&lt;=setup.items[$pantsSlot].description&gt;&gt;&lt;/span&gt;&lt;/span&gt;
&lt;/td&gt;&lt;/tr&gt;

&lt;tr&gt;&lt;td style=&quot;width:30%&quot;&gt;&amp;emsp;&amp;emsp;&lt;&lt;button &quot;脚部&quot;&gt;&gt;&lt;&lt;set _eqchoice = &quot;脚部&quot;&gt;&gt;&lt;&lt;run Dialog.setup(&quot;更换脚部装备&quot;);Dialog.wiki(Story.get(&quot;更换装备&quot;).processText());Dialog.open()&gt;&gt;&lt;&lt;/button&gt;&gt;&amp;emsp;
&lt;span class=&quot;tip&quot;&gt;&lt;b&gt;@@#footSlot;&lt;&lt;= $footSlot&gt;&gt;@@&lt;/b&gt;&lt;span class=&quot;tiptext&quot;&gt;&lt;b&gt;$footSlot&lt;/b&gt;&lt;br&gt;&lt;font color=#FFAA00&gt;&lt;&lt;=setup.items[$footSlot].function&gt;&gt;&lt;/font&gt;&lt;br&gt;&lt;&lt;=setup.items[$footSlot].description&gt;&gt;&lt;/span&gt;&lt;/span&gt;
&lt;/td&gt;&lt;/tr&gt;

&lt;/tbody&gt;
&lt;/table&gt;</tw-passagedata><tw-passagedata pid="116" name="许愿井" tags="nobr" position="300,600" size="100,100">&lt;&lt;if $loc != &quot;许愿井&quot;&gt;&gt;&lt;&lt;set $loc = &quot;许愿井&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;
&lt;&lt;if  $wellfirst != 1&gt;&gt;&lt;&lt;set  $wellfirst = 1&gt;&gt;
【你正准备离开深林边缘, 突然意识到一旁有一条不明显的小路. 这条路看上去很久没人走过了, 大部分已经被植被覆盖, 这一定是你之前没能发现它的原因, 但现在你注意到, 路旁生长的荆棘和灌木略微不融入周围环境】&lt;br&gt;
&lt;br&gt;
&lt;&lt;timed 2s t8n&gt;&gt;【你扒开了层层的灌木和荆棘, 在路的尽头是一口水井, 木棚已经在长年累月的风雨中失去了其遮挡的作用, 破损的木板掩盖住了井口. 等你再靠近一点, 就能看见井的一侧上几近磨灭的文字写着: 许愿井】&lt;&lt;set $wellfirst to 1&gt;&gt;&lt;&lt;/timed&gt;&gt;&lt;br&gt;
&lt;br&gt;
&lt;&lt;timed 3s t8n&gt;&gt;✧「下井」&lt;br&gt;
✧「许愿」&lt;br&gt;
&lt;br&gt;
&lt;&lt;link ▷「离开」 深林边缘&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;&lt;/timed&gt;&gt;
&lt;&lt;else&gt;&gt;【你扒开了层层的灌木和荆棘, 在路的尽头是一口水井, 木棚已经在长年累月的风雨中失去了其遮挡的作用, 破损的木板掩盖住了井口. 等你再靠近一点, 就能看见井的一侧上几近磨灭的文字写着: 许愿井】&lt;br&gt;
&lt;br&gt;
✧「下井」&lt;br&gt;
✧「许愿」&lt;br&gt;
&lt;br&gt;
&lt;&lt;link ▷「离开」 深林边缘&gt;&gt;&lt;&lt;/link&gt;&gt;</tw-passagedata><tw-passagedata pid="117" name="贝雷河" tags="nobr" position="400,200" size="100,100">&lt;&lt;if $loc != &quot;贝雷河&quot;&gt;&gt;&lt;&lt;set $loc = &quot;贝雷河&quot;&gt;&gt;&lt;&lt;timeWidget&gt;&gt;&lt;&lt;set $minute to $minute+ random(5,10)&gt;&gt;&lt;&lt;set $HP to $HP- 1&gt;&gt;&lt;&lt;/if&gt;&gt;//作为横穿岛屿的一条淡水河, 贝雷河及其支流是永无乡上最主要的用水来源. 众多的建筑都是依河而建, 马场、小镇、港口码头...即使在最冷的季节贝雷河也不会冻结, 永远沉默着从西至东流逝, 为岛屿带来生机. 但无论河水看起来有多么平静, 永远不要涉身到她的黑水中//
&lt;br&gt;
&lt;&lt;NPCloc&gt;&gt;
&lt;br&gt;地点活动&lt;br&gt;
&lt;&lt;if $lostsheep[0] == 1&gt;&gt;[[✧「找羊」|era互动]]&lt;br&gt;&lt;&lt;/if&gt;&gt;
[[◈「钓鱼」|钓鱼]]&lt;br&gt;
[[◈「散步」|散步]]&lt;br&gt;
[[◈「打猎」|打猎]]&lt;br&gt;
&lt;br&gt;继续前往&lt;br&gt;
[[✧「猎户小屋」|猎户小屋]]&lt;br&gt;
&lt;br&gt;其他地区&lt;br&gt;
[[♢「小镇」|小镇]]&lt;br&gt;
[[♢「草甸」|草甸]]&lt;br&gt;
[[♢「高地」|高地]]&lt;br&gt;
[[♢「主港口」|主港口]]&lt;br&gt;
[[♢「副港口」|副港口]]&lt;br&gt;
[[♢「罗索伦特湖」|罗索伦特湖]]</tw-passagedata><tw-passagedata pid="118" name="赚钱指南" tags="" position="1500,400" size="100,100">&lt;font color=#FFAA00&gt;Seisinofoaga&lt;/font&gt;: 
看看是谁终于肯动动懒屁股去干点正事了, 但做事情要先确保你的体力充沛, 要是因为干点活计就累倒, 那我们这段时间可就有得笑话讲了

&lt;&lt;link [[♢「草甸」|草甸]]&gt;&gt;&lt;&lt;dialogclose&gt;&gt;&lt;&lt;/link&gt;&gt;
不下雨的时候Era都会在草甸上放羊, 那小子很乐意有谁能代他的班呢, 但是别想着替他的位子, 你离够格还远着呢
&lt;&lt;link [[♢「拓荒者木屋」|拓荒者木屋]]&gt;&gt;&lt;&lt;dialogclose&gt;&gt;&lt;&lt;/link&gt;&gt;
这边时不时会有一些杂活, 我想Nix也不会在酬劳上吝啬
&lt;&lt;link [[♢「咖啡馆」|咖啡馆]]&gt;&gt;&lt;&lt;dialogclose&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;&lt;link [[♢「酒馆」|酒馆]]&gt;&gt;&lt;&lt;dialogclose&gt;&gt;&lt;&lt;/link&gt;&gt; 
两位老板娘总有自己忙不过来的时候, 去给她们搭把手, 报酬不会少的
✧「钓鱼」  ✧「打猎」
既然你还有副好身体, 为什么不去干点你的祖先几千年前都会干的事? 但岛上的东西可不是取之不尽的, 我会时刻注视着你
&lt;&lt;link [[♢「杂货铺」|杂货铺]]&gt;&gt;&lt;&lt;dialogclose&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;&lt;link [[♢「鱼铺」|鱼铺]]&gt;&gt;&lt;&lt;dialogclose&gt;&gt;&lt;&lt;/link&gt;&gt;
平日里获得的东西都可以拿到这些店里去卖
&lt;&lt;link [[♢「主港口灯塔」|灯塔]]&gt;&gt;&lt;&lt;dialogclose&gt;&gt;&lt;&lt;/link&gt;&gt;
在灯塔看守琼那里可以提交你炼制的鱼油, 价钱不高但积少成多


&lt;&lt;if $sin &gt;=10&gt;&gt;哦, 我知道了. 你看起来也没有多么正派. 在晚上的镇子多转转, 总能发现点不一样的东西. 去那碰碰运气吧, 或者, 说不定, 你会花光自己的钱
&lt;&lt;elseif $sin &gt;=20&gt;&gt;不知道你有没有去过深林? 好奇吗? 想去一探究竟吗?&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="119" name="赠送" tags="" position="1400,300" size="100,100">&lt;div class=&quot;tab-container&quot;&gt;&lt;div class=&quot;tab-content&quot; id=&quot;item1&quot;&gt;&lt;&lt;nobr&gt;&gt;
▸▹ ✾ ✾ ✾ ✾ ✾ ✾ ✾ ✾ ✾ ✾ ✾ ✾ ✾ ✾◃◂&lt;br&gt;
&lt;&lt;for _i to 0; _i lt $item.uniqueLength;  _i++&gt;&gt;
&lt;&lt;set _itemn = $item.list[_i]&gt;&gt;
◈_itemn × &lt;&lt;=$item.count(_itemn)&gt;&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;
&lt;&lt;capture _itemn&gt;&gt;
&lt;&lt;link &quot;赠送&quot;&gt;&gt;&lt;&lt;set $gift = _itemn&gt;&gt;&lt;&lt;drop $item _itemn 1&gt;&gt;&lt;&lt;goto &quot;赠送回复&quot;&gt;&gt;&lt;&lt;dialogclose&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;&lt;/capture&gt;&gt;&lt;br&gt;
&lt;&lt;/for&gt;&gt;
▸▹ ✾ ✾ ✾ ✾ ✾ ✾ ✾ ✾ ✾ ✾ ✾ ✾ ✾ ✾◃◂
&lt;&lt;/nobr&gt;&gt;&lt;/div&gt;&lt;div class=&quot;tab-content&quot; id=&quot;item2&quot;&gt;&lt;&lt;nobr&gt;&gt;
▸▹ ✾ ✾ ✾ ✾ ✾ ✾ ✾ ✾ ✾ ✾ ✾ ✾ ✾ ✾◃◂&lt;br&gt;
&lt;&lt;for _i to 0; _i lt $food.uniqueLength;  _i++&gt;&gt;
&lt;&lt;set _itemn = $food.list[_i]&gt;&gt;
◈_itemn × &lt;&lt;=$food.count(_itemn)&gt;&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;
&lt;&lt;capture _itemn&gt;&gt;
&lt;&lt;link &quot;赠送&quot;&gt;&gt;&lt;&lt;set $gift = _itemn&gt;&gt;&lt;&lt;drop $food _itemn 1&gt;&gt;&lt;&lt;goto &quot;赠送回复&quot;&gt;&gt;&lt;&lt;dialogclose&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;&lt;/capture&gt;&gt;&lt;br&gt;
&lt;&lt;/for&gt;&gt;
▸▹ ✾ ✾ ✾ ✾ ✾ ✾ ✾ ✾ ✾ ✾ ✾ ✾ ✾ ✾◃◂
&lt;&lt;/nobr&gt;&gt;&lt;/div&gt;&lt;div class=&quot;tab-content&quot; id=&quot;item3&quot;&gt;&lt;&lt;nobr&gt;&gt;
▸▹ ✾ ✾ ✾ ✾ ✾ ✾ ✾ ✾ ✾ ✾ ✾ ✾ ✾ ✾◃◂&lt;br&gt;
&lt;&lt;for _i to 0; _i lt $book.uniqueLength;  _i++&gt;&gt;
&lt;&lt;set _itemn = $book.list[_i]&gt;&gt;
◈_itemn × &lt;&lt;=$book.count(_itemn)&gt;&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;
&lt;&lt;capture _itemn&gt;&gt;
&lt;&lt;link &quot;赠送&quot;&gt;&gt;&lt;&lt;set $gift = _itemn&gt;&gt;&lt;&lt;drop $book _itemn 1&gt;&gt;&lt;&lt;goto &quot;赠送回复&quot;&gt;&gt;&lt;&lt;dialogclose&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;&lt;/capture&gt;&gt;&lt;br&gt;
&lt;&lt;/for&gt;&gt;
▸▹ ✾ ✾ ✾ ✾ ✾ ✾ ✾ ✾ ✾ ✾ ✾ ✾ ✾ ✾◃◂
&lt;&lt;/nobr&gt;&gt;&lt;/div&gt;&lt;div class=&quot;tab-content&quot; id=&quot;item4&quot;&gt;&lt;&lt;nobr&gt;&gt;
▸▹ ✾ ✾ ✾ ✾ ✾ ✾ ✾ ✾ ✾ ✾ ✾ ✾ ✾ ✾◃◂&lt;br&gt;
&lt;&lt;for _i to 0; _i lt $prey.uniqueLength;  _i++&gt;&gt;
&lt;&lt;set _itemn = $prey.list[_i]&gt;&gt;
◈_itemn × &lt;&lt;=$prey.count(_itemn)&gt;&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;
&lt;&lt;capture _itemn&gt;&gt;
&lt;&lt;link &quot;赠送&quot;&gt;&gt;&lt;&lt;set $gift = _itemn&gt;&gt;&lt;&lt;drop $prey _itemn 1&gt;&gt;&lt;&lt;goto &quot;赠送回复&quot;&gt;&gt;&lt;&lt;dialogclose&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;&lt;/capture&gt;&gt;&lt;br&gt;
&lt;&lt;/for&gt;&gt;
▸▹ ✾ ✾ ✾ ✾ ✾ ✾ ✾ ✾ ✾ ✾ ✾ ✾ ✾ ✾◃◂
&lt;&lt;/nobr&gt;&gt;&lt;/div&gt;&lt;div class=&quot;tab-content&quot; id=&quot;item5&quot;&gt;&lt;&lt;nobr&gt;&gt;
▸▹ ✾ ✾ ✾ ✾ ✾ ✾ ✾ ✾ ✾ ✾ ✾ ✾ ✾ ✾◃◂&lt;br&gt;
&lt;&lt;for _i to 0; _i lt $fish.uniqueLength;  _i++&gt;&gt;
&lt;&lt;set _itemn = $fish.list[_i]&gt;&gt;
◈_itemn × &lt;&lt;=$fish.count(_itemn)&gt;&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;
&lt;&lt;capture _itemn&gt;&gt;
&lt;&lt;link &quot;赠送&quot;&gt;&gt;&lt;&lt;set $gift = _itemn&gt;&gt;&lt;&lt;drop $fish _itemn 1&gt;&gt;&lt;&lt;goto &quot;赠送回复&quot;&gt;&gt;&lt;&lt;dialogclose&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;&lt;/capture&gt;&gt;&lt;br&gt;
&lt;&lt;/for&gt;&gt;
▸▹ ✾ ✾ ✾ ✾ ✾ ✾ ✾ ✾ ✾ ✾ ✾ ✾ ✾ ✾◃◂
&lt;&lt;/nobr&gt;&gt;&lt;/div&gt;&lt;/div&gt;


&lt;script&gt;
  var tabBtns = document.querySelectorAll(&#39;.tab-btn&#39;);
  var tabContents = document.querySelectorAll(&#39;.tab-content&#39;);
 
  tabBtns.forEach(function(tabBtn) {
    tabBtn.addEventListener(&#39;click&#39;, function() {
      var tabId = this.getAttribute(&#39;data-tab&#39;);
      // 隐藏所有的 tab 内容
      tabContents.forEach(function(tabContent) {
        tabContent.classList.remove(&#39;active&#39;);
      });
      // 显示当前点击的 tab 内容
      document.getElementById(tabId).classList.add(&#39;active&#39;);
    });
  });
&lt;/script&gt;</tw-passagedata><tw-passagedata pid="120" name="赠送回复" tags="nobr" position="1500,300" size="100,100">&lt;&lt;set _m to random(3,5)&gt;&gt;&lt;&lt;set _n to random(1,3)&gt;&gt;
&lt;&lt;if $npc == &quot;Era&quot;&gt;&gt;&lt;&lt;set $eragift = 0&gt;&gt;
&lt;&lt;if Item.get($gift).hasTag(&quot;eralove&quot;)&gt;&gt;&lt;&lt;set $erahgd += _m&gt;&gt;【Era收下了你的礼物】&lt;br&gt;&lt;font color=#DB8E88&gt;❥Era对你的好感度增加了&lt;/font&gt;
&lt;&lt;elseif Item.get($gift).hasTag(&quot;eralike&quot;)&gt;&gt;&lt;&lt;set $erahgd += _n&gt;&gt;【Era收下了你的礼物】&lt;br&gt;&lt;font color=#DB8E88&gt;❥Era对你的好感度增加了&lt;/font&gt;
&lt;&lt;elseif Item.get($gift).hasTag(&quot;erahate&quot;)&gt;&gt;&lt;&lt;set $erahgd -= _n&gt;&gt;【Era收下了你的礼物】&lt;br&gt;&lt;font color=#5F6B78&gt;💔Era对你的好感度降低了&lt;/font&gt;
&lt;&lt;elseif $gift == &quot;蓝宝石&quot;&gt;&gt;&lt;&lt;set $erahgd += 10&gt;&gt;暗示自己的船沉船是Nix背地操控&lt;br&gt;&lt;font color=#DB8E88&gt;❥Era对你的好感度增加了&lt;/font&gt;
&lt;&lt;else&gt;&gt;&lt;&lt;set $erahgd +=1&gt;&gt;【Era收下了你的礼物】&lt;br&gt;&lt;font color=#DB8E88&gt;❥Era对你的好感度增加了&lt;/font&gt;
&lt;&lt;/if&gt;&gt;&lt;&lt;/if&gt;&gt;

&lt;&lt;if $npc == &quot;奥里&quot;&gt;&gt;&lt;&lt;set $eragift = 0&gt;&gt;
&lt;&lt;if Item.get($gift).hasAnyTags(&quot;bow&quot;, &quot;sweet&quot;)&gt;&gt;&lt;&lt;set $erahgd += _m&gt;&gt;
【奥里收下了你的礼物】&lt;br&gt;&lt;font color=#DB8E88&gt;❥奥里对你的好感度增加了&lt;/font&gt;
&lt;&lt;elseif Item.get($gift).hasTag(&quot;eralike&quot;)&gt;&gt;&lt;&lt;set $erahgd += _n&gt;&gt;【奥里收下了你的礼物】&lt;br&gt;&lt;font color=#DB8E88&gt;❥奥里对你的好感度增加了&lt;/font&gt;
&lt;&lt;elseif Item.get($gift).hasAnyTags(&quot;laji&quot;, &quot;bug&quot;)&gt;&gt;&lt;&lt;set $erahgd -= _n&gt;&gt;【Era收下了你的礼物】&lt;br&gt;&lt;font color=#5F6B78&gt;💔奥里对你的好感度降低了&lt;/font&gt;
&lt;&lt;else&gt;&gt;&lt;&lt;set $erahgd +=1&gt;&gt;【Era收下了你的礼物】&lt;br&gt;&lt;font color=#DB8E88&gt;❥奥里对你的好感度增加了&lt;/font&gt;
&lt;&lt;/if&gt;&gt;&lt;&lt;/if&gt;&gt;

&lt;&lt;link ▷「继续」 $loc&gt;&gt;&lt;&lt;/link&gt;&gt;</tw-passagedata><tw-passagedata pid="121" name="进入永无乡" tags="" position="800,1175" size="100,100">&lt;font color=&quot;FFAA00&quot;&gt; Seisinofoaga&lt;/font&gt;: 
&lt;&lt;type-wp 45ms element &quot;span&quot;&gt;&gt;说得够多了, 现在, 拿起行李去开启你的新生活吧, 我会一直看着你的, $nn
&lt;font color=&quot;CF7C34&quot;&gt;✶开启任务【主线】新的开始✶&lt;/font&gt;
&lt;&lt;pickup $ms &quot;新的开始&quot; 1&gt;&gt;&lt;&lt;set $mss to &quot;主线第一天&quot;&gt;&gt;
&lt;&lt;set $msstat = &quot;新的开始1&quot;&gt;&gt;&lt;&lt;set $msname = &quot;新的开始&quot;&gt;&gt;
&lt;&lt;set $firsts = 1&gt;&gt;
&lt;&lt;set $map = 1&gt;&gt;

&lt;&lt;link &quot;▷「地图」&quot;&gt;&gt;
&lt;&lt;run
Dialog.setup(&quot;永无乡地图&quot;);
Dialog.wiki(Story.get(&quot;map&quot;).processText());
Dialog.open();
&gt;&gt;
&lt;&lt;/link&gt;&gt;
&lt;&lt;link ▷「进入小镇」 小镇&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;&lt;/type-wp&gt;&gt;</tw-passagedata><tw-passagedata pid="122" name="送信" tags="" position="1300,400" size="100,100">还没写</tw-passagedata><tw-passagedata pid="123" name="邮箱" tags="" position="1200,400" size="100,100"></tw-passagedata><tw-passagedata pid="124" name="酒馆" tags="nobr" position="200,400" size="100,100">&lt;b&gt;两轮之间酒馆&lt;/b&gt;&lt;br&gt;
【营业时间 10: 00~02: 00】&lt;br&gt;
&lt;&lt;if $hour &gt;= 10 || $hour &lt;= 2&gt;&gt;&lt;&lt;if $loc != &quot;酒馆&quot;&gt;&gt;&lt;&lt;set $loc = &quot;酒馆&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;
&lt;&lt;audio &quot;mainBGM&quot; mute&gt;&gt;
&lt;&lt;audio &quot;pubBGM&quot; loop play&gt;&gt;
&lt;font color=#D4A34C&gt;//这是一间被主人精心布置的小酒馆，华丽得恰到好处。角落里的留声机正播放着李斯特的《爱之梦》，一遍又一遍，不知厌烦也不知疲倦。“来者即是客。亲爱的，要来点什么？”酒馆老板娘举起酒杯向你致意//&lt;/font&gt;&lt;br&gt;
&lt;br&gt;
&lt;&lt;link&quot; ✣「琥珀夫人」 &quot; &quot;酒馆&quot;&gt;&gt;&lt;&lt;set $loct = $loc, $npc to &quot;琥珀夫人&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;
&lt;br&gt;&lt;br&gt;
继续前往&lt;br&gt;
[[♢「吧台」|找个座位]]&lt;br&gt;
[[♢「后厨」|找个座位]]&lt;br&gt;
&lt;br&gt;地点活动&lt;br&gt;
&lt;&lt;link ✧「查看菜单」&gt;&gt;&lt;&lt;run
  Dialog.setup(&quot;酒馆商品&quot;);
  Dialog.wiki(Story.get(&quot;兑换&quot;).processText());
  Dialog.open();
&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;br&gt;
[[✧「表演」|地点活动]]&lt;br&gt;
✧「酒馆游戏」 &lt;br&gt;
[[❖「打工」|打工]]  (花费1小时) 

&lt;&lt;else&gt;&gt;【酒馆的门紧闭着, 换个时间再来吧】&lt;&lt;/if&gt;&gt;
&lt;br&gt;&lt;br&gt;
离开
&lt;&lt;link ▷「回到小镇」 小镇&gt;&gt;&lt;&lt;set $npc to 0&gt;&gt;&lt;&lt;/link&gt;&gt;

&lt;center&gt;&lt;div class=&quot;hidden&quot;&gt;Alcohol was the gift of the Deity, just as the Deity had shared it with felins, cats were expected to share it with each other&lt;/div&gt;&lt;/center&gt;</tw-passagedata><tw-passagedata pid="125" name="钓鱼" tags="" position="1000,0" size="100,100">&lt;&lt;if $toolSlot != &quot;鱼竿&quot;&gt;&gt;【你没有装备上合适的钓鱼工具, 去湖边小屋看看吧】
&lt;&lt;link ▷「返回」 $loc&gt;&gt;&lt;&lt;/link&gt;&gt;
&lt;&lt;elseif $HP lt 2&gt;&gt;【你感到些许疲惫, 做事情力不从心. 你最好去吃点东西休息一下, 充足的睡眠没有坏处】
&lt;&lt;link ▷「返回」 $loc&gt;&gt;&lt;&lt;/link&gt;&gt;
&lt;&lt;elseif $item.count(&#39;鱼饵&#39;) &lt;= 0&gt;&gt;【你用完了所有的鱼饵, 去鱼铺看看吧】
&lt;&lt;link ▷「返回」 $loc&gt;&gt;&lt;&lt;/link&gt;&gt;
&lt;&lt;else&gt;&gt;&lt;&lt;set $HP to $HP- 2&gt;&gt;&lt;&lt;drop $item &quot;鱼饵&quot; 1&gt;&gt;&lt;&lt;set _ft to random(1,10)&gt;&gt;【你将钓钩抛进水中, 静静等待着】

&lt;&lt;timed 3s&gt;&gt;@@.[[▷「收杆」|收杆]]@@&lt;&lt;/timed&gt;&gt;
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="126" name="问好" tags="nobr" position="1400,200" size="100,100">&lt;font color=&quot;FFAA00&quot;&gt; Seisinofoaga&lt;/font&gt;:&lt;br&gt;
&lt;&lt;if $dn == 0 &amp;&amp; $hi == 1&gt;&gt;
&lt;&lt;set $hi = 0&gt;&gt;
&lt;&lt;print [&quot;用那种眼神看着我做什么, 快点去睡觉, 这里没有睡前故事&quot;,&quot;我看得出那副表情, 小鬼. 你在想: 白天已经受得够多了, 拜托别让我在梦里也见到老Seisi&quot;,&quot;愿你今夜无梦. 要是见到祂们中的哪位了, 记得别多嘴&quot;,&quot;你在希望我回应你这样的寒暄吗? 真不知道你从哪来的错觉以为我会关心你的事情. 不过要放心, 当你睡觉的时候, 我会继续以超乎你所能想象的高贵和智慧来驾驭存在的复杂性. 如果你能理解这个概念,那就做个好梦吧&quot;,&quot;晚安, 世界终于从你没完没了的闲聊中休息片刻了&quot;,&quot;睡眠, 多么古怪啊. 逃离现实几个小时一定让你心情愉悦. 别担心, 我还会在这里, 好在早上用我超凡的智力来启发你&quot;,&quot;这是给你的一条建议——要大胆做梦, 因为这是你在微不足道的存在中最接近实现任何重大成就的机会&quot;].random()&gt;&gt;
&lt;&lt;elseif $hour &gt;=6 &amp;&amp; $hour &lt;=9&gt;&gt;
&lt;&lt;print [&quot;一早就遇见你这样冒失的家伙, 今天想必不会好到哪儿去&quot;,&quot;如果早晨真的很美好, 我就不必忍受你们这样下等生物平凡的寒暄了&quot;,&quot;我发现早晨被高估了, 就像你在社交礼仪上的尝试一样&quot;,&quot;你说早上好? 比起无意义的礼节, 多关注你的新一天吧, 毕竟没有第二个人会去在意&quot;].random()&gt;&gt;
&lt;&lt;elseif $hour &gt;=12 &amp;&amp; $hour &lt;=14&gt;&gt;
嘘, 安静...你难道不知道现在是规定的午睡时间吗
&lt;&lt;elseif $hour &gt;=21 || $hour ==0&gt;&gt;
&lt;&lt;set _rpl= [&quot;你好, 亲爱的$nn. 我多么希望你的存在不像你的问候这么平凡&quot;,&quot;晚上好, 小毛球. 让我猜猜看, 你今天又过得一事无成&quot;,&quot;哦, $nn, 一天到晚殷殷恳恳地到处给别人问好&quot;,&quot;晚上好, 小鬼. 你的礼貌和你的智力一样微弱. 我想我该感激你用你的平庸来逗我开心&quot;,&quot;无论是早上、中午还是深夜, 你的讨好对我来说都毫无作用&quot;].random()&gt;&gt;_rpl
&lt;&lt;else&gt;&gt;
&lt;&lt;set _rpl= [&quot;你好, 亲爱的$nn. 我多么希望你的存在不像你的问候这么平凡&quot;,&quot;你好? 只有这点廉价还毫无意义的问候? 你们这些家伙连对神最基本的礼节都没了吗?&quot;,&quot;哦, $nn, 一天到晚殷殷恳恳地到处给别人问好&quot;,&quot;早安午安晚安, blahblah, 你们的礼节可真是无趣&quot;,&quot;无论是早上、中午还是深夜, 你的讨好对我来说都毫无作用&quot;].random()&gt;&gt;_rpl
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="127" name="阅读" tags="nobr" position="1000,600" size="100,100">&lt;&lt;do tag &quot;阅读&quot;&gt;&gt;&lt;div id=&quot;textcard&quot;&gt;&lt;br&gt;&lt;&lt;if $choice == &quot;渡鸦之书&quot;&gt;&gt;
&lt;&lt;if $page == 1&gt;&gt;
&lt;center&gt;嘎嘎嘎嘎嘎嘎嘎嘎嘎嘎嘎嘎&lt;br&gt;
嘎嘎嘎嘎嘎嘎嘎嘎嘎嘎嘎嘎嘎嘎嘎嘎嘎嘎嘎嘎嘎嘎嘎嘎嘎嘎嘎嘎嘎嘎&lt;br&gt;
嘎嘎嘎嘎嘎嘎嘎嘎嘎嘎嘎嘎嘎嘎嘎嘎嘎嘎嘎嘎嘎嘎&lt;br&gt;
嘎嘎嘎嘎嘎嘎嘎嘎嘎嘎嘎嘎嘎嘎嘎&lt;/center&gt;
&lt;&lt;elseif $page == 2&gt;&gt;
嘎嘎嘎嘎嘎嘎嘎嘎嘎嘎嘎嘎嘎嘎嘎嘎嘎&lt;br&gt;
嘎嘎嘎嘎嘎嘎嘎嘎嘎嘎嘎嘎嘎嘎嘎嘎嘎嘎嘎嘎嘎嘎嘎嘎嘎嘎嘎嘎嘎嘎嘎嘎嘎嘎嘎嘎嘎嘎嘎嘎&lt;br&gt;
嘎嘎嘎嘎嘎嘎嘎嘎嘎嘎嘎嘎嘎嘎嘎嘎嘎嘎嘎嘎嘎嘎嘎嘎嘎嘎嘎嘎嘎嘎嘎嘎嘎嘎嘎嘎嘎嘎嘎嘎嘎嘎&lt;br&gt;
嘎嘎嘎嘎嘎嘎嘎嘎&lt;br&gt;
嘎嘎嘎嘎嘎嘎嘎嘎嘎嘎嘎嘎嘎嘎嘎嘎嘎嘎嘎嘎嘎嘎&lt;/center&gt;&lt;&lt;set $pageS = &quot;on&quot;&gt;&gt;
&lt;&lt;else&gt;&gt;&lt;&lt;set $pageS = &quot;end&quot;&gt;&gt;&lt;center&gt;嘎嘎嘎嘎嘎&lt;br&gt;
嘎嘎嘎嘎嘎嘎嘎嘎嘎嘎嘎嘎&lt;br&gt;
嘎嘎&lt;/center&gt;
&lt;&lt;/if&gt;&gt;&lt;&lt;/if&gt;&gt;

&lt;&lt;if $choice == &quot;百诗集&quot;&gt;&gt;
&lt;center&gt;&lt;&lt;if $page == 1&gt;&gt;
&lt;h5&gt;第1章&lt;/h5&gt;
幽深夜里，独坐于秘密的书斋&lt;br&gt;黄铜三脚架之上&lt;br&gt;幽暗的火苗微微闪烁&lt;br&gt;难以置信的预言诞生了&lt;br&gt;&lt;br&gt;
将手杖放置于三脚架正中&lt;br&gt;将水泼向皮袍下襟与足面&lt;br&gt;神谕　恐怖&lt;br&gt;令长袍之下的身躯颤栗&lt;br&gt;神圣的光彩中&lt;br&gt;■■与我同在&lt;br&gt;&lt;br&gt;
辇台被旋风吹翻&lt;br&gt;容颜被假面隐藏&lt;br&gt;此时&lt;br&gt;新共和国将使自己的人民苦恼&lt;br&gt;红白颠倒国无宁安&lt;br&gt;&lt;br&gt;
世界将会出现&lt;br&gt;只能品尝到&lt;br&gt;短暂和平的君王&lt;br&gt;教皇之舟必受致命创伤&lt;br&gt;沉没于波涛之中
&lt;&lt;elseif $page == 2&gt;&gt;
他们无情地被驱逐&lt;br&gt;跋涉在无边的沼泽&lt;br&gt;乡村在惨祸中喘息&lt;br&gt;市镇将被卷入更大的战争&lt;br&gt;卡尔卡松与纳尔波鲁&lt;br&gt;你时刻车动着我的心&lt;br&gt;&lt;br&gt;
拉文纳将失去双眼&lt;br&gt;双翼在脚下萎缩之时&lt;br&gt;布雷斯特的三者&lt;br&gt;赋予都灵与维切利的是一具骨骼&lt;br&gt;法兰西将它们统统踩碎&lt;br&gt;&lt;br&gt;
迟到的证据，判决已告完毕&lt;br&gt;风向对他们不利&lt;br&gt;书信途中被劫&lt;br&gt;谋判者为某党十四者&lt;br&gt;经卢梭之手&lt;br&gt;不可告人之阴谋将得以实现&lt;br&gt;&lt;br&gt;
啊，太阳城哟&lt;br&gt;你几度身陷囚笼&lt;br&gt;空洞而野蛮的变法&lt;br&gt;使你走进了黑暗的时代&lt;br&gt;从今你再不是奴隶&lt;br&gt;伟大的亨利你的血管将重新复苏
&lt;&lt;elseif $page == 3&gt;&gt;
来自东洋卡塔戈族的心愿&lt;br&gt;将令阿德利（亨利）与罗慕洛的继承者&lt;br&gt;承受何等的不快&lt;br&gt;与利比亚舰队同行&lt;br&gt;马耳他的寺院与邻近的岛屿一片荒芜&lt;br&gt;&lt;br&gt;
棺木将被安放在铁的灵堂&lt;br&gt;七位王子已在其中聚首&lt;br&gt;代代祖先欲从地狱深处抬起头&lt;br&gt;悲叹如此离去的&lt;br&gt;一族子孙&lt;br&gt;&lt;br&gt;
感觉心足手的一举一动&lt;br&gt;将会与那波利、里昂、西西里保持一致&lt;br&gt;剑、火、洪水；高贵的罗马猫族将会溺死&lt;br&gt;被杀死还是自然死，一切皆因愚蠢所致&lt;br&gt;&lt;br&gt;
猫们将会谈论一位不可信赖的公猫&lt;br&gt;他从卑微之职陡然平步青云&lt;br&gt;他将成为短命的统治者&lt;br&gt;更将成为见异思迁的叛逆&lt;br&gt;维罗纳哟&lt;br&gt;此猫必将成为你的主宰
&lt;&lt;set $pageS = &quot;on&quot;&gt;&gt;
&lt;&lt;else&gt;&gt;&lt;&lt;set $pageS = &quot;end&quot;&gt;&gt;
满腔怒恨与憎恶&lt;br&gt;驱使亡命者酿成阴谋&lt;br&gt;国王危在旦夕&lt;br&gt;朝臣忠贞不屈&lt;br&gt;谋反必将被察觉&lt;br&gt;&lt;br&gt;
受奴役者放声歌唱&lt;br&gt;怒吼出苦难的心声&lt;br&gt;王侯贵族被投入牢狱&lt;br&gt;无头的狂徒&lt;br&gt;祈祷吧，未日即将到来&lt;br&gt;&lt;br&gt;&lt;br&gt;流血将达七十回&lt;br&gt;圣职在受到崇敬的同时&lt;br&gt;更多的是遭受诽谤与抵赖&lt;br&gt;在那些人的心目之中&lt;br&gt;信仰已不值一提&lt;br&gt;&lt;br&gt;
大镰出现在最高的星位&lt;br&gt;连接到射手座上&lt;br&gt;从军队手里播下　恶疫、饥荒、死亡&lt;br&gt;已经接近了世纪的再生
&lt;&lt;/if&gt;&gt;&lt;/center&gt;&lt;&lt;/if&gt;&gt;
&lt;br&gt;&lt;/div&gt;
&lt;br&gt;&lt;br&gt;
&lt;div class=&quot;page&quot;&gt;
&lt;span&gt;&lt;&lt;if $page&gt;1&gt;&gt;&lt;&lt;button &#39;&lt;i class=&quot;fa-solid fa-arrow-left fa-xl&quot;&gt;&lt;/i&gt;&#39;&gt;&gt;&lt;&lt;set $page-=1&gt;&gt;&lt;&lt;redo &quot;阅读&quot;&gt;&gt;&lt;&lt;/button&gt;&gt;&lt;&lt;/if&gt;&gt;&lt;/span&gt;
&lt;span&gt;✧✦$page✦✧&lt;/span&gt;
&lt;span&gt;&lt;&lt;if $pageS !=&quot;end&quot;&gt;&gt;&lt;&lt;button &#39;&lt;i class=&quot;fa-solid fa-arrow-right fa-xl&quot;&gt;&lt;/i&gt;&#39;&gt;&gt;&lt;&lt;set $page+=1&gt;&gt;&lt;&lt;redo &quot;阅读&quot;&gt;&gt;&lt;&lt;/button&gt;&gt;&lt;&lt;/if&gt;&gt;&lt;/span&gt;
&lt;/div&gt;&lt;&lt;/do&gt;&gt;</tw-passagedata><tw-passagedata pid="128" name="随便逛逛" tags="nobr" position="1100,500" size="100,100">&lt;&lt;set _s to random(1,100)&gt;&gt;
&lt;&lt;if $loc == &quot;小镇&quot;&gt;&gt;
&lt;&lt;if _s &lt;= 26 &amp;&amp; $spaloc == &quot;小镇&quot;&gt;&gt;
【你在小镇上漫无目的的闲逛着, 一位坐在长椅上晒太阳的老猫出现在你的视野里, 她手握着一支破旧的羽毛笔, 在一本厚重的抄写本上缓缓书写着. 那是萨巴夫人, 一位精于种植、热爱诗歌的女士, 如果你有合适的诗集, 可以跟她换些种子】&lt;br&gt;&lt;br&gt;
&lt;&lt;link&quot; ✣「NPC 萨巴夫人」 &quot; &quot;小镇&quot;&gt;&gt;&lt;&lt;set $loct = $loc, $npc to &quot;萨巴&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;br&gt;

&lt;&lt;elseif _s &lt;= 16&gt;&gt;【遭遇醉汉/饥饿的猫】

&lt;&lt;elseif $hour &gt; 5 &amp;&amp; $hour &lt; 23&gt;&gt;
&lt;&lt;if $social&lt;=5&gt;&gt;&lt;&lt;lockedhouse&gt;&gt;
&lt;&lt;elseif $social&lt;=15 &amp;&amp; _s &lt;= 90&gt;&gt;&lt;&lt;lockedhouse&gt;&gt;
&lt;&lt;elseif $social&lt;=25 &amp;&amp; _s &lt;= 80&gt;&gt;&lt;&lt;lockedhouse&gt;&gt;
&lt;&lt;elseif $social&lt;=35 &amp;&amp; _s &lt;= 70&gt;&gt;&lt;&lt;lockedhouse&gt;&gt;
&lt;&lt;else&gt;&gt;【居民家门口开着】
&lt;&lt;/if&gt;&gt;

&lt;&lt;elseif _s &lt;= 45&gt;&gt;&lt;&lt;lockedhouse&gt;&gt;

&lt;&lt;elseif _s &lt;= 52&gt;&gt;【医院上锁】&lt;br&gt;&lt;br&gt;&lt;&lt;link ✧「撬锁」 偷窃&gt;&gt;&lt;&lt;set $choice to &quot;撬锁&quot;, $stoleloc = &quot;医院&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;br&gt;
&lt;&lt;link ▷「离开」 小镇&gt;&gt;&lt;&lt;/link&gt;&gt;
&lt;&lt;elseif _s &lt;= 57&gt;&gt;【酒馆上锁】&lt;br&gt;&lt;br&gt;&lt;&lt;link ✧「撬锁」 偷窃&gt;&gt;&lt;&lt;set $choice to &quot;撬锁&quot;, $stoleloc = &quot;酒馆&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;br&gt;
&lt;&lt;link ▷「离开」 小镇&gt;&gt;&lt;&lt;/link&gt;&gt;
&lt;&lt;elseif _s &lt;= 66&gt;&gt;【咖啡馆上锁】&lt;br&gt;&lt;br&gt;&lt;&lt;link ✧「撬锁」 偷窃&gt;&gt;&lt;&lt;set $choice to &quot;撬锁&quot;, $stoleloc = &quot;咖啡馆&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;br&gt;
&lt;&lt;link ▷「离开」 小镇&gt;&gt;&lt;&lt;/link&gt;&gt;
&lt;&lt;elseif _s &lt;= 74&gt;&gt;【工坊上锁】&lt;br&gt;&lt;br&gt;&lt;&lt;link ✧「撬锁」 偷窃&gt;&gt;&lt;&lt;set $choice to &quot;撬锁&quot;, $stoleloc = &quot;工坊&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;br&gt;
&lt;&lt;link ▷「离开」 小镇&gt;&gt;&lt;&lt;/link&gt;&gt;
&lt;&lt;elseif _s &lt;= 82&gt;&gt;【泡泡布提上锁】&lt;br&gt;&lt;br&gt;&lt;&lt;link ✧「撬锁」 偷窃&gt;&gt;&lt;&lt;set $choice to &quot;撬锁&quot;, $stoleloc = &quot;泡泡布提&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;br&gt;
&lt;&lt;link ▷「离开」 小镇&gt;&gt;&lt;&lt;/link&gt;&gt;

&lt;&lt;else&gt;&gt;&lt;&lt;goto &quot;天上人间&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;


&lt;&lt;/if&gt;&gt;
&lt;br&gt;&lt;br&gt;&lt;&lt;link ▷「离开」 小镇&gt;&gt;&lt;&lt;/link&gt;&gt;</tw-passagedata><tw-passagedata pid="129" name="随机设定" tags="" position="2125,100" size="100,100">姓名：&lt;&lt;print [&quot;Ann&quot;,&quot;Alice&quot;,&quot;Ada&quot;,&quot;Amy&quot;,&quot;Ivy&quot;,&quot;Gladys&quot;,&quot;Gloria&quot;,&quot;Belinda&quot;,&quot;Breeda&quot;,&quot;Florence&quot;,&quot;Griselda&quot;,&quot;Jennifer&quot;,&quot;Lorraine&quot;,&quot;Anastasia&quot;,&quot;Annabelle&quot;,&quot;Catherine&quot;,&quot;Charlotte&quot;,&quot;Christine&quot;,&quot;Constance&quot;,&quot;Elizabeth&quot;,&quot;Frederica&quot;,&quot;Gabrielle&quot;,&quot;Genevieve&quot;,&quot;Geraldine&quot;,&quot;Gwendolyn&quot;,&quot;Josephine&quot;,&quot;Katherine&quot;,&quot;Kimberley&quot;,&quot;Eleanore&quot;,&quot;Georgia&quot;,&quot;Giselle&quot;,&quot;Gustave&quot;,&quot;Harriet&quot;,&quot;Heather&quot;,&quot;Heloise&quot;,&quot;Hermosa&quot;,&quot;Jessica&quot;,&quot;Jocelyn&quot;,&quot;Kristin&quot;,&quot;Letitia&quot;,&quot;Lillian&quot;,&quot;Lindsay&quot;,&quot;Adelaide&quot;,&quot;Atalanta&quot;,&quot;Beatrice&quot;,&quot;Candance&quot;,&quot;Caroline&quot;,&quot;Cornelia&quot;,&quot;June&quot;,&quot;Kama&quot;,&quot;Lena&quot;,&quot;Lisa&quot;,&quot;Lucy&quot;,&quot;Lynn&quot;,&quot;Adela&quot;,&quot;Agnes&quot;,&quot;Alice&quot;,&quot;April&quot;,&quot;Bella&quot;,&quot;Belle&quot;,&quot;Beryl&quot;,&quot;Betsy&quot;,&quot;Betty&quot;,&quot;Brook&quot;,&quot;Carol&quot;,&quot;Cathy&quot;,&quot;Chloe&quot;,&quot;Clark&quot;,&quot;Aaron&quot;,&quot;Abbott&quot;,&quot;Ivan&quot;,&quot;Ives&quot;,&quot;Hayden&quot;,&quot;Heater&quot;,&quot;Henry&quot;,&quot;Herbert&quot;,&quot;Herman&quot;,&quot;Hilary&quot;,&quot;Hiram&quot;,&quot;Hobart&quot;,&quot;Hogan&quot;,&quot;Horace&quot;,&quot;Howar&quot;,&quot;Hubery&quot;,&quot;Hugh&quot;,&quot;Hugo&quot;,&quot;Humphrey&quot;,&quot;Hunter&quot;,&quot;Hyman&quot;,&quot;Ian&quot;,&quot;Nat&quot;,&quot;Nathan&quot;,&quot;Nathaniel&quot;,&quot;Neil&quot;,&quot;Nelson&quot;,&quot;Newman&quot;,&quot;Newt&quot;,&quot;Nicholas&quot;,&quot;Nick&quot;,&quot;Nigel&quot;,&quot;Noah&quot;,&quot;Noel&quot;,&quot;Norman&quot;,&quot;Norton&quot;,&quot;Ogden&quot;,&quot;Oliver&quot;,&quot;Omar&quot;,&quot;Orville&quot;,&quot;Osborn&quot;,&quot;Oscar&quot;,&quot;Osmond&quot;,&quot;Oswald&quot;,&quot;Otis&quot;,&quot;Otto&quot;,&quot;Owen&quot;].random()&gt;&gt; &lt;&lt;print [&quot;Smith&quot;,&quot;Brown&quot;,&quot;White&quot;,&quot;Anderson&quot;,&quot;Harris&quot;,&quot;Moore&quot;,&quot;Wilson&quot;,&quot;Parker&quot;,&quot;Evans&quot;,&quot;Edwards&quot;,&quot;Collins&quot;,&quot;Stewart&quot;,&quot;Sanchez&quot;,&quot;Morris&quot;,&quot;Rogers&quot;,&quot;Reed&quot;,&quot;Finch&quot;,&quot;Cook&quot;,&quot;Morgan&quot;,&quot;Bell&quot;,&quot;Murphy&quot;,&quot;Cox&quot;,&quot;Howard&quot;,&quot;Ward&quot;,&quot;Torres&quot;,&quot;Peterson&quot;,&quot;Gray&quot;,&quot;Ramirez&quot;,&quot;James&quot;,&quot;Watson&quot;,&quot;Brooks&quot;,&quot;Kelly&quot;,&quot;Sanders&quot;,&quot;Price&quot;,&quot;Bennett&quot;,&quot;Wood&quot;,&quot;Barnes&quot;,&quot;Ross&quot;,&quot;Henderson&quot;,&quot;Coleman&quot;,&quot;Jenkins&quot;,&quot;Perry&quot;,&quot;Roux&quot;,&quot;Lopez&quot;,&quot;Vincent&quot;,&quot;Fontaine&quot;,&quot;Fournier&quot;,&quot;Chevalier&quot;,&quot;Morel&quot;,&quot;Girard&quot;,&quot;Robin&quot;,&quot;Andre&quot;,&quot;Masson&quot;,&quot;Lefevre&quot;,&quot;Mercier&quot;,&quot;Gerard&quot;,&quot;Dupont&quot;,&quot;Nguyen&quot;,&quot;Leroy&quot;,&quot;Roussel&quot;,&quot;Moreau&quot;,&quot;Nicolas&quot;,&quot;Laurent&quot;,&quot;Perrin&quot;,&quot;Lefebvre&quot;,&quot;Morin&quot;,&quot;Michel&quot;,&quot;Mathieu&quot;,&quot;Garcia&quot;,&quot;Clement&quot;,&quot;David&quot;,&quot;Gauthier&quot;,&quot;Bertrand&quot;,&quot;Dumont&quot;,&quot;Martin&quot;,&quot;Moreau&quot;,&quot;Menard&quot;,&quot;Terrien&quot;,&quot;ALLARD&quot;].random()&gt;&gt;
性别：&lt;&lt;print [&quot;男&quot;,&quot;女&quot;].random()&gt;&gt;
出生日期: &lt;&lt;print random(1,12)&gt;&gt;-&lt;&lt;print random(1,31)&gt;&gt;-&lt;&lt;print random(1970,2003)&gt;&gt;
血统: &lt;&lt;print [&quot;英短&quot;,&quot;暹罗&quot;,&quot;波斯&quot;,&quot;金吉拉&quot;,&quot;俄蓝&quot;,&quot;安哥拉&quot;,&quot;哈瓦那&quot;,&quot;挪威森林&quot;,&quot;缅因&quot;,&quot;东短&quot;,&quot;埃及&quot;,&quot;缅因&quot;,&quot;奥西&quot;,&quot;巴厘&quot;,&quot;短尾&quot;,&quot;无尾&quot;,&quot;东奇尼&quot;,&quot;阿比西尼亚&quot;,&quot;索马里&quot;,&quot;德文卷毛&quot;,&quot;孟买&quot;,&quot;布偶&quot;,&quot;卷耳&quot;,&quot;伯曼&quot;,&quot;波米拉&quot;].randomMany(4)&gt;&gt;
样貌: &lt;&lt;print [&quot;丑陋&quot;,&quot;五官端正&quot;,&quot;万里挑一&quot;,&quot;五官端正&quot;,&quot;出众&quot;,&quot;平平&quot;,&quot;五官端正&quot;,&quot;平平&quot;,&quot;毁容&quot;].random()&gt;&gt;
体型: &lt;&lt;print [&quot;丰满&quot;,&quot;微胖&quot;,&quot;强壮&quot;,&quot;适中&quot;,&quot;健美&quot;,&quot;偏瘦&quot;,&quot;苗条&quot;,&quot;消瘦&quot;,&quot;残疾&quot;].random()&gt;&gt;
发型: &lt;&lt;print [&quot;长头毛&quot;,&quot;长发&quot;,&quot;短发&quot;,&quot;短头毛&quot;].random()&gt;&gt;
身高: &lt;&lt;print random(135,190)&gt;&gt;
国籍: &lt;&lt;print [&quot;英国&quot;,&quot;法国&quot;,&quot;德国&quot;,&quot;俄国&quot;,&quot;比利时&quot;,&quot;西班牙&quot;,&quot;葡萄牙&quot;,&quot;美国&quot;,&quot;奥匈帝国&quot;,&quot;瑞士&quot;,&quot;意大利&quot;,&quot;希腊&quot;,&quot;荷兰&quot;,&quot;挪威&quot;,&quot;丹麦&quot;,&quot;瑞典&quot;,&quot;塞尔维亚&quot;,&quot;罗马尼亚&quot;,&quot;波兹南公国&quot;,&quot;克拉科夫共和国&quot;,&quot;加拿大&quot;].random()&gt;&gt;
家庭背景: &lt;&lt;print [&quot;父亲去世&quot;,&quot;父亲战死&quot;,&quot;父亲得病而死&quot;,&quot;母亲杀了父亲&quot;,&quot;父亲健在&quot;,&quot;父母离婚&quot;,&quot;父亲抛弃家庭&quot;,&quot;父母关系和睦&quot;,&quot;父亲在监狱&quot;,&quot;父亲无业&quot;,&quot;父亲贵族&quot;,&quot;父亲富有&quot;,&quot;父亲高官&quot;,&quot;父亲开店&quot;,&quot;父亲黑帮&quot;,&quot;父亲政客&quot;,&quot;父亲从军&quot;,&quot;父亲镇长&quot;,&quot;父亲不明&quot;].random()&gt;&gt;, &lt;&lt;print [&quot;母亲得病而死&quot;,&quot;父亲杀了母亲&quot;,&quot;母亲健在&quot;,&quot;母亲去世&quot;,&quot;母亲抛弃家庭&quot;,&quot;母亲在监狱&quot;,&quot;母亲无业&quot;,&quot;母亲贵族&quot;,&quot;母亲富有&quot;,&quot;母亲开店&quot;,&quot;母亲名媛&quot;,&quot;母亲黑帮&quot;,&quot;母亲医生&quot;,&quot;母亲家庭主妇&quot;,&quot;母亲不明&quot;].random()&gt;&gt;, &lt;&lt;print [&quot;独生子&quot;,&quot;弃子&quot;,&quot;一个姐姐&quot;,&quot;两个姐姐&quot;,&quot;三个姐姐&quot;,&quot;一个哥哥&quot;,&quot;两个哥哥&quot;,&quot;三个哥哥&quot;,&quot;一个妹妹&quot;,&quot;两个妹妹&quot;,&quot;三个妹妹&quot;,&quot;一个弟弟&quot;,&quot;两个弟弟&quot;,&quot;三个弟弟&quot;,&quot;一个姐姐两个哥哥&quot;,&quot;一个姐姐两个妹妹&quot;,&quot;一个姐姐两个弟弟&quot;,&quot;一个姐姐一个哥哥&quot;,&quot;一个姐姐一个妹妹&quot;,&quot;一个姐姐一个弟弟&quot;,&quot;一个哥哥两个姐姐&quot;,&quot;一个哥哥一个姐姐&quot;,&quot;一个哥哥一个妹妹&quot;,&quot;一个哥哥一个弟弟&quot;,&quot;一个哥哥两个妹妹&quot;,&quot;一个哥哥两个弟弟&quot;,&quot;一个妹妹两个哥哥&quot;,&quot;一个妹妹一个弟弟&quot;,&quot;一个妹妹两个姐姐&quot;,&quot;一个弟弟两个姐姐&quot;,&quot;一个弟弟两个哥哥&quot;].random()&gt;&gt;
财力: &lt;&lt;print [&quot;贫困潦倒&quot;,&quot;勉强度日&quot;,&quot;正常生活&quot;,&quot;足够娱乐&quot;,&quot;储蓄很多&quot;,&quot;收支相抵&quot;,&quot;中产&quot;,&quot;富可敌国&quot;,&quot;家产丰厚&quot;,&quot;小本生意&quot;,&quot;大型商业&quot;].random()&gt;&gt;
生活环境: &lt;&lt;print [&quot;友善&quot;,&quot;恶劣&quot;,&quot;幸福&quot;,&quot;一般&quot;,&quot;艰巨&quot;].random()&gt;&gt;
受教育程度: &lt;&lt;print [&quot;小学&quot;,&quot;初中&quot;,&quot;自学&quot;,&quot;家教&quot;,&quot;大学&quot;,&quot;高中&quot;,&quot;识字&quot;,&quot;母语&quot;,&quot;双语&quot;,&quot;三语&quot;].random()&gt;&gt;
擅长: &lt;&lt;print [&quot;驾车&quot;,&quot;机械&quot;,&quot;开船&quot;,&quot;骑术&quot;,&quot;长跑&quot;,&quot;枪械&quot;,&quot;野外生存&quot;,&quot;游泳&quot;,&quot;潜水&quot;,&quot;药学&quot;,&quot;医术&quot;,&quot;肉搏&quot;,&quot;唱歌&quot;,&quot;逢场作戏&quot;,&quot;作曲&quot;,&quot;作画&quot;,&quot;写作&quot;,&quot;烹饪&quot;,&quot;经济学&quot;,&quot;经销&quot;,&quot;小偷小摸&quot;,&quot;说谎&quot;,&quot;交友&quot;,&quot;打猎&quot;,&quot;钓鱼&quot;,&quot;笼络人心&quot;,&quot;领导管理&quot;,&quot;摄影&quot;,&quot;化妆&quot;,&quot;共情&quot;,&quot;历史&quot;,&quot;语言&quot;,&quot;话术&quot;,&quot;法学&quot;,&quot;地质学&quot;,&quot;化学&quot;,&quot;天文学&quot;,&quot;航海术&quot;,&quot;数学&quot;,&quot;物理学&quot;,&quot;符号学&quot;,&quot;植物学&quot;,&quot;动物学&quot;,&quot;生物学&quot;,&quot;气象学&quot;,&quot;弓箭&quot;,&quot;剑&quot;,&quot;政治&quot;,&quot;攀岩&quot;,&quot;考古学&quot;,&quot;钢琴&quot;,&quot;小提琴&quot;,&quot;吉他&quot;,&quot;足球&quot;,&quot;棒球&quot;,&quot;橄榄球&quot;,&quot;照顾他人&quot;,&quot;缝纫&quot;,&quot;栽培植物&quot;,&quot;饲养动物&quot;,&quot;扑克&quot;,&quot;教学&quot;,&quot;舞蹈&quot;,&quot;口技&quot;,&quot;做爱&quot;].randomMany(4)&gt;&gt;
不擅长: &lt;&lt;print [&quot;驾车&quot;,&quot;机械&quot;,&quot;开船&quot;,&quot;骑术&quot;,&quot;长跑&quot;,&quot;枪械&quot;,&quot;野外生存&quot;,&quot;游泳&quot;,&quot;潜水&quot;,&quot;药学&quot;,&quot;医术&quot;,&quot;肉搏&quot;,&quot;唱歌&quot;,&quot;逢场作戏&quot;,&quot;作曲&quot;,&quot;作画&quot;,&quot;写作&quot;,&quot;烹饪&quot;,&quot;经济学&quot;,&quot;经销&quot;,&quot;小偷小摸&quot;,&quot;说谎&quot;,&quot;交友&quot;,&quot;打猎&quot;,&quot;钓鱼&quot;,&quot;笼络人心&quot;,&quot;领导管理&quot;,&quot;摄影&quot;,&quot;化妆&quot;,&quot;共情&quot;,&quot;历史&quot;,&quot;语言&quot;,&quot;话术&quot;,&quot;法学&quot;,&quot;地质学&quot;,&quot;化学&quot;,&quot;天文学&quot;,&quot;航海术&quot;,&quot;数学&quot;,&quot;物理学&quot;,&quot;符号学&quot;,&quot;植物学&quot;,&quot;动物学&quot;,&quot;生物学&quot;,&quot;气象学&quot;,&quot;弓箭&quot;,&quot;剑&quot;,&quot;政治&quot;,&quot;攀岩&quot;,&quot;考古学&quot;,&quot;钢琴&quot;,&quot;小提琴&quot;,&quot;吉他&quot;,&quot;足球&quot;,&quot;棒球&quot;,&quot;橄榄球&quot;,&quot;照顾他人&quot;,&quot;缝纫&quot;,&quot;栽培植物&quot;,&quot;饲养动物&quot;,&quot;扑克&quot;,&quot;教学&quot;,&quot;舞蹈&quot;,&quot;口技&quot;,&quot;做爱&quot;].randomMany(3)&gt;&gt;
随身物品: &lt;&lt;print [&quot;手杖&quot;,&quot;书本&quot;,&quot;武器&quot;,&quot;乐器&quot;,&quot;食物&quot;,&quot;动物&quot;,&quot;植物&quot;,&quot;怀表&quot;,&quot;背包&quot;,&quot;运动器材&quot;,&quot;雨伞&quot;,&quot;酒瓶&quot;,&quot;衣服&quot;,&quot;无&quot;,&quot;无&quot;,&quot;魔法天赋&quot;,&quot;香烟&quot;,&quot;扑克&quot;,&quot;望远镜&quot;,&quot;茶杯&quot;,&quot;武器&quot;,&quot;食物&quot;,&quot;宗教物品&quot;,&quot;职业用品&quot;,&quot;项链&quot;,&quot;帽子&quot;,&quot;报纸&quot;,&quot;手环&quot;,&quot;戒指&quot;,&quot;厨具&quot;,&quot;照明用具&quot;,&quot;眼镜&quot;,&quot;文具&quot;,&quot;绷带&quot;,&quot;眼罩&quot;,&quot;围巾&quot;,&quot;棋子&quot;,&quot;画具&quot;,&quot;水果&quot;].randomMany(5)&gt;&gt;
特质: &lt;&lt;print [&quot;有才华&quot;,&quot;主动&quot;,&quot;适应能力强&quot;,&quot;机敏&quot;,&quot;有野心&quot;,&quot;有进取心&quot;,&quot;友善&quot;,&quot;理解能力强&quot;,&quot;擅长逻辑思维&quot;,&quot;冒险精神&quot;,&quot;做事细致&quot;,&quot;强正义感&quot;,&quot;善解人意&quot;,&quot;有领导力&quot;,&quot;自信&quot;,&quot;自律&quot;,&quot;体贴&quot;,&quot;容易陷入沉思&quot;,&quot;随遇而安&quot;,&quot;沉稳&quot;,&quot;意志坚定&quot;,&quot;负责可靠&quot;,&quot;坚韧&quot;,&quot;小心谨慎&quot;,&quot;喜爱整洁&quot;,&quot;好奇心充沛&quot;,&quot;颠覆传统&quot;,&quot;想象力丰富&quot;,&quot;独立&quot;,&quot;乐于尝试新鲜事物&quot;,&quot;容易情绪化&quot;,&quot;情绪稳定&quot;,&quot;善于交际&quot;,&quot;容易相处&quot;,&quot;多变&quot;,&quot;忠诚&quot;,&quot;直率&quot;,&quot;俭朴&quot;,&quot;有教养&quot;,&quot;精力充沛&quot;,&quot;幽默&quot;,&quot;公平公正&quot;,&quot;有主见&quot;,&quot;奉献精神&quot;,&quot;办事高效&quot;,&quot;老谋深算&quot;,&quot;客观&quot;,&quot;感性&quot;,&quot;谦虚&quot;,&quot;逃避责任&quot;,&quot;控制欲强&quot;,&quot;猜忌多疑&quot;,&quot;难以相处&quot;,&quot;偏执&quot;,&quot;退缩&quot;,&quot;谎话连篇&quot;,&quot;道德高尚&quot;,&quot;强欲&quot;,&quot;强保护欲&quot;,&quot;务实实干&quot;,&quot;逆来顺受&quot;,&quot;冷漠&quot;,&quot;脾气暴躁&quot;,&quot;见利忘义&quot;,&quot;对他人严格&quot;,&quot;多愁善感&quot;,&quot;悲观主义&quot;,&quot;幼稚天真&quot;,&quot;胆小&quot;,&quot;循规蹈矩&quot;,&quot;莽撞冲动&quot;,&quot;轻率&quot;,&quot;犹豫不决&quot;,&quot;洞察力强&quot;,&quot;自以为是&quot;,&quot;优柔寡断&quot;,&quot;贪财&quot;,&quot;吹毛求疵&quot;,&quot;慷慨&quot;,&quot;安全感低&quot;,&quot;易怒&quot;,&quot;蛮横无理&quot;,&quot;教条死板&quot;,&quot;利己&quot;,&quot;利他&quot;,&quot;虚伪做作&quot;,&quot;纨绔&quot;,&quot;轻浮&quot;,&quot;迟钝&quot;,&quot;圆滑世故&quot;,&quot;平淡&quot;,&quot;意志薄弱&quot;,&quot;盲目无主见&quot;,&quot;幸运&quot;].randomMany(4)&gt;&gt;
动机: &lt;&lt;print [&quot;环境-生存&quot;,&quot;野心-权力/社会地位&quot;,&quot;财富&quot;,&quot;外界-复仇&quot;,&quot;外界-报恩/还债&quot;,&quot;自身-人际关系(爱情/朋友/家人)&quot;,&quot;自身-责任/道义&quot;,&quot;自身-求知心&quot;,&quot;自身-自由/自我救赎&quot;,&quot;自身-恐惧/逃避&quot;,&quot;自身-理念(梦想/信仰/仇恨)&quot;].randomMany(2)&gt;&gt;
行为倾向: &lt;&lt;print [&quot;拯救他人&quot;,&quot;实现自身道义&quot;,&quot;自私利己&quot;,&quot;自我毁灭&quot;,&quot;求知&quot;,&quot;破坏外界&quot;,&quot;随心所欲&quot;,&quot;恪守秩序&quot;,&quot;追求理想&quot;,&quot;优柔寡断&quot;].random()&gt;&gt;
面部特征: &lt;&lt;print [&quot;咬脸颊内侧&quot;,&quot;咬下唇&quot;,&quot;咬紧牙关&quot;,&quot;卷起嘴唇&quot;,&quot;鼻孔张开&quot;,&quot;睫毛颤动&quot;,&quot;皱眉&quot;,&quot;扮鬼脸&quot;,&quot;舔嘴唇&quot;,&quot;撅嘴&quot;,&quot;紧闭双唇&quot;,&quot;鼓起双颊&quot;,&quot;下巴颤抖&quot;,&quot;扬起一边眉毛&quot;,&quot;皱鼻子&quot;,&quot;微笑&quot;,&quot;闭嘴微笑&quot;,&quot;只用一侧嘴角微笑&quot;,&quot;傻笑&quot;,&quot;咆哮&quot;,&quot;伸出舌头&quot;,&quot;吮吸牙齿&quot;,&quot;出汗过多&quot;,&quot;嘴角露出&quot;,&quot;收紧下巴&quot;].randomMany(2)&gt;&gt;
眼部特征: &lt;&lt;print [&quot;避免目光接触&quot;,&quot;有节奏地眨眼&quot;,&quot;缓慢眨眼&quot;,&quot;斜眼望去&quot;,&quot;翻白眼&quot;,&quot;上下扫视&quot;,&quot;专注于一点&quot;,&quot;凝视远方&quot;,&quot;眼神呆滞&quot;,&quot;半闭双眼&quot;,&quot;说话时低头&quot;,&quot;思考时抬头&quot;,&quot;眯起眼睛&quot;,&quot;透过眼镜凝视&quot;,&quot;快速眨眼&quot;].randomMany(2)&gt;&gt;
头部动作特征: &lt;&lt;print [&quot;摇头晃脑 &quot;,&quot;咀嚼头发&quot;,&quot;歪头&quot;,&quot;遮住耳朵&quot;,&quot;用手托住下巴&quot;,&quot;拽耳朵&quot;,&quot;捋顺头发&quot;,&quot;点头&quot;,&quot;玩头发&quot;,&quot;整理头发&quot;,&quot;摩擦发际线&quot;,&quot;抓下巴&quot;,&quot;挠头&quot;,&quot;抚摸下巴或胡须&quot;,&quot;歪头&quot;,&quot;抚摸头发&quot;,&quot;猛地转过头&quot;,&quot;擦拭额头&quot;].randomMany(2)&gt;&gt;
手部动作特征: &lt;&lt;print [&quot;咬指甲&quot;,&quot;双手在背后紧握&quot;,&quot;双手紧握&quot;,&quot;握紧拳头&quot;,&quot;用手捂住嘴&quot;,&quot;掰指关节&quot;,&quot;交叉双臂&quot;,&quot;用手指敲击表面&quot;,&quot;摆弄双手&quot;,&quot;双手交叉放在膝盖上&quot;,&quot;说话时做手势&quot;,&quot;抓毛发&quot;,&quot;将手放在胸前&quot;,&quot;双手放在臀部&quot;,&quot;用食指指向&quot;,&quot;搓搓双手&quot;,&quot;耸耸肩膀&quot;,&quot;打响指&quot;,&quot;轻蔑地挥手&quot;,&quot;双手放在腿上&quot;,&quot;摆弄附近的物体&quot;,&quot;调整或推高眼镜&quot;,&quot;弯曲回形针&quot;,&quot;扣上和解开外套&quot;,&quot;沉迷于查看信件&quot;,&quot;反复检查手表&quot;,&quot;咬钢笔或铅笔的尖&quot;,&quot;单击或点击钢笔或铅笔&quot;,&quot;心不在焉地涂鸦&quot;,&quot;摆弄耳环&quot;,&quot;摆弄纸张或文件&quot;,&quot;撕纸&quot;,&quot;摘下眼镜并清洁&quot;,&quot;撕餐巾&quot;,&quot;拉扯衣服&quot;,&quot;旋转或敲击硬币&quot;,&quot;转动戒指或手表&quot;].randomMany(4)&gt;&gt;
姿势特征: &lt;&lt;print [&quot;拱起背部&quot;,&quot;翘二郎腿&quot;,&quot;抱住自己&quot;,&quot;耸肩&quot;,&quot;靠在墙上&quot;,&quot;身体前倾&quot;,&quot;躺着思考&quot;,&quot;双手插进口袋&quot;,&quot;挺起胸膛&quot;,&quot;将脚放在凸起的表面上&quot;,&quot;将肘部放在表面上&quot;,&quot;双手抱头&quot;,&quot;单腿支撑身体重量&quot;,&quot;坐在椅子边上&quot;,&quot;双腿张开坐姿&quot;,&quot;动作懒散&quot;,&quot;站得笔直&quot;,&quot;僵硬的姿势&quot;,&quot;弯腰或蹲下&quot;,&quot;收腹&quot;,&quot;左右摇摆&quot;,&quot;把下巴缩进胸口&quot;,&quot;畏缩&quot;].randomMany(2)&gt;&gt;
步态特征: &lt;&lt;print [&quot;蹦蹦跳跳&quot;,&quot;拖着一只脚&quot;,&quot;平稳地滑行或漂浮&quot;,&quot;走路时身体倾斜或倾斜&quot;,&quot;跛行&quot;,&quot;来回踱步&quot;,&quot;快速或匆忙行走&quot;,&quot;用脚跟前后摇摆&quot;,&quot;行走时双手在墙面上滑行&quot;,&quot;步伐缓慢或拖沓&quot;,&quot;走路时驼背或弯腰驼背&quot;,&quot;自信迈步&quot;,&quot;走路时臀部摆动&quot;,&quot;小而快的步伐&quot;].random()&gt;&gt;
个人空间偏好: &lt;&lt;print [&quot;避免身体接触&quot;,&quot;远离他人&quot;,&quot;握紧拳头或绷紧肌肉&quot;,&quot;不断调整位置&quot;,&quot;说话时背对着别人&quot;,&quot;拥抱作为问候&quot;,&quot;侵犯他人的个人空间&quot;,&quot;保持较远距离&quot;,&quot;说话时身体前倾或后倾&quot;,&quot;靠近出口或入口&quot;,&quot;交谈时频繁触碰他人&quot;,&quot;坐在桌子的首位&quot;,&quot;坐在角落或靠墙&quot;,&quot;坐着或站着时与他人之间要有屏障&quot;,&quot;双臂交叉或双手放在臀部站立以占据空间&quot;].random()&gt;&gt;
声音特征: &lt;&lt;print [&quot;无聊或冷漠的语气&quot;,&quot;气息嘶哑或沙哑的声音&quot;,&quot;命令或权威的语气&quot;,&quot;说话清晰、吐词准确&quot;,&quot;富有表现力和活力的语调&quot;,&quot;平淡无情的语气&quot;,&quot;粗哑或沙哑的声音&quot;,&quot;尖锐或刺耳的声音&quot;,&quot;低沉的声音&quot;,&quot;旋律优美或歌唱般的声音&quot;,&quot;鼻音&quot;,&quot;快速或狂躁的语调&quot;,&quot;嘶哑的声音&quot;,&quot;讽刺或嘲弄的语气&quot;,&quot;柔和或温和的语调&quot;,&quot;单调的语气&quot;,&quot;说话声音颤抖&quot;,&quot;威胁或威胁的语气&quot;,&quot;使用简短或简短的语气&quot;,&quot;在句末使用向上的语调&quot;,&quot;哀怨的声音&quot;].random()&gt;&gt;
音量特征: &lt;&lt;print [&quot;与环境匹配的音量&quot;,&quot;喃喃自语&quot;,&quot;演讲式&quot;,&quot;兴奋或愤怒时提高声音&quot;,&quot;大喊或大叫&quot;,&quot;保持音量一致&quot;,&quot;用柔和或安静的声音说话&quot;,&quot;改变音量以强调&quot;,&quot;低声耳语或说话&quot;].random()&gt;&gt;
语速特征: &lt;&lt;print [&quot;强调某些单词&quot;,&quot;经常停顿或说话犹豫&quot;,&quot;重复单词或短语&quot;,&quot;以刻意或有节奏的语速讲话、吐词准确&quot;,&quot;以流畅或优美的节奏讲话&quot;,&quot;说话断断续续或节奏不均匀&quot;,&quot;以轻松或悠闲的语调讲话&quot;,&quot;以快速或机关枪式的风格讲话&quot;,&quot;缓慢而谨慎地说话&quot;,&quot;滔滔不绝地讲话&quot;,&quot;为效果改变速度&quot;].random()&gt;&gt;
讲话特征: &lt;&lt;print [&quot;说话前清嗓子&quot;,&quot;用闲聊填补沉默&quot;,&quot;说话前犹豫&quot;,&quot;字里行间夹杂笑声&quot;,&quot;长时间停顿以达到戏剧效果&quot;,&quot;过度使用“嗯”或“呃”&quot;,&quot;回答前暂停&quot;,&quot;停下来整理思绪&quot;,&quot;说某些词时结巴&quot;,&quot;使用“well”作为填充词&quot;,&quot;使用短暂、尖锐的停顿来强调&quot;,&quot;利用沉默作为沟通方式&quot;,&quot;经常吹口哨&quot;].random()&gt;&gt;
语言风格: &lt;&lt;print [&quot;发音错误或说话磕磕巴巴&quot;,&quot;分享古怪的说法&quot;,&quot;混合不同语言或方言的词语&quot;,&quot;使用正式或学术词汇进行演讲&quot;,&quot;使用工人阶级或非正式的词汇进行交谈&quot;,&quot;使用陈词滥调或流行语&quot;,&quot;使用委婉语或礼貌用语&quot;,&quot;使用行话或技术术语&quot;,&quot;使用隐喻或明喻&quot;,&quot;使用粗言秽语&quot;].random()&gt;&gt;
习惯特征: &lt;&lt;print [&quot;早餐或午餐总是吃特定的食物&quot;,&quot;总是在口袋或包里携带特定物品&quot;,&quot;总是走同一条路&quot;,&quot;早上第一件事就是查看邮件或报纸&quot;,&quot;多次检查锁&quot;,&quot;用编织来放松&quot;,&quot;听歌来寻找灵感&quot;,&quot;每天早上列出待办事项清单&quot;,&quot;每天祈祷或冥想&quot;,&quot;休息时阅读&quot;,&quot;佩戴特定物品以求好运&quot;,&quot;只听特定类型的音乐&quot;,&quot;能背诵诗歌或书中段落&quot;,&quot;倾向于计数：步数、火车上的人、上班途中看到的鸟&quot;,&quot;休息时阅读&quot;,&quot;避开镜子&quot;,&quot;总是唱歌、哼歌或吹口哨&quot;,&quot;一直在阅读&quot;,&quot;喝很多茶/咖啡&quot;,&quot;挑食者&quot;,&quot;总是涂鸦&quot;,&quot;独特的笔迹——糟糕或漂亮&quot;,&quot;只看特定类型的电影或读特定类型的书&quot;,&quot;容易收留流浪动物（包括人和动物！）&quot;,&quot;总是丢东西&quot;,&quot;一直在阅读&quot;,&quot;喝很多茶/咖啡&quot;,&quot;挑食者&quot;,&quot;总是涂鸦&quot;].randomMany(2)&gt;&gt;
社交特征: &lt;&lt;print [&quot;总是询问别人的问题&quot;,&quot;总是试图说服别人&quot;,&quot;总是走同一条路&quot;,&quot;避免冲突&quot;,&quot;避免目光接触&quot;,&quot;谈话时慌乱或尴尬&quot;,&quot;极其诚实&quot;,&quot;不屑一顾&quot;,&quot;调情&quot;,&quot;过于健谈&quot;,&quot;过于礼貌&quot;,&quot;不断道歉&quot;,&quot;主导对话&quot;,&quot;进行大量花言巧语&quot;,&quot;经常偷瞄别人&quot;,&quot;打断别人&quot;,&quot;嘲笑自己的笑话&quot;,&quot;对别人做出奉承的评论&quot;,&quot;开玩笑或说双关语&quot;,&quot;发表大量批评或评判性的评论&quot;,&quot;发表自嘲性言论&quot;,&quot;经常谈论别人&quot;,&quot;通过触摸表达爱意&quot;,&quot;不断谈论自己&quot;,&quot;使用大量讽刺&quot;,&quot;发表自嘲性言论&quot;,&quot;对每个人都使用昵称&quot;,&quot;不喜欢和别人一起吃饭&quot;,&quot;对服务员很粗鲁&quot;,&quot;喜欢告诉人们他们为东西花了多少钱&quot;,&quot;和朋友保持联系&quot;,&quot;总是送手工制作的礼物&quot;,&quot;能够通过谈话解决任何问题&quot;,&quot;无论走到哪里都能和每个人交朋友&quot;,&quot;总是结交新朋友&quot;,&quot;总是赞美别人&quot;,&quot;撒谎能力很差&quot;,&quot;很有耐心&quot;].randomMany(3)&gt;&gt;
情绪特征: &lt;&lt;print [&quot;容易变得愤怒&quot;,&quot;受到批评时变得防御&quot;,&quot;争吵时情绪激动&quot;,&quot;很快脸红或感到尴尬&quot;,&quot;容易哭泣&quot;,&quot;表现出坚忍的风度&quot;,&quot;通过创造性渠道表达情感&quot;,&quot;表达情绪波动很大&quot;,&quot;寻求他人的安慰&quot;,&quot;遇到困难也保持幽默&quot;,&quot;对小麻烦反应过度&quot;,&quot;拒绝谈论情绪&quot;,&quot;不愿与他人分享情绪&quot;,&quot;把一切都变成游戏&quot;,&quot;你永远不知道他们是在撒谎还是在说实话&quot;,&quot;你永远不知道他们是在开玩笑还是认真的&quot;,&quot;很少表露情感&quot;,&quot;没有幽默感&quot;,&quot;拒绝谈论情绪&quot;,&quot;不愿与他人分享情绪&quot;,&quot;把一切都变成游戏&quot;].random(2)&gt;&gt;
管理情绪方式: &lt;&lt;print [&quot;携带枪支&quot;,&quot;强迫性购物&quot;,&quot;争吵时情绪激动&quot;,&quot;深呼吸&quot;,&quot;喝酒&quot;,&quot;沉浸在书籍、电影或游戏中&quot;,&quot;过度运动&quot;,&quot;寻求社会支持&quot;,&quot;吸烟&quot;,&quot;向朋友发泄&quot;].random()&gt;&gt;
阵营: &lt;&lt;print [&quot;皮猫&quot;,&quot;皮猫&quot;,&quot;皮猫&quot;,&quot;巫师保和派&quot;,&quot;巫师保和派&quot;,&quot;巫师反击派&quot;,&quot;自由巫师&quot;,&quot;皮猫&quot;,&quot;恶魔&quot;,&quot;天使&quot;,&quot;新神&quot;,&quot;皮猫&quot;,&quot;皮猫&quot;,&quot;皮猫&quot;,&quot;巫师保和派&quot;,&quot;巫师保和派&quot;,&quot;巫师反击派&quot;,&quot;自由巫师&quot;,&quot;皮猫&quot;,&quot;恶魔&quot;,&quot;天使&quot;,&quot;狩魔师&quot;,&quot;偏向猫族天使&quot;,&quot;皮猫&quot;,&quot;皮猫&quot;,&quot;皮猫&quot;,&quot;巫师保和派&quot;,&quot;巫师保和派&quot;,&quot;皮猫&quot;,&quot;自由巫师&quot;,&quot;皮猫&quot;,&quot;偏向猫族恶魔&quot;,&quot;天使&quot;,&quot;旧神&quot;].random()&gt;&gt;
属性: &lt;&lt;print [&quot;守序&quot;,&quot;中立&quot;,&quot;混乱&quot;].random()&gt;&gt;&lt;&lt;print [&quot;善良&quot;,&quot;中立&quot;,&quot;邪恶&quot;].random()&gt;&gt;
反派: &lt;&lt;print [&quot;否&quot;,&quot;否&quot;,&quot;否&quot;,&quot;否&quot;,&quot;否&quot;,&quot;否&quot;,&quot;否&quot;,&quot;否&quot;,&quot;否&quot;,&quot;否&quot;,&quot;否&quot;,&quot;否&quot;,&quot;否&quot;,&quot;否&quot;,&quot;否&quot;,&quot;否&quot;,&quot;否&quot;,&quot;否&quot;,&quot;否&quot;,&quot;否&quot;,&quot;否&quot;,&quot;童年遭受欺凌, 长大报复社会&quot;,&quot;想通过犯罪找到创作灵感&quot;,&quot;迷恋犯罪头目, 想得到赏识&quot;,&quot;感官薄弱, 通过作恶获得感官刺激&quot;,&quot;感官薄弱, 无所谓行恶&quot;,&quot;生于罪犯家庭, 传承家业&quot;,&quot;被陷害后痛恨虚假的正义&quot;,&quot;家庭富裕, 犯罪不过是一种消遣&quot;,&quot;天生反社会人格&quot;,&quot;痛恨另一个反派, 犯罪与其作对&quot;,&quot;急需钱财&quot;,&quot;利用程序漏洞&quot;].random()&gt;&gt;
龙裔: &lt;&lt;print [&quot;否&quot;,&quot;否&quot;,&quot;否&quot;,&quot;否&quot;,&quot;否&quot;,&quot;否&quot;,&quot;否&quot;,&quot;否&quot;,&quot;否&quot;,&quot;否&quot;,&quot;否&quot;,&quot;否&quot;,&quot;否&quot;,&quot;否&quot;,&quot;否&quot;,&quot;否&quot;,&quot;否&quot;,&quot;否&quot;,&quot;否&quot;,&quot;否&quot;,&quot;否&quot;,&quot;否&quot;,&quot;否&quot;,&quot;否&quot;,&quot;否&quot;,&quot;否&quot;,&quot;否&quot;,&quot;否&quot;,&quot;否&quot;,&quot;否&quot;,&quot;否&quot;,&quot;否&quot;,&quot;否&quot;,&quot;否&quot;,&quot;否&quot;,&quot;否&quot;,&quot;否&quot;,&quot;否&quot;,&quot;体能强化&quot;,&quot;千里耳&quot;,&quot;发出次声波&quot;,&quot;夜视&quot;,&quot;多眼&quot;,&quot;生出翅膀&quot;,&quot;生出尖刺&quot;,&quot;生出鳞片&quot;,&quot;自我恢复&quot;,&quot;可在水下呼吸&quot;,&quot;超忆&quot;,&quot;变形&quot;,&quot;石化&quot;,&quot;镭射眼&quot;,&quot;雾化&quot;,&quot;体型变化&quot;,&quot;分泌毒素&quot;,&quot;血液凝固成尖刺或盔甲&quot;,&quot;体能强化&quot;,&quot;千里耳&quot;,&quot;发出次声波&quot;,&quot;夜视&quot;,&quot;多眼&quot;,&quot;生出翅膀&quot;,&quot;生出尖刺&quot;,&quot;生出鳞片&quot;,&quot;自我恢复&quot;,&quot;可在水下呼吸&quot;,&quot;超忆&quot;,&quot;变形&quot;,&quot;石化&quot;,&quot;镭射眼&quot;,&quot;雾化&quot;,&quot;体型变化&quot;,&quot;分泌毒素&quot;,&quot;血液凝固成尖刺或盔甲&quot;,&quot;控制火焰&quot;,&quot;控制水分子&quot;,&quot;瞬移&quot;,&quot;隐形&quot;,&quot;控制雷电&quot;,&quot;与动物沟通&quot;,&quot;疾步&quot;,&quot;防水&quot;,&quot;调动周围情绪&quot;,&quot;促进细胞生长&quot;,&quot;控制震动&quot;,&quot;控制金属&quot;,&quot;操控物体&quot;,&quot;使物体漂浮&quot;,&quot;使物体雾化&quot;,&quot;控制重力&quot;,&quot;控制温度&quot;,&quot;控制光束&quot;,&quot;制造幻影&quot;,&quot;控制风暴&quot;,&quot;读心&quot;,&quot;入梦&quot;,&quot;预言&quot;,&quot;思维控制&quot;,&quot;语言操控&quot;,&quot;感知灵魂&quot;,&quot;造梦&quot;,&quot;唤醒欲望&quot;].random()&gt;&gt;
死法: &lt;&lt;print [&quot;衰老&quot;,&quot;衰老&quot;,&quot;衰老&quot;,&quot;衰老&quot;,&quot;衰老&quot;,&quot;衰老&quot;,&quot;衰老&quot;,&quot;食物中毒&quot;,&quot;金属中毒&quot;,&quot;跳崖&quot;,&quot;跳楼&quot;,&quot;利器贯穿&quot;,&quot;枪击&quot;,&quot;割喉&quot;,&quot;火焚&quot;,&quot;窒息&quot;,&quot;野兽&quot;,&quot;溺水&quot;,&quot;上吊&quot;].random()&gt;&gt;</tw-passagedata><tw-passagedata pid="130" name="领鸟羽" tags="" position="1400,100" size="100,100">&lt;&lt;if $lny !=1&gt;&gt;&lt;&lt;set $o to random(1,10)&gt;&gt;&lt;&lt;set $feather += $o&gt;&gt;&lt;&lt;set $lny = 1&gt;&gt;&lt;font color=#FFAA00&gt;Seisinofoaga&lt;/font&gt;: &lt;&lt;set _rpf = [&quot;只有$o枚羽毛, 心怀感激地拿去吧. 瞧瞧你自己, 小东西, 现在可是拥有$feather片神圣的羽毛了, 还不满足么?&quot;,&quot;已经给了你$o枚羽毛，那样的眼神难道在奢求更多吗? 瞧瞧你现在拥有的$feather枚羽毛, 收敛收敛你的贪婪吧, 小鬼&quot;].random()&gt;&gt;_rpf&lt;&lt;redo&gt;&gt;
&lt;&lt;if $msstat == &quot;新的开始1&quot;&gt;&gt;&lt;&lt;set $msstat = &quot;新的开始2&quot;&gt;&gt;&lt;&lt;if $msstat == &quot;新的开始2&quot; &amp;&amp; $feather &gt;= 200&gt;&gt;&lt;&lt;set $msstat = &quot;新的开始3&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;&lt;&lt;/if&gt;&gt;&lt;&lt;else&gt;&gt;&lt;font color=#FFAA00&gt;Seisinofoaga&lt;/font&gt;: 
&lt;&lt;set _rpf = [&quot;喂, 小孩, 我今天见过你一次了吧&quot;,&quot;小鬼, 贪心可没有好下场&quot;].random()&gt;&gt;_rpf
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="131" name="风车" tags="nobr" position="200,600" size="100,100">&lt;&lt;if $loc != &quot;风车&quot;&gt;&gt;&lt;&lt;set $minute += random(2,5)&gt;&gt;&lt;&lt;set $loc = &quot;风车&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;//一栋小型的风车房和磨坊, 岛上永不止息的海风使得其能提供上供给全岛的谷物//&lt;br&gt;&lt;br&gt;

✧「磨坊帮工」&lt;br&gt;&lt;br&gt;

&lt;&lt;link ▷「离开」 草甸&gt;&gt;&lt;&lt;/link&gt;&gt;</tw-passagedata><tw-passagedata pid="132" name="食物" tags="" position="1700,100" size="100,100">&lt;&lt;inv $food use drop inspect stack filter&gt;&gt;</tw-passagedata><tw-passagedata pid="133" name="高地" tags="nobr" position="300,200" size="100,100">&lt;&lt;if $loc != &quot;高地&quot;&gt;&gt;&lt;&lt;set $loc = &quot;高地&quot;&gt;&gt;&lt;&lt;set $minute to $minute+ random(5,10)&gt;&gt;&lt;&lt;set $HP to $HP- 1&gt;&gt;&lt;&lt;/if&gt;&gt;
&lt;&lt;audio &quot;mainBGM&quot; unmute&gt;&gt;
&lt;img src=&quot;https://f2.toyhou.se/file/f2-toyhou-se/images/87543101_EspOXZWRg0VWkcL.jpg&quot; width=100% class=&quot;pic&quot;&gt;
//&quot;它的全名其实是&quot;拓荒者高地&quot;, 跟我的屋子一样的来历, 但是现在大家都只说&quot;去高地&quot;. 不被需要的事物就是这样吧, 他们离去, 他们消失, 他们被从群体的记忆中抹去. &quot;//
&lt;br&gt;
&lt;&lt;NPCloc&gt;&gt;
&lt;br&gt;地点活动&lt;br&gt;
&lt;&lt;if $lostsheep[0] == 1&gt;&gt;[[✧「找羊」|era互动]]&lt;br&gt;&lt;&lt;/if&gt;&gt;
[[◈「散步」|散步]]&lt;br&gt;
[[◈「打猎」|打猎]]&lt;br&gt;
&lt;br&gt;继续前往&lt;br&gt;
[[✧「花田」|花田]]&lt;br&gt;
[[✧「拓荒者木屋」|拓荒者木屋]]&lt;br&gt;
&lt;br&gt;其他地区&lt;br&gt;
[[♢「秋毛岗」|秋毛岗]]&lt;br&gt;
[[♢「贝雷河」|贝雷河]]&lt;br&gt;
[[♢「主港口」|主港口]]</tw-passagedata><tw-passagedata pid="134" name="鱼铺" tags="nobr" position="400,600" size="100,100">&lt;&lt;if $tretloc == &quot;鱼铺&quot;&gt;&gt;&lt;&lt;if $loc != &quot;鱼铺&quot;&gt;&gt;&lt;&lt;set $loc = &quot;鱼铺&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;【你从鱼铺的橱窗向里张望, 老板Tret正在橱案边处理海鲜】&lt;br&gt;&lt;br&gt;
&lt;&lt;if $msstat == &quot;新的开始2&quot; &amp;&amp; $feather &gt;= 200&gt;&gt;&lt;&lt;set $msstat = &quot;新的开始3&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;

&lt;&lt;link&quot; ✣「NPC Tret」 &quot; &quot;鱼铺&quot;&gt;&gt;&lt;&lt;set $loct = $loc, $npc to &quot;Tret&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;
&lt;br&gt;&lt;br&gt;
[[✧「租船」|地点活动]](没写完别点)&lt;br&gt;
&lt;&lt;link ✧「出售」 兑换&gt;&gt;&lt;&lt;set $choice = &quot;出售&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;br&gt;
&lt;&lt;link ✧「剁鱼」 兑换&gt;&gt;&lt;&lt;set $choice = &quot;剁鱼&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;br&gt;
&lt;&lt;link ✧「兑换鱼饵」 兑换&gt;&gt;&lt;&lt;set $choice = &quot;兑换鱼饵&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;
&lt;&lt;else&gt;&gt;【鱼铺的门紧闭着，换个时间再来吧】&lt;&lt;/if&gt;&gt;
&lt;br&gt;&lt;br&gt;&lt;&lt;link ▷「离开」 副港口&gt;&gt;&lt;&lt;/link&gt;&gt;</tw-passagedata><tw-passagedata pid="135" name="鸟窝" tags="" position="1500,200" size="100,100">还没写</tw-passagedata><tw-passagedata pid="136" name="黑市" tags="" position="600,500" size="100,100">还没写</tw-passagedata><tw-passagedata pid="137" name="PassageDone" tags="" position="2125,300" size="100,100">/*----------------BGM判断----------------*/
&lt;&lt;audio &quot;mainBGM&quot; loop play&gt;&gt;
&lt;&lt;if $loc !=&quot;拓荒者木屋&quot;&gt;&gt;&lt;&lt;audio &quot;NixBGM&quot; stop&gt;&gt;&lt;&lt;/if&gt;&gt;
&lt;&lt;if $loc !=&quot;酒馆&quot;&gt;&gt;&lt;&lt;audio &quot;pubBGM&quot; stop&gt;&gt;&lt;&lt;/if&gt;&gt;</tw-passagedata></tw-storydata>
	<script id="script-sugarcube" type="text/javascript">
	/*! SugarCube JS */
	if(document.documentElement.getAttribute("data-init")==="loading"){(function(window,document,jQuery,undefined){"use strict";var _excluded=["bubbles","cancelable","composed","detail"],_excluded2=["bubbles","cancelable"],_excluded3=["state"];function _toConsumableArray(arr){return _arrayWithoutHoles(arr)||_iterableToArray(arr)||_unsupportedIterableToArray(arr)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _iterableToArray(iter){if("undefined"!=typeof Symbol&&null!=iter[Symbol.iterator]||null!=iter["@@iterator"])return Array.from(iter)}function _arrayWithoutHoles(arr){if(Array.isArray(arr))return _arrayLikeToArray(arr)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,_toPropertyKey(descriptor.key),descriptor)}}function _createClass(Constructor,protoProps,staticProps){return protoProps&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),Object.defineProperty(Constructor,"prototype",{writable:!1}),Constructor}function _toPropertyKey(t){var i=_toPrimitive(t,"string");return"symbol"==_typeof(i)?i:i+""}function _toPrimitive(t,r){if("object"!=_typeof(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}function _objectWithoutProperties(source,excluded){if(null==source)return{};var key,i,target=_objectWithoutPropertiesLoose(source,excluded);if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++)key=sourceSymbolKeys[i],excluded.indexOf(key)>=0||Object.prototype.propertyIsEnumerable.call(source,key)&&(target[key]=source[key])}return target}function _objectWithoutPropertiesLoose(source,excluded){if(null==source)return{};var key,i,target={},sourceKeys=Object.keys(source);for(i=0;i<sourceKeys.length;i++)key=sourceKeys[i],excluded.indexOf(key)>=0||(target[key]=source[key]);return target}function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_unsupportedIterableToArray(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(o,minLen){if(o){if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);return"Object"===n&&o.constructor&&(n=o.constructor.name),"Map"===n||"Set"===n?Array.from(o):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(o,minLen):void 0}}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function _iterableToArrayLimit(r,l){var t=null==r?null:"undefined"!=typeof Symbol&&r[Symbol.iterator]||r["@@iterator"];if(null!=t){var e,n,i,u,a=[],f=!0,o=!1;try{if(i=(t=t.call(r)).next,0===l){if(Object(t)!==t)return;f=!1}else for(;!(f=(e=i.call(t)).done)&&(a.push(e.value),a.length!==l);f=!0);}catch(r){o=!0,n=r}finally{try{if(!f&&null!=t.return&&(u=t.return(),Object(u)!==u))return}finally{if(o)throw n}}return a}}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}function _typeof(o){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},_typeof(o)}var errorPrologRegExp=/^(?:(?:uncaught\s+(?:exception:\s+)?)?\w*(?:error|exception|_err):\s+)+/i,Alert=function(){function mesg(where,error,isFatal,isUncaught){var mesg="Error",nice="A".concat(isFatal?" fatal":"n"," error has occurred.");nice+=isFatal?" Aborting.":" You may be able to continue, but some parts may not work properly.";var isObject=null!==error&&"object"===_typeof(error),what=(isObject&&"message"in error?String(error.message).replace(errorPrologRegExp,""):String(error)).trim()||"unknown error";null!=where&&(mesg+=" [".concat(where,"]")),mesg+=": ".concat(what,"."),isObject&&"stack"in error&&(mesg+="\n\nStack Trace:\n".concat(error.stack)),mesg&&(nice+="\n\n".concat(mesg)),isUncaught||console[isFatal?"error":"warn"](mesg),window.alert(nice)}var origOnError;return origOnError=window.onerror,window.onerror=function(what,source,lineNum,colNum,error){"complete"===document.readyState?mesg(null,null!=error?error:what,!1,!0):(mesg(null,null!=error?error:what,!0,!0),window.onerror=origOnError,"function"==typeof window.onerror&&window.onerror.apply(this,arguments))},Object.preventExtensions(Object.create(null,{error:{value:function(where,error){mesg(where,error)}},fatal:{value:function(where,error){mesg(where,error,!0)}}}))}(),Patterns=(wsMap=new Map([[" ","\\u0020"],["\f","\\f"],["\n","\\n"],["\r","\\r"],["\t","\\t"],["\v","\\v"],[" ","\\u00a0"],[" ","\\u1680"],["᠎","\\u180e"],[" ","\\u2000"],[" ","\\u2001"],[" ","\\u2002"],[" ","\\u2003"],[" ","\\u2004"],[" ","\\u2005"],[" ","\\u2006"],[" ","\\u2007"],[" ","\\u2008"],[" ","\\u2009"],[" ","\\u200a"],["\u2028","\\u2028"],["\u2029","\\u2029"],[" ","\\u202f"],[" ","\\u205f"],["　","\\u3000"],["\ufeff","\\ufeff"]]),wsRe=/^\s$/,missing="",wsMap.forEach((function(pat,char){wsRe.test(char)||(missing+=pat)})),space=missing?"[\\s".concat(missing,"]"):"\\s",spaceNoTerminator="[\\u0020\\f\\t\\v\\u00a0\\u1680\\u180e\\u2000-\\u200a\\u202f\\u205f\\u3000\\ufeff]",notSpace="\\s"===space?"\\S":space.replace(/^\[/,"[^"),anyChar="(?:.|".concat("[\\n\\r\\u2028\\u2029]",")"),anyLetter="[0-9A-Z_a-z\\-\\u00c0-\\u00d6\\u00d8-\\u00f6\\u00f8-\\u00ff\\u0150\\u0170\\u0151\\u0171]",anyLetterStrict=anyLetter.replace("\\-",""),identifier="".concat("[$A-Z_a-z]").concat("[$0-9A-Z_a-z]","*"),variable="[$_]"+identifier,htmlTagName="[A-Za-z](?:".concat(cENChar="(?:[\\x2D.0-9A-Z_a-z\\xB7\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u037D\\u037F-\\u1FFF\\u200C\\u200D\\u203F\\u2040\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD]|[\\uD800-\\uDB7F][\\uDC00-\\uDFFF])","*-").concat(cENChar,"*|[0-9A-Za-z]*)"),twStyle="(".concat(anyLetter,"+)\\(([^\\)\\|\\n]+)\\):"),cssStyle="".concat(spaceNoTerminator,"*(").concat(anyLetter,"+)").concat(spaceNoTerminator,"*:([^;\\|\\n]+);"),idOrClass="".concat(spaceNoTerminator,"*((?:").concat("[#.]").concat(anyLetter,"+").concat(spaceNoTerminator,"*)+);"),inlineCss="".concat(twStyle,"|").concat(cssStyle,"|").concat(idOrClass),url="(?:file|https?|mailto|ftp|javascript|irc|news|data):[^\\s'\"]+",externalUrl=url.replace(/\|javascript|\|data/g,""),Object.freeze(Object.assign(Object.create(null),{space:space,spaceNoTerminator:spaceNoTerminator,lineTerminator:"[\\n\\r\\u2028\\u2029]",notSpace:notSpace,anyChar:anyChar,anyLetter:anyLetter,anyLetterStrict:anyLetterStrict,identifierFirstChar:"[$A-Z_a-z]",identifierNextChar:"[$0-9A-Z_a-z]",identifier:identifier,variableSigil:"[$_]",variable:variable,macroName:"[A-Za-z][\\w-]*|[=-]",templateName:"[A-Za-z][\\w-]*",htmlTagName:htmlTagName,cssIdOrClassSigil:"[#.]",cssImage:"\\[[<>]?[Ii][Mm][Gg]\\[(?:\\s|\\S)*?\\]\\]+",inlineCss:inlineCss,url:url,externalUrl:externalUrl}))),wsMap,wsRe,missing,cENChar,twStyle,cssStyle,idOrClass,space,spaceNoTerminator,notSpace,anyChar,anyLetter,anyLetterStrict,identifier,variable,htmlTagName,inlineCss,url,externalUrl;!function(){var startWSRe,endWSRe,_trimString=(startWSRe=new RegExp("^".concat(Patterns.space).concat(Patterns.space,"*")),endWSRe=new RegExp("".concat(Patterns.space).concat(Patterns.space,"*$")),function(str,where){var val=String(str);if(!val)return val;switch(where){case"start":return startWSRe.test(val)?val.replace(startWSRe,""):val;case"end":return endWSRe.test(val)?val.replace(endWSRe,""):val;default:throw new Error('_trimString called with incorrect where parameter value: "'.concat(where,'"'))}});function _createPadString(length,padding){var targetLength=Number.parseInt(length,10)||0;if(targetLength<1)return"";var padString=void 0===padding?"":String(padding);for(""===padString&&(padString=" ");padString.length<targetLength;){var curPadLength=padString.length,remainingLength=targetLength-curPadLength;padString+=curPadLength>remainingLength?padString.slice(0,remainingLength):padString}return padString.length>targetLength&&(padString=padString.slice(0,targetLength)),padString}if(Array.prototype.flat||Object.defineProperty(Array.prototype,"flat",{configurable:!0,writable:!0,value:function flat(){if(null==this)throw new TypeError("Array.prototype.flat called on null or undefined");var depth=0===arguments.length?1:Number(arguments[0])||0;if(depth<1)return Array.prototype.slice.call(this);var push=Array.prototype.push;return Array.prototype.reduce.call(this,(function(acc,cur){return cur instanceof Array?push.apply(acc,flat.call(cur,depth-1)):acc.push(cur),acc}),[])}}),Array.prototype.flatMap||Object.defineProperty(Array.prototype,"flatMap",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("Array.prototype.flatMap called on null or undefined");return Array.prototype.map.apply(this,arguments).flat()}}),Array.prototype.includes||Object.defineProperty(Array.prototype,"includes",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("Array.prototype.includes called on null or undefined");if(0===arguments.length)return!1;var length=this.length>>>0;if(0===length)return!1;var needle=arguments[0],i=Number(arguments[1])||0;for(i<0&&(i=Math.max(0,length+i));i<length;++i){var value=this[i];if(value===needle||value!=value&&needle!=needle)return!0}return!1}}),Object.entries||Object.defineProperty(Object,"entries",{configurable:!0,writable:!0,value:function(obj){if("object"!==_typeof(obj)||null===obj)throw new TypeError("Object.entries object parameter must be an object");return Object.keys(obj).map((function(key){return[key,obj[key]]}))}}),Object.fromEntries||Object.defineProperty(Object,"fromEntries",{configurable:!0,writable:!0,value:function(iter){return Array.from(iter).reduce((function(acc,pair){if(Object(pair)!==pair)throw new TypeError("Object.fromEntries iterable parameter must yield objects");return pair[0]in acc?Object.defineProperty(acc,pair[0],{configurable:!0,enumerable:!0,writable:!0,value:pair[1]}):acc[pair[0]]=pair[1],acc}),{})}}),Object.getOwnPropertyDescriptors||Object.defineProperty(Object,"getOwnPropertyDescriptors",{configurable:!0,writable:!0,value:function(obj){if(null==obj)throw new TypeError("Object.getOwnPropertyDescriptors object parameter is null or undefined");var O=Object(obj);return Reflect.ownKeys(O).reduce((function(acc,key){var desc=Object.getOwnPropertyDescriptor(O,key);return void 0!==desc&&(key in acc?Object.defineProperty(acc,key,{configurable:!0,enumerable:!0,writable:!0,value:desc}):acc[key]=desc),acc}),{})}}),!Object.hasOwn){var _hasOwnProperty=Object.prototype.hasOwnProperty;Object.defineProperty(Object,"hasOwn",{configurable:!0,writable:!0,value:function(O,P){return _hasOwnProperty.call(Object(O),P)}})}Object.values||Object.defineProperty(Object,"values",{configurable:!0,writable:!0,value:function(obj){if("object"!==_typeof(obj)||null===obj)throw new TypeError("Object.values object parameter must be an object");return Object.keys(obj).map((function(key){return obj[key]}))}}),String.prototype.padStart||Object.defineProperty(String.prototype,"padStart",{configurable:!0,writable:!0,value:function(length,padding){if(null==this)throw new TypeError("String.prototype.padStart called on null or undefined");var baseString=String(this),baseLength=baseString.length,targetLength=Number.parseInt(length,10);return targetLength<=baseLength?baseString:_createPadString(targetLength-baseLength,padding)+baseString}}),String.prototype.padEnd||Object.defineProperty(String.prototype,"padEnd",{configurable:!0,writable:!0,value:function(length,padding){if(null==this)throw new TypeError("String.prototype.padEnd called on null or undefined");var baseString=String(this),baseLength=baseString.length,targetLength=Number.parseInt(length,10);return targetLength<=baseLength?baseString:baseString+_createPadString(targetLength-baseLength,padding)}}),String.prototype.trimStart||Object.defineProperty(String.prototype,"trimStart",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("String.prototype.trimStart called on null or undefined");return _trimString(this,"start")}}),String.prototype.trimLeft||Object.defineProperty(String.prototype,"trimLeft",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("String.prototype.trimLeft called on null or undefined");return _trimString(this,"start")}}),String.prototype.trimEnd||Object.defineProperty(String.prototype,"trimEnd",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("String.prototype.trimEnd called on null or undefined");return _trimString(this,"end")}}),String.prototype.trimRight||Object.defineProperty(String.prototype,"trimRight",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("String.prototype.trimRight called on null or undefined");return _trimString(this,"end")}})}(),function(){var _regExpMetaCharsRe,_hasRegExpMetaCharsRe,_formatRegExp,_hasFormatRegExp,_nativeMathRandom=Math.random;function _random(){var min,max;switch(arguments.length){case 0:throw new Error("_random called with insufficient parameters");case 1:min=0,max=arguments[0];break;default:min=arguments[0],max=arguments[1]}if(min>max){var _ref=[max,min];min=_ref[0],max=_ref[1]}return Math.floor(_nativeMathRandom()*(max-min+1))+min}function _randomIndex(length,boundsArgs){var min,max;switch(boundsArgs.length){case 1:min=0,max=length-1;break;case 2:min=0,max=Math.trunc(boundsArgs[1]);break;default:min=Math.trunc(boundsArgs[1]),max=Math.trunc(boundsArgs[2])}return Number.isNaN(min)?min=0:!Number.isFinite(min)||min>=length?min=length-1:min<0&&(min=length+min)<0&&(min=0),Number.isNaN(max)?max=0:(!Number.isFinite(max)||max>=length||max<0&&(max=length+max)<0)&&(max=length-1),_random(min,max)}function _getCodePointStartAndEnd(str,pos){var code=str.charCodeAt(pos);if(Number.isNaN(code))return{char:"",start:-1,end:-1};if(code<55296||code>57343)return{char:str.charAt(pos),start:pos,end:pos};if(code>=55296&&code<=56319){var nextPos=pos+1;if(nextPos>=str.length)throw new Error("high surrogate without trailing low surrogate");var nextCode=str.charCodeAt(nextPos);if(nextCode<56320||nextCode>57343)throw new Error("high surrogate without trailing low surrogate");return{char:str.charAt(pos)+str.charAt(nextPos),start:pos,end:nextPos}}if(0===pos)throw new Error("low surrogate without leading high surrogate");var prevPos=pos-1,prevCode=str.charCodeAt(prevPos);if(prevCode<55296||prevCode>56319)throw new Error("low surrogate without leading high surrogate");return{char:str.charAt(prevPos)+str.charAt(pos),start:prevPos,end:pos}}Object.defineProperty(Array.prototype,"concatUnique",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("Array.prototype.concatUnique called on null or undefined");var result=Array.from(this);if(0===arguments.length)return result;var items=Array.prototype.reduce.call(arguments,(function(prev,cur){return prev.concat(cur)}),[]),addSize=items.length;if(0===addSize)return result;for(var indexOf=Array.prototype.indexOf,push=Array.prototype.push,i=0;i<addSize;++i){var value=items[i];-1===indexOf.call(result,value)&&push.call(result,value)}return result}}),Object.defineProperty(Array.prototype,"count",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("Array.prototype.count called on null or undefined");for(var indexOf=Array.prototype.indexOf,needle=arguments[0],pos=Number(arguments[1])||0,count=0;-1!==(pos=indexOf.call(this,needle,pos));)++count,++pos;return count}}),Object.defineProperty(Array.prototype,"countWith",{configurable:!0,writable:!0,value:function(predicate,thisArg){if(null==this)throw new TypeError("Array.prototype.countWith called on null or undefined");if("function"!=typeof predicate)throw new Error("Array.prototype.countWith predicate parameter must be a function");var length=this.length>>>0;if(0===length)return 0;for(var count=0,i=0;i<length;++i)predicate.call(thisArg,this[i],i,this)&&++count;return count}}),Object.defineProperty(Array.prototype,"deleteAll",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("Array.prototype.deleteAll called on null or undefined");if(0===arguments.length)return[];var length=this.length>>>0;if(0===length)return[];for(var needles=Array.prototype.concat.apply([],arguments),needlesLength=needles.length,indices=[],i=0;i<length;++i)for(var value=this[i],j=0;j<needlesLength;++j){var needle=needles[j];if(value===needle||value!=value&&needle!=needle){indices.push(i);break}}for(var result=[],_i=0,iend=indices.length;_i<iend;++_i)result[_i]=this[indices[_i]];for(var splice=Array.prototype.splice,_i2=indices.length-1;_i2>=0;--_i2)splice.call(this,indices[_i2],1);return result}}),Object.defineProperty(Array.prototype,"deleteAt",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("Array.prototype.deleteAt called on null or undefined");if(0===arguments.length)return[];var length=this.length>>>0;if(0===length)return[];for(var splice=Array.prototype.splice,cpyIndices=Array.from(new Set(Array.from(arguments).map((function(x){return x<0?Math.max(0,length+x):x}))).values()),delIndices=Array.from(cpyIndices).sort((function(a,b){return b-a})),result=[],i=0,iend=cpyIndices.length;i<iend;++i)result[i]=this[cpyIndices[i]];for(var _i3=0,_iend=delIndices.length;_i3<_iend;++_i3)splice.call(this,delIndices[_i3],1);return result}}),Object.defineProperty(Array.prototype,"deleteFirst",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("Array.prototype.deleteFirst called on null or undefined");if(0!==arguments.length){var length=this.length>>>0;if(0!==length){for(var splice=Array.prototype.splice,needles=Array.prototype.concat.apply([],arguments),result=[],i=0;i<length&&needles.length>0;++i)for(var value=this[i],j=0;j<needles.length;++j){var needle=needles[j];if(value===needle||value!=value&&needle!=needle){result.push(value),splice.call(this,i--,1),needles.splice(j--,1);break}}return result}}}}),Object.defineProperty(Array.prototype,"deleteLast",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("Array.prototype.deleteLast called on null or undefined");if(0!==arguments.length){var length=this.length>>>0;if(0!==length){for(var splice=Array.prototype.splice,needles=Array.prototype.concat.apply([],arguments),result=[],i=length-1;i>=0&&needles.length>0;--i)for(var value=this[i],j=0;j<needles.length;++j){var needle=needles[j];if(value===needle||value!=value&&needle!=needle){result.push(value),splice.call(this,i++,1),needles.splice(j--,1);break}}return result}}}}),Object.defineProperty(Array.prototype,"deleteWith",{configurable:!0,writable:!0,value:function(predicate,thisArg){if(null==this)throw new TypeError("Array.prototype.deleteWith called on null or undefined");if("function"!=typeof predicate)throw new Error("Array.prototype.deleteWith predicate parameter must be a function");var length=this.length>>>0;if(0===length)return[];for(var splice=Array.prototype.splice,indices=[],result=[],i=0;i<length;++i)predicate.call(thisArg,this[i],i,this)&&(result.push(this[i]),indices.push(i));for(var _i4=indices.length-1;_i4>=0;--_i4)splice.call(this,indices[_i4],1);return result}}),Object.defineProperty(Array.prototype,"first",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("Array.prototype.first called on null or undefined");if(0!==this.length>>>0)return this[0]}}),Object.defineProperty(Array.prototype,"includesAll",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("Array.prototype.includesAll called on null or undefined");if(1===arguments.length)return Array.isArray(arguments[0])?Array.prototype.includesAll.apply(this,arguments[0]):Array.prototype.includes.apply(this,arguments);for(var i=0,iend=arguments.length;i<iend;++i)if(!Array.prototype.some.call(this,(function(val){return val===this.val||val!=val&&this.val!=this.val}),{val:arguments[i]}))return!1;return!0}}),Object.defineProperty(Array.prototype,"includesAny",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("Array.prototype.includesAny called on null or undefined");if(1===arguments.length)return Array.isArray(arguments[0])?Array.prototype.includesAny.apply(this,arguments[0]):Array.prototype.includes.apply(this,arguments);for(var i=0,iend=arguments.length;i<iend;++i)if(Array.prototype.some.call(this,(function(val){return val===this.val||val!=val&&this.val!=this.val}),{val:arguments[i]}))return!0;return!1}}),Object.defineProperty(Array.prototype,"last",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("Array.prototype.last called on null or undefined");var length=this.length>>>0;if(0!==length)return this[length-1]}}),Object.defineProperty(Array.prototype,"pluck",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("Array.prototype.pluck called on null or undefined");var length=this.length>>>0;if(0!==length){var index=0===arguments.length?_random(0,length-1):_randomIndex(length,Array.from(arguments));return Array.prototype.splice.call(this,index,1)[0]}}}),Object.defineProperty(Array.prototype,"pluckMany",{configurable:!0,writable:!0,value:function(wantSize){if(null==this)throw new TypeError("Array.prototype.pluckMany called on null or undefined");var length=this.length>>>0;if(0===length)return[];var want=Math.trunc(wantSize);if(!Number.isInteger(want))throw new Error("Array.prototype.pluckMany want parameter must be an integer");if(want<1)return[];want>length&&(want=length);var splice=Array.prototype.splice,result=[],max=length-1;do{result.push(splice.call(this,_random(0,max--),1)[0])}while(result.length<want);return result}}),Object.defineProperty(Array.prototype,"pushUnique",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("Array.prototype.pushUnique called on null or undefined");var addSize=arguments.length;if(0===addSize)return this.length>>>0;for(var indexOf=Array.prototype.indexOf,push=Array.prototype.push,i=0;i<addSize;++i){var value=arguments[i];-1===indexOf.call(this,value)&&push.call(this,value)}return this.length>>>0}}),Object.defineProperty(Array.prototype,"random",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("Array.prototype.random called on null or undefined");var length=this.length>>>0;if(0!==length)return this[0===arguments.length?_random(0,length-1):_randomIndex(length,Array.from(arguments))]}}),Object.defineProperty(Array.prototype,"randomMany",{configurable:!0,writable:!0,value:function(wantSize){if(null==this)throw new TypeError("Array.prototype.randomMany called on null or undefined");var length=this.length>>>0;if(0===length)return[];var want=Math.trunc(wantSize);if(!Number.isInteger(want))throw new Error("Array.prototype.randomMany want parameter must be an integer");if(want<1)return[];want>length&&(want=length);var picked=new Map,result=[],max=length-1;do{var i=void 0;do{i=_random(0,max)}while(picked.has(i));picked.set(i,!0),result.push(this[i])}while(result.length<want);return result}}),Object.defineProperty(Array.prototype,"shuffle",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("Array.prototype.shuffle called on null or undefined");var length=this.length>>>0;if(0===length)return this;for(var i=length-1;i>0;--i){var j=Math.floor(_nativeMathRandom()*(i+1));if(i!==j){var swap=this[i];this[i]=this[j],this[j]=swap}}return this}}),Object.defineProperty(Array.prototype,"toShuffled",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("Array.prototype.toShuffled called on null or undefined");return Array.from(this).shuffle()}}),Object.defineProperty(Array.prototype,"toUnique",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("Array.prototype.toUnique called on null or undefined");return Array.from(new Set(this))}}),Object.defineProperty(Array.prototype,"unshiftUnique",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("Array.prototype.unshiftUnique called on null or undefined");var addSize=arguments.length;if(0===addSize)return this.length>>>0;for(var indexOf=Array.prototype.indexOf,unshift=Array.prototype.unshift,i=0;i<addSize;++i){var value=arguments[i];-1===indexOf.call(this,value)&&unshift.call(this,value)}return this.length>>>0}}),Object.defineProperty(Function.prototype,"partial",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("Function.prototype.partial called on null or undefined");var slice=Array.prototype.slice,fn=this,bound=slice.call(arguments,0);return function(){for(var applied=[],argc=0,i=0;i<bound.length;++i)applied.push(bound[i]===undefined?arguments[argc++]:bound[i]);return fn.apply(this,applied.concat(slice.call(arguments,argc)))}}}),Object.defineProperty(Math,"clamp",{configurable:!0,writable:!0,value:function(num,min,max){if(3!==arguments.length)throw new Error("Math.clamp called with an incorrect number of parameters (want: 3, received: ".concat(arguments.length,")"));var value=Number(num),minVal=Number(min),maxVal=Number(max);if(minVal>maxVal){var _ref2=[maxVal,minVal];minVal=_ref2[0],maxVal=_ref2[1]}return Math.min(Math.max(value,minVal),maxVal)}}),RegExp.escape||(_regExpMetaCharsRe=/[\\^$*+?.()|[\]{}]/g,_hasRegExpMetaCharsRe=new RegExp(_regExpMetaCharsRe.source),Object.defineProperty(RegExp,"escape",{configurable:!0,writable:!0,value:function(str){var val=String(str);return val&&_hasRegExpMetaCharsRe.test(val)?val.replace(_regExpMetaCharsRe,"\\$&"):val}})),_formatRegExp=/{(\d+)(?:,([+-]?\d+))?}/g,_hasFormatRegExp=new RegExp(_formatRegExp.source),Object.defineProperty(String,"format",{configurable:!0,writable:!0,value:function(format){if(arguments.length<2)return 0===arguments.length?"":format;var args=2===arguments.length&&Array.isArray(arguments[1])?Array.from(arguments[1]):Array.prototype.slice.call(arguments,1);return 0===args.length?format:_hasFormatRegExp.test(format)?(_formatRegExp.lastIndex=0,format.replace(_formatRegExp,(function(match,index,align){var retval=args[index];if(null==retval)return"";for(;"function"==typeof retval;)retval=retval();switch(_typeof(retval)){case"string":break;case"object":retval=JSON.stringify(retval);break;default:retval=String(retval)}return function(str,align,pad){if(!align)return str;var plen=Math.abs(align)-str.length;if(plen<1)return str;var padding=String(pad).repeat(plen);return align<0?str+padding:padding+str}(retval,align?Number.parseInt(align,10):0," ")}))):format}}),Object.defineProperty(String.prototype,"count",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("String.prototype.count called on null or undefined");var needle=String(arguments[0]||"");if(""===needle)return 0;for(var indexOf=String.prototype.indexOf,step=needle.length,pos=Number(arguments[1])||0,count=0;-1!==(pos=indexOf.call(this,needle,pos));)++count,pos+=step;return count}}),Object.defineProperty(String.prototype,"first",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("String.prototype.first called on null or undefined");return _getCodePointStartAndEnd(String(this),0).char}}),Object.defineProperty(String.prototype,"last",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("String.prototype.last called on null or undefined");var str=String(this);return _getCodePointStartAndEnd(str,str.length-1).char}}),Object.defineProperty(String.prototype,"splice",{configurable:!0,writable:!0,value:function(startAt,delCount,replacement){if(null==this)throw new TypeError("String.prototype.splice called on null or undefined");var length=this.length>>>0;if(0===length)return"";var start=Number(startAt);Number.isSafeInteger(start)?start<0&&(start+=length)<0&&(start=0):start=0,start>length&&(start=length);var count=Number(delCount);(!Number.isSafeInteger(count)||count<0)&&(count=0);var res=this.slice(0,start);return void 0!==replacement&&(res+=replacement),start+count<length&&(res+=this.slice(start+count)),res}}),Object.defineProperty(String.prototype,"splitOrEmpty",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("String.prototype.splitOrEmpty called on null or undefined");return""===String(this)?[]:String.prototype.split.apply(this,arguments)}}),Object.defineProperty(String.prototype,"toLocaleUpperFirst",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("String.prototype.toLocaleUpperFirst called on null or undefined");var str=String(this),_getCodePointStartAnd3=_getCodePointStartAndEnd(str,0),char=_getCodePointStartAnd3.char,end=_getCodePointStartAnd3.end;return-1===end?"":char.toLocaleUpperCase()+str.slice(end+1)}}),Object.defineProperty(String.prototype,"toUpperFirst",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("String.prototype.toUpperFirst called on null or undefined");var str=String(this),_getCodePointStartAnd4=_getCodePointStartAndEnd(str,0),char=_getCodePointStartAnd4.char,end=_getCodePointStartAnd4.end;return-1===end?"":char.toUpperCase()+str.slice(end+1)}}),Object.defineProperty(Array.prototype,"delete",{configurable:!0,writable:!0,value:function(){if(console.warn("[DEPRECATED] <Array>.delete() is deprecated."),null==this)throw new TypeError("Array.prototype.delete called on null or undefined");return Array.prototype.deleteAll.apply(this,arguments)}}),Object.defineProperty(JSON,"reviveWrapper",{configurable:!0,writable:!0,value:function(code,data){if(console.warn("[DEPRECATED] JSON.reviveWrapper() is deprecated."),"string"!=typeof code)throw new TypeError("JSON.reviveWrapper code parameter must be a string");return Serial.createReviver(code,data)}}),Object.defineProperty(Math,"easeInOut",{configurable:!0,writable:!0,value:function(num){return console.warn("[DEPRECATED] Math.easeInOut() is deprecated."),1-(Math.cos(Number(num)*Math.PI)+1)/2}}),Object.defineProperty(Number.prototype,"clamp",{configurable:!0,writable:!0,value:function(){if(console.warn("[DEPRECATED] <Number>.clamp() is deprecated."),null==this)throw new TypeError("Number.prototype.clamp called on null or undefined");if(2!==arguments.length)throw new Error("Number.prototype.clamp called with an incorrect number of parameters (want: 2, received: ".concat(arguments.length,")"));return Math.clamp(this,arguments[0],arguments[1])}})}(),function(){function onKeypressFn(ev){13!==ev.which&&32!==ev.which||(ev.preventDefault(),triggerEvent("click",getActiveElement()||this))}function onClickFnWrapper(fn){return function(){var $this=jQuery(this);$this.ariaIsDisabled()||($this.is("[aria-pressed]")&&$this.attr("aria-pressed","true"===$this.attr("aria-pressed")?"false":"true"),fn.apply(this,arguments))}}function disableTabindex(el){if(!el.hasAttribute("data-last-tabindex")){var tabindex=el.getAttribute("tabindex");el.setAttribute("data-last-tabindex",null!==tabindex?tabindex.trim():"")}el.setAttribute("tabindex",-1)}function restoreTabindex(el){var lastTabindex=el.getAttribute("data-last-tabindex");null!==lastTabindex&&(el.removeAttribute("data-last-tabindex"),""===lastTabindex?el.removeAttribute("tabindex"):el.setAttribute("tabindex",lastTabindex))}jQuery.fn.extend({ariaClick:function(options,handler){if(0===this.length||0===arguments.length)return this;var opts=options,fn=handler;return null==fn&&(fn=opts,opts=undefined),"string"!=typeof(opts=jQuery.extend({namespace:undefined,one:!1,selector:undefined,data:undefined,role:undefined,tabindex:0,controls:undefined,pressed:undefined,label:undefined},opts)).namespace?opts.namespace="":"."!==opts.namespace[0]&&(opts.namespace=".".concat(opts.namespace)),"boolean"==typeof opts.pressed&&(opts.pressed=opts.pressed?"true":"false"),this.filter("button").prop("type","button"),null!=opts.role?this.attr("role",opts.role):this.not("[role]").filter("a,[data-passage]").attr("role","link").end().not("a").not("[data-passage]").attr("role","button").end().end().end(),this.attr("tabindex",opts.tabindex),null!=opts.controls&&this.attr("aria-controls",opts.controls),null!=opts.pressed&&this.attr("aria-pressed",opts.pressed),null!=opts.label&&this.attr({"aria-label":opts.label,title:opts.label}),this.not("button").on("keypress.aria-clickable".concat(opts.namespace),opts.selector,onKeypressFn),this.on("click.aria-clickable".concat(opts.namespace),opts.selector,opts.data,opts.one?function(fn){return onClickFnWrapper((function(){jQuery(this).off(".aria-clickable").removeAttr("role tabindex aria-controls aria-pressed").filter("button").prop("disabled",!0),fn.apply(this,arguments)}))}(fn):onClickFnWrapper(fn)),this},ariaDisabled:function(disable){if(0===this.length||0===arguments.length)return this;var $nonDisableable=this.not("button,fieldset,input,menuitem,optgroup,option,select,textarea"),$disableable=this.filter("button,fieldset,input,menuitem,optgroup,option,select,textarea");return disable?($nonDisableable.each((function(){this.setAttribute("disabled","disabled"),this.setAttribute("aria-disabled","true"),disableTabindex(this)})),$disableable.each((function(){this.disabled=!0,this.setAttribute("aria-disabled","true"),disableTabindex(this)}))):($nonDisableable.each((function(){this.removeAttribute("disabled"),this.removeAttribute("aria-disabled"),restoreTabindex(this)})),$disableable.each((function(){this.disabled=!1,this.removeAttribute("aria-disabled"),restoreTabindex(this)}))),this},ariaIsDisabled:function(){return this.is("[disabled]")}})}(),jQuery.fn.extend({getForbiddenInteractiveContentTagNames:function(){if(0===this.length)return[];var forbidden=new Set;return this.find("a,button,fieldset,form,input,menuitem,optgroup,option,select,textarea").each((function(_,el){return forbidden.add(el.nodeName.toLowerCase())})),Array.from(forbidden)}}),jQuery.extend({wikiWithOptions:function(options){for(var _len=arguments.length,sources=new Array(_len>1?_len-1:0),_key=1;_key<_len;_key++)sources[_key-1]=arguments[_key];if(0!==sources.length){var frag=document.createDocumentFragment();sources.forEach((function(content){return new Wikifier(frag,content,options)}));var errors=Array.from(frag.querySelectorAll(".error")).map((function(errEl){return errEl.textContent.replace(errorPrologRegExp,"")}));if(errors.length>0)throw new Error(errors.join("; "))}},wiki:function(){for(var _len2=arguments.length,sources=new Array(_len2),_key2=0;_key2<_len2;_key2++)sources[_key2]=arguments[_key2];this.wikiWithOptions.apply(this,[undefined].concat(sources))},wikiPassage:function(name){this.wikiWithOptions(undefined,Story.get(name).processText())}}),jQuery.fn.extend({wikiWithOptions:function(options){for(var _len3=arguments.length,sources=new Array(_len3>1?_len3-1:0),_key3=1;_key3<_len3;_key3++)sources[_key3-1]=arguments[_key3];if(0===this.length||0===sources.length)return this;var frag=document.createDocumentFragment();return sources.forEach((function(content){return new Wikifier(frag,content,options)})),this.append(frag),this},wiki:function(){for(var _len4=arguments.length,sources=new Array(_len4),_key4=0;_key4<_len4;_key4++)sources[_key4]=arguments[_key4];return this.wikiWithOptions.apply(this,[undefined].concat(sources))},wikiPassage:function(name){return this.wikiWithOptions(undefined,Story.get(name).processText())}});var Browser=(userAgent=navigator.userAgent.toLowerCase(),winPhone=userAgent.includes("windows phone"),isMobile=Object.freeze({Android:!winPhone&&userAgent.includes("android"),BlackBerry:/blackberry|bb10/.test(userAgent),iOS:!winPhone&&/ip(?:hone|ad|od)/.test(userAgent),Opera:!winPhone&&("object"===_typeof(window.operamini)||userAgent.includes("opera mini")),Windows:winPhone||/iemobile|wpdesktop/.test(userAgent),any:function(){return isMobile.Android||isMobile.BlackBerry||isMobile.iOS||isMobile.Opera||isMobile.Windows}}),isGecko=!isMobile.Windows&&!/khtml|trident|edge/.test(userAgent)&&userAgent.includes("gecko"),isIE=!userAgent.includes("opera")&&/msie|trident/.test(userAgent),ieVersion=isIE?(ver=/(?:msie\s+|rv:)(\d+\.\d)/.exec(userAgent))?Number(ver[1]):0:null,isOpera=userAgent.includes("opera")||userAgent.includes(" opr/"),operaVersion=isOpera?function(){var ver=new RegExp("".concat(/khtml|chrome/.test(userAgent)?"opr":"version","\\/(\\d+\\.\\d+)")).exec(userAgent);return ver?Number(ver[1]):0}():null,isVivaldi=userAgent.includes("vivaldi"),Object.freeze(Object.assign(Object.create(null),{userAgent:userAgent,isMobile:isMobile,isGecko:isGecko,isIE:isIE,ieVersion:ieVersion,isOpera:isOpera,operaVersion:operaVersion,isVivaldi:isVivaldi}))),ver,userAgent,winPhone,isMobile,isGecko,isIE,ieVersion,isOpera,operaVersion,isVivaldi,Has=(hasAudioElement=function(){try{return"function"==typeof document.createElement("audio").canPlayType}catch(ex){}return!1}(),hasFile=function(){try{return"Blob"in window&&"File"in window&&"FileList"in window&&"FileReader"in window&&(!Browser.isOpera||Browser.operaVersion>=15)}catch(ex){}return!1}(),hasGeolocation=function(){try{return"geolocation"in navigator&&"function"==typeof navigator.geolocation.getCurrentPosition&&"function"==typeof navigator.geolocation.watchPosition}catch(ex){}return!1}(),hasMutationObserver=function(){try{return"MutationObserver"in window&&"function"==typeof window.MutationObserver}catch(ex){}return!1}(),hasPerformance=function(){try{return"performance"in window&&"function"==typeof window.performance.now}catch(ex){}return!1}(),hasTouch=function(){try{return"ontouchstart"in window||!!window.DocumentTouch&&document instanceof window.DocumentTouch||!!navigator.maxTouchPoints||!!navigator.msMaxTouchPoints}catch(ex){}return!1}(),hasTransitionEndEvent=function(){try{for(var teMap=new Map([["transition","transitionend"],["MSTransition","msTransitionEnd"],["WebkitTransition","webkitTransitionEnd"],["MozTransition","transitionend"]]),teKeys=Array.from(teMap.keys()),el=document.createElement("div"),i=0;i<teKeys.length;++i)if(el.style[teKeys[i]]!==undefined)return teMap.get(teKeys[i])}catch(ex){}return!1}(),Object.freeze(Object.assign(Object.create(null),{audio:hasAudioElement,fileAPI:hasFile,geolocation:hasGeolocation,mutationObserver:hasMutationObserver,performance:hasPerformance,touch:hasTouch,transitionEndEvent:hasTransitionEndEvent}))),hasAudioElement,hasFile,hasGeolocation,hasMutationObserver,hasPerformance,hasTouch,hasTransitionEndEvent,Fullscreen=function(){var _hasPromise,vendor=function(){try{return Object.freeze([{isEnabled:"fullscreenEnabled",element:"fullscreenElement",requestFn:"requestFullscreen",exitFn:"exitFullscreen",changeEvent:"fullscreenchange",errorEvent:"fullscreenerror"},{isEnabled:"webkitFullscreenEnabled",element:"webkitFullscreenElement",requestFn:"webkitRequestFullscreen",exitFn:"webkitExitFullscreen",changeEvent:"webkitfullscreenchange",errorEvent:"webkitfullscreenerror"},{isEnabled:"mozFullScreenEnabled",element:"mozFullScreenElement",requestFn:"mozRequestFullScreen",exitFn:"mozCancelFullScreen",changeEvent:"mozfullscreenchange",errorEvent:"mozfullscreenerror"},{isEnabled:"msFullscreenEnabled",element:"msFullscreenElement",requestFn:"msRequestFullscreen",exitFn:"msExitFullscreen",changeEvent:"MSFullscreenChange",errorEvent:"MSFullscreenError"}].find((function(vnd){return vnd.isEnabled in document})))}catch(ex){}return undefined}(),_returnsPromise=(_hasPromise=null,function(){if(null!==_hasPromise)return _hasPromise;if(_hasPromise=!1,vendor)try{var value=document.exitFullscreen();value.catch((function(){})),_hasPromise=value instanceof Promise}catch(ex){}return _hasPromise});function _selectElement(requestedEl){var selectedEl=requestedEl||document.documentElement;return selectedEl===document.documentElement&&("msRequestFullscreen"===vendor.requestFn||Browser.isOpera&&Browser.operaVersion<15)&&(selectedEl=document.body),selectedEl}function isFullscreen(){return Boolean(vendor&&document[vendor.element])}function requestFullscreen(options,requestedEl){if(!vendor)return Promise.reject(new Error("fullscreen not supported"));var element=_selectElement(requestedEl);if("function"!=typeof element[vendor.requestFn])return Promise.reject(new Error("fullscreen not supported"));if(isFullscreen())return Promise.resolve();if(_returnsPromise())return element[vendor.requestFn](options);var namespace=".Fullscreen_requestFullscreen";return new Promise((function(resolve,reject){var $element=jQuery(element);$element.off(namespace).one("".concat(vendor.errorEvent).concat(namespace," ").concat(vendor.changeEvent).concat(namespace),(function(ev){$element.off(namespace),ev.type===vendor.errorEvent?reject(new Error("unknown fullscreen request error")):resolve()})),element[vendor.requestFn](options)}))}function exitFullscreen(){if(!vendor||"function"!=typeof document[vendor.exitFn])return Promise.reject(new TypeError("fullscreen not supported"));if(!isFullscreen())return Promise.reject(new TypeError("fullscreen mode not active"));if(_returnsPromise())return document[vendor.exitFn]();var namespace=".Fullscreen_exitFullscreen";return new Promise((function(resolve,reject){var $document=jQuery(document);$document.off(namespace).one("".concat(vendor.errorEvent).concat(namespace," ").concat(vendor.changeEvent).concat(namespace),(function(ev){$document.off(namespace),ev.type===vendor.errorEvent?reject(new Error("unknown fullscreen exit error")):resolve()})),document[vendor.exitFn]()}))}return Object.preventExtensions(Object.create(null,{vendor:{get:function(){return vendor}},element:{get:function(){return vendor?document[vendor.element]:null}},isEnabled:{value:function(){return Boolean(vendor&&document[vendor.isEnabled])}},isFullscreen:{value:isFullscreen},request:{value:requestFullscreen},exit:{value:exitFullscreen},toggle:{value:function(options,requestedEl){return isFullscreen()?exitFullscreen():requestFullscreen(options,requestedEl)}},onChange:{value:function(handlerFn,requestedEl){if(vendor){var element=_selectElement(requestedEl);jQuery(element).on(vendor.changeEvent,handlerFn)}}},offChange:{value:function(handlerFn,requestedEl){if(vendor){var element=_selectElement(requestedEl);handlerFn?jQuery(element).off(vendor.changeEvent,handlerFn):jQuery(element).off(vendor.changeEvent)}}},onError:{value:function(handlerFn,requestedEl){if(vendor){var element=_selectElement(requestedEl);jQuery(element).on(vendor.errorEvent,handlerFn)}}},offError:{value:function(handlerFn,requestedEl){if(vendor){var element=_selectElement(requestedEl);handlerFn?jQuery(element).off(vendor.errorEvent,handlerFn):jQuery(element).off(vendor.errorEvent)}}}}))}(),Outliner=function(){var lastEvent,styleEl=null;function outlinerHide(){document.documentElement.removeAttribute("data-outlines"),styleEl.styleSheet?styleEl.styleSheet.cssText="*:focus{outline:none;}":styleEl.textContent="*:focus{outline:none;}"}function outlinerShow(){document.documentElement.setAttribute("data-outlines",""),styleEl.styleSheet?styleEl.styleSheet.cssText="":styleEl.textContent=""}return Object.preventExtensions(Object.create(null,{init:{value:function(){styleEl||(styleEl=document.createElement("style"),jQuery(styleEl).attr({id:"style-outliner",type:"text/css"}).appendTo(document.head),jQuery(document).on("mousedown.style-outliner keydown.style-outliner",(function(ev){ev.type!==lastEvent&&(lastEvent=ev.type,"keydown"===ev.type?outlinerShow():outlinerHide())})),lastEvent="mousedown",outlinerHide())}},hide:{value:outlinerHide},show:{value:outlinerShow}}))}(),Serial=function(){var supportedTypes=Object.freeze([{id:"Date",get reference(){return Date.prototype},method:function(){return["(revive:date)",this.toISOString()]}},{id:"Function",get reference(){return Function.prototype},method:function(){return["(revive:)",["(".concat(this.toString(),")")]]}},{id:"Map",get reference(){return Map.prototype},method:function(){return["(revive:map)",Array.from(this)]}},{id:"RegExp",get reference(){return RegExp.prototype},method:function(){return["(revive:)",[this.toString()]]}},{id:"Set",get reference(){return Set.prototype},method:function(){return["(revive:set)",Array.from(this)]}}]);function createReviver(code,data){if("string"!=typeof code)throw new TypeError("Serial.createReviver code parameter must be a string");return["(revive:)",[code,data]]}function parse(text,reviver){return JSON.parse(text,(function(key,val){var value=val;if(value instanceof Array&&2===value.length)switch(value[0]){case"(revive:set)":value=new Set(value[1]);break;case"(revive:map)":value=new Map(value[1]);break;case"(revive:date)":value=new Date(value[1]);break;case"(revive:eval)":case"(revive:)":try{var $ReviveData$=value[1][1];value=eval(value[1][0])}catch(ex){}}if("function"==typeof reviver)try{value=reviver(key,value)}catch(ex){}return value}))}function stringify(value,replacer,space){var origMethodCache=new Map;supportedTypes.forEach((function(_ref3){var id=_ref3.id,reference=_ref3.reference,method=_ref3.method;Object.hasOwn(reference,"toJSON")&&origMethodCache.set(id,reference.toJSON),Object.defineProperty(reference,"toJSON",{configurable:!0,writable:!0,value:method})}));var notation=JSON.stringify(value,(function(key,val){var value=val;if("function"==typeof replacer)try{value=replacer(key,value)}catch(ex){}switch(_typeof(value)){case"undefined":value=["(revive:)","undefined"];break;case"Infinity":value=["(revive:)","Infinity"]}return value}),space);return supportedTypes.forEach((function(_ref4){var id=_ref4.id,reference=_ref4.reference;origMethodCache.has(id)?(Object.defineProperty(reference,"toJSON",{configurable:!0,writable:!0,value:origMethodCache.get(id)}),origMethodCache.delete(id)):delete reference.toJSON})),notation}return Object.preventExtensions(Object.create(null,{createReviver:{value:createReviver},parse:{value:parse},stringify:{value:stringify}}))}(),Visibility=(vendor=function(){try{return Object.freeze([{hiddenProperty:"hidden",stateProperty:"visibilityState",changeEvent:"visibilitychange"},{hiddenProperty:"webkitHidden",stateProperty:"webkitVisibilityState",changeEvent:"webkitvisibilitychange"},{hiddenProperty:"mozHidden",stateProperty:"mozVisibilityState",changeEvent:"mozvisibilitychange"},{hiddenProperty:"msHidden",stateProperty:"msVisibilityState",changeEvent:"msvisibilitychange"}].find((function(vnd){return vnd.hiddenProperty in document})))}catch(ex){}return undefined}(),Object.preventExtensions(Object.create(null,{vendor:{get:function(){return vendor}},state:{get:function(){return vendor&&document[vendor.stateProperty]||"visible"}},isEnabled:{value:function(){return Boolean(vendor)}},isHidden:{value:function(){return Boolean(vendor&&document[vendor.hiddenProperty])}},hiddenProperty:{value:vendor&&vendor.hiddenProperty},stateProperty:{value:vendor&&vendor.stateProperty},changeEvent:{value:vendor&&vendor.changeEvent}}))),vendor;function appendError(output,message,source){var $wrapper=jQuery(document.createElement("div")),$toggle=jQuery(document.createElement("button")),$source=jQuery(document.createElement("pre")),mesg="".concat(L10n.get("errorViewTitle"),": ").concat(message||"unknown error");return $toggle.addClass("error-toggle").ariaClick({label:L10n.get("errorViewLabelToggle")},(function(){$toggle.hasClass("enabled")?($toggle.removeClass("enabled"),$source.attr({"aria-hidden":!0,hidden:"hidden"})):($toggle.addClass("enabled"),$source.removeAttr("aria-hidden hidden"))})).appendTo($wrapper),jQuery(document.createElement("span")).addClass("error").text(mesg).appendTo($wrapper),jQuery(document.createElement("code")).text(source).appendTo($source),$source.addClass("error-source").attr({"aria-hidden":!0,hidden:"hidden"}).appendTo($wrapper),$wrapper.addClass("error-view").appendTo(output),console.warn("".concat(mesg,"\n\t").concat(source.replace(/\n/g,"\n\t"))),!1}var throwError=appendError;function charAndPosAt(string,position){var str=String(string),pos=Math.trunc(position),code=str.charCodeAt(pos);if(Number.isNaN(code))return{char:"",start:-1,end:-1};var retval={char:str.charAt(pos),start:pos,end:pos};if(code<55296||code>57343)return retval;if(code>=55296&&code<=56319){var nextPos=pos+1;if(nextPos>=str.length)return retval;var nextCode=str.charCodeAt(nextPos);return nextCode<56320||nextCode>57343||(retval.char=retval.char+str.charAt(nextPos),retval.end=nextPos),retval}if(0===pos)return retval;var prevPos=pos-1,prevCode=str.charCodeAt(prevPos);return prevCode<55296||prevCode>56319||(retval.char=str.charAt(prevPos)+retval.char,retval.start=prevPos),retval}function clone(O){if("object"!==_typeof(O)||null===O)return O;if("function"==typeof O.clone)return O.clone(!0);var copy;if(O instanceof Array)copy=new Array(O.length);else if(O instanceof Date)copy=new Date(O.getTime());else if(O instanceof Map)copy=new Map,O.forEach((function(val,key){return copy.set(clone(key),clone(val))}));else if(O instanceof RegExp)copy=new RegExp(O);else if(O instanceof Set)copy=new Set,O.forEach((function(val){return copy.add(clone(val))}));else{var type=getTypeOf(O);if("Object"!==type)throw new TypeError("attempted to clone unsupported type: ".concat(type));copy=Object.create(Object.getPrototypeOf(O))}return Object.keys(O).forEach((function(P){return copy[P]=clone(O[P])})),copy}var convertBreaks=function(){var isNotSpaceRE=new RegExp(Patterns.notSpace);function isParagraphEmpty(para){if(!para.hasChildNodes())return!0;for(var nodes=para.childNodes,length=nodes.length,i=0;i<length;++i){var node=nodes[i];switch(node.nodeType){case Node.TEXT_NODE:if(isNotSpaceRE.test(node.nodeValue))return!1;break;case Node.COMMENT_NODE:break;default:return!1}}return!0}return function(source){for(var node,output=document.createDocumentFragment(),para=document.createElement("p");null!==(node=source.firstChild);){if(node.nodeType===Node.ELEMENT_NODE)switch(node.nodeName.toUpperCase()){case"BR":if(null!==node.nextSibling&&node.nextSibling.nodeType===Node.ELEMENT_NODE&&"BR"===node.nextSibling.nodeName.toUpperCase()){source.removeChild(node.nextSibling),source.removeChild(node),isParagraphEmpty(para)||output.appendChild(para),para=document.createElement("p");continue}if(isParagraphEmpty(para)){source.removeChild(node);continue}break;case"ADDRESS":case"ARTICLE":case"ASIDE":case"BLOCKQUOTE":case"CENTER":case"DIV":case"DL":case"FIGURE":case"FOOTER":case"FORM":case"H1":case"H2":case"H3":case"H4":case"H5":case"H6":case"HEADER":case"HR":case"MAIN":case"NAV":case"OL":case"P":case"PRE":case"SECTION":case"TABLE":case"UL":isParagraphEmpty(para)||(output.appendChild(para),para=document.createElement("p")),output.appendChild(node);continue}para.appendChild(node)}isParagraphEmpty(para)||output.appendChild(para),source.appendChild(output)}}(),createFilename=(illegalCharsRE=/[\x00-\x1f"#$%&'*+,/:;<=>?\\^`|\x7f-\x9f]+/g,function(str){return String(str).trim().replace(illegalCharsRE,"")}),illegalCharsRE,createSlug=function(){var illegalCharsRE=/[\x00-\x20!-/:-@[-^`{-\x9f]+/g,isInvalidSlugRE=/^-*$/,storySigilRE=/^\$/,tempSigilRE=/^_/;return function(str){var base=String(str).trim(),legacy=base.replace(/[^\w\s\u2013\u2014-]+/g,"").replace(/[_\s\u2013\u2014-]+/g,"-").toLocaleLowerCase();return isInvalidSlugRE.test(legacy)?base.replace(storySigilRE,"").replace(tempSigilRE,"-").replace(illegalCharsRE,""):legacy}}();function cssPropToDOMProp(cssName){if(!cssName.includes("-"))switch(cssName){case"bgcolor":return"backgroundColor";case"float":return"cssFloat";default:return cssName}return("-ms-"===cssName.slice(0,4)?cssName.slice(1):cssName).split("-").map((function(part,i){return 0===i?part:part.toUpperFirst()})).join("")}var cssTimeToMS=(cssTimeRE=/^([+-]?(?:\d*\.)?\d+)([Mm]?[Ss])$/,function(cssTime){var match=cssTimeRE.exec(String(cssTime));if(null===match)throw new SyntaxError('invalid time value syntax: "'.concat(cssTime,'"'));var msec=Number(match[1]);if(1===match[2].length&&(msec*=1e3),Number.isNaN(msec)||!Number.isFinite(msec))throw new RangeError('invalid time value: "'.concat(cssTime,'"'));return msec}),cssTimeRE,decodeEntities=(escapedHtmlRE=/&(?:amp|#38|#x26|lt|#60|#x3c|gt|#62|#x3e|quot|#34|#x22|apos|#39|#x27|#96|#x60);/gi,hasEscapedHtmlRE=new RegExp(escapedHtmlRE.source,"i"),escapedHtmlTable=enumFrom({"&amp;":"&","&#38;":"&","&#x26;":"&","&lt;":"<","&#60;":"<","&#x3c;":"<","&gt;":">","&#62;":">","&#x3e;":">","&quot;":'"',"&#34;":'"',"&#x22;":'"',"&apos;":"'","&#39;":"'","&#x27;":"'","&#96;":"`","&#x60;":"`"}),function(str){if(null==str)return"";var val=String(str);return val&&hasEscapedHtmlRE.test(val)?val.replace(escapedHtmlRE,(function(entity){return escapedHtmlTable[entity.toLowerCase()]})):val}),escapedHtmlRE,hasEscapedHtmlRE,escapedHtmlTable,encodeEntities=(htmlCharsRE=/[&<>"'`]/g,hasHtmlCharsRE=new RegExp(htmlCharsRE.source),htmlCharsTable=enumFrom({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","`":"&#96;"}),function(str){if(null==str)return"";var val=String(str);return val&&hasHtmlCharsRE.test(val)?val.replace(htmlCharsRE,(function(ch){return htmlCharsTable[ch]})):val}),htmlCharsRE,hasHtmlCharsRE,htmlCharsTable,encodeMarkup=(markupCharsRE=/[!"#$&'*\-/<=>?@[\\\]^_`{|}~]/g,hasMarkupCharsRE=new RegExp(markupCharsRE.source),markupCharsTable=enumFrom({"!":"&#33;",'"':"&quot;","#":"&#35;",$:"&#36;","&":"&amp;","'":"&#39;","*":"&#42;","-":"&#45;","/":"&#47;","<":"&lt;","=":"&#61;",">":"&gt;","?":"&#63;","@":"&#64;","[":"&#91;","\\":"&#92;","]":"&#93;","^":"&#94;",_:"&#95;","`":"&#96;","{":"&#123;","|":"&#124;","}":"&#125;","~":"&#126;"}),function(str){if(null==str)return"";var val=String(str);return val&&hasMarkupCharsRE.test(val)?val.replace(markupCharsRE,(function(ch){return markupCharsTable[ch]})):val}),markupCharsRE,hasMarkupCharsRE,markupCharsTable,enquote=(unescapedDQuoteRE=/(^|[^\\])(")/g,unescapedSQuoteRE=/(^|[^\\])(')/g,function(string){for(var dqCount=0,sqCount=0,i=0;i<string.length;++i)switch(string[i]){case"\\":++i;break;case'"':++dqCount;break;case"'":++sqCount}if(0===dqCount)return'"'.concat(string,'"');if(0===sqCount)return"'".concat(string,"'");var quote=dqCount<=sqCount?'"':"'";return"".concat(quote).concat(string.replace('"'===quote?unescapedDQuoteRE:unescapedSQuoteRE,"$1\\$2")).concat(quote)}),unescapedDQuoteRE,unescapedSQuoteRE;function enumFrom(O){var pEnum=Object.create(null);if(O instanceof Array)O.forEach((function(val,i){return pEnum[String(val)]=i}));else if(O instanceof Set)Array.from(O).forEach((function(val,i){return pEnum[String(val)]=i}));else if(O instanceof Map)O.forEach((function(val,key){return pEnum[String(key)]=val}));else{if(null===O||"object"!==_typeof(O)||Object.getPrototypeOf(O)!==Object.prototype)throw new TypeError("enumFrom object parameter must be an Array, Map, Set, or generic object");Object.assign(pEnum,O)}return Object.freeze(Object.defineProperties(pEnum,{nameFrom:{value:function(needle){var entry=Object.entries(this).find((function(entry){return entry[1]===needle}));return entry?entry[0]:undefined}}}))}var exceptionFrom=(extraProps=Object.freeze(["code","data","result","stack","columnNumber","fileName","lineNumber","description","number"]),function(original,exceptionType,override){if(null===original||"object"!==_typeof(original))throw new Error("exceptionFrom original parameter must be an object");if("function"!=typeof exceptionType)throw new Error("exceptionFrom exceptionType parameter must be an error type constructor");var overrideType=_typeof(override);if("undefined"!==overrideType&&"string"!==overrideType&&"object"!==overrideType)throw new Error("exceptionFrom override parameter must be an object or string");var propValues=new Map;extraProps.forEach((function(name){void 0!==original[name]&&propValues.set(name,original[name])})),"string"===overrideType?propValues.set("message",override):"object"===overrideType&&null!==override&&Object.getOwnPropertyNames(override).forEach((function(name){void 0!==override[name]&&propValues.set(name,override[name])}));var ex=new exceptionType(propValues.get("message"));return propValues.delete("message"),propValues.forEach((function(value,name){void 0===ex[name]?Object.defineProperty(ex,name,{value:value,configurable:!0,writable:!0}):ex[name]=value})),ex}),extraProps;function getActiveElement(){try{return document.activeElement||null}catch(ex){return null}}function getErrorMessage(O){return null==O?"unknown error":"object"===_typeof(O)&&"message"in O?O.message:String(O)}var getToStringTag=(toString=Object.prototype.toString,slice=String.prototype.slice,"[object Object]"===toString.call(new Map)?function(O){return O instanceof Map?"Map":O instanceof Set?"Set":slice.call(toString.call(O),8,-1)}:function(O){return slice.call(toString.call(O),8,-1)}),toString,slice,getTypeOf=function(){var toString=Object.prototype.toString,slice=String.prototype.slice;return function(O){if(null===O)return"null";var baseType=_typeof(O);return"object"===baseType?slice.call(toString.call(O),8,-1):baseType}}(),hasMediaQuery="function"!=typeof window.matchMedia?function(){return!1}:function(mediaQuery){return window.matchMedia(mediaQuery).matches},isExternalLink=(externalUrlRE=new RegExp("^".concat(Patterns.externalUrl),"gim"),fingerprintRE=/[/\\?]/,function(link){return!Story.has(link)&&(externalUrlRE.test(link)||fingerprintRE.test(link))}),externalUrlRE,fingerprintRE;function msToCSSTime(msec){if("number"!=typeof msec||Number.isNaN(msec)||!Number.isFinite(msec)){var what;switch(_typeof(msec)){case"string":what='"'.concat(msec,'"');break;case"number":what=String(msec);break;default:what=getTypeOf(msec)}throw new TypeError("invalid milliseconds value: ".concat(what))}return"".concat(msec,"ms")}var now=(clock=Has.performance?performance:Date,function(){return clock.now()}),clock,onUserActivation=(uaEvents=Object.freeze(["keydown","mousedown","pointerdown","pointerup","touchend"]),function(namespace,callback){jQuery(document).off(namespace).on(uaEvents.map((function(name){return"".concat(name).concat(namespace)})).join(" "),(function(ev){callback(ev).then((function(){return jQuery(document).off(namespace)}),(function(ex){if("NotAllowedError"!==ex.name)throw jQuery(document).off(namespace),ex}))}))}),uaEvents;function parseURL(url){var parser=document.createElement("a"),searchParams=Object.create(null);parser.href=url,parser.search&&parser.search.replace(/^\?/,"").splitOrEmpty(/(?:&(?:amp;)?|;)/).forEach((function(query){var _query$split2=_slicedToArray(query.split("="),2),key=_query$split2[0],value=_query$split2[1];Object.hasOwn(searchParams,key)?searchParams[key].push(value):searchParams[key]=[value]}));var pathname=parser.host&&"/"!==parser.pathname[0]?"/".concat(parser.pathname):parser.pathname;return Object.freeze(Object.assign(Object.create(null),{href:parser.href,protocol:parser.protocol,host:parser.host,hostname:parser.hostname,port:parser.port,path:"".concat(pathname).concat(parser.search),pathname:pathname,search:parser.search,searchParams:Object.freeze(searchParams),hash:parser.hash}))}function sameValueZero(a,b){return a===b||a!=a&&b!=b}var scrubEventKey=function(){var separatorKey,decimalKey;if("undefined"!=typeof Intl&&"function"==typeof Intl.NumberFormat){var match=(new Intl.NumberFormat).format(111111.5).match(/(\D*)\d+(\D*)\d$/);match&&(separatorKey=match[1],decimalKey=match[2])}return separatorKey||decimalKey||(separatorKey=",",decimalKey="."),function(key){switch(key){case"Scroll":return"ScrollLock";case"Spacebar":return" ";case"Left":return"ArrowLeft";case"Right":return"ArrowRight";case"Up":return"ArrowUp";case"Down":return"ArrowDown";case"Del":return"Delete";case"Crsel":return"CrSel";case"Exsel":return"ExSel";case"Esc":return"Escape";case"Apps":return"ContextMenu";case"Nonconvert":return"NonConvert";case"MediaNextTrack":return"MediaTrackNext";case"MediaPreviousTrack":return"MediaTrackPrevious";case"VolumeUp":return"AudioVolumeUp";case"VolumeDown":return"AudioVolumeDown";case"VolumeMute":return"AudioVolumeMute";case"Zoom":return"ZoomToggle";case"SelectMedia":case"MediaSelect":return"LaunchMediaPlayer";case"Add":return"+";case"Divide":return"/";case"Multiply":return"*";case"Subtract":return"-";case"Decimal":return decimalKey;case"Separator":return separatorKey}return key}}(),setDisplayTitle=function(title,isPlainText){if("string"!=typeof title)throw new TypeError("title parameter must be a string (received: ".concat(getTypeOf(title),")"));var render,text;isPlainText?text=render=title.trim():(render=document.createDocumentFragment(),new Wikifier(render,title,{noCleanup:!0}),text=function(source){for(var node,copy=source.cloneNode(!0),frag=document.createDocumentFragment();null!==(node=copy.firstChild);){if(node.nodeType===Node.ELEMENT_NODE)switch(node.nodeName.toUpperCase()){case"BR":case"DIV":case"P":frag.appendChild(document.createTextNode(" "))}frag.appendChild(node)}return frag.textContent}(render).trim()),document.title=Config.passages.displayTitles&&""!==State.passage&&State.passage!==Config.passages.start?"".concat(State.passage," | ").concat(text):text,jQuery("#story-title").empty().append(render)};function setPageElement(idOrElement,titles,defaultText){var el="object"===_typeof(idOrElement)?idOrElement:document.getElementById(idOrElement);if(null==el)return null;var ids=titles instanceof Array?titles:[titles];jQuery(el).empty();for(var i=0;i<ids.length;++i)if(Story.has(ids[i]))return new Wikifier(el,Story.get(ids[i]).processText().trim()),el;if(null!=defaultText){var text=String(defaultText).trim();""!==text&&new Wikifier(el,text)}return el}function stringFrom(value){switch(_typeof(value)){case"function":return"[function]";case"number":if(Number.isNaN(value))return"[number NaN]";break;case"object":if(null===value)return"[null]";if(value instanceof Array)return value.map((function(val){return stringFrom(val)})).join(", ");if(value instanceof Set)return Array.from(value).map((function(val){return stringFrom(val)})).join(", ");if(value instanceof Map){var result=Array.from(value).map((function(_ref5){var _ref6=_slicedToArray(_ref5,2),key=_ref6[0],val=_ref6[1];return"".concat(stringFrom(key)," → ").concat(stringFrom(val))}));return"{ ".concat(result.join(", ")," }")}if(value instanceof Date)return value.toLocaleString();if(value instanceof Element){if(value===document.documentElement||value===document.head||value===document.body)throw new Error("illegal operation; attempting to convert the <html>, <head>, or <body> tags to string is not allowed");return value.outerHTML}if(value instanceof Node)return value.textContent;break;case"symbol":var desc=void 0!==value.description?' "'.concat(value.description,'"'):"";return"[symbol".concat(desc,"]");case"undefined":return"[undefined]"}return String(value)}var triggerEvent=(createEvent=function(){try{return new CustomEvent("click",{bubbles:!0}),function(name,options){for(var _Object$assign=Object.assign({bubbles:!0,cancelable:!0,composed:!1},options),bubbles=_Object$assign.bubbles,cancelable=_Object$assign.cancelable,composed=_Object$assign.composed,detail=_Object$assign.detail,custom=_objectWithoutProperties(_Object$assign,_excluded),event=new CustomEvent(name,{bubbles:bubbles,cancelable:cancelable,composed:composed,detail:detail}),i=0,keys=Object.keys(custom);i<keys.length;++i){var key=keys[i];void 0!==custom[key]&&(event[key]=options[key])}return event}}catch(ex){return function(name,options){for(var _Object$assign2=Object.assign({bubbles:!0,cancelable:!0},options),bubbles=_Object$assign2.bubbles,cancelable=_Object$assign2.cancelable,custom=_objectWithoutProperties(_Object$assign2,_excluded2),event=document.createEvent("Event"),i=0,keys=Object.keys(custom);i<keys.length;++i){var key=keys[i];void 0!==custom[key]&&(event[key]=options[key])}return event.initEvent(name,bubbles,cancelable),event}}}(),function(name,targets,options){var event=createEvent(name,options),elems=[];if(targets)if(targets instanceof jQuery||targets instanceof NodeList||targets instanceof Array)for(var i=0;i<targets.length;++i)elems.push(targets[i]);else elems.push(targets);else elems.push(document);for(var _i5=0;_i5<elems.length;++_i5)elems[_i5].dispatchEvent(event)}),createEvent,SimpleStore=(_adapters=[],_initialized=null,Object.preventExtensions(Object.create(null,{adapters:{value:_adapters},create:{value:function(storageId,persistent){if(_initialized)return _initialized.create(storageId,persistent);for(var i=0;i<_adapters.length;++i)if(_adapters[i].init(storageId,persistent))return(_initialized=_adapters[i]).create(storageId,persistent);throw new Error("No valid storage adapters found")}}}))),_adapters,_initialized,_MAX_EXPIRY,_MIN_EXPIRY,_ok,CookieAdapter;SimpleStore.adapters.push(function(){var _ok=!1,WebStorageAdapter=function(){function WebStorageAdapter(storageId,persistent){_classCallCheck(this,WebStorageAdapter);var prefix="".concat(storageId,"."),engine=null,name=null;persistent?(engine=window.localStorage,name="localStorage"):(engine=window.sessionStorage,name="sessionStorage"),Object.defineProperties(this,{_engine:{value:engine},_prefix:{value:prefix},_prefixRe:{value:new RegExp("^".concat(RegExp.escape(prefix)))},name:{value:name},id:{value:storageId},persistent:{value:Boolean(persistent)}})}return _createClass(WebStorageAdapter,[{key:"size",get:function(){return this.keys().length}},{key:"keys",value:function(){for(var keys=[],i=0;i<this._engine.length;++i){var key=this._engine.key(i);this._prefixRe.test(key)&&keys.push(key.replace(this._prefixRe,""))}return keys}},{key:"has",value:function(key){return!("string"!=typeof key||!key)&&Object.hasOwn(this._engine,this._prefix+key)}},{key:"get",value:function(key){if("string"!=typeof key||!key)return null;var value=this._engine.getItem(this._prefix+key);return null==value?null:WebStorageAdapter._deserialize(value)}},{key:"set",value:function(key,value){if("string"!=typeof key||!key)return!1;try{this._engine.setItem(this._prefix+key,WebStorageAdapter._serialize(value))}catch(ex){if(isQuotaDOMException(ex))throw exceptionFrom(ex,Error,{cause:{origin:ex},message:"".concat(this.name," quota exceeded")});throw ex}return!0}},{key:"delete",value:function(key){return!("string"!=typeof key||!key)&&(this._engine.removeItem(this._prefix+key),!0)}},{key:"clear",value:function(){for(var keys=this.keys(),i=0,length=keys.length;i<length;++i)this.delete(keys[i]);return!0}}],[{key:"_serialize",value:function(obj){return LZString.compressToUTF16(Serial.stringify(obj))}},{key:"_deserialize",value:function(str){return Serial.parse(LZString.decompressFromUTF16(str))}}])}();var isQuotaErrorRE=/quota.?(?:exceeded|reached)/i;function isQuotaDOMException(ex){return ex instanceof DOMException&&(22===ex.code||1014===ex.code||isQuotaErrorRE.test(ex.name)||isQuotaErrorRE.test(ex.message))}return Object.preventExtensions(Object.create(null,{init:{value:function(){function hasWebStorage(storeId){var store;try{store=window[storeId];var val="_sc_".concat(String(Date.now()));store.setItem(val,val);var result=store.getItem(val)===val;return store.removeItem(val),result}catch(ex){return store&&0!==store.length&&isQuotaDOMException(ex)}}return _ok=hasWebStorage("localStorage")&&hasWebStorage("sessionStorage")}},create:{value:function(storageId,persistent){if(!_ok)throw new Error("adapter not initialized");return new WebStorageAdapter(storageId,persistent)}}}))}()),SimpleStore.adapters.push((_MAX_EXPIRY="Tue, 19 Jan 2038 03:14:07 GMT",_MIN_EXPIRY="Thu, 01 Jan 1970 00:00:00 GMT",_ok=!1,CookieAdapter=function(){function CookieAdapter(storageId,persistent){_classCallCheck(this,CookieAdapter);var prefix="".concat(storageId).concat(persistent?"!":"*",".");Object.defineProperties(this,{_prefix:{value:prefix},_prefixRe:{value:new RegExp("^".concat(RegExp.escape(prefix)))},name:{value:"cookie"},id:{value:storageId},persistent:{value:Boolean(persistent)}})}return _createClass(CookieAdapter,[{key:"size",get:function(){return this.keys().length}},{key:"keys",value:function(){if(""===document.cookie)return[];for(var cookies=document.cookie.split(/;\s*/),keys=[],i=0;i<cookies.length;++i){var kvPair=cookies[i].split("="),key=decodeURIComponent(kvPair[0]);this._prefixRe.test(key)&&""!==decodeURIComponent(kvPair[1])&&keys.push(key.replace(this._prefixRe,""))}return keys}},{key:"has",value:function(key){return!("string"!=typeof key||!key)&&null!==CookieAdapter._getCookie(this._prefix+key)}},{key:"get",value:function(key){if("string"!=typeof key||!key)return null;var value=CookieAdapter._getCookie(this._prefix+key);return null===value?null:CookieAdapter._deserialize(value)}},{key:"set",value:function(key,value){if("string"!=typeof key||!key)return!1;try{if(CookieAdapter._setCookie(this._prefix+key,CookieAdapter._serialize(value),this.persistent?_MAX_EXPIRY:undefined),!this.has(key))throw new Error("unknown validation error during set")}catch(ex){throw exceptionFrom(ex,Error,{cause:{origin:ex},message:"cookie error: ".concat(ex.message)})}return!0}},{key:"delete",value:function(key){if("string"!=typeof key||!key||!this.has(key))return!1;try{if(CookieAdapter._setCookie(this._prefix+key,undefined,_MIN_EXPIRY),this.has(key))throw new Error("unknown validation error during delete")}catch(ex){throw exceptionFrom(ex,Error,{cause:{origin:ex},message:"cookie error: ".concat(ex.message)})}return!0}},{key:"clear",value:function(){for(var keys=this.keys(),i=0,length=keys.length;i<length;++i)this.delete(keys[i]);return!0}}],[{key:"_getCookie",value:function(prefixedKey){if(!prefixedKey||""===document.cookie)return null;for(var cookies=document.cookie.split(/;\s*/),i=0;i<cookies.length;++i){var kvPair=cookies[i].split("=");if(prefixedKey===decodeURIComponent(kvPair[0]))return decodeURIComponent(kvPair[1])||null}return null}},{key:"_setCookie",value:function(prefixedKey,value,expiry){if(prefixedKey){var payload="".concat(encodeURIComponent(prefixedKey),"=");null!=value&&(payload+=encodeURIComponent(value)),null!=expiry&&(payload+="; expires=".concat(expiry)),payload+="; path=/",document.cookie=payload}}},{key:"_serialize",value:function(obj){return LZString.compressToBase64(Serial.stringify(obj))}},{key:"_deserialize",value:function(str){return Serial.parse(LZString.decompressFromBase64(str))}}])}(),Object.preventExtensions(Object.create(null,{init:{value:function(storageId){try{var tid="_sc_".concat(String(Date.now()));CookieAdapter._setCookie(tid,CookieAdapter._serialize(tid),undefined),_ok=CookieAdapter._deserialize(CookieAdapter._getCookie(tid))===tid,CookieAdapter._setCookie(tid,undefined,_MIN_EXPIRY)}catch(ex){_ok=!1}return _ok&&function(storageId){if(""!==document.cookie)for(var oldPrefix="".concat(storageId,"."),oldPrefixRe=new RegExp("^".concat(RegExp.escape(oldPrefix))),persistPrefix="".concat(storageId,"!."),sessionPrefix="".concat(storageId,"*."),sessionTestRe=/\.(?:state|rcWarn)$/,cookies=document.cookie.split(/;\s*/),_loop=function(){var kvPair=cookies[i].split("="),key=decodeURIComponent(kvPair[0]);if(oldPrefixRe.test(key)){var value=decodeURIComponent(kvPair[1]);if(""!==value){var persist=!sessionTestRe.test(key);CookieAdapter._setCookie(key,undefined,_MIN_EXPIRY),CookieAdapter._setCookie(key.replace(oldPrefixRe,(function(){return persist?persistPrefix:sessionPrefix})),value,persist?_MAX_EXPIRY:undefined)}}},i=0;i<cookies.length;++i)_loop()}(storageId),_ok}},create:{value:function(storageId,persistent){if(!_ok)throw new Error("adapter not initialized");return new CookieAdapter(storageId,persistent)}}}))));var DebugView=function(){function DebugView(parent,type,name,title){_classCallCheck(this,DebugView),Object.defineProperties(this,{parent:{value:parent},view:{value:document.createElement("span")},break:{value:document.createElement("wbr")}}),jQuery(this.view).attr({title:title,"aria-label":title,"data-type":null!=type?type:"","data-name":null!=name?name:""}).addClass("debug"),jQuery(this.break).addClass("debug hidden"),this.parent.appendChild(this.view),this.parent.appendChild(this.break)}return _createClass(DebugView,[{key:"output",get:function(){return this.view}},{key:"type",get:function(){return this.view.getAttribute("data-type")},set:function(type){this.view.setAttribute("data-type",null!=type?type:"")}},{key:"name",get:function(){return this.view.getAttribute("data-name")},set:function(name){this.view.setAttribute("data-name",null!=name?name:"")}},{key:"title",get:function(){return this.view.title},set:function(title){this.view.title=title}},{key:"append",value:function(el){return jQuery(this.view).append(el),this}},{key:"modes",value:function(options){if(null==options){var current={};return this.view.className.splitOrEmpty(/\s+/).forEach((function(name){"debug"!==name&&(current[name]=!0)})),current}if("object"===_typeof(options))return Object.keys(options).forEach((function(name){this[options[name]?"addClass":"removeClass"](name)}),jQuery(this.view)),this;throw new Error("DebugView.prototype.modes options parameter must be an object or null/undefined")}},{key:"remove",value:function(){var $view=jQuery(this.view);this.view.hasChildNodes()&&$view.contents().appendTo(this.parent),$view.remove(),jQuery(this.break).remove()}}],[{key:"isEnabled",value:function(){return"enabled"===jQuery(document.documentElement).attr("data-debug-view")}},{key:"enable",value:function(){jQuery(document.documentElement).attr("data-debug-view","enabled"),triggerEvent(":debugviewupdate")}},{key:"disable",value:function(){jQuery(document.documentElement).removeAttr("data-debug-view"),triggerEvent(":debugviewupdate")}},{key:"toggle",value:function(){DebugView.isEnabled()?DebugView.disable():DebugView.enable()}}])}(),NodeTyper=function(){return _createClass((function NodeTyper(config){if(_classCallCheck(this,NodeTyper),"object"!==_typeof(config)||null===config)throw new Error("config parameter must be an object (received: ".concat(getTypeOf(config),")"));if(!(Object.hasOwn(config,"targetNode")&&config.targetNode instanceof Node))throw new Error('config parameter object "targetNode" property must be a node');Object.defineProperties(this,{node:{value:config.targetNode},childNodes:{value:[]},nodeValue:{writable:!0,value:""},appendTo:{writable:!0,value:config.parentNode||null},classNames:{writable:!0,value:config.classNames||null},finished:{writable:!0,value:!1}});var childNode,node=this.node;for(node.nodeValue&&(this.nodeValue=node.nodeValue,node.nodeValue="");null!==(childNode=node.firstChild);)this.childNodes.push(new NodeTyper({targetNode:childNode,parentNode:node,classNames:this.classNames})),node.removeChild(childNode)}),[{key:"finish",value:function(){for(;this.type(!0););return!1}},{key:"type",value:function(flush){if(this.finished)return!1;if(this.appendTo){if(this.appendTo.appendChild(this.node),this.appendTo=null,this.node.nodeType!==Node.ELEMENT_NODE&&this.node.nodeType!==Node.TEXT_NODE||"none"===jQuery(this.node.parentNode).css("display"))return this.finish();this.node.parentNode&&this.classNames&&jQuery(this.node.parentNode).addClass(this.classNames)}if(this.nodeValue){if(flush)this.node.nodeValue+=this.nodeValue,this.nodeValue="";else{var _charAndPosAt=charAndPosAt(this.nodeValue,0),char=_charAndPosAt.char,start=_charAndPosAt.start,end=_charAndPosAt.end;this.node.nodeValue+=char,this.nodeValue=this.nodeValue.slice(1+end-start)}return!0}this.classNames&&(jQuery(this.node.parentNode).removeClass(this.classNames),this.classNames=null);for(var childNodes=this.childNodes;childNodes.length>0;){if(childNodes[0].type())return!0;childNodes.shift()}return this.finished=!0,!1}}])}(),StyleWrapper=(_imageMarkupRe=new RegExp(Patterns.cssImage,"g"),_hasImageMarkupRe=new RegExp(Patterns.cssImage),function(){return _createClass((function StyleWrapper(style){if(_classCallCheck(this,StyleWrapper),null==style)throw new TypeError("StyleWrapper style parameter must be an HTMLStyleElement object");Object.defineProperties(this,{style:{value:style}})}),[{key:"isEmpty",value:function(){return 0===this.style.cssRules.length}},{key:"set",value:function(rawCss){this.clear(),this.add(rawCss)}},{key:"add",value:function(rawCss){var css=rawCss;_hasImageMarkupRe.test(css)&&(_imageMarkupRe.lastIndex=0,css=css.replace(_imageMarkupRe,(function(wikiImage){var markup=Wikifier.helpers.parseSquareBracketedMarkup({source:wikiImage,matchStart:0});if(Object.hasOwn(markup,"error")||markup.pos<wikiImage.length)return wikiImage;var source=markup.source;if("data:"!==source.slice(0,5)&&Story.has(source)){var passage=Story.get(source);passage.tags.includes("Twine.image")&&(source=passage.text.trim())}return'url("'.concat(source.replace(/"/g,"%22"),'")')}))),this.style.styleSheet?this.style.styleSheet.cssText+=css:this.style.appendChild(document.createTextNode(css))}},{key:"clear",value:function(){this.style.styleSheet?this.style.styleSheet.cssText="":jQuery(this.style).empty()}}])}()),_imageMarkupRe,_hasImageMarkupRe,Diff=function(){var Op=enumFrom({Delete:0,SpliceArray:1,Copy:2,CopyDate:3});function isNumeric(O){var num;switch(_typeof(O)){case"number":num=O;break;case"string":num=Number(O);break;default:return!1}return!Number.isNaN(num)&&Number.isFinite(num)}return Object.preventExtensions(Object.create(null,{Op:{value:Op},diff:{value:function diff(a,b){for(var aOpKey,toString=Object.prototype.toString,aIsArray=a instanceof Array,delta=Object.create(null),keys=[].concat(_toConsumableArray(Object.keys(a)),_toConsumableArray(Object.keys(b))).sort().filter((function(val,i,arr){return 0===i||arr[i-1]!==val})),isAOpKey=function(key){return key===aOpKey},i=0,klen=keys.length;i<klen;++i){var key=keys[i],aVal=a[key],bVal=b[key];if(Object.hasOwn(a,key))if(Object.hasOwn(b,key)){if(aVal===bVal)continue;if(_typeof(aVal)===_typeof(bVal))if("function"==typeof aVal)aVal.toString()!==bVal.toString()&&(delta[key]=[Op.Copy,bVal]);else if("object"!==_typeof(aVal)||null===aVal)delta[key]=[Op.Copy,bVal];else{var aValType=toString.call(aVal);if(aValType===toString.call(bVal))if(aVal instanceof Date)aVal.getTime()!==bVal.getTime()&&(delta[key]=[Op.Copy,clone(bVal)]);else if(aVal instanceof Map)delta[key]=[Op.Copy,clone(bVal)];else if(aVal instanceof RegExp)aVal.toString()!==bVal.toString()&&(delta[key]=[Op.Copy,clone(bVal)]);else if(aVal instanceof Set)delta[key]=[Op.Copy,clone(bVal)];else if(aVal instanceof Array||"[object Object]"===aValType){var subDelta=diff(aVal,bVal);null!==subDelta&&(delta[key]=subDelta)}else delta[key]=[Op.Copy,clone(bVal)];else delta[key]=[Op.Copy,clone(bVal)]}else delta[key]=[Op.Copy,"object"!==_typeof(bVal)||null===bVal?bVal:clone(bVal)]}else if(aIsArray&&isNumeric(key)){var index=Number(key);if(!aOpKey){aOpKey="";do{aOpKey+="~"}while(keys.some(isAOpKey));delta[aOpKey]=[Op.SpliceArray,index,index]}index<delta[aOpKey][1]&&(delta[aOpKey][1]=index),index>delta[aOpKey][2]&&(delta[aOpKey][2]=index)}else delta[key]=Op.Delete;else delta[key]=[Op.Copy,"object"!==_typeof(bVal)||null===bVal?bVal:clone(bVal)]}return Object.keys(delta).length>0?delta:null}},patch:{value:function patch(orig,delta){for(var keys=delta?Object.keys(delta):[],patched=clone(orig),i=0,klen=keys.length;i<klen;++i){var key=keys[i],value=delta[key];if(value===Op.Delete)delete patched[key];else if(value instanceof Array)switch(value[0]){case Op.SpliceArray:patched.splice(value[1],value[2]-value[1]+1);break;case Op.Copy:patched[key]=clone(value[1]);break;case Op.CopyDate:patched[key]=new Date(value[1])}else patched[key]=patch(patched[key],value)}return patched}}}))}(),L10n=(replaceRE=/\{\w+\}/g,hasReplaceRE=new RegExp(replaceRE.source),Object.preventExtensions(Object.create(null,{init:{value:function(){}},get:{value:function(ids,overrides){if(!ids)return"";var id=(Array.isArray(ids)?ids:[ids]).find((function(id){return Object.hasOwn(l10nStrings,id)}));if(!id)return"";for(var value=l10nStrings[id],i=0;hasReplaceRE.test(value);){if(++i>50)throw new Error("L10n.get exceeded maximum replacement depth, probable infinite loop");replaceRE.lastIndex=0,value=value.replace(replaceRE,(function(replacement){var rid=replacement.slice(1,-1);return overrides&&Object.hasOwn(overrides,rid)?overrides[rid]:Object.hasOwn(l10nStrings,rid)?l10nStrings[rid]:void 0}))}return value}}}))),replaceRE,hasReplaceRE,l10nStrings={textAbort:"Abort",textAborting:"Aborting",textCancel:"Cancel",textClear:"Clear",textClose:"Close",textDelete:"Delete",textExport:"Export",textIdentity:"game",textImport:"Import",textLoad:"Load",textOff:"Off",textOk:"OK",textOn:"On",textSave:"Save",textTurn:"Turn",errorNonexistentPassage:'the passage "{passage}" does not exist',warningNoStorage:"All usable storage APIs are missing. Possible causes are a disabled third-party cookie setting, which also affects Web Storage, or a private browsing mode.",warningNoWebStorage:"The Web Storage API is missing, so this {textIdentity} is running in a degraded mode. You may be able to continue, however, some parts may not work properly.",warningDegraded:"Some capabilities required to support this {textIdentity} are missing, so it is running in a degraded mode. You may be able to continue, however, some parts may not work properly.",warningNoSaves:"Some capabilities required to support saves are missing, so saves have been disabled for this session.",saveErrorDisallowed:"Saving is currently disallowed.",saveErrorDecodeFail:"unable to decode save, likely due to corruption",saveErrorDiskLoadFail:"failed to load save file from disk",saveErrorIdMismatch:"save is from the wrong {textIdentity}",saveErrorInvalidData:"save is missing required data, likely due to corruption",saveErrorNonexistent:"save does not exist",uiBarLabelToggle:"Toggle the UI bar",uiBarLabelBackward:"Go backward within the {textIdentity} history",uiBarLabelForward:"Go forward within the {textIdentity} history",uiBarLabelJumpto:"Jump to a specific point within the {textIdentity} history",alertTitle:"Alert",restartTitle:"Restart",restartMesgPrompt:"All unsaved progress will be lost. Are you sure that you want to restart?",continueTitle:"Continue",savesTitle:"Saves",savesHeaderBrowser:"In Browser",savesHeaderDisk:"On Disk",savesLabelBrowserClear:"Clear all browser saves",savesLabelBrowserExport:"Export browser saves to bundle",savesLabelBrowserImport:"Import browser saves from bundle",savesLabelDiskLoad:"Load from disk",savesLabelDiskSave:"Save to disk",savesTextBrowserAuto:"Auto",savesTextBrowserSlot:"Slot",savesTextNoDate:"unknown date",settingsTitle:"Settings",settingsTextReset:"Reset to Defaults",errorViewTitle:"Error",errorViewLabelToggle:"Toggle the error view",debugBarLabelToggle:"Toggle the debug bar",debugBarLabelViewsToggle:"Toggle the debug views",debugBarLabelWatchAdd:"Add a new watch",debugBarLabelWatchAll:"Watch all",debugBarLabelWatchClear:"Clear all watches",debugBarLabelWatchDelete:"Delete this watch",debugBarLabelWatchPlaceholder:"variable name",debugBarLabelPassagePlaceholder:"passage name",debugBarLabelPassagePlay:"Play passage",debugBarLabelWatchToggle:"Toggle the watch panel",debugBarMesgNoWatches:"No watches set",debugBarTextAdd:"Add",debugBarTextPassage:"Passage",debugBarTextViews:"Views",debugBarTextWatch:"Watch",macroBackText:"Back",macroReturnText:"Return",autoloadTitle:"Autoload",autoloadMesgPrompt:"An autosave exists. Load it now or go to the start?",autoloadTextCancel:"Go to start",autoloadTextOk:"Load autosave",jumptoTitle:"Jump To",jumptoMesgUnavailable:"No jump points currently available…",shareTitle:"Share"},Config=(_addVisitedLinkClass=!1,_cleanupWikifierOutput=!1,_debug=!1,_enableOptionalDebugging=!1,_loadDelay=0,_audioPauseOnFadeToZero=!0,_audioPreloadMetadata=!0,_historyControls=!0,_historyMaxStates=40,_macrosMaxLoopIterations=1e3,_macrosTypeSkipKey=" ",_macrosTypeVisitedPassages=!0,_passagesDisplayTitles=!1,_passagesNobr=!1,_savesMaxAuto=0,_savesMaxSlot=8,_uiStowBarInitially=800,_uiUpdateStoryElements=!0,errPassagesDescriptionsDeprecated="[DEPRECATED] Config.passages.descriptions has been deprecated, see Config.saves.descriptions instead",errSavesAutoloadDeprecated="[DEPRECATED] Config.saves.autoload has been deprecated, see the Save.browser.continue API instead",_baseSavesAutosaveDeprecated="[DEPRECATED] Config.saves.autosave has been deprecated",errSavesOnLoadDeprecated="[DEPRECATED] Config.saves.onLoad has been deprecated, see the Save.onLoad API instead",errSavesOnSaveDeprecated="[DEPRECATED] Config.saves.onSave has been deprecated, see the Save.onSave API instead",errSavesSlotsDeprecated="[DEPRECATED] Config.saves.slots has been deprecated, see Config.saves.maxSlotSaves instead",Object.freeze({get addVisitedLinkClass(){return _addVisitedLinkClass},set addVisitedLinkClass(value){_addVisitedLinkClass=Boolean(value)},get cleanupWikifierOutput(){return _cleanupWikifierOutput},set cleanupWikifierOutput(value){_cleanupWikifierOutput=Boolean(value)},get debug(){return _debug},set debug(value){_debug=Boolean(value)},get enableOptionalDebugging(){return _enableOptionalDebugging},set enableOptionalDebugging(value){_enableOptionalDebugging=Boolean(value)},get loadDelay(){return _loadDelay},set loadDelay(value){if(!Number.isSafeInteger(value)||value<0)throw new RangeError("Config.loadDelay must be a non-negative integer");_loadDelay=value},audio:Object.freeze({get pauseOnFadeToZero(){return _audioPauseOnFadeToZero},set pauseOnFadeToZero(value){_audioPauseOnFadeToZero=Boolean(value)},get preloadMetadata(){return _audioPreloadMetadata},set preloadMetadata(value){_audioPreloadMetadata=Boolean(value)}}),history:Object.freeze({get controls(){return _historyControls},set controls(value){var controls=Boolean(value);if(1===_historyMaxStates&&controls)throw new Error("Config.history.controls must be false when Config.history.maxStates is 1");_historyControls=controls},get maxStates(){return _historyMaxStates},set maxStates(value){if(!Number.isSafeInteger(value)||value<1)throw new RangeError("Config.history.maxStates must be a positive integer");_historyMaxStates=value,_historyControls&&1===value&&(_historyControls=!1)}}),macros:Object.freeze({get maxLoopIterations(){return _macrosMaxLoopIterations},set maxLoopIterations(value){if(!Number.isSafeInteger(value)||value<1)throw new RangeError("Config.macros.maxLoopIterations must be a positive integer");_macrosMaxLoopIterations=value},get typeSkipKey(){return _macrosTypeSkipKey},set typeSkipKey(value){_macrosTypeSkipKey=String(value)},get typeVisitedPassages(){return _macrosTypeVisitedPassages},set typeVisitedPassages(value){_macrosTypeVisitedPassages=Boolean(value)},get ifAssignmentError(){throw new Error("[DEPRECATED] Config.macros.ifAssignmentError has been deprecated, see Config.enableOptionalDebugging instead")},set ifAssignmentError(value){console.warn("[DEPRECATED] Config.macros.ifAssignmentError has been deprecated, see Config.enableOptionalDebugging instead"),Config.enableOptionalDebugging=value}}),navigation:Object.freeze({get override(){return _navigationOverride},set override(value){if(!(null==value||value instanceof Function))throw new TypeError("Config.navigation.override must be a function or null/undefined (received: ".concat(getTypeOf(value),")"));_navigationOverride=value}}),passages:Object.freeze({get displayTitles(){return _passagesDisplayTitles},set displayTitles(value){_passagesDisplayTitles=Boolean(value)},get nobr(){return _passagesNobr},set nobr(value){_passagesNobr=Boolean(value)},get onProcess(){return _passagesOnProcess},set onProcess(value){if(null!=value){var valueType=getTypeOf(value);if("function"!==valueType)throw new TypeError("Config.passages.onProcess must be a function or null/undefined (received: ".concat(valueType,")"))}_passagesOnProcess=value},get start(){return _passagesStart},set start(value){if(null!=value){var valueType=getTypeOf(value);if("string"!==valueType)throw new TypeError("Config.passages.start must be a string or null/undefined (received: ".concat(valueType,")"))}_passagesStart=value},get transitionOut(){return _passagesTransitionOut},set transitionOut(value){if(null!=value){var valueType=getTypeOf(value);if("string"!==valueType&&("number"!==valueType||!Number.isSafeInteger(value)||value<0))throw new TypeError("Config.passages.transitionOut must be a string, non-negative integer, or null/undefined (received: ".concat(valueType,")"))}_passagesTransitionOut=value},get descriptions(){throw new Error(errPassagesDescriptionsDeprecated)},set descriptions(value){switch(console.warn(errPassagesDescriptionsDeprecated),_typeof(value)){case"boolean":value&&!Config.saves.descriptions&&(Config.saves.descriptions=function(){return State.passage});break;case"function":Config.saves.descriptions||(Config.saves.descriptions=value);break;case"undefined":case"object":if(value&&!Config.saves.descriptions){var dict=value;Config.saves.descriptions=function(){return Object.hasOwn(dict,State.passage)&&dict[State.passage]}}break;default:throw new TypeError("Config.passages.descriptions must be a boolean, object, function, or null/undefined (received: ".concat(getTypeOf(value),")"))}}}),saves:Object.freeze({get descriptions(){return _savesDescriptions},set descriptions(value){if(!(null==value||value instanceof Function))throw new TypeError("Config.saves.descriptions must be a function or null/undefined (received: ".concat(getTypeOf(value),")"));_savesDescriptions=value},get id(){return _savesId},set id(value){if("string"!=typeof value||""===value)throw new TypeError("Config.saves.id must be a non-empty string (received: ".concat(getTypeOf(value),")"));_savesId=value},get isAllowed(){return _savesIsAllowed},set isAllowed(value){if(!(null==value||value instanceof Function))throw new TypeError("Config.saves.isAllowed must be a function or null/undefined (received: ".concat(getTypeOf(value),")"));_savesIsAllowed=value},get maxAutoSaves(){return _savesMaxAuto},set maxAutoSaves(value){if(!Number.isInteger(value))throw new TypeError("Config.saves.maxAutoSaves must be an integer");if(value<0||value>Save.MAX_INDEX+1)throw new RangeError("Config.saves.maxAutoSaves out of bounds (range: 0–".concat(Save.MAX_INDEX+1,"; received: ").concat(value,")"));_savesMaxAuto=value},get maxSlotSaves(){return _savesMaxSlot},set maxSlotSaves(value){if(!Number.isInteger(value))throw new TypeError("Config.saves.maxSlotSaves must be an integer");if(value<0||value>Save.MAX_INDEX+1)throw new RangeError("Config.saves.maxSlotSaves out of bounds (range: 0–".concat(Save.MAX_INDEX+1,"; received: ").concat(value,")"));_savesMaxSlot=value},get metadata(){return _savesMetadata},set metadata(value){if(!(null==value||value instanceof Function))throw new TypeError("Config.saves.metadata must be a function or null/undefined (received: ".concat(getTypeOf(value),")"));_savesMetadata=value},get version(){return _savesVersion},set version(value){_savesVersion=value},get _internal_autoload_(){return _savesAutoload},get autoload(){return console.warn(errSavesAutoloadDeprecated),_savesAutoload},set autoload(value){if(console.warn(errSavesAutoloadDeprecated),null!=value){var valueType=getTypeOf(value);if("boolean"!==valueType&&("string"!==valueType||"prompt"!==value)&&"function"!==valueType)throw new TypeError("Config.saves.autoload must be a boolean, string ('prompt'), function, or null/undefined (received: ".concat(valueType,")"))}_savesAutoload=value},get autosave(){throw new Error("".concat(_baseSavesAutosaveDeprecated,", see Config.saves.maxAutoSaves and Config.saves.isAllowed instead"))},set autosave(value){switch(_typeof(value)){case"boolean":console.warn("".concat(_baseSavesAutosaveDeprecated,", for boolean usage see Config.saves.maxAutoSaves instead"));break;case"function":if(console.warn("".concat(_baseSavesAutosaveDeprecated,", for function usage see Config.saves.isAllowed instead")),!Config.saves.isAllowed){var callback=value;Config.saves.isAllowed=function(saveType){return saveType!==Save.Type.Auto||callback(saveType)}}break;default:if(console.warn("".concat(_baseSavesAutosaveDeprecated,", for tag usage see Config.saves.isAllowed instead")),!(value instanceof Array)||0===value.length||value.some((function(tag){return"string"!=typeof tag}))){var valueType=getTypeOf(value);throw new TypeError("Config.saves.autosave must be a boolean, Array<string>, function, or null/undefined (received: ".concat(valueType).concat("Array"===valueType?"<any>":"",")"))}if(!Config.saves.isAllowed){var tags=value;Config.saves.isAllowed=function(saveType){return saveType!==Save.Type.Auto||tags.includesAny(tags())}}}0===Config.saves.maxAutoSaves&&(Config.saves.maxAutoSaves=1)},get onLoad(){throw new Error(errSavesOnLoadDeprecated)},set onLoad(value){console.warn(errSavesOnLoadDeprecated),Save.onLoad.add(value)},get onSave(){throw new Error(errSavesOnSaveDeprecated)},set onSave(value){console.warn(errSavesOnSaveDeprecated),Save.onSave.add(value)},get slots(){throw new Error(errSavesSlotsDeprecated)},set slots(value){console.warn(errSavesSlotsDeprecated),Config.saves.maxSlotSaves=value},get tryDiskOnMobile(){return console.warn("[DEPRECATED] Config.saves.tryDiskOnMobile has been deprecated"),!0},set tryDiskOnMobile(value){console.warn("[DEPRECATED] Config.saves.tryDiskOnMobile has been deprecated")}}),ui:Object.freeze({get stowBarInitially(){return _uiStowBarInitially},set stowBarInitially(value){var valueType=getTypeOf(value);if("boolean"!==valueType&&("number"!==valueType||!Number.isSafeInteger(value)||value<0))throw new TypeError("Config.ui.stowBarInitially must be a boolean or non-negative integer (received: ".concat(valueType,")"));_uiStowBarInitially=value},get updateStoryElements(){return _uiUpdateStoryElements},set updateStoryElements(value){_uiUpdateStoryElements=Boolean(value)}})})),_navigationOverride,_passagesStart,_passagesOnProcess,_passagesTransitionOut,_savesDescriptions,_savesId,_savesIsAllowed,_savesMetadata,_savesVersion,_savesAutoload,_addVisitedLinkClass,_cleanupWikifierOutput,_debug,_enableOptionalDebugging,_loadDelay,_audioPauseOnFadeToZero,_audioPreloadMetadata,_historyControls,_historyMaxStates,_macrosMaxLoopIterations,_macrosTypeSkipKey,_macrosTypeVisitedPassages,_passagesDisplayTitles,_passagesNobr,_savesMaxAuto,_savesMaxSlot,_uiStowBarInitially,_uiUpdateStoryElements,errPassagesDescriptionsDeprecated,errSavesAutoloadDeprecated,_baseSavesAutosaveDeprecated,errSavesOnLoadDeprecated,errSavesOnSaveDeprecated,errSavesSlotsDeprecated,SimpleAudio=function(){var _hasPromise,_specialIds=Object.freeze([":not",":all",":looped",":muted",":paused",":playing",":stopped"]),_formatSpecRe=/^([\w-]+)\s*\|\s*(\S.*)$/,_badIdRe=/[:\s]/,_tracks=new Map,_groups=new Map,_lists=new Map,_subscribers=new Map,_masterRate=1,_masterVolume=1,_masterMute=!1,_masterMuteOnHidden=!1,_playReturnsPromise=(_hasPromise=null,function(){if(null!==_hasPromise)return _hasPromise;if(_hasPromise=!1,Has.audio)try{var audio=document.createElement("audio");audio.muted=!0;var value=audio.play();value.catch((function(){})),_hasPromise=value instanceof Promise}catch(ex){}return _hasPromise}),AudioTrack=function(){function AudioTrack(obj){if(_classCallCheck(this,AudioTrack),obj instanceof Array)this._create(obj);else{if(!(obj instanceof AudioTrack))throw new Error("sources parameter must be either an array, of URIs or source objects, or an AudioTrack instance");this._copy(obj)}}return _createClass(AudioTrack,[{key:"_create",value:function(sourceList){var dataUriRe=/^data:\s*audio\/(?:x-)?([^;,]+)\s*[;,]/i,extRe=/\.([^./\\]+)$/,formats=AudioTrack.formats,usedSources=[],audio=document.createElement("audio");audio.preload="none",sourceList.forEach((function(src){var srcUri=null;switch(_typeof(src)){case"string":var match;if("data:"===src.slice(0,5)){if(null===(match=dataUriRe.exec(src)))throw new Error("source data URI missing media type")}else if(null===(match=extRe.exec(parseURL(src).pathname)))throw new Error("source URL missing file extension");formats[match[1]]&&(srcUri=src);break;case"object":if(null===src)throw new Error("source object cannot be null");if(!Object.hasOwn(src,"src"))throw new Error('source object missing required "src" property');if(!Object.hasOwn(src,"format"))throw new Error('source object missing required "format" property');formats[src.format]&&(srcUri=src.src);break;default:throw new Error("invalid source value (type: ".concat(_typeof(src),")"))}if(null!==srcUri){var source=document.createElement("source");source.src=srcUri,audio.appendChild(source),usedSources.push(srcUri)}})),audio.hasChildNodes()&&Config.audio.preloadMetadata&&(audio.preload="metadata"),this._finalize(audio,usedSources,clone(sourceList))}},{key:"_copy",value:function(obj){this._finalize(obj.audio.cloneNode(!0),clone(obj.sources),clone(obj.originals))}},{key:"_finalize",value:function(audio,sources,originals){var _this=this;Object.defineProperties(this,{audio:{configurable:!0,value:audio},sources:{value:Object.freeze(sources)},originals:{value:Object.freeze(originals)},_error:{writable:!0,value:!1},_faderId:{writable:!0,value:null},_mute:{writable:!0,value:!1},_rate:{writable:!0,value:1},_volume:{writable:!0,value:1}}),jQuery(this.audio).on("loadstart.AudioTrack",(function(){return _this._error=!1})).on("error.AudioTrack",(function(){return _this._error=!0})).find("source:last-of-type").on("error.AudioTrack",(function(){return _this._trigger("error")})),function(id,callback){if("function"!=typeof callback)throw new Error("callback parameter must be a function");_subscribers.set(id,callback)}(this,(function(mesg){if(_this.audio)switch(mesg){case"loadwithscreen":if(_this.hasSource()){var lockId=LoadScreen.lock();_this.off(".AudioTrack_loadwithscreen").one("canplaythrough.AudioTrack_loadwithscreen error.AudioTrack_loadwithscreen",(function(){jQuery(this).off(".AudioTrack_loadwithscreen"),LoadScreen.unlock(lockId)})).load()}break;case"load":_this.load();break;case"mute":_this._updateAudioMute();break;case"rate":_this._updateAudioRate();break;case"stop":_this.stop();break;case"volume":_this._updateAudioVolume();break;case"unload":_this.unload()}else unsubscribe(_this)})),this._updateAudioMute(),this._updateAudioRate(),this._updateAudioVolume()}},{key:"_trigger",value:function(eventName){triggerEvent(eventName,this.audio,{bubbles:!1})}},{key:"_destroy",value:function(){unsubscribe(this),this.audio&&(jQuery(this.audio).off(),this.unload(),this._error=!0,delete this.audio)}},{key:"clone",value:function(){return new AudioTrack(this)}},{key:"load",value:function(){var _this2=this;if(this.fadeStop(),this.audio.pause(),!this.audio.hasChildNodes()){if(0===this.sources.length)return;this.sources.forEach((function(srcUri){var source=document.createElement("source");source.src=srcUri,_this2.audio.appendChild(source)}))}"auto"!==this.audio.preload&&(this.audio.preload="auto"),this.isLoading()||this.audio.load()}},{key:"unload",value:function(){this.fadeStop(),this.stop();var audio=this.audio;for(audio.preload="none";audio.hasChildNodes();)audio.removeChild(audio.firstChild);audio.load()}},{key:"play",value:function(){var _this3=this;if(!this.hasSource())return Promise.reject(new Error("none of the candidate sources were acceptable"));if(this.isUnloaded())return Promise.reject(new Error("no sources are loaded"));if(this.isFailed())return Promise.reject(new Error("failed to load any of the sources"));"auto"!==this.audio.preload&&(this.audio.preload="auto");var namespace=".AudioTrack_play";return _playReturnsPromise()?this.audio.play():new Promise((function(resolve,reject){_this3.isPlaying()?resolve():(jQuery(_this3.audio).off(namespace).one("error".concat(namespace," playing").concat(namespace," timeupdate").concat(namespace),(function(ev){jQuery(_this3.audio).off(namespace),"error"===ev.type?reject(new Error("unknown audio play error")):resolve()})),_this3.audio.play())}))}},{key:"playWhenAllowed",value:function(){var _this4=this;return this.play().catch((function(ex){if("NotAllowedError"!==ex.name)throw ex;onUserActivation(".AudioTrack_playWhenAllowed",(function(){return _this4.audio.play()}))}))}},{key:"pause",value:function(){this.audio.pause()}},{key:"stop",value:function(){this.audio.pause(),this.time(0),this._trigger(":stopped")}},{key:"fade",value:function(duration,toVol,fromVol){var _this5=this;if("number"!=typeof duration)throw new TypeError("duration parameter must be a number");if("number"!=typeof toVol)throw new TypeError("toVolume parameter must be a number");if(null!=fromVol&&"number"!=typeof fromVol)throw new TypeError("fromVolume parameter must be a number");if(!this.hasSource())return Promise.reject(new Error("none of the candidate sources were acceptable"));if(this.isUnloaded())return Promise.reject(new Error("no sources are loaded"));if(this.isFailed())return Promise.reject(new Error("failed to load any of the sources"));this.fadeStop();var from=Math.clamp(null==fromVol?this.volume():fromVol,0,1),to=Math.clamp(toVol,0,1);return from!==to?(this.volume(from),jQuery(this.audio).off("timeupdate.AudioTrack_fade").one("timeupdate.AudioTrack_fade",(function(){var min,max;from<to?(min=from,max=to):(min=to,max=from);var time=Math.max(duration,1),delta=(to-from)/(time/.025);_this5._trigger(":fading"),_this5._faderId=setInterval((function(){_this5.isPlaying()?(_this5.volume(Math.clamp(_this5.volume()+delta,min,max)),Config.audio.pauseOnFadeToZero&&0===_this5.volume()&&_this5.pause(),_this5.volume()===to&&(_this5.fadeStop(),_this5._trigger(":faded"))):_this5.fadeStop()}),25)})),this.play()):void 0}},{key:"fadeIn",value:function(duration,fromVol){return this.fade(duration,1,fromVol)}},{key:"fadeOut",value:function(duration,fromVol){return this.fade(duration,0,fromVol)}},{key:"fadeStop",value:function(){null!==this._faderId&&(clearInterval(this._faderId),this._faderId=null)}},{key:"loop",value:function(_loop2){return null==_loop2?this.audio.loop:(this.audio.loop=!!_loop2,this)}},{key:"mute",value:function(_mute){return null==_mute?this._mute:(this._mute=!!_mute,this._updateAudioMute(),this)}},{key:"_updateAudioMute",value:function(){this.audio.muted=this._mute||_masterMute}},{key:"rate",value:function(_rate){if(null==_rate)return this._rate;if("number"!=typeof _rate)throw new TypeError("rate parameter must be a number");return this._rate=Math.clamp(_rate,.2,5),this._updateAudioRate(),this}},{key:"_updateAudioRate",value:function(){this.audio.playbackRate=Math.clamp(this._rate*_masterRate,.2,5)}},{key:"time",value:function(_time){var _this6=this;if(null==_time)return this.audio.currentTime;if("number"!=typeof _time)throw new TypeError("time parameter must be a number");return this.hasMetadata()?this.audio.currentTime=_time:jQuery(this.audio).off("loadedmetadata.AudioTrack_time").one("loadedmetadata.AudioTrack_time",(function(){return _this6.audio.currentTime=_time})),this}},{key:"volume",value:function(_volume){if(null==_volume)return this._volume;if("number"!=typeof _volume)throw new TypeError("volume parameter must be a number");return this._volume=Math.clamp(_volume,0,1),this._updateAudioVolume(),this}},{key:"_updateAudioVolume",value:function(){this.audio.volume=Math.clamp(this._volume*_masterVolume,0,1)}},{key:"duration",value:function(){return this.audio.duration}},{key:"remaining",value:function(){return this.audio.duration-this.audio.currentTime}},{key:"isFailed",value:function(){return this._error}},{key:"isLoading",value:function(){return this.audio.networkState===HTMLMediaElement.NETWORK_LOADING}},{key:"isUnloaded",value:function(){return!this.audio.hasChildNodes()}},{key:"isUnavailable",value:function(){return!this.hasSource()||this.isUnloaded()||this.isFailed()}},{key:"isPlaying",value:function(){return!this.audio.paused&&this.hasSomeData()}},{key:"isPaused",value:function(){return this.audio.paused&&(this.audio.duration===1/0||this.audio.currentTime>0)&&!this.audio.ended}},{key:"isStopped",value:function(){return this.audio.paused&&0===this.audio.currentTime}},{key:"isEnded",value:function(){return this.audio.ended}},{key:"isFading",value:function(){return null!==this._faderId}},{key:"isSeeking",value:function(){return this.audio.seeking}},{key:"hasSource",value:function(){return this.sources.length>0}},{key:"hasNoData",value:function(){return this.audio.readyState===HTMLMediaElement.HAVE_NOTHING}},{key:"hasMetadata",value:function(){return this.audio.readyState>=HTMLMediaElement.HAVE_METADATA}},{key:"hasSomeData",value:function(){return this.audio.readyState>=HTMLMediaElement.HAVE_CURRENT_DATA}},{key:"hasData",value:function(){return this.audio.readyState===HTMLMediaElement.HAVE_ENOUGH_DATA}},{key:"on",value:function(){for(var _len5=arguments.length,args=new Array(_len5),_key5=0;_key5<_len5;_key5++)args[_key5]=arguments[_key5];return jQuery.fn.on.apply(jQuery(this.audio),args),this}},{key:"one",value:function(){for(var _len6=arguments.length,args=new Array(_len6),_key6=0;_key6<_len6;_key6++)args[_key6]=arguments[_key6];return jQuery.fn.one.apply(jQuery(this.audio),args),this}},{key:"off",value:function(){for(var _len7=arguments.length,args=new Array(_len7),_key7=0;_key7<_len7;_key7++)args[_key7]=arguments[_key7];return jQuery.fn.off.apply(jQuery(this.audio),args),this}}])}();Object.defineProperties(AudioTrack,{formats:{value:function(){var audio=document.createElement("audio"),types=new Map;function canPlay(mimeType){return types.has(mimeType)||types.set(mimeType,""!==audio.canPlayType(mimeType).replace(/^no$/i,"")),types.get(mimeType)}return Object.assign(Object.create(null),{aac:canPlay("audio/aac"),caf:canPlay("audio/x-caf")||canPlay("audio/caf"),flac:canPlay("audio/x-flac")||canPlay("audio/flac"),mp3:canPlay('audio/mpeg; codecs="mp3"')||canPlay("audio/mpeg")||canPlay("audio/mp3")||canPlay("audio/mpa"),mpeg:canPlay("audio/mpeg"),m4a:canPlay("audio/x-m4a")||canPlay("audio/m4a")||canPlay("audio/aac"),mp4:canPlay("audio/x-mp4")||canPlay("audio/mp4")||canPlay("audio/aac"),ogg:canPlay("audio/ogg"),oga:canPlay("audio/ogg"),opus:canPlay('audio/ogg; codecs="opus"')||canPlay("audio/opus"),wav:canPlay('audio/wave; codecs="1"')||canPlay('audio/wav; codecs="1"')||canPlay("audio/wave")||canPlay("audio/wav"),wave:canPlay('audio/wave; codecs="1"')||canPlay('audio/wav; codecs="1"')||canPlay("audio/wave")||canPlay("audio/wav"),weba:canPlay("audio/webm"),webm:canPlay("audio/webm")})}()}});var AudioList=function(){return _createClass((function AudioList(obj){if(_classCallCheck(this,AudioList),obj instanceof Array)this._create(obj);else{if(!(obj instanceof AudioList))throw new Error("tracks parameter must be either an array, of track objects, or an AudioTrack instance");this._copy(obj)}}),[{key:"_create",value:function(trackList){var _this7=this;this._finalize(trackList.map((function(trackObj){if("object"!==_typeof(trackObj))throw new Error("tracks parameter array members must be objects");var own,rate,track,volume;if(trackObj instanceof AudioTrack)own=!0,rate=trackObj.rate(),track=trackObj.clone(),volume=trackObj.volume();else{if(!Object.hasOwn(trackObj,"track"))throw new Error('track object missing required "track" property');if(!(trackObj.track instanceof AudioTrack))throw new Error('track object\'s "track" property must be an AudioTrack object');own=Object.hasOwn(trackObj,"own")&&trackObj.own,rate=Object.hasOwn(trackObj,"rate")?trackObj.rate:trackObj.track.rate(),track=trackObj.track,volume=Object.hasOwn(trackObj,"volume")?trackObj.volume:trackObj.track.volume()}return track.stop(),track.loop(!1),track.mute(!1),track.rate(rate),track.volume(volume),track.on("ended.AudioList",(function(){return _this7._onEnd()})),{own:own,track:track,volume:volume,rate:rate}})))}},{key:"_copy",value:function(obj){this._finalize(clone(obj.tracks))}},{key:"_finalize",value:function(tracks){Object.defineProperties(this,{tracks:{configurable:!0,value:Object.freeze(tracks)},queue:{configurable:!0,value:[]},current:{writable:!0,value:null},_rate:{writable:!0,value:1},_volume:{writable:!0,value:1},_mute:{writable:!0,value:!1},_loop:{writable:!0,value:!1},_shuffle:{writable:!0,value:!1}})}},{key:"_destroy",value:function(){this.stop(),this.tracks.filter((function(trackObj){return trackObj.own})).forEach((function(trackObj){return trackObj.track._destroy()})),delete this.tracks,delete this.queue}},{key:"load",value:function(){this.tracks.forEach((function(trackObj){return trackObj.track.load()}))}},{key:"unload",value:function(){this.stop(),this.tracks.forEach((function(trackObj){return trackObj.track.unload()}))}},{key:"play",value:function(){return null!==this.current&&!this.current.track.isUnavailable()&&!this.current.track.isEnded()||(0===this.queue.length&&this._fillQueue(),this._next())?this.current.track.play():Promise.reject(new Error("no tracks were available"))}},{key:"playWhenAllowed",value:function(){var _this8=this;return this.play().catch((function(ex){if("NotAllowedError"!==ex.name)throw ex;onUserActivation(".AudioList_playWhenAllowed",(function(){return _this8.play()}))}))}},{key:"pause",value:function(){null!==this.current&&this.current.track.pause()}},{key:"stop",value:function(){null!==this.current&&(this.current.track.stop(),this.current=null),this._drainQueue()}},{key:"skip",value:function(){this._next()?this.current.track.play():this._loop&&this.play()}},{key:"fade",value:function(duration,toVol,fromVol){if("number"!=typeof duration)throw new TypeError("duration parameter must be a number");if("number"!=typeof toVol)throw new TypeError("toVolume parameter must be a number");if(null!=fromVol&&"number"!=typeof fromVol)throw new TypeError("fromVolume parameter must be a number");if(0===this.queue.length&&this._fillQueue(),null!==this.current&&!this.current.track.isUnavailable()&&!this.current.track.isEnded()||this._next()){var adjFromVol,adjToVol=Math.clamp(toVol,0,1)*this.current.volume;return null!=fromVol&&(adjFromVol=Math.clamp(fromVol,0,1)*this.current.volume),this._volume=toVol,this.current.track.fade(duration,adjToVol,adjFromVol)}}},{key:"fadeIn",value:function(duration,fromVol){return this.fade(duration,1,fromVol)}},{key:"fadeOut",value:function(duration,fromVol){return this.fade(duration,0,fromVol)}},{key:"fadeStop",value:function(){null!==this.current&&this.current.track.fadeStop()}},{key:"loop",value:function(_loop3){return null==_loop3?this._loop:(this._loop=!!_loop3,this)}},{key:"mute",value:function(_mute2){return null==_mute2?this._mute:(this._mute=!!_mute2,null!==this.current&&this.current.track.mute(this._mute),this)}},{key:"rate",value:function(_rate2){if(null==_rate2)return this._rate;if("number"!=typeof _rate2)throw new TypeError("rate parameter must be a number");return this._rate=Math.clamp(_rate2,.2,5),null!==this.current&&this.current.track.rate(this._rate*this.current.rate),this}},{key:"shuffle",value:function(_shuffle){var _this9=this;if(null==_shuffle)return this._shuffle;if(this._shuffle=!!_shuffle,this.queue.length>0&&(this._fillQueue(),!this._shuffle&&null!==this.current&&this.queue.length>1)){var _this$queue,firstIndex=this.queue.findIndex((function(trackObj){return trackObj===_this9.current}));if(-1!==firstIndex)(_this$queue=this.queue).push.apply(_this$queue,_toConsumableArray(this.queue.splice(0,firstIndex+1)))}return this}},{key:"volume",value:function(_volume2){if(null==_volume2)return this._volume;if("number"!=typeof _volume2)throw new TypeError("volume parameter must be a number");return this._volume=Math.clamp(_volume2,0,1),null!==this.current&&this.current.track.volume(this._volume*this.current.volume),this}},{key:"duration",value:function(){if(arguments.length>0)throw new Error("duration takes no parameters");return this.tracks.map((function(trackObj){return trackObj.track.duration()})).reduce((function(prev,cur){return prev+cur}),0)}},{key:"remaining",value:function(){if(arguments.length>0)throw new Error("remaining takes no parameters");var remainingTime=this.queue.map((function(trackObj){return trackObj.track.duration()})).reduce((function(prev,cur){return prev+cur}),0);return null!==this.current&&(remainingTime+=this.current.track.remaining()),remainingTime}},{key:"time",value:function(){if(arguments.length>0)throw new Error("time takes no parameters");return this.duration()-this.remaining()}},{key:"isPlaying",value:function(){return null!==this.current&&this.current.track.isPlaying()}},{key:"isPaused",value:function(){return null===this.current||this.current.track.isPaused()}},{key:"isStopped",value:function(){return 0===this.queue.length&&null===this.current}},{key:"isEnded",value:function(){return 0===this.queue.length&&(null===this.current||this.current.track.isEnded())}},{key:"isFading",value:function(){return null!==this.current&&this.current.track.isFading()}},{key:"_next",value:function(){var nextTrack;for(null!==this.current&&(this.current.track.stop(),this.current=null);nextTrack=this.queue.shift();)if(!nextTrack.track.isUnavailable()){this.current=nextTrack;break}return null!==this.current&&(this.current.track.mute(this._mute),this.current.track.rate(this._rate*this.current.rate),this.current.track.volume(this._volume*this.current.volume),this.current.track.loop(!1),!0)}},{key:"_onEnd",value:function(){if(0===this.queue.length){if(!this._loop)return;this._fillQueue()}this._next()&&this.current.track.play()}},{key:"_drainQueue",value:function(){this.queue.splice(0)}},{key:"_fillQueue",value:function(){var _this$queue2;this._drainQueue(),(_this$queue2=this.queue).push.apply(_this$queue2,_toConsumableArray(this.tracks.filter((function(trackObj){return!trackObj.track.isUnavailable()})))),0!==this.queue.length&&this._shuffle&&(this.queue.shuffle(),this.queue.length>1&&this.queue[0]===this.current&&this.queue.push(this.queue.shift()))}}])}(),AudioRunner=function(){function AudioRunner(list){if(_classCallCheck(this,AudioRunner),!(list instanceof Set||list instanceof AudioRunner))throw new TypeError("list parameter must be a Set or a AudioRunner instance");Object.defineProperties(this,{trackIds:{value:new Set(list instanceof AudioRunner?list.trackIds:list)}})}return _createClass(AudioRunner,[{key:"load",value:function(){AudioRunner._run(this.trackIds,AudioTrack.prototype.load)}},{key:"unload",value:function(){AudioRunner._run(this.trackIds,AudioTrack.prototype.unload)}},{key:"play",value:function(){AudioRunner._run(this.trackIds,AudioTrack.prototype.play)}},{key:"playWhenAllowed",value:function(){AudioRunner._run(this.trackIds,AudioTrack.prototype.playWhenAllowed)}},{key:"pause",value:function(){AudioRunner._run(this.trackIds,AudioTrack.prototype.pause)}},{key:"stop",value:function(){AudioRunner._run(this.trackIds,AudioTrack.prototype.stop)}},{key:"fade",value:function(duration,toVol,fromVol){if(null==duration||null==toVol)throw new Error("fade requires parameters");AudioRunner._run(this.trackIds,AudioTrack.prototype.fade,duration,toVol,fromVol)}},{key:"fadeIn",value:function(duration,fromVol){if(null==duration)throw new Error("fadeIn requires a parameter");AudioRunner._run(this.trackIds,AudioTrack.prototype.fadeIn,duration,fromVol)}},{key:"fadeOut",value:function(duration,fromVol){if(null==duration)throw new Error("fadeOut requires a parameter");AudioRunner._run(this.trackIds,AudioTrack.prototype.fadeOut,duration,fromVol)}},{key:"fadeStop",value:function(){AudioRunner._run(this.trackIds,AudioTrack.prototype.fadeStop)}},{key:"loop",value:function(_loop4){if(null==_loop4)throw new Error("loop requires a parameter");return AudioRunner._run(this.trackIds,AudioTrack.prototype.loop,_loop4),this}},{key:"mute",value:function(_mute3){if(null==_mute3)throw new Error("mute requires a parameter");return AudioRunner._run(this.trackIds,AudioTrack.prototype.mute,_mute3),this}},{key:"rate",value:function(_rate3){if(null==_rate3)throw new Error("rate requires a parameter");return AudioRunner._run(this.trackIds,AudioTrack.prototype.rate,_rate3),this}},{key:"time",value:function(_time2){if(null==_time2)throw new Error("time requires a parameter");return AudioRunner._run(this.trackIds,AudioTrack.prototype.time,_time2),this}},{key:"volume",value:function(_volume3){if(null==_volume3)throw new Error("volume requires a parameter");return AudioRunner._run(this.trackIds,AudioTrack.prototype.volume,_volume3),this}},{key:"on",value:function(){for(var _len8=arguments.length,args=new Array(_len8),_key8=0;_key8<_len8;_key8++)args[_key8]=arguments[_key8];return AudioRunner._run.apply(AudioRunner,[this.trackIds,AudioTrack.prototype.on].concat(args)),this}},{key:"one",value:function(){for(var _len9=arguments.length,args=new Array(_len9),_key9=0;_key9<_len9;_key9++)args[_key9]=arguments[_key9];return AudioRunner._run.apply(AudioRunner,[this.trackIds,AudioTrack.prototype.one].concat(args)),this}},{key:"off",value:function(){for(var _len10=arguments.length,args=new Array(_len10),_key10=0;_key10<_len10;_key10++)args[_key10]=arguments[_key10];return AudioRunner._run.apply(AudioRunner,[this.trackIds,AudioTrack.prototype.off].concat(args)),this}}],[{key:"_run",value:function(ids,fn){for(var _len11=arguments.length,args=new Array(_len11>2?_len11-2:0),_key11=2;_key11<_len11;_key11++)args[_key11-2]=arguments[_key11];ids.forEach((function(id){var track=_tracks.get(id);track&&fn.apply(track,args)}))}}])}();var _runnerParseSelector=function(){var notWsRe=/\S/g,parenRe=/[()]/g;function processNegation(str,startPos){var match;if(notWsRe.lastIndex=startPos,null===(match=notWsRe.exec(str))||"("!==match[0])throw new Error('invalid ":not()" syntax: missing parenthesis');parenRe.lastIndex=notWsRe.lastIndex;for(var start=notWsRe.lastIndex,result={str:"",nextMatch:-1},depth=1;null!==(match=parenRe.exec(str));)if("("===match[0]?++depth:--depth,depth<1){result.nextMatch=parenRe.lastIndex,result.str=str.slice(start,result.nextMatch-1);break}return result}return function parseSelector(idArg){for(var match,ids=[],idRe=/:?[^\s:()]+/g;null!==(match=idRe.exec(idArg));){var id=match[0];if(":not"===id){if(0===ids.length)throw new Error('invalid negation: no group ID preceded ":not()"');var parent=ids[ids.length-1];if(!parent.id.startsWith(":"))throw new Error('invalid negation of track "'.concat(parent.id,'": only groups may be negated with ":not()"'));var negation=processNegation(idArg,idRe.lastIndex);if(-1===negation.nextMatch)throw new Error('unknown error parsing ":not()"');idRe.lastIndex=negation.nextMatch,parent.not=parseSelector(negation.str)}else ids.push({id:id})}return ids}}();function masterMute(mute){if(null==mute)return _masterMute;publish("mute",_masterMute=!!mute)}function unsubscribe(id){_subscribers.delete(id)}function publish(mesg,data){_subscribers.forEach((function(fn){return fn(mesg,data)}))}function _newTrack(sources){return new AudioTrack(sources.map((function(source){if("data:"!==source.slice(0,5)&&Story.has(source)){var passage=Story.get(source);if(passage.tags.includes("Twine.audio"))return passage.text.trim()}var match=_formatSpecRe.exec(source);return null===match?source:{format:match[1],src:match[2]}})))}return Object.preventExtensions(Object.create(null,{tracks:{value:Object.preventExtensions(Object.create(null,{add:{value:function(){if(arguments.length<2){var errors=[];throw arguments.length<1&&errors.push("track ID"),arguments.length<2&&errors.push("sources"),new Error("no ".concat(errors.join(" or ")," specified"))}var id=String(arguments[0]).trim(),what='track ID "'.concat(id,'"');if(_badIdRe.test(id))throw new Error("invalid ".concat(what,": track IDs must not contain colons or whitespace"));var track,sources=Array.isArray(arguments[1])?Array.from(arguments[1]):Array.from(arguments).slice(1);try{track=_newTrack(sources)}catch(ex){throw new Error("".concat(what,": error during track initialization: ").concat(ex.message))}if(Config.debug&&!track.hasSource())throw new Error("".concat(what,": no supported audio sources found"));_tracks.has(id)&&_tracks.get(id)._destroy(),_tracks.set(id,track)}},delete:{value:function(id){return _tracks.has(id)&&_tracks.get(id)._destroy(),_tracks.delete(id)}},clear:{value:function(){_tracks.forEach((function(track){return track._destroy()})),_tracks.clear()}},has:{value:function(id){return _tracks.has(id)}},get:{value:function(id){return _tracks.get(id)||null}}}))},groups:{value:Object.preventExtensions(Object.create(null,{add:{value:function(){if(arguments.length<2){var errors=[];throw arguments.length<1&&errors.push("group ID"),arguments.length<2&&errors.push("track IDs"),new Error("no ".concat(errors.join(" or ")," specified"))}var id=String(arguments[0]).trim(),what='group ID "'.concat(id,'"');if(!id.startsWith(":")||_badIdRe.test(id.slice(1)))throw new Error("invalid ".concat(what,": group IDs must start with a colon and must not contain colons or whitespace"));if(_specialIds.includes(id))throw new Error("cannot clobber special ".concat(what));var group,trackIds=Array.isArray(arguments[1])?Array.from(arguments[1]):Array.from(arguments).slice(1);try{group=new Set(trackIds.map((function(trackId){if(!_tracks.has(trackId))throw new Error('track "'.concat(trackId,'" does not exist'));return trackId})))}catch(ex){throw new Error("".concat(what,": error during group initialization: ").concat(ex.message))}_groups.set(id,Object.freeze(Array.from(group)))}},delete:{value:function(id){return _groups.delete(id)}},clear:{value:function(){_groups.clear()}},has:{value:function(id){return _groups.has(id)}},get:{value:function(id){return _groups.get(id)||null}}}))},lists:{value:Object.preventExtensions(Object.create(null,{add:{value:function(){if(arguments.length<2){var errors=[];throw arguments.length<1&&errors.push("list ID"),arguments.length<2&&errors.push("track IDs"),new Error("no ".concat(errors.join(" or ")," specified"))}var id=String(arguments[0]).trim(),what='list ID "'.concat(id,'"');if(_badIdRe.test(id))return this.error("invalid ".concat(what,": list IDs must not contain colons or whitespace"));var list,descriptors=Array.isArray(arguments[1])?Array.from(arguments[1]):Array.from(arguments).slice(1);try{list=new AudioList(descriptors.map((function(desc){if(null===desc)throw new Error("track descriptor must be a string or object (type: null)");switch(_typeof(desc)){case"string":desc={id:desc};break;case"object":if(!Object.hasOwn(desc,"id")&&!Object.hasOwn(desc,"sources"))throw new Error('track descriptor must contain one of either an "id" or a "sources" property');if(Object.hasOwn(desc,"id")&&Object.hasOwn(desc,"sources"))throw new Error('track descriptor must contain either an "id" or a "sources" property, not both');break;default:throw new Error("track descriptor must be a string or object (type: ".concat(_typeof(desc),")"))}var own,track,volume;if(Object.hasOwn(desc,"id")){if("string"!=typeof desc.id)throw new Error('"id" property must be a string');if(!_tracks.has(desc.id))throw new Error('track "'.concat(desc.id,'" does not exist'));track=_tracks.get(desc.id)}else if(Object.hasOwn(desc,"sources")){if(!Array.isArray(desc.sources)||0===desc.sources.length)throw new Error('"sources" property must be a non-empty array');if(Object.hasOwn(desc,"own"))throw new Error('"own" property is not allowed with the "sources" property');try{track=_newTrack(desc.sources),own=!0}catch(ex){throw new Error("error during track initialization: ".concat(ex.message))}if(Config.debug&&!track.hasSource())throw new Error("no supported audio sources found")}if(Object.hasOwn(desc,"own")){if("boolean"!=typeof desc.own)throw new Error('"own" property must be a boolean');(own=desc.own)&&(track=track.clone())}if(Object.hasOwn(desc,"volume")){if("number"!=typeof desc.volume||Number.isNaN(desc.volume)||!Number.isFinite(desc.volume)||desc.volume<0)throw new Error('"volume" property must be a non-negative finite number');volume=desc.volume}return{own:null!=own&&own,track:track,volume:null!=volume?volume:track.volume()}})))}catch(ex){throw new Error("".concat(what,": error during playlist initialization: ").concat(ex.message))}_lists.has(id)&&_lists.get(id)._destroy(),_lists.set(id,list)}},delete:{value:function(id){return _lists.has(id)&&_lists.get(id)._destroy(),_lists.delete(id)}},clear:{value:function(){_lists.forEach((function(list){return list._destroy()})),_lists.clear()}},has:{value:function(id){return _lists.has(id)}},get:{value:function(id){return _lists.get(id)||null}}}))},select:{value:function(){if(0===arguments.length)throw new Error("no track selector specified");var selector=String(arguments[0]).trim(),trackIds=new Set;try{var renderIds=function renderIds(idObj){var ids,id=idObj.id;switch(id){case":all":ids=allIds;break;case":looped":ids=allIds.filter((function(id){return _tracks.get(id).loop()}));break;case":muted":ids=allIds.filter((function(id){return _tracks.get(id).mute()}));break;case":paused":ids=allIds.filter((function(id){return _tracks.get(id).isPaused()}));break;case":playing":ids=allIds.filter((function(id){return _tracks.get(id).isPlaying()}));break;case":stopped":ids=allIds.filter((function(id){return _tracks.get(id).isStopped()}));break;default:if(id.startsWith(":")){var group=_groups.get(id);if(!group)throw new Error('group "'.concat(id,'" does not exist'));ids=group}else ids=[id]}if(Object.hasOwn(idObj,"not")){var negated=idObj.not.map((function(idObj){return renderIds(idObj)})).flat(1/0);ids=ids.filter((function(id){return!negated.includes(id)}))}return ids},allIds=Array.from(_tracks.keys());_runnerParseSelector(selector).forEach((function(idObj){return renderIds(idObj).forEach((function(id){if(!_tracks.has(id))throw new Error('track "'.concat(id,'" does not exist'));trackIds.add(id)}))}))}catch(ex){throw new Error("error during runner initialization: ".concat(ex.message))}return new AudioRunner(trackIds)}},load:{value:function(){publish("load")}},loadWithScreen:{value:function(){publish("loadwithscreen")}},mute:{value:masterMute},muteOnHidden:{value:function(mute){if(!Visibility.isEnabled())return!1;if(null==mute)return _masterMuteOnHidden;var namespace=".SimpleAudio_masterMuteOnHidden";if(_masterMuteOnHidden=!!mute){var visibilityChange="".concat(Visibility.changeEvent).concat(namespace);jQuery(document).off(namespace).on(visibilityChange,(function(){return masterMute(Visibility.isHidden())})),Visibility.isHidden()&&masterMute(!0)}else jQuery(document).off(namespace)}},rate:{value:function(rate){if(null==rate)return _masterRate;if("number"!=typeof rate||Number.isNaN(rate)||!Number.isFinite(rate))throw new Error("rate must be a finite number");publish("rate",_masterRate=Math.clamp(rate,.2,5))}},stop:{value:function(){publish("stop")}},unload:{value:function(){publish("unload")}},volume:{value:function(volume){if(null==volume)return _masterVolume;if("number"!=typeof volume||Number.isNaN(volume)||!Number.isFinite(volume))throw new Error("volume must be a finite number");publish("volume",_masterVolume=Math.clamp(volume,0,1))}}}))}(),State=function(){var _history=[],_active=momentCreate(),_activeIndex=-1,_expired=[],_prng=null,_temporary=Object.create(null);function stateMarshal(noDelta){var state={index:_activeIndex};return noDelta?state.history=clone(_history):state.delta=historyDeltaEncode(_history),_expired.length>0&&(state.expired=Array.from(_expired)),null!==_prng&&(state.seed=_prng.seed),state}function stateUnmarshal(state,noDelta){if(null==state)throw new Error("state object is null or undefined");if(!Object.hasOwn(state,noDelta?"history":"delta")||0===state[noDelta?"history":"delta"].length)throw new Error("state object has no history or history is empty");if(!Object.hasOwn(state,"index"))throw new Error("state object has no index");if(null!==_prng&&!Object.hasOwn(state,"seed"))throw new Error("state object has no seed, but PRNG is enabled");if(null===_prng&&Object.hasOwn(state,"seed"))throw new Error("state object has seed, but PRNG is disabled");_history=noDelta?clone(state.history):historyDeltaDecode(state.delta),_activeIndex=state.index,_expired=Object.hasOwn(state,"expired")?Array.from(state.expired):[],Object.hasOwn(state,"seed")&&(_prng.seed=state.seed),momentActivate(_activeIndex)}function momentCreate(title,variables){return{title:null==title?"":String(title),variables:null==variables?{}:clone(variables)}}function momentActivate(moment){if(null==moment)throw new Error("moment activation attempted with null or undefined");switch(_typeof(moment)){case"object":_active=clone(moment);break;case"number":if(historyIsEmpty())throw new Error("moment activation attempted with index on empty history");if(moment<0||moment>=historySize())throw new RangeError("moment activation attempted with out-of-bounds index; need [0, ".concat(historySize()-1,"], got ").concat(moment));_active=clone(_history[moment]);break;default:throw new TypeError('moment activation attempted with a "'.concat(_typeof(moment),'"; must be an object or valid history stack index'))}return null!==_prng&&(_prng=function(state){for(var prng=prngCreate(state.seed),i=state.pull;i>0;--i)prng.random();return prng}({seed:_prng.seed,pull:_active.pull})),session.set("state",stateMarshal()),triggerEvent(":historyupdate"),_active}function historyLength(){return _activeIndex+1}function historySize(){return _history.length}function historyIsEmpty(){return 0===_history.length}function historyTop(){return _history.length>0?_history[_history.length-1]:null}function historyGoTo(index){return!(null==index||index<0||index>=historySize()||index===_activeIndex)&&(momentActivate(_activeIndex=index),!0)}function historyDeltaEncode(historyArr){if(!Array.isArray(historyArr))return null;if(0===historyArr.length)return[];for(var delta=[historyArr[0]],i=1,iend=historyArr.length;i<iend;++i)delta.push(Diff.diff(historyArr[i-1],historyArr[i]));return delta}function historyDeltaDecode(delta){if(!Array.isArray(delta))return null;if(0===delta.length)return[];for(var historyArr=[clone(delta[0])],i=1,iend=delta.length;i<iend;++i)historyArr.push(Diff.patch(historyArr[i-1],delta[i]));return historyArr}function prngCreate(seedBase,mixEntropy){return new Math.seedrandom(seedBase,{entropy:Boolean(mixEntropy),pass:function(prng,seed){return Object.create(null,{prng:{value:prng},seed:{writable:!0,value:seed},pull:{writable:!0,value:0},random:{value:function(){return++this.pull,this.prng()}}})}})}function tempVariablesClear(){_temporary=Object.create(null)}var _METADATA_STORE="metadata";function metadataDelete(key){if("string"!=typeof key)throw new TypeError("State.metadata.delete key parameter must be a string (received: ".concat(_typeof(key),")"));var store=storage.get(_METADATA_STORE);store&&Object.hasOwn(store,key)&&(1===Object.keys(store).length?storage.delete(_METADATA_STORE):(delete store[key],storage.set(_METADATA_STORE,store)))}return Object.preventExtensions(Object.create(null,{reset:{value:function(){session.delete("state"),_history=[],_active=momentCreate(),_activeIndex=-1,_expired=[],_prng=null===_prng?null:prngCreate(_prng.seed),tempVariablesClear()}},restore:{value:function(){var state=session.get("state");return null!=state&&(stateUnmarshal(state),!0)}},marshalForSave:{value:function(){return stateMarshal(!0)}},unmarshalForSave:{value:function(state){return stateUnmarshal(state,!0)}},expired:{get:function(){return _expired}},turns:{get:function(){return _expired.length+historyLength()}},passages:{get:function(){return _expired.concat(_history.slice(0,historyLength()).map((function(moment){return moment.title})))}},hasPlayed:{value:function(title){return null!=title&&""!==title&&(!!_expired.includes(title)||!!_history.slice(0,historyLength()).some((function(moment){return moment.title===title})))}},active:{get:function(){return _active}},activeIndex:{get:function(){return _activeIndex}},passage:{get:function(){return _active.title}},variables:{get:function(){return _active.variables}},history:{get:function(){return _history}},length:{get:historyLength},size:{get:historySize},isEmpty:{value:historyIsEmpty},current:{get:function(){return _history.length>0?_history[_activeIndex]:null}},top:{get:historyTop},bottom:{get:function(){return _history.length>0?_history[0]:null}},index:{value:function(index){return historyIsEmpty()||index<0||index>_activeIndex?null:_history[index]}},peek:{value:function(offset){if(historyIsEmpty())return null;var lengthOffset=1+(offset?Math.abs(offset):0);return lengthOffset>historyLength()?null:_history[historyLength()-lengthOffset]}},has:{value:function(title){if(historyIsEmpty()||null==title||""===title)return!1;for(var i=_activeIndex;i>=0;--i)if(_history[i].title===title)return!0;return!1}},create:{value:function(title){for(0,historyLength()<historySize()&&_history.splice(historyLength(),historySize()-historyLength()),_history.push(momentCreate(title,_active.variables)),_prng&&(historyTop().pull=_prng.pull);historySize()>Config.history.maxStates;)_expired.push(_history.shift().title);return momentActivate(_activeIndex=historySize()-1),historyLength()}},goTo:{value:historyGoTo},go:{value:function(offset){return null!=offset&&0!==offset&&historyGoTo(_activeIndex+offset)}},deltaEncode:{value:historyDeltaEncode},deltaDecode:{value:historyDeltaDecode},prng:{value:Object.preventExtensions(Object.create(null,{init:{value:function(seedBase,mixEntropy){var what;if(!historyIsEmpty())throw what="the story JavaScript section",new Error("State.prng.init must be called during initialization, within either ".concat(what," or the StoryInit special passage"));_prng=prngCreate(seedBase,Boolean(mixEntropy)),_active.pull=_prng.pull}},isEnabled:{value:function(){return null!==_prng}},pull:{get:function(){return null!==_prng?_prng.pull:NaN}},seed:{get:function(){return null!==_prng?_prng.seed:null}}}))},random:{value:function(){return null!==_prng?_prng.random():Math.random()}},clearTemporary:{value:tempVariablesClear},temporary:{get:function(){return _temporary}},getVar:{value:function(varExpression){try{return Scripting.evalTwineScript(varExpression)}catch(ex){}}},setVar:{value:function(varExpression,value){try{return Scripting.evalTwineScript("".concat(varExpression," = SCRIPT$DATA$"),null,value),!0}catch(ex){}return!1}},metadata:{value:Object.preventExtensions(Object.create(null,{clear:{value:function(){storage.delete(_METADATA_STORE)}},delete:{value:metadataDelete},entries:{value:function(){var store=storage.get(_METADATA_STORE);return store&&Object.entries(store)}},get:{value:function(key){if("string"!=typeof key)throw new TypeError("State.metadata.get key parameter must be a string (received: ".concat(_typeof(key),")"));var store=storage.get(_METADATA_STORE);return store&&Object.hasOwn(store,key)?store[key]:undefined}},has:{value:function(key){if("string"!=typeof key)throw new TypeError("State.metadata.has key parameter must be a string (received: ".concat(_typeof(key),")"));var store=storage.get(_METADATA_STORE);return store&&Object.hasOwn(store,key)}},keys:{value:function(){var store=storage.get(_METADATA_STORE);return store&&Object.keys(store)}},set:{value:function(key,value){if("string"!=typeof key)throw new TypeError("State.metadata.set key parameter must be a string (received: ".concat(_typeof(key),")"));if(void 0===value)metadataDelete(key);else{var store=storage.get(_METADATA_STORE)||{};store[key]=value,storage.set(_METADATA_STORE,store)}}},size:{get:function(){var store=storage.get(_METADATA_STORE);return store?Object.keys(store).length:0}}}))}}))}(),Scripting=function(){function toStringOrDefault(value){return console.warn("[DEPRECATED] toStringOrDefault() is deprecated."),stringFrom(value)}function either(){if(0!==arguments.length)return Array.prototype.concat.apply([],arguments).random()}function forget(key){if("string"!=typeof key)throw new TypeError("forget key parameter must be a string (received: ".concat(getTypeOf(key),")"));State.metadata.delete(key)}function hasVisited(){if(0===arguments.length)throw new Error("hasVisited called with insufficient parameters");if(State.isEmpty())return!1;for(var needles=Array.prototype.concat.apply([],arguments),played=State.passages,i=0;i<needles.length;++i)if(!played.includes(needles[i]))return!1;return!0}function lastVisited(){if(0===arguments.length)throw new Error("lastVisited called with insufficient parameters");if(State.isEmpty())return-1;for(var needles=Array.prototype.concat.apply([],arguments),played=State.passages,uBound=played.length-1,turns=State.turns,i=0;i<needles.length&&turns>-1;++i){var lastIndex=played.lastIndexOf(needles[i]);turns=Math.min(turns,-1===lastIndex?-1:uBound-lastIndex)}return turns}function memorize(key,value){if("string"!=typeof key)throw new TypeError("memorize key parameter must be a string (received: ".concat(getTypeOf(key),")"));State.metadata.set(key,value)}function passage(){return State.passage}function previous(){var passages=State.passages;if(arguments.length>0){var offset=Number(arguments[0]);if(!Number.isSafeInteger(offset)||offset<1)throw new RangeError("previous offset parameter must be a positive integer greater than zero");return passages.length>offset?passages[passages.length-1-offset]:""}for(var i=passages.length-2;i>=0;--i)if(passages[i]!==State.passage)return passages[i];return""}function random(){var min,max;switch(arguments.length){case 0:throw new Error("random called with insufficient parameters");case 1:min=0,max=Math.trunc(arguments[0]);break;default:min=Math.trunc(arguments[0]),max=Math.trunc(arguments[1])}if(!Number.isInteger(min))throw new TypeError("random min parameter must be an integer");if(!Number.isInteger(max))throw new TypeError("random max parameter must be an integer");if(min>max){var _ref7=[max,min];min=_ref7[0],max=_ref7[1]}return Math.floor(State.random()*(max-min+1))+min}function randomFloat(){var min,max;switch(arguments.length){case 0:throw new Error("randomFloat called with insufficient parameters");case 1:min=0,max=Number(arguments[0]);break;default:min=Number(arguments[0]),max=Number(arguments[1])}if(Number.isNaN(min)||!Number.isFinite(min))throw new TypeError("randomFloat min parameter must be a number");if(Number.isNaN(max)||!Number.isFinite(max))throw new TypeError("randomFloat max parameter must be a number");if(min>max){var _ref8=[max,min];min=_ref8[0],max=_ref8[1]}return State.random()*(max-min)+min}function recall(key,defaultValue){if("string"!=typeof key)throw new TypeError("recall key parameter must be a string (received: ".concat(getTypeOf(key),")"));return State.metadata.has(key)?State.metadata.get(key):defaultValue}function tags(){if(0===arguments.length)return Story.get(State.passage).tags.slice(0);for(var passages=Array.prototype.concat.apply([],arguments),tags=[],i=0;i<passages.length;++i)tags=tags.concat(Story.get(passages[i]).tags);return tags}function temporary(){return State.temporary}function time(){return null===Engine.lastPlay?0:now()-Engine.lastPlay}function turns(){return State.turns}function variables(){return State.variables}function visited(){if(State.isEmpty())return 0;for(var needles=Array.prototype.concat.apply([],0===arguments.length?[State.passage]:arguments),played=State.passages,count=State.turns,i=0;i<needles.length&&count>0;++i)count=Math.min(count,played.count(needles[i]));return count}function visitedTags(){if(0===arguments.length)throw new Error("visitedTags called with insufficient parameters");if(State.isEmpty())return 0;for(var needles=Array.prototype.concat.apply([],arguments),nLength=needles.length,played=State.passages,seen=new Map,count=0,i=0;i<played.length;++i){var title=played[i];if(seen.has(title))seen.get(title)&&++count;else{var _tags2=Story.get(title).tags;if(_tags2.length>0){for(var found=0,j=0;j<nLength;++j)_tags2.includes(needles[j])&&++found;found===nLength?(++count,seen.set(title,!0)):seen.set(title,!1)}}}return count}var _ref9=function(){function slugifyUrl(url){return parseURL(url).path.replace(/^[^\w]+|[^\w]+$/g,"").replace(/[^\w]+/g,"-").toLocaleLowerCase()}function addScript(url){return new Promise((function(resolve,reject){var kind,src;if("string"==typeof url)kind=url.trim().toLowerCase().endsWith(".mjs")?"module":"text/javascript",src=url;else{if("object"!==_typeof(url))throw new Error("importScripts url parameter must be a string or object");kind=url.type,src=url.src}jQuery(document.createElement("script")).one("load abort error",(function(ev){jQuery(ev.target).off(),"load"===ev.type?resolve(ev.target):reject(new Error('importScripts failed to load the script "'.concat(src,'"')))})).appendTo(document.head).attr({id:"script-imported-".concat(slugifyUrl(src)),type:kind,src:src})}))}function addStyle(url){return new Promise((function(resolve,reject){if("string"!=typeof url)throw new Error("importStyles url parameter must be a string");jQuery(document.createElement("link")).one("load abort error",(function(ev){jQuery(ev.target).off(),"load"===ev.type?resolve(ev.target):reject(new Error('importStyles failed to load the stylesheet "'.concat(url,'"')))})).appendTo(document.head).attr({id:"style-imported-".concat(slugifyUrl(url)),rel:"stylesheet",href:url})}))}function sequence(callbacks){return callbacks.reduce((function(seq,fn){return seq.then(fn)}),Promise.resolve())}return{importScripts:function(){for(var _len12=arguments.length,urls=new Array(_len12),_key12=0;_key12<_len12;_key12++)urls[_key12]=arguments[_key12];return Promise.all(urls.map((function(oneOrSeries){return Array.isArray(oneOrSeries)?sequence(oneOrSeries.map((function(url){return function(){return addScript(url)}}))):addScript(oneOrSeries)})))},importStyles:function(){for(var _len13=arguments.length,urls=new Array(_len13),_key13=0;_key13<_len13;_key13++)urls[_key13]=arguments[_key13];return Promise.all(urls.map((function(oneOrSeries){return Array.isArray(oneOrSeries)?sequence(oneOrSeries.map((function(url){return function(){return addStyle(url)}}))):addStyle(oneOrSeries)})))}}}(),importScripts=_ref9.importScripts,importStyles=_ref9.importStyles,desugar=function(){var tokenTable=enumFrom({$:"State.variables.",_:"State.temporary.",to:"=",eq:"==",neq:"!=",is:"===",isnot:"!==",gt:">",gte:">=",lt:"<",lte:"<=",and:"&&",or:"||",not:"!",def:'"undefined" !== typeof',ndef:'"undefined" === typeof'}),desugarRE=new RegExp(["(?:\"\"|''|``)",'(?:"(?:\\\\.|[^"\\\\])+")',"(?:'(?:\\\\.|[^'\\\\])+')","(`(?:\\\\.|[^`\\\\])+`)","(?:[=+\\-*\\/%<>&\\|\\^~!?:,;\\(\\)\\[\\]{}]+)","(?:\\.{3})","([^\"'=+\\-*\\/%<>&\\|\\^~!?:,;\\(\\)\\[\\]{}\\s]+)"].join("|"),"g"),varTest=new RegExp("^".concat(Patterns.variable)),withColonTestRE=new RegExp("^".concat(Patterns.space,"*:"));function desugar(rawCodeString){if(0!==desugarRE.lastIndex)throw new RangeError("Scripting.desugar last index is non-zero at start");for(var match,code=rawCodeString,lastMatch="";null!==(match=desugarRE.exec(code));){if(match[1]){var rawTemplate=match[1],desugaredTemplate=desugarTemplate(rawTemplate);desugaredTemplate!==rawTemplate&&(code=code.splice(match.index,rawTemplate.length,desugaredTemplate),desugarRE.lastIndex+=desugaredTemplate.length-rawTemplate.length)}else if(match[2]){var token=match[2];if("$"===token||"_"===token)continue;if(withColonTestRE.test(code.slice(desugarRE.lastIndex))&&!lastMatch.endsWith("?"))continue;varTest.test(token)&&(token=token[0]),tokenTable[token]&&(code=code.splice(match.index,token.length,tokenTable[token]),desugarRE.lastIndex+=tokenTable[token].length-token.length)}lastMatch=match[0]}return code}var templateGroupStartRE=/\$\{/g,templateGroupParseRE=new RegExp(["(?:\"\"|'')",'(?:"(?:\\\\.|[^"\\\\])+")',"(?:'(?:\\\\.|[^'\\\\])+')","(\\{)","(\\})"].join("|"),"g");function desugarTemplate(rawTemplateLiteral){if(0!==templateGroupStartRE.lastIndex)throw new RangeError("Scripting.desugar last index is non-zero at start of template literal");for(var startMatch,template=rawTemplateLiteral;null!==(startMatch=templateGroupStartRE.exec(template));){var startIndex=startMatch.index+2,endIndex=startIndex,depth=1,endMatch=void 0;for(templateGroupParseRE.lastIndex=startIndex;null!==(endMatch=templateGroupParseRE.exec(template));)if(endMatch[1]?++depth:endMatch[2]&&--depth,0===depth){endIndex=endMatch.index;break}if(endIndex>startIndex){var desugarIndex=desugarRE.lastIndex,rawGroup=template.slice(startIndex,endIndex);desugarRE.lastIndex=0;var desugaredGroup=desugar(rawGroup);desugarRE.lastIndex=desugarIndex,template=template.splice(startIndex,rawGroup.length,desugaredGroup),templateGroupStartRE.lastIndex+=desugaredGroup.length-rawGroup.length}}return template}return desugar}();function evalJavaScript(code,output,data){return function(code,output,SCRIPT$DATA$){return eval(code)}.call(output?{output:output}:null,String(code),output,data)}function evalTwineScript(code,output,data){return function(code,output,SCRIPT$DATA$){return eval(code)}.call(output?{output:output}:null,desugar(String(code)),output,data)}return Object.preventExtensions(Object.create(null,{desugar:{value:desugar},evalJavaScript:{value:evalJavaScript},evalTwineScript:{value:evalTwineScript},parse:{value:desugar}}))}(),_ref10=function(){var Lexer=function(){return _createClass((function Lexer(source,initialState){if(_classCallCheck(this,Lexer),arguments.length<2)throw new Error("Lexer constructor called with too few parameters (source:string , initialState:function)");Object.defineProperties(this,{source:{value:source},initial:{value:initialState},state:{writable:!0,value:initialState},start:{writable:!0,value:0},pos:{writable:!0,value:0},depth:{writable:!0,value:0},items:{writable:!0,value:[]},data:{writable:!0,value:{}}})}),[{key:"reset",value:function(){this.state=this.initial,this.start=0,this.pos=0,this.depth=0,this.items=[],this.data={}}},{key:"run",value:function(){for(;null!==this.state;)this.state=this.state(this);return this.items}},{key:"nextItem",value:function(){for(;0===this.items.length&&null!==this.state;)this.state=this.state(this);return this.items.shift()}},{key:"next",value:function(){return this.pos>=this.source.length?-1:this.source[this.pos++]}},{key:"peek",value:function(){return this.pos>=this.source.length?-1:this.source[this.pos]}},{key:"backup",value:function(num){this.pos-=num||1}},{key:"forward",value:function(num){this.pos+=num||1}},{key:"ignore",value:function(){this.start=this.pos}},{key:"accept",value:function(valid){var ch=this.next();return-1!==ch&&(!!valid.includes(ch)||(this.backup(),!1))}},{key:"acceptRe",value:function(validRe){var ch=this.next();return-1!==ch&&(!!validRe.test(ch)||(this.backup(),!1))}},{key:"acceptRun",value:function(valid){for(;;){var ch=this.next();if(-1===ch)return;if(!valid.includes(ch))break}this.backup()}},{key:"acceptRunRe",value:function(validRe){for(;;){var ch=this.next();if(-1===ch)return;if(!validRe.test(ch))break}this.backup()}},{key:"emit",value:function(type){this.items.push({type:type,text:this.source.slice(this.start,this.pos),start:this.start,pos:this.pos}),this.start=this.pos}},{key:"error",value:function(type,message){if(arguments.length<2)throw new Error("Lexer.prototype.error called with too few parameters (type:number , message:string)");return this.items.push({type:type,message:message,text:this.source.slice(this.start,this.pos),start:this.start,pos:this.pos}),null}}],[{key:"enumFromNames",value:function(names){var obj=names.reduce((function(obj,name,i){return obj[name]=i,obj}),{});return Object.freeze(Object.assign(Object.create(null),obj))}}])}();return{EOF:-1,Lexer:Lexer}}(),EOF=_ref10.EOF,Lexer=_ref10.Lexer,Wikifier=function(){var _optionsStack,macroParser,lookaheadRe,idOrClassRe,_callDepth=0,Wikifier=function(){function Wikifier(destination,source,options){_classCallCheck(this,Wikifier),Wikifier.Parser.Profile.isEmpty()&&Wikifier.Parser.Profile.compile(),Object.defineProperties(this,{source:{value:String(source)},options:{writable:!0,value:Object.assign({profile:"all"},options)},nextMatch:{writable:!0,value:0},output:{writable:!0,value:null},_rawArgs:{writable:!0,value:""}}),this.output=null==destination?document.createDocumentFragment():destination instanceof jQuery?destination[0]:destination;try{++_callDepth,this.subWikify(this.output),1===_callDepth&&(Object.hasOwn(this.options,"cleanup")&&null!=this.options.cleanup?this.options.cleanup:Config.cleanupWikifierOutput)&&convertBreaks(this.output)}finally{--_callDepth}}return _createClass(Wikifier,[{key:"subWikify",value:function(output,terminator,options){var newOptions,oldOptions,oldOutput=this.output;this.output=output,Wikifier.Option.length>0&&(newOptions=Object.assign(newOptions||{},Wikifier.Option.options)),null!==options&&"object"===_typeof(options)&&(newOptions=Object.assign(newOptions||{},options)),newOptions&&(oldOptions=this.options,this.options=Object.assign({},this.options,newOptions));var terminatorMatch,parserMatch,parsersProfile=Wikifier.Parser.Profile.get(this.options.profile),terminatorRegExp=terminator?new RegExp("(?:".concat(terminator,")"),this.options.ignoreTerminatorCase?"gim":"gm"):null;do{if(parsersProfile.parserRegExp.lastIndex=this.nextMatch,terminatorRegExp&&(terminatorRegExp.lastIndex=this.nextMatch),parserMatch=parsersProfile.parserRegExp.exec(this.source),(terminatorMatch=terminatorRegExp?terminatorRegExp.exec(this.source):null)&&(!parserMatch||terminatorMatch.index<=parserMatch.index))return terminatorMatch.index>this.nextMatch&&this.outputText(this.output,this.nextMatch,terminatorMatch.index),this.matchStart=terminatorMatch.index,this.matchLength=terminatorMatch[0].length,this.matchText=terminatorMatch[0],this.nextMatch=terminatorRegExp.lastIndex,this.output=oldOutput,void(oldOptions&&(this.options=oldOptions));if(parserMatch){parserMatch.index>this.nextMatch&&this.outputText(this.output,this.nextMatch,parserMatch.index),this.matchStart=parserMatch.index,this.matchLength=parserMatch[0].length,this.matchText=parserMatch[0],this.nextMatch=parsersProfile.parserRegExp.lastIndex;for(var matchingParser=void 0,i=1,iend=parserMatch.length;i<iend;++i)if(parserMatch[i]){matchingParser=i-1;break}if(parsersProfile.parsers[matchingParser].handler(this),null!=TempState.break)break}}while(terminatorMatch||parserMatch);null==TempState.break?this.nextMatch<this.source.length&&(this.outputText(this.output,this.nextMatch,this.source.length),this.nextMatch=this.source.length):this.output.lastChild&&this.output.lastChild.nodeType===Node.ELEMENT_NODE&&"BR"===this.output.lastChild.nodeName.toUpperCase()&&jQuery(this.output.lastChild).remove(),this.output=oldOutput,oldOptions&&(this.options=oldOptions)}},{key:"outputText",value:function(destination,startPos,endPos){jQuery(destination).append(document.createTextNode(this.source.substring(startPos,endPos)))}},{key:"rawArgs",value:function(){return console.warn("[DEPRECATED] Wikifier.rawArgs() is deprecated."),this._rawArgs}},{key:"fullArgs",value:function(){return console.warn("[DEPRECATED] Wikifier.fullArgs() is deprecated."),Scripting.desugar(this._rawArgs)}}],[{key:"wikifyEval",value:function(text){var output=document.createDocumentFragment();new Wikifier(output,text);var errors=output.querySelector(".error");if(null!==errors)throw new Error(errors.textContent.replace(errorPrologRegExp,""));return output}},{key:"createInternalLink",value:function(destination,passage,text,callback){var $link=jQuery(document.createElement("a"));return null!=passage&&($link.attr("data-passage",passage),Story.has(passage)?($link.addClass("link-internal"),Config.addVisitedLinkClass&&State.hasPlayed(passage)&&$link.addClass("link-visited")):$link.addClass("link-broken"),$link.ariaClick({one:!0},(function(){"function"==typeof callback&&callback(),Engine.play(passage)}))),text&&$link.append(document.createTextNode(text)),destination&&$link.appendTo(destination),$link[0]}},{key:"createExternalLink",value:function(destination,url,text){var $link=jQuery(document.createElement("a")).attr("target","_blank").addClass("link-external").text(text).appendTo(destination);return null!=url&&$link.attr({href:url,tabindex:0}),$link[0]}}])}();return Object.defineProperty(Wikifier,"Option",{value:(_optionsStack=[],Object.preventExtensions(Object.create(null,{length:{get:function(){return _optionsStack.length}},options:{get:function(){return Object.assign.apply(Object,[{}].concat(_toConsumableArray(_optionsStack)))}},clear:{value:function(){_optionsStack=[]}},get:{value:function(index){return _optionsStack[index]}},pop:{value:function(){return _optionsStack.pop()}},push:{value:function(options){if("object"!==_typeof(options)||null===options)throw new TypeError("Wikifier.Option.push options parameter must be an object (received: ".concat(getTypeOf(options),")"));return _optionsStack.push(options)}}})))}),Object.defineProperty(Wikifier,"Parser",{value:function(){var _profiles,_parsers=[];function parsersHas(name){return!!_parsers.find((function(parser){return parser.name===name}))}return Object.preventExtensions(Object.create(null,{parsers:{get:function(){return _parsers}},add:{value:function(parser){if("object"!==_typeof(parser))throw new Error("Wikifier.Parser.add parser parameter must be an object");if(!Object.hasOwn(parser,"name"))throw new Error('parser object missing required "name" property');if("string"!=typeof parser.name)throw new Error('parser object "name" property must be a string');if(!Object.hasOwn(parser,"match"))throw new Error('parser object missing required "match" property');if("string"!=typeof parser.match)throw new Error('parser object "match" property must be a string');if(!Object.hasOwn(parser,"handler"))throw new Error('parser object missing required "handler" property');if("function"!=typeof parser.handler)throw new Error('parser object "handler" property must be a function');if(Object.hasOwn(parser,"profiles")&&!Array.isArray(parser.profiles))throw new Error('parser object "profiles" property must be an array');if(parsersHas(parser.name))throw new Error('cannot clobber existing parser "'.concat(parser.name,'"'));_parsers.push(parser)}},delete:{value:function(name){var parser=_parsers.find((function(parser){return parser.name===name}));parser&&_parsers.delete(parser)}},isEmpty:{value:function(){return 0===_parsers.length}},has:{value:parsersHas},get:{value:function(name){return _parsers.find((function(parser){return parser.name===name}))||null}},Profile:{value:Object.preventExtensions(Object.create(null,{profiles:{get:function(){return _profiles}},compile:{value:function(){var all=_parsers,core=all.filter((function(parser){return!Array.isArray(parser.profiles)||parser.profiles.includes("core")}));return _profiles=Object.freeze({all:{parsers:all,parserRegExp:new RegExp(all.map((function(parser){return"(".concat(parser.match,")")})).join("|"),"gm")},core:{parsers:core,parserRegExp:new RegExp(core.map((function(parser){return"(".concat(parser.match,")")})).join("|"),"gm")}})}},isEmpty:{value:function(){return"object"!==_typeof(_profiles)||0===Object.keys(_profiles).length}},has:{value:function(profile){return"object"===_typeof(_profiles)&&Object.hasOwn(_profiles,profile)}},get:{value:function(profile){if("object"!==_typeof(_profiles)||!Object.hasOwn(_profiles,profile))throw new Error('nonexistent parser profile "'.concat(profile,'"'));return _profiles[profile]}}}))}}))}()}),Object.defineProperties(Wikifier,{helpers:{value:{}},isExternalLink:{value:isExternalLink},getValue:{value:State.getVar},setValue:{value:State.setVar},parse:{value:Scripting.desugar},evalExpression:{value:Scripting.evalTwineScript},evalStatements:{value:Scripting.evalTwineScript},textPrimitives:{value:Patterns}}),Object.defineProperties(Wikifier.helpers,{inlineCss:{value:(lookaheadRe=new RegExp(Patterns.inlineCss,"gm"),idOrClassRe=new RegExp("(".concat(Patterns.cssIdOrClassSigil,")(").concat(Patterns.anyLetter,"+)"),"g"),function(w){var matched,css={classes:[],id:"",styles:{}};do{lookaheadRe.lastIndex=w.nextMatch;var match=lookaheadRe.exec(w.source);if(matched=match&&match.index===w.nextMatch){if(match[1])css.styles[cssPropToDOMProp(match[1])]=match[2].trim();else if(match[3])css.styles[cssPropToDOMProp(match[3])]=match[4].trim();else if(match[5]){var subMatch=void 0;for(idOrClassRe.lastIndex=0;null!==(subMatch=idOrClassRe.exec(match[5]));)"."===subMatch[1]?css.classes.push(subMatch[2]):css.id=subMatch[2]}w.nextMatch=lookaheadRe.lastIndex}}while(matched);return css})},evalText:{value:function(text){var result;try{switch(_typeof(result=Scripting.evalTwineScript(text))){case"string":""===result.trim()&&(result=text);break;case"number":result=String(result);break;default:result=text}}catch(ex){result=text}return result}},evalPassageId:{value:function(passage){return null==passage||Story.has(passage)?passage:Wikifier.helpers.evalText(passage)}},hasBlockContext:{value:function(nodes){for(var hasGCS="function"==typeof window.getComputedStyle,i=nodes.length-1;i>=0;--i){var node=nodes[i];switch(node.nodeType){case Node.ELEMENT_NODE:var tagName=node.nodeName.toUpperCase();if("BR"===tagName)return!0;var styles=hasGCS?window.getComputedStyle(node,null):node.currentStyle;if(styles&&styles.display){if("none"===styles.display)continue;return"block"===styles.display}switch(tagName){case"ADDRESS":case"ARTICLE":case"ASIDE":case"BLOCKQUOTE":case"CENTER":case"DIV":case"DL":case"FIGURE":case"FOOTER":case"FORM":case"H1":case"H2":case"H3":case"H4":case"H5":case"H6":case"HEADER":case"HR":case"MAIN":case"NAV":case"OL":case"P":case"PRE":case"SECTION":case"TABLE":case"UL":return!0}return!1;case Node.COMMENT_NODE:continue;default:return!1}}return!0}},shadowHandler:{value:(macroParser=null,function(code){var shadowStore=Object.create(null);return macroParser||function(){if(!macroParser&&!(macroParser=Wikifier.Parser.get("macro")))throw new Error('cannot find "macro" parser')}(),macroParser.context&&macroParser.context.shadowView.forEach((function(varName){var varKey=varName.slice(1),store="$"===varName[0]?State.variables:State.temporary;shadowStore[varName]=store[varKey]})),function(){var shadowNames=Object.keys(shadowStore),valueCache=shadowNames.length>0?{}:null;try{return shadowNames.forEach((function(varName){var varKey=varName.slice(1),store="$"===varName[0]?State.variables:State.temporary;Object.hasOwn(store,varKey)&&(valueCache[varKey]=store[varKey]),store[varKey]=shadowStore[varName]})),Scripting.evalJavaScript(code)}finally{shadowNames.forEach((function(varName){var varKey=varName.slice(1),store="$"===varName[0]?State.variables:State.temporary;shadowStore[varName]=store[varKey],Object.hasOwn(valueCache,varKey)?store[varKey]=valueCache[varKey]:delete store[varKey]}))}}})},parseSquareBracketedMarkup:{value:function(){var Item=Lexer.enumFromNames(["Error","DelimLTR","DelimRTL","InnerMeta","ImageMeta","LinkMeta","Link","RightMeta","Setter","Source","Text"]),Delim=Lexer.enumFromNames(["None","LTR","RTL"]);function slurpQuote(lexer,endQuote){loop:for(;;)switch(lexer.next()){case"\\":var ch=lexer.next();if(ch!==EOF&&"\n"!==ch)break;case EOF:case"\n":return EOF;case endQuote:break loop}return lexer.pos}function lexLeftMeta(lexer){if(!lexer.accept("["))return lexer.error(Item.Error,"malformed square-bracketed markup");if(lexer.accept("["))lexer.data.isLink=!0,lexer.emit(Item.LinkMeta);else{if(lexer.accept("<>"),!(lexer.accept("Ii")&&lexer.accept("Mm")&&lexer.accept("Gg")&&lexer.accept("[")))return lexer.error(Item.Error,"malformed square-bracketed markup");lexer.data.isLink=!1,lexer.emit(Item.ImageMeta)}return lexer.depth=2,lexCoreComponents}function lexCoreComponents(lexer){for(var what=lexer.data.isLink?"link":"image",delim=Delim.None;;)switch(lexer.next()){case EOF:case"\n":return lexer.error(Item.Error,"unterminated ".concat(what," markup"));case'"':if(slurpQuote(lexer,'"')===EOF)return lexer.error(Item.Error,"unterminated double quoted string in ".concat(what," markup"));break;case"|":delim===Delim.None&&(delim=Delim.LTR,lexer.backup(),lexer.emit(Item.Text),lexer.forward(),lexer.emit(Item.DelimLTR));break;case"-":delim===Delim.None&&">"===lexer.peek()&&(delim=Delim.LTR,lexer.backup(),lexer.emit(Item.Text),lexer.forward(2),lexer.emit(Item.DelimLTR));break;case"<":delim===Delim.None&&"-"===lexer.peek()&&(delim=Delim.RTL,lexer.backup(),lexer.emit(lexer.data.isLink?Item.Link:Item.Source),lexer.forward(2),lexer.emit(Item.DelimRTL));break;case"[":++lexer.depth;break;case"]":if(--lexer.depth,1===lexer.depth)switch(lexer.peek()){case"[":return++lexer.depth,lexer.backup(),delim===Delim.RTL?lexer.emit(Item.Text):lexer.emit(lexer.data.isLink?Item.Link:Item.Source),lexer.forward(2),lexer.emit(Item.InnerMeta),lexer.data.isLink?lexSetter:lexImageLink;case"]":return--lexer.depth,lexer.backup(),delim===Delim.RTL?lexer.emit(Item.Text):lexer.emit(lexer.data.isLink?Item.Link:Item.Source),lexer.forward(2),lexer.emit(Item.RightMeta),null;default:return lexer.error(Item.Error,"malformed ".concat(what," markup"))}}}function lexImageLink(lexer){for(var what=lexer.data.isLink?"link":"image";;)switch(lexer.next()){case EOF:case"\n":return lexer.error(Item.Error,"unterminated ".concat(what," markup"));case'"':if(slurpQuote(lexer,'"')===EOF)return lexer.error(Item.Error,"unterminated double quoted string in ".concat(what," markup link component"));break;case"[":++lexer.depth;break;case"]":if(--lexer.depth,1===lexer.depth)switch(lexer.peek()){case"[":return++lexer.depth,lexer.backup(),lexer.emit(Item.Link),lexer.forward(2),lexer.emit(Item.InnerMeta),lexSetter;case"]":return--lexer.depth,lexer.backup(),lexer.emit(Item.Link),lexer.forward(2),lexer.emit(Item.RightMeta),null;default:return lexer.error(Item.Error,"malformed ".concat(what," markup"))}}}function lexSetter(lexer){for(var what=lexer.data.isLink?"link":"image";;)switch(lexer.next()){case EOF:case"\n":return lexer.error(Item.Error,"unterminated ".concat(what," markup"));case'"':if(slurpQuote(lexer,'"')===EOF)return lexer.error(Item.Error,"unterminated double quoted string in ".concat(what," markup setter component"));break;case"'":if(slurpQuote(lexer,"'")===EOF)return lexer.error(Item.Error,"unterminated single quoted string in ".concat(what," markup setter component"));break;case"[":++lexer.depth;break;case"]":if(--lexer.depth,1===lexer.depth)return"]"!==lexer.peek()?lexer.error(Item.Error,"malformed ".concat(what," markup")):(--lexer.depth,lexer.backup(),lexer.emit(Item.Setter),lexer.forward(2),lexer.emit(Item.RightMeta),null)}}return function(w){var lexer=new Lexer(w.source,lexLeftMeta);lexer.start=lexer.pos=w.matchStart;var markup={},items=lexer.run(),last=items.last();return last&&last.type===Item.Error?markup.error=last.message:items.forEach((function(item){var text=item.text.trim();switch(item.type){case Item.ImageMeta:markup.isImage=!0,"<"===text[1]?markup.align="left":">"===text[1]&&(markup.align="right");break;case Item.LinkMeta:markup.isLink=!0;break;case Item.Link:"~"===text[0]?(markup.forceInternal=!0,markup.link=text.slice(1)):markup.link=text;break;case Item.Setter:markup.setter=text;break;case Item.Source:markup.source=text;break;case Item.Text:markup.text=text}})),markup.pos=lexer.pos,markup}}()}}),Wikifier}();!function(){function _verbatimTagHandler(w){this.lookahead.lastIndex=w.matchStart;var match=this.lookahead.exec(w.source);match&&match.index===w.matchStart&&(w.nextMatch=this.lookahead.lastIndex,jQuery(document.createDocumentFragment()).append(match[1]).appendTo(w.output))}Wikifier.Parser.add({name:"quoteByBlock",profiles:["block"],match:"^<<<\\n",terminator:"^<<<\\n",handler:function(w){Wikifier.helpers.hasBlockContext(w.output.childNodes)?w.subWikify(jQuery(document.createElement("blockquote")).appendTo(w.output).get(0),this.terminator):jQuery(w.output).append(document.createTextNode(w.matchText))}}),Wikifier.Parser.add({name:"quoteByLine",profiles:["block"],match:"^>+",lookahead:/^>+/gm,terminator:"\\n",handler:function(w){if(Wikifier.helpers.hasBlockContext(w.output.childNodes)){var matched,i,destStack=[w.output],curLevel=0,newLevel=w.matchLength;do{if(newLevel>curLevel)for(i=curLevel;i<newLevel;++i)destStack.push(jQuery(document.createElement("blockquote")).appendTo(destStack[destStack.length-1]).get(0));else if(newLevel<curLevel)for(i=curLevel;i>newLevel;--i)destStack.pop();curLevel=newLevel,w.subWikify(destStack[destStack.length-1],this.terminator),jQuery(document.createElement("br")).appendTo(destStack[destStack.length-1]),this.lookahead.lastIndex=w.nextMatch;var match=this.lookahead.exec(w.source);(matched=match&&match.index===w.nextMatch)&&(newLevel=match[0].length,w.nextMatch+=match[0].length)}while(matched)}else jQuery(w.output).append(document.createTextNode(w.matchText))}}),Wikifier.Parser.add({name:"macro",profiles:["core"],match:"<<",lookahead:new RegExp("<<(/?".concat(Patterns.macroName,")(?:\\s*)((?:(?:/\\*[^*]*\\*+(?:[^/*][^*]*\\*+)*/)|(?://.*\\n)|(?:`(?:\\\\.|[^`\\\\])*`)|(?:\"(?:\\\\.|[^\"\\\\])*\")|(?:'(?:\\\\.|[^'\\\\])*')|(?:\\[(?:[<>]?[Ii][Mm][Gg])?\\[[^\\r\\n]*?\\]\\]+)|[^>]|(?:>(?!>)))*)>>"),"gm"),working:{source:"",name:"",arguments:"",index:0},context:null,handler:function(w){var matchStart=this.lookahead.lastIndex=w.matchStart;if(this.parseTag(w)){var macro,nextMatch=w.nextMatch,name=this.working.name,rawArgs=this.working.arguments;try{if(!(macro=Macro.get(name))){if(Macro.tags.has(name)){var tags=Macro.tags.get(name);return appendError(w.output,"child tag <<".concat(name,">> was found outside of a call to its parent macro").concat(1===tags.length?"":"s"," <<").concat(tags.join(">>, <<"),">>"),w.source.slice(matchStart,w.nextMatch))}return appendError(w.output,"macro <<".concat(name,">> does not exist"),w.source.slice(matchStart,w.nextMatch))}var payload=null;if(void 0!==macro.tags&&!(payload=this.parseBody(w,macro)))return w.nextMatch=nextMatch,appendError(w.output,"cannot find a closing tag for macro <<".concat(name,">>"),"".concat(w.source.slice(matchStart,w.nextMatch),"…"));if("function"!=typeof macro.handler)return appendError(w.output,"macro <<".concat(name,">> handler function ").concat(void 0===macro.handler?"does not exist":"is not a function"),w.source.slice(matchStart,w.nextMatch));var args=payload?payload[0].args:this.createArgs(rawArgs,this.skipArgs(macro,macro.name));if(void 0!==macro._MACRO_API){this.context=new MacroContext({macro:macro,name:name,args:args,payload:payload,source:w.source.slice(matchStart,w.nextMatch),parent:this.context,parser:w});try{macro.handler.call(this.context)}finally{this.context=this.context.parent}}else{console.warn("[DEPRECATED] The legacy macro API, used by <<".concat(name,">>, is deprecated."));var prevRawArgs=w._rawArgs;w._rawArgs=rawArgs;try{macro.handler(w.output,name,args,w,payload)}finally{w._rawArgs=prevRawArgs}}}catch(ex){return appendError(w.output,"cannot execute ".concat(macro&&macro.isWidget?"widget":"macro"," <<").concat(name,">>: ").concat(ex.message),w.source.slice(matchStart,w.nextMatch))}finally{this.working.source="",this.working.name="",this.working.arguments="",this.working.index=0}}else w.outputText(w.output,w.matchStart,w.nextMatch)},parseTag:function(w){var match=this.lookahead.exec(w.source);return!(!match||match.index!==w.matchStart||!match[1])&&(w.nextMatch=this.lookahead.lastIndex,this.working.source=w.source.slice(match.index,this.lookahead.lastIndex),this.working.name=match[1],this.working.arguments=match[2],this.working.index=match.index,!0)},parseBody:function(w,macro){for(var openTag=this.working.name,closeTag="/".concat(openTag),closeAlt="end".concat(openTag),bodyTags=!!Array.isArray(macro.tags)&&macro.tags,payload=[],end=-1,opened=1,curSource=this.working.source,curTag=this.working.name,curArgument=this.working.arguments,contentStart=w.nextMatch;-1!==(w.matchStart=w.source.indexOf(this.match,w.nextMatch));)if(this.parseTag(w)){var tagSource=this.working.source,tagName=this.working.name,tagArgs=this.working.arguments,tagBegin=this.working.index,tagEnd=w.nextMatch,hasArgs=""!==tagArgs.trim();switch(tagName){case openTag:++opened;break;case closeAlt:case closeTag:if(hasArgs)throw w.nextMatch=tagBegin+2+tagName.length,new Error('malformed closing tag: "'.concat(tagSource,'"'));--opened;break;default:if(hasArgs&&(tagName.startsWith("/")||tagName.startsWith("end"))){this.lookahead.lastIndex=w.nextMatch=tagBegin+2+tagName.length;continue}if(1===opened&&bodyTags)for(var i=0,iend=bodyTags.length;i<iend;++i)tagName===bodyTags[i]&&(payload.push({source:curSource,name:curTag,arguments:curArgument,args:this.createArgs(curArgument,this.skipArgs(macro,curTag)),contents:w.source.slice(contentStart,tagBegin)}),curSource=tagSource,curTag=tagName,curArgument=tagArgs,contentStart=tagEnd)}if(0===opened){payload.push({source:curSource,name:curTag,arguments:curArgument,args:this.createArgs(curArgument,this.skipArgs(macro,curTag)),contents:w.source.slice(contentStart,tagBegin)}),end=tagEnd;break}}else this.lookahead.lastIndex=w.nextMatch=w.matchStart+this.match.length;return-1!==end?(w.nextMatch=end,payload):null},createArgs:function(rawArgsString,skipArgs){var args=skipArgs?[]:this.parseArgs(rawArgsString);return Object.defineProperties(args,{raw:{value:rawArgsString},full:{value:Scripting.desugar(rawArgsString)}}),args},skipArgs:function(macro,tagName){if(void 0!==macro.skipArgs){var sa=macro.skipArgs;return"boolean"==typeof sa&&sa||Array.isArray(sa)&&sa.includes(tagName)}return void 0!==macro.skipArg0&&(macro.skipArg0&&macro.name===tagName)},parseArgs:function(){var Item=Lexer.enumFromNames(["Error","Bareword","Expression","String","SquareBracket"]),spaceRe=new RegExp(Patterns.space),notSpaceRe=new RegExp(Patterns.notSpace),varTest=new RegExp("^".concat(Patterns.variable));function slurpQuote(lexer,endQuote){loop:for(;;)switch(lexer.next()){case"\\":var ch=lexer.next();if(ch!==EOF&&"\n"!==ch)break;case EOF:case"\n":return EOF;case endQuote:break loop}return lexer.pos}function lexSpace(lexer){var offset=lexer.source.slice(lexer.pos).search(notSpaceRe);if(offset===EOF)return null;switch(0!==offset&&(lexer.pos+=offset,lexer.ignore()),lexer.next()){case"`":return lexExpression;case'"':return lexDoubleQuote;case"'":return lexSingleQuote;case"[":return lexSquareBracket;default:return lexBareword}}function lexExpression(lexer){return slurpQuote(lexer,"`")===EOF?lexer.error(Item.Error,"unterminated backquote expression"):(lexer.emit(Item.Expression),lexSpace)}function lexDoubleQuote(lexer){return slurpQuote(lexer,'"')===EOF?lexer.error(Item.Error,"unterminated double quoted string"):(lexer.emit(Item.String),lexSpace)}function lexSingleQuote(lexer){return slurpQuote(lexer,"'")===EOF?lexer.error(Item.Error,"unterminated single quoted string"):(lexer.emit(Item.String),lexSpace)}function lexSquareBracket(lexer){var what;if(lexer.accept("<>IiMmGg")?(what="image",lexer.acceptRun("<>IiMmGg")):what="link",!lexer.accept("["))return lexer.error(Item.Error,"malformed ".concat(what," markup"));lexer.depth=2;loop:for(;;)switch(lexer.next()){case"\\":var ch=lexer.next();if(ch!==EOF&&"\n"!==ch)break;case EOF:case"\n":return lexer.error(Item.Error,"unterminated ".concat(what," markup"));case"[":++lexer.depth;break;case"]":if(--lexer.depth,lexer.depth<0)return lexer.error(Item.Error,"unexpected right square bracket ']'");if(1===lexer.depth){if("]"===lexer.next()){--lexer.depth;break loop}lexer.backup()}}return lexer.emit(Item.SquareBracket),lexSpace}function lexBareword(lexer){var offset=lexer.source.slice(lexer.pos).search(spaceRe);return lexer.pos=offset===EOF?lexer.source.length:lexer.pos+offset,lexer.emit(Item.Bareword),offset===EOF?null:lexSpace}return function(rawArgsString){var lexer=new Lexer(rawArgsString,lexSpace),args=[];return lexer.run().forEach((function(item){var arg=item.text;switch(item.type){case Item.Error:throw new Error('unable to parse macro argument "'.concat(arg,'": ').concat(item.message));case Item.Bareword:if(varTest.test(arg))arg=State.getVar(arg);else if(/^(?:settings|setup)[.[]/.test(arg))try{arg=Scripting.evalTwineScript(arg)}catch(ex){throw new Error('unable to parse macro argument "'.concat(arg,'": ').concat(ex.message))}else if("null"===arg)arg=null;else if("undefined"===arg)arg=undefined;else if("true"===arg)arg=!0;else if("false"===arg)arg=!1;else if("NaN"===arg)arg=NaN;else{var argAsNum=Number(arg);Number.isNaN(argAsNum)||(arg=argAsNum)}break;case Item.Expression:if(""===(arg=arg.slice(1,-1).trim()))arg=undefined;else try{arg=Scripting.evalTwineScript("(".concat(arg,")"))}catch(ex){throw new Error('unable to parse macro argument expression "'.concat(arg,'": ').concat(ex.message))}break;case Item.String:try{arg=Scripting.evalJavaScript(arg)}catch(ex){throw new Error('unable to parse macro argument string "'.concat(arg,'": ').concat(ex.message))}break;case Item.SquareBracket:var markup=Wikifier.helpers.parseSquareBracketedMarkup({source:arg,matchStart:0});if(Object.hasOwn(markup,"error"))throw new Error('unable to parse macro argument "'.concat(arg,'": ').concat(markup.error));if(markup.pos<arg.length)throw new Error('unable to parse macro argument "'.concat(arg,'": unexpected character(s) "').concat(arg.slice(markup.pos),'" (pos: ').concat(markup.pos,")"));markup.isLink?((arg={isLink:!0}).count=Object.hasOwn(markup,"text")?2:1,arg.link=Wikifier.helpers.evalPassageId(markup.link),arg.text=Object.hasOwn(markup,"text")?Wikifier.helpers.evalText(markup.text):arg.link,arg.external=!markup.forceInternal&&Wikifier.isExternalLink(arg.link),arg.setFn=Object.hasOwn(markup,"setter")?Wikifier.helpers.shadowHandler(Scripting.desugar(markup.setter)):null):markup.isImage&&(arg=function(source){var imgObj={source:source,isImage:!0};if("data:"!==source.slice(0,5)&&Story.has(source)){var passage=Story.get(source);passage.tags.includes("Twine.image")&&(imgObj.source=passage.text,imgObj.passage=passage.name)}return imgObj}(Wikifier.helpers.evalPassageId(markup.source)),Object.hasOwn(markup,"align")&&(arg.align=markup.align),Object.hasOwn(markup,"text")&&(arg.title=Wikifier.helpers.evalText(markup.text)),Object.hasOwn(markup,"link")&&(arg.link=Wikifier.helpers.evalPassageId(markup.link),arg.external=!markup.forceInternal&&Wikifier.isExternalLink(arg.link)),arg.setFn=Object.hasOwn(markup,"setter")?Wikifier.helpers.shadowHandler(Scripting.desugar(markup.setter)):null)}args.push(arg)})),args}}()}),Wikifier.Parser.add({name:"link",profiles:["core"],match:"\\[\\[[^[]",handler:function(w){var markup=Wikifier.helpers.parseSquareBracketedMarkup(w);if(Object.hasOwn(markup,"error"))w.outputText(w.output,w.matchStart,w.nextMatch);else{w.nextMatch=markup.pos;var link=Wikifier.helpers.evalPassageId(markup.link),text=Object.hasOwn(markup,"text")?Wikifier.helpers.evalText(markup.text):link,setFn=Object.hasOwn(markup,"setter")?Wikifier.helpers.shadowHandler(Scripting.desugar(markup.setter)):null,output=(Config.debug?new DebugView(w.output,"link-markup","[[link]]",w.source.slice(w.matchStart,w.nextMatch)):w).output;markup.forceInternal||!Wikifier.isExternalLink(link)?Wikifier.createInternalLink(output,link,text,setFn):Wikifier.createExternalLink(output,link,text)}}}),Wikifier.Parser.add({name:"urlLink",profiles:["core"],match:Patterns.url,handler:function(w){w.outputText(Wikifier.createExternalLink(w.output,w.matchText),w.matchStart,w.nextMatch)}}),Wikifier.Parser.add({name:"image",profiles:["core"],match:"\\[[<>]?[Ii][Mm][Gg]\\[",handler:function(w){var markup=Wikifier.helpers.parseSquareBracketedMarkup(w);if(Object.hasOwn(markup,"error"))w.outputText(w.output,w.matchStart,w.nextMatch);else{var debugView;w.nextMatch=markup.pos,Config.debug&&(debugView=new DebugView(w.output,"image-markup",Object.hasOwn(markup,"link")?"[img[][link]]":"[img[]]",w.source.slice(w.matchStart,w.nextMatch))).modes({block:!0});var source,setFn=Object.hasOwn(markup,"setter")?Wikifier.helpers.shadowHandler(Scripting.desugar(markup.setter)):null,el=(Config.debug?debugView:w).output;if(Object.hasOwn(markup,"link")){var link=Wikifier.helpers.evalPassageId(markup.link);(el=markup.forceInternal||!Wikifier.isExternalLink(link)?Wikifier.createInternalLink(el,link,null,setFn):Wikifier.createExternalLink(el,link)).classList.add("link-image")}if(el=jQuery(document.createElement("img")).appendTo(el).get(0),"data:"!==(source=Wikifier.helpers.evalPassageId(markup.source)).slice(0,5)&&Story.has(source)){var passage=Story.get(source);passage.tags.includes("Twine.image")&&(el.setAttribute("data-passage",passage.name),source=passage.text.trim())}el.src=source,Object.hasOwn(markup,"text")&&(el.title=Wikifier.helpers.evalText(markup.text)),Object.hasOwn(markup,"align")&&(el.align=markup.align)}}}),Wikifier.Parser.add({name:"monospacedByBlock",profiles:["block"],match:"^\\{\\{\\{\\n",lookahead:/^\{\{\{\n((?:^[^\n]*\n)+?)(^\}\}\}$\n?)/gm,handler:function(w){this.lookahead.lastIndex=w.matchStart;var match=this.lookahead.exec(w.source);if(match&&match.index===w.matchStart){var pre=jQuery(document.createElement("pre"));jQuery(document.createElement("code")).text(match[1]).appendTo(pre),pre.appendTo(w.output),w.nextMatch=this.lookahead.lastIndex}}}),Wikifier.Parser.add({name:"formatByChar",profiles:["core"],match:"''|//|__|\\^\\^|~~|==|\\{\\{\\{",handler:function(w){switch(w.matchText){case"''":w.subWikify(jQuery(document.createElement("strong")).appendTo(w.output).get(0),"''");break;case"//":w.subWikify(jQuery(document.createElement("em")).appendTo(w.output).get(0),"//");break;case"__":w.subWikify(jQuery(document.createElement("u")).appendTo(w.output).get(0),"__");break;case"^^":w.subWikify(jQuery(document.createElement("sup")).appendTo(w.output).get(0),"\\^\\^");break;case"~~":w.subWikify(jQuery(document.createElement("sub")).appendTo(w.output).get(0),"~~");break;case"==":w.subWikify(jQuery(document.createElement("s")).appendTo(w.output).get(0),"==");break;case"{{{":var lookahead=/\{\{\{((?:.|\n)*?)\}\}\}/gm;lookahead.lastIndex=w.matchStart;var match=lookahead.exec(w.source);match&&match.index===w.matchStart&&(jQuery(document.createElement("code")).text(match[1]).appendTo(w.output),w.nextMatch=lookahead.lastIndex)}}}),Wikifier.Parser.add({name:"customStyle",profiles:["core"],match:"@@",terminator:"@@",blockRe:/\s*\n/gm,handler:function(w){var css=Wikifier.helpers.inlineCss(w);this.blockRe.lastIndex=w.nextMatch;var blockMatch=this.blockRe.exec(w.source),blockLevel=blockMatch&&blockMatch.index===w.nextMatch,$el=jQuery(document.createElement(blockLevel?"div":"span")).appendTo(w.output);0===css.classes.length&&""===css.id&&0===Object.keys(css.styles).length?$el.addClass("marked"):(css.classes.forEach((function(className){return $el.addClass(className)})),""!==css.id&&$el.attr("id",css.id),$el.css(css.styles)),blockLevel?(w.nextMatch+=blockMatch[0].length,w.subWikify($el[0],"\\n?".concat(this.terminator))):w.subWikify($el[0],this.terminator)}}),Wikifier.Parser.add({name:"verbatimText",profiles:["core"],match:'"{3}|<[Nn][Oo][Ww][Ii][Kk][Ii]>',lookahead:/(?:"{3}((?:.|\n)*?)"{3})|(?:<[Nn][Oo][Ww][Ii][Kk][Ii]>((?:.|\n)*?)<\/[Nn][Oo][Ww][Ii][Kk][Ii]>)/gm,handler:function(w){this.lookahead.lastIndex=w.matchStart;var match=this.lookahead.exec(w.source);match&&match.index===w.matchStart&&(w.nextMatch=this.lookahead.lastIndex,jQuery(document.createElement("span")).addClass("verbatim").text(match[1]||match[2]).appendTo(w.output))}}),Wikifier.Parser.add({name:"horizontalRule",profiles:["core"],match:"^----+\\s*$",handler:function(w){jQuery(document.createElement("hr")).appendTo(w.output)}}),Wikifier.Parser.add({name:"emdash",profiles:["core"],match:"--",handler:function(w){jQuery(document.createTextNode("—")).appendTo(w.output)}}),Wikifier.Parser.add({name:"doubleDollarSign",profiles:["core"],match:"\\${2}",handler:function(w){jQuery(document.createTextNode("$")).appendTo(w.output)}}),Wikifier.Parser.add({name:"nakedVariable",profiles:["core"],match:"".concat(Patterns.variable,"(?:(?:\\.").concat(Patterns.identifier,")|(?:\\[\\d+\\])|(?:\\[\"(?:\\\\.|[^\"\\\\])+\"\\])|(?:\\['(?:\\\\.|[^'\\\\])+'\\])|(?:\\[").concat(Patterns.variable,"\\]))*"),handler:function(w){var result=State.getVar(w.matchText);null==result?jQuery(document.createTextNode(w.matchText)).appendTo(w.output):new Wikifier((Config.debug?new DebugView(w.output,"variable",w.matchText,w.matchText):w).output,stringFrom(result))}}),Wikifier.Parser.add({name:"template",profiles:["core"],match:"\\?".concat(Patterns.templateName),handler:function(w){var name=w.matchText.slice(1),template=Template.get(name),result=null;switch(template instanceof Array&&(template=template.random()),_typeof(template)){case"function":try{result=stringFrom(template.call({name:name}))}catch(ex){return appendError(w.output,"cannot execute function template ?".concat(name,": ").concat(ex.message),w.source.slice(w.matchStart,w.nextMatch))}break;case"string":result=template}null===result?jQuery(document.createTextNode(w.matchText)).appendTo(w.output):new Wikifier((Config.debug?new DebugView(w.output,"template",w.matchText,w.matchText):w).output,result)}}),Wikifier.Parser.add({name:"heading",profiles:["block"],match:"^!{1,6}",terminator:"\\n",handler:function(w){Wikifier.helpers.hasBlockContext(w.output.childNodes)?w.subWikify(jQuery(document.createElement("h".concat(w.matchLength))).appendTo(w.output).get(0),this.terminator):jQuery(w.output).append(document.createTextNode(w.matchText))}}),Wikifier.Parser.add({name:"table",profiles:["block"],match:"^\\|(?:[^\\n]*)\\|(?:[fhck]?)$",lookahead:/^\|([^\n]*)\|([fhck]?)$/gm,rowTerminator:"\\|(?:[cfhk]?)$\\n?",cellPattern:"(?:\\|([^\\n\\|]*)\\|)|(\\|[cfhk]?$\\n?)",cellTerminator:"(?:\\u0020*)\\|",rowTypes:{c:"caption",f:"tfoot",h:"thead","":"tbody"},handler:function(w){if(Wikifier.helpers.hasBlockContext(w.output.childNodes)){var matched,table=jQuery(document.createElement("table")).appendTo(w.output).get(0),prevColumns=[],curRowType=null,$rowContainer=null,rowCount=0;w.nextMatch=w.matchStart;do{this.lookahead.lastIndex=w.nextMatch;var match=this.lookahead.exec(w.source);if(matched=match&&match.index===w.nextMatch){var nextRowType=match[2];"k"===nextRowType?(table.className=match[1],w.nextMatch+=match[0].length+1):(nextRowType!==curRowType&&(curRowType=nextRowType,$rowContainer=jQuery(document.createElement(this.rowTypes[nextRowType])).appendTo(table)),"c"===curRowType?($rowContainer.css("caption-side",0===rowCount?"top":"bottom"),w.nextMatch+=1,w.subWikify($rowContainer[0],this.rowTerminator)):this.rowHandler(w,jQuery(document.createElement("tr")).appendTo($rowContainer).get(0),prevColumns),++rowCount)}}while(matched)}else jQuery(w.output).append(document.createTextNode(w.matchText))},rowHandler:function(w,rowEl,prevColumns){var matched,_this10=this,cellRe=new RegExp(this.cellPattern,"gm"),col=0,curColCount=1,_loop5=function(){cellRe.lastIndex=w.nextMatch;var cellMatch=cellRe.exec(w.source);if(matched=cellMatch&&cellMatch.index===w.nextMatch){if("~"===cellMatch[1]){var last=prevColumns[col];last&&(++last.rowCount,last.$element.attr("rowspan",last.rowCount).css("vertical-align","middle")),w.nextMatch=cellMatch.index+cellMatch[0].length-1}else if(">"===cellMatch[1])++curColCount,w.nextMatch=cellMatch.index+cellMatch[0].length-1;else{if(cellMatch[2])return w.nextMatch=cellMatch.index+cellMatch[0].length,1;++w.nextMatch;for(var $cell,css=Wikifier.helpers.inlineCss(w),spaceLeft=!1,spaceRight=!1;" "===w.source.substr(w.nextMatch,1);)spaceLeft=!0,++w.nextMatch;"!"===w.source.substr(w.nextMatch,1)?($cell=jQuery(document.createElement("th")).appendTo(rowEl),++w.nextMatch):$cell=jQuery(document.createElement("td")).appendTo(rowEl),prevColumns[col]={rowCount:1,$element:$cell},curColCount>1&&($cell.attr("colspan",curColCount),curColCount=1),w.subWikify($cell[0],_this10.cellTerminator)," "===w.matchText.substr(w.matchText.length-2,1)&&(spaceRight=!0),css.classes.forEach((function(className){return $cell.addClass(className)})),""!==css.id&&$cell.attr("id",css.id),spaceLeft&&spaceRight?css.styles["text-align"]="center":spaceLeft?css.styles["text-align"]="right":spaceRight&&(css.styles["text-align"]="left"),$cell.css(css.styles),w.nextMatch=w.nextMatch-1}++col}};do{if(_loop5())break}while(matched)}}),Wikifier.Parser.add({name:"list",profiles:["block"],match:"^(?:(?:\\*+)|(?:#+))",lookahead:/^(?:(\*+)|(#+))/gm,terminator:"\\n",handler:function(w){if(Wikifier.helpers.hasBlockContext(w.output.childNodes)){w.nextMatch=w.matchStart;var matched,i,destStack=[w.output],curType=null,curLevel=0;do{this.lookahead.lastIndex=w.nextMatch;var match=this.lookahead.exec(w.source);if(matched=match&&match.index===w.nextMatch){var newType=match[2]?"ol":"ul",newLevel=match[0].length;if(w.nextMatch+=match[0].length,newLevel>curLevel)for(i=curLevel;i<newLevel;++i)destStack.push(jQuery(document.createElement(newType)).appendTo(destStack[destStack.length-1]).get(0));else if(newLevel<curLevel)for(i=curLevel;i>newLevel;--i)destStack.pop();else newLevel===curLevel&&newType!==curType&&(destStack.pop(),destStack.push(jQuery(document.createElement(newType)).appendTo(destStack[destStack.length-1]).get(0)));curLevel=newLevel,curType=newType,w.subWikify(jQuery(document.createElement("li")).appendTo(destStack[destStack.length-1]).get(0),this.terminator)}}while(matched)}else jQuery(w.output).append(document.createTextNode(w.matchText))}}),Wikifier.Parser.add({name:"commentByBlock",profiles:["core"],match:"(?:/(?:%|\\*))|(?:\x3c!--)",lookahead:/(?:\/(%|\*)(?:(?:.|\n)*?)\1\/)|(?:<!--(?:(?:.|\n)*?)-->)/gm,handler:function(w){this.lookahead.lastIndex=w.matchStart;var match=this.lookahead.exec(w.source);match&&match.index===w.matchStart&&(w.nextMatch=this.lookahead.lastIndex)}}),Wikifier.Parser.add({name:"lineContinuation",profiles:["core"],match:"\\\\".concat(Patterns.spaceNoTerminator,"*\\n|\\n").concat(Patterns.spaceNoTerminator,"*\\\\|\\n?\\\\").concat(Patterns.spaceNoTerminator,"*$|^").concat(Patterns.spaceNoTerminator,"*\\\\\\n?"),handler:function(w){w.nextMatch=w.matchStart+w.matchLength}}),Wikifier.Parser.add({name:"lineBreak",profiles:["core"],match:"\\n",handler:function(w){w.options.nobr||jQuery(document.createElement("br")).appendTo(w.output)}}),Wikifier.Parser.add({name:"htmlCharacterReference",profiles:["core"],match:"(?:(?:&#?[0-9A-Za-z]{2,8};|.)(?:&#?(?:x0*(?:3[0-6][0-9A-Fa-f]|1D[C-Fc-f][0-9A-Fa-f]|20[D-Fd-f][0-9A-Fa-f]|FE2[0-9A-Fa-f])|0*(?:76[89]|7[7-9][0-9]|8[0-7][0-9]|761[6-9]|76[2-7][0-9]|84[0-3][0-9]|844[0-7]|6505[6-9]|6506[0-9]|6507[0-1]));)+|&#?[0-9A-Za-z]{2,8};)",handler:function(w){jQuery(document.createDocumentFragment()).append(w.matchText).appendTo(w.output)}}),Wikifier.Parser.add({name:"xmlProlog",profiles:["core"],match:"<\\?[Xx][Mm][Ll][^>]*\\?>",handler:function(w){w.nextMatch=w.matchStart+w.matchLength}}),Wikifier.Parser.add({name:"verbatimHtml",profiles:["core"],match:"<[Hh][Tt][Mm][Ll]>",lookahead:/<[Hh][Tt][Mm][Ll]>((?:.|\n)*?)<\/[Hh][Tt][Mm][Ll]>/gm,handler:_verbatimTagHandler}),Wikifier.Parser.add({name:"verbatimScriptTag",profiles:["core"],match:"<[Ss][Cc][Rr][Ii][Pp][Tt][^>]*>",lookahead:/(<[Ss][Cc][Rr][Ii][Pp][Tt][^>]*>(?:.|\n)*?<\/[Ss][Cc][Rr][Ii][Pp][Tt]>)/gm,handler:_verbatimTagHandler}),Wikifier.Parser.add({name:"styleTag",profiles:["core"],match:"<[Ss][Tt][Yy][Ll][Ee][^>]*>",lookahead:/(<[Ss][Tt][Yy][Ll][Ee][^>]*>)((?:.|\n)*?)(<\/[Ss][Tt][Yy][Ll][Ee]>)/gm,imageMarkup:new RegExp(Patterns.cssImage,"g"),hasImageMarkup:new RegExp(Patterns.cssImage),handler:function(w){this.lookahead.lastIndex=w.matchStart;var match=this.lookahead.exec(w.source);if(match&&match.index===w.matchStart){w.nextMatch=this.lookahead.lastIndex;var css=match[2];this.hasImageMarkup.test(css)&&(this.imageMarkup.lastIndex=0,css=css.replace(this.imageMarkup,(function(wikiImage){var markup=Wikifier.helpers.parseSquareBracketedMarkup({source:wikiImage,matchStart:0});if(Object.hasOwn(markup,"error")||markup.pos<wikiImage.length)return wikiImage;var source=Wikifier.helpers.evalPassageId(markup.source);if("data:"!==source.slice(0,5)&&Story.has(source)){var passage=Story.get(source);passage.tags.includes("Twine.image")&&(source=passage.text)}return'url("'.concat(source.replace(/"/g,"%22"),'")')}))),jQuery(document.createDocumentFragment()).append(match[1]+css+match[3]).appendTo(w.output)}}}),Wikifier.Parser.add({name:"svgTag",profiles:["core"],match:"<[Ss][Vv][Gg][^>]*>",lookahead:/<(\/?)[Ss][Vv][Gg][^>]*>/gm,namespace:"http://www.w3.org/2000/svg",handler:function(w){var _this11=this;this.lookahead.lastIndex=w.nextMatch;for(var match,depth=1;depth>0&&null!==(match=this.lookahead.exec(w.source));)depth+="/"===match[1]?-1:1;if(0===depth){w.nextMatch=this.lookahead.lastIndex;var svgTag=w.source.slice(w.matchStart,this.lookahead.lastIndex),$frag=jQuery(document.createDocumentFragment()).append(svgTag);$frag.find("a[data-passage],image[data-passage]").each((function(_,el){var tagName=el.tagName.toLowerCase();try{_this11.processAttributeDirectives(el)}catch(ex){return appendError(w.output,"svg|<".concat(tagName,">: ").concat(ex.message),"".concat(w.matchText,"…"))}el.hasAttribute("data-passage")&&_this11.processDataAttributes(el,tagName)})),$frag.appendTo(w.output)}},processAttributeDirectives:function(el){Array.from(el.attributes).forEach((function(_ref11){var name=_ref11.name,value=_ref11.value,evalShorthand="@"===name[0];if(evalShorthand||name.startsWith("sc-eval:")){var result,newName=name.slice(evalShorthand?1:8);if("data-setter"===newName)throw new Error('evaluation directive is not allowed on the data-setter attribute: "'.concat(name,'"'));try{result=Scripting.evalTwineScript(value)}catch(ex){throw new Error('bad evaluation from attribute directive "'.concat(name,'": ').concat(ex.message))}try{el.setAttribute(newName,result),el.removeAttribute(name)}catch(ex){throw new Error('cannot transform attribute directive "'.concat(name,'" into attribute "').concat(newName,'"'))}}}))},processDataAttributes:function(el,tagName){var passage=el.getAttribute("data-passage");if(null!=passage){var evaluated=Wikifier.helpers.evalPassageId(passage);if(evaluated!==passage&&(passage=evaluated,el.setAttribute("data-passage",evaluated)),""!==passage)if("image"===tagName)"data:"!==passage.slice(0,5)&&Story.has(passage)&&(passage=Story.get(passage)).tags.includes("Twine.image")&&el.setAttribute("href",passage.text.trim());else{var setFn,setter=el.getAttribute("data-setter");null!=setter&&""!==(setter=String(setter).trim())&&(setFn=Wikifier.helpers.shadowHandler(Scripting.desugar(setter))),Story.has(passage)?(el.classList.add("link-internal"),Config.addVisitedLinkClass&&State.hasPlayed(passage)&&el.classList.add("link-visited")):el.classList.add("link-broken"),jQuery(el).ariaClick({one:!0},(function(){"function"==typeof setFn&&setFn.call(this),Engine.play(passage)}))}}}}),Wikifier.Parser.add({name:"htmlTag",profiles:["core"],match:"<".concat(Patterns.htmlTagName,"(?:\\s+[^\\u0000-\\u001F\\u007F-\\u009F\\s\"'>\\/=]+(?:\\s*=\\s*(?:\"[^\"]*?\"|'[^']*?'|[^\\s\"'=<>`]+))?)*\\s*\\/?>"),tagRe:new RegExp("^<(".concat(Patterns.htmlTagName,")")),mediaTags:["audio","img","source","track","video"],nobrTags:["audio","colgroup","datalist","dl","figure","meter","ol","optgroup","picture","progress","ruby","select","table","tbody","tfoot","thead","tr","ul","video"],voidTags:["area","base","br","col","embed","hr","img","input","keygen","link","menuitem","meta","param","source","track","wbr"],handler:function(w){var tagMatch=this.tagRe.exec(w.matchText),tag=tagMatch&&tagMatch[1],tagName=tag&&tag.toLowerCase();if(tagName){var terminator,terminatorMatch,isVoid=this.voidTags.includes(tagName)||w.matchText.endsWith("/>"),isNobr=this.nobrTags.includes(tagName);if(!isVoid){terminator="<\\/".concat(tagName,"\\s*>");var terminatorRe=new RegExp(terminator,"gim");terminatorRe.lastIndex=w.matchStart,terminatorMatch=terminatorRe.exec(w.source)}if(!isVoid&&!terminatorMatch)return appendError(w.output,"cannot find a closing tag for HTML <".concat(tag,">"),"".concat(w.matchText,"…"));var debugView,output=w.output,el=document.createElement(w.output.tagName);for(el.innerHTML=w.matchText;el.firstChild;)el=el.firstChild;try{this.processAttributeDirectives(el)}catch(ex){return appendError(w.output,"<".concat(tagName,">: ").concat(ex.message),"".concat(w.matchText,"…"))}if(el.hasAttribute("data-passage")){if(el.hasAttribute("href"))return appendError(w.output,"<".concat(tagName,'>: elements may not include both "data-passage" and "href" atttributes'),"".concat(w.matchText,"…"));this.processDataAttributes(el,tagName),Config.debug&&((debugView=new DebugView(w.output,"html-".concat(tagName),tagName,w.matchText)).modes({block:"img"===tagName,nonvoid:terminatorMatch}),output=debugView.output)}else el.hasAttribute("href")&&Wikifier.isExternalLink(el.getAttribute("href"))&&el.classList.add("link-external");if(terminatorMatch){try{Wikifier.Option.push({nobr:isNobr}),w.subWikify(el,terminator,{ignoreTerminatorCase:!0})}finally{Wikifier.Option.pop()}debugView&&jQuery(el).find(".debug.block").length>0&&debugView.modes({block:!0})}output.appendChild("track"===tagName?el.cloneNode(!0):el)}},processAttributeDirectives:function(el){Array.from(el.attributes).forEach((function(_ref12){var name=_ref12.name,value=_ref12.value,evalShorthand="@"===name[0];if(evalShorthand||name.startsWith("sc-eval:")){var result,newName=name.slice(evalShorthand?1:8);if("data-setter"===newName)throw new Error('evaluation directive is not allowed on the data-setter attribute: "'.concat(name,'"'));try{result=Scripting.evalTwineScript(value)}catch(ex){throw new Error('bad evaluation from attribute directive "'.concat(name,'": ').concat(ex.message))}try{el.setAttribute(newName,result),el.removeAttribute(name)}catch(ex){throw new Error('cannot transform attribute directive "'.concat(name,'" into attribute "').concat(newName,'"'))}}}))},processDataAttributes:function(el,tagName){var passage=el.getAttribute("data-passage");if(null!=passage){var evaluated=Wikifier.helpers.evalPassageId(passage);if(evaluated!==passage&&(passage=evaluated,el.setAttribute("data-passage",evaluated)),""!==passage)if(this.mediaTags.includes(tagName)){if("data:"!==passage.slice(0,5)&&Story.has(passage)){var parentName,twineTag;switch(passage=Story.get(passage),tagName){case"audio":case"video":twineTag="Twine.".concat(tagName);break;case"img":twineTag="Twine.image";break;case"track":twineTag="Twine.vtt";break;case"source":var $parent=$(el).closest("audio,picture,video");$parent.length>0&&(parentName=$parent.get(0).tagName.toLowerCase(),twineTag="Twine.".concat("picture"===parentName?"image":parentName))}passage.tags.includes(twineTag)&&(el["picture"===parentName?"srcset":"src"]=passage.text.trim())}}else{var setFn,setter=el.getAttribute("data-setter");null!=setter&&""!==(setter=String(setter).trim())&&(setFn=Wikifier.helpers.shadowHandler(Scripting.desugar(setter))),Story.has(passage)?(el.classList.add("link-internal"),Config.addVisitedLinkClass&&State.hasPlayed(passage)&&el.classList.add("link-visited")):el.classList.add("link-broken"),jQuery(el).ariaClick({one:!0},(function(){"function"==typeof setFn&&setFn.call(this),Engine.play(passage)}))}}}})}();var Template=(_templates=new Map,_validNameRe=new RegExp("^(?:".concat(Patterns.templateName,")$")),_validType=function(template){var templateType=_typeof(template);return"function"===templateType||"string"===templateType},Object.preventExtensions(Object.create(null,{add:{value:function(name,template){if(!(_validType(template)||template instanceof Array&&template.length>0&&template.every(_validType)))throw new TypeError("invalid template type (".concat(name,"); templates must be: functions, strings, or an array of either"));(name instanceof Array?name:[name]).forEach((function(name){if(!_validNameRe.test(name))throw new Error('invalid template name "'.concat(name,'"'));if(_templates.has(name))throw new Error("cannot clobber existing template ?".concat(name));_templates.set(name,template)}))}},delete:{value:function(name){(name instanceof Array?name:[name]).forEach((function(name){return _templates.delete(name)}))}},get:{value:function(name){return _templates.has(name)?_templates.get(name):null}},has:{value:function(name){return _templates.has(name)}},size:{get:function(){return _templates.size}}}))),_templates,_validNameRe,_validType,Macro=function(){var _macros={},_tags={},_validNameRe=new RegExp("^(?:".concat(Patterns.macroName,")$"));function macrosHas(name){return Object.hasOwn(_macros,name)}function tagsRegister(parent,bodyTags){if(!parent)throw new Error("no parent specified");for(var endTags=["/".concat(parent),"end".concat(parent)],allTags=[].concat(endTags,Array.isArray(bodyTags)?bodyTags:[]),i=0;i<allTags.length;++i){var tag=allTags[i];if(macrosHas(tag))throw new Error("cannot register tag for an existing macro");tagsHas(tag)?_tags[tag].includes(parent)||(_tags[tag].push(parent),_tags[tag].sort()):_tags[tag]=[parent]}}function tagsUnregister(parent){if(!parent)throw new Error("no parent specified");Object.keys(_tags).forEach((function(tag){var i=_tags[tag].indexOf(parent);-1!==i&&(1===_tags[tag].length?delete _tags[tag]:_tags[tag].splice(i,1))}))}function tagsHas(name){return Object.hasOwn(_tags,name)}return Object.preventExtensions(Object.create(null,{add:{value:function macrosAdd(name,def){if(Array.isArray(name))name.forEach((function(name){return macrosAdd(name,def)}));else{if(!_validNameRe.test(name))throw new Error('invalid macro name "'.concat(name,'"'));if(macrosHas(name))throw new Error("cannot clobber existing macro <<".concat(name,">>"));if(tagsHas(name))throw new Error("cannot clobber child tag <<".concat(name,">> of parent macro").concat(1===_tags[name].length?"":"s"," <<").concat(_tags[name].join(">>, <<"),">>"));try{if("object"===_typeof(def))_macros[name]=Object.assign(Object.create(null),def,{_MACRO_API:!0});else{if(!macrosHas(def))throw new Error("cannot create alias of nonexistent macro <<".concat(def,">>"));_macros[name]=Object.create(_macros[def],{_ALIAS_OF:{enumerable:!0,value:def}})}Object.defineProperty(_macros,name,{writable:!1})}catch(ex){throw"TypeError"===ex.name?new Error("cannot clobber protected macro <<".concat(name,">>")):new Error("unknown error when attempting to add macro <<".concat(name,">>: [").concat(ex.name,"] ").concat(ex.message))}if(void 0!==_macros[name].tags)if(null==_macros[name].tags)tagsRegister(name);else{if(!Array.isArray(_macros[name].tags))throw new Error('bad value for "tags" property of macro <<'.concat(name,">>"));tagsRegister(name,_macros[name].tags)}}}},delete:{value:function macrosDelete(name){if(Array.isArray(name))name.forEach((function(name){return macrosDelete(name)}));else if(macrosHas(name)){void 0!==_macros[name].tags&&tagsUnregister(name);try{Object.defineProperty(_macros,name,{writable:!0}),delete _macros[name]}catch(ex){throw new Error("unknown error removing macro <<".concat(name,">>: ").concat(ex.message))}}else if(tagsHas(name))throw new Error("cannot remove child tag <<".concat(name,">> of parent macro <<").concat(_tags[name],">>"))}},isEmpty:{value:function(){return 0===Object.keys(_macros).length}},has:{value:macrosHas},get:{value:function(name){var macro=null;return macrosHas(name)&&"function"==typeof _macros[name].handler?macro=_macros[name]:Object.hasOwn(macros,name)&&"function"==typeof macros[name].handler&&(macro=macros[name]),macro}},init:{value:function(){var handler=arguments.length>0&&arguments[0]!==undefined?arguments[0]:"init";Object.keys(_macros).forEach((function(name){"function"==typeof _macros[name][handler]&&_macros[name][handler](name)})),Object.keys(macros).forEach((function(name){"function"==typeof macros[name][handler]&&macros[name][handler](name)}))}},tags:{value:Object.preventExtensions(Object.create(null,{register:{value:tagsRegister},unregister:{value:tagsUnregister},has:{value:tagsHas},get:{value:function(name){return tagsHas(name)?_tags[name]:null}}}))},evalStatements:{value:function(){return Scripting.evalJavaScript.apply(Scripting,arguments)}}}))}(),MacroContext=function(){var MacroContext=function(){return _createClass((function MacroContext(contextData){_classCallCheck(this,MacroContext);var context=Object.assign({parent:null,macro:null,name:"",displayName:"",args:null,payload:null,parser:null,source:""},contextData);if(null===context.macro||""===context.name||null===context.parser)throw new TypeError("context object missing required properties");Object.defineProperties(this,{self:{value:context.macro},name:{value:void 0===context.macro._ALIAS_OF?context.name:context.macro._ALIAS_OF},displayName:{value:context.name},args:{value:context.args},payload:{value:context.payload},source:{value:context.source},parent:{value:context.parent},parser:{value:context.parser},_output:{value:context.parser.output},_shadows:{writable:!0,value:null},_debugView:{writable:!0,value:null},_debugViewEnabled:{writable:!0,value:Config.debug}})}),[{key:"output",get:function(){return this._debugViewEnabled?this.debugView.output:this._output}},{key:"shadows",get:function(){return Array.from(this._shadows)}},{key:"shadowView",get:function(){for(var view=new Set,context=this;null!==context;context=context.parent)context._shadows&&context._shadows.forEach((function(name){return view.add(name)}));return Array.from(view)}},{key:"debugView",get:function(){return this._debugViewEnabled?null!==this._debugView?this._debugView:this.createDebugView():null}},{key:"contextFilter",value:function(predicate,thisArg){if("function"!=typeof predicate)throw new TypeError("<MacroContext>.contextFilter() predicate parameter must be a function");for(var result=[],context=this.parent;null!==context;context=context.parent)predicate.call(void 0===thisArg?this:thisArg,context)&&result.push(context);return result}},{key:"contextFind",value:function(predicate,thisArg){if("function"!=typeof predicate)throw new TypeError("<MacroContext>.contextFind() predicate parameter must be a function");for(var context=this.parent;null!==context;context=context.parent)if(predicate.call(void 0===thisArg?this:thisArg,context))return context}},{key:"contextSome",value:function(predicate,thisArg){if("function"!=typeof predicate)throw new TypeError("<MacroContext>.contextSome() predicate parameter must be a function");for(var context=this.parent;null!==context;context=context.parent)if(predicate.call(void 0===thisArg?this:thisArg,context))return!0;return!1}},{key:"addShadow",value:function(){var _this12=this;this._shadows||(this._shadows=new Set);for(var varRe=new RegExp("^".concat(Patterns.variable,"$")),_len14=arguments.length,names=new Array(_len14),_key14=0;_key14<_len14;_key14++)names[_key14]=arguments[_key14];names.flat(1/0).forEach((function(name){if("string"!=typeof name)throw new TypeError("variable name must be a string; type: ".concat(_typeof(name)));if(!varRe.test(name))throw new Error('invalid variable name "'.concat(name,'"'));_this12._shadows.add(name)}))}},{key:"shadowHandler",value:function(callback,doneCallback,startCallback){var shadowStore,shadowContext=this;return"function"==typeof callback&&(shadowStore=Object.create(null),this.shadowView.forEach((function(varName){var varKey=varName.slice(1),store="$"===varName[0]?State.variables:State.temporary;shadowStore[varName]=store[varKey]}))),function(){for(var _len15=arguments.length,args=new Array(_len15),_key15=0;_key15<_len15;_key15++)args[_key15]=arguments[_key15];if("function"==typeof startCallback&&startCallback.apply(this,args),"function"==typeof callback){var contextCache,shadowNames=Object.keys(shadowStore),valueCache=shadowNames.length>0?{}:null,macroParser=Wikifier.Parser.get("macro");try{shadowNames.forEach((function(varName){var varKey=varName.slice(1),store="$"===varName[0]?State.variables:State.temporary;Object.hasOwn(store,varKey)&&(valueCache[varKey]=store[varKey]),store[varKey]=shadowStore[varName]})),contextCache=macroParser.context,macroParser.context=shadowContext,callback.apply(this,args)}finally{contextCache!==undefined&&(macroParser.context=contextCache),shadowNames.forEach((function(varName){var varKey=varName.slice(1),store="$"===varName[0]?State.variables:State.temporary;shadowStore[varName]=store[varKey],Object.hasOwn(valueCache,varKey)?store[varKey]=valueCache[varKey]:delete store[varKey]}))}}"function"==typeof doneCallback&&doneCallback.apply(this,args)}}},{key:"createDebugView",value:function(name,title){return this._debugView=new DebugView(this._output,"macro",name||this.displayName,title||this.source),null!==this.payload&&this.payload.length>0&&this._debugView.modes({nonvoid:!0}),this._debugViewEnabled=!0,this._debugView}},{key:"removeDebugView",value:function(){null!==this._debugView&&(this._debugView.remove(),this._debugView=null),this._debugViewEnabled=!1}},{key:"error",value:function(message,source){return appendError(this._output,"<<".concat(this.displayName,">>: ").concat(message),source||this.source)}}])}();return Object.defineProperties(MacroContext.prototype,{contextHas:{value:function(){console.warn("[DEPRECATED] <MacroContext>.contextHas() is deprecated.");for(var _len16=arguments.length,args=new Array(_len16),_key16=0;_key16<_len16;_key16++)args[_key16]=arguments[_key16];return MacroContext.prototype.contextSome.apply(this,args)}},contextSelect:{value:function(){console.warn("[DEPRECATED] <MacroContext>.contextSelect() is deprecated.");for(var _len17=arguments.length,args=new Array(_len17),_key17=0;_key17<_len17;_key17++)args[_key17]=arguments[_key17];return MacroContext.prototype.contextFind.apply(this,args)}},contextSelectAll:{value:function(){console.warn("[DEPRECATED] <MacroContext>.contextSelectAll() is deprecated.");for(var _len18=arguments.length,args=new Array(_len18),_key18=0;_key18<_len18;_key18++)args[_key18]=arguments[_key18];return MacroContext.prototype.contextFilter.apply(this,args)}},createShadowWrapper:{value:function(){console.warn("[DEPRECATED] <MacroContext>.createShadowWrapper() is deprecated.");for(var _len19=arguments.length,args=new Array(_len19),_key19=0;_key19<_len19;_key19++)args[_key19]=arguments[_key19];return MacroContext.prototype.shadowHandler.apply(this,args)}}}),MacroContext}();Macro.add(["addclass","toggleclass"],{handler:function(){if(this.args.length<2){var errors=[];return this.args.length<1&&errors.push("selector"),this.args.length<2&&errors.push("class names"),this.error("no ".concat(errors.join(" or ")," specified"))}var $targets=jQuery(this.args[0]);if(0===$targets.length)return this.error('no elements matched the selector "'.concat(this.args[0],'"'));switch(this.name){case"addclass":$targets.addClass(this.args[1].trim());break;case"toggleclass":$targets.toggleClass(this.args[1].trim())}Config.debug&&this.debugView.modes({hidden:!0})}}),Macro.add(["append","prepend","replace"],{tags:null,t8nRe:/^(?:transition|t8n)$/,handler:function(){var _this13=this;if(0===this.args.length)return this.error("no selector specified");var $insert,$targets=jQuery(this.args[0]);if(0===$targets.length)return this.error('no elements matched the selector "'.concat(this.args[0],'"'));if(""!==this.payload[0].contents)switch(this.args.length>1&&this.self.t8nRe.test(this.args[1])?(($insert=jQuery(document.createElement("span"))).addClass("macro-".concat(this.name,"-insert macro-").concat(this.name,"-in")),setTimeout((function(){return $insert.removeClass("macro-".concat(_this13.name,"-in"))}),Engine.DOM_DELAY)):$insert=jQuery(document.createDocumentFragment()),$insert.wiki(this.payload[0].contents),this.name){case"replace":$targets.empty();case"append":$targets.append($insert);break;case"prepend":$targets.prepend($insert)}else"replace"===this.name&&$targets.empty();Config.debug&&this.debugView.modes({hidden:!0})}}),function(){if(Has.audio){var errorOnePlaybackAction=function(cur,prev){return'only one playback action allowed per invocation, "'.concat(cur,'" cannot be combined with "').concat(prev,'"')};Macro.add("audio",{handler:function(){if(this.args.length<2){var errors=[];return this.args.length<1&&errors.push("track and/or group IDs"),this.args.length<2&&errors.push("actions"),this.error("no ".concat(errors.join(" or ")," specified"))}var selected;try{selected=SimpleAudio.select(this.args[0])}catch(ex){return this.error(ex.message)}for(var action,fadeTo,loop,mute,passage,time,volume,args=this.args.slice(1),fadeOver=5;args.length>0;){var arg=args.shift(),raw=void 0;switch(arg){case"load":case"pause":case"play":case"stop":case"unload":if(action)return this.error(errorOnePlaybackAction(arg,action));action=arg;break;case"fadein":if(action)return this.error(errorOnePlaybackAction(arg,action));action="fade",fadeTo=1;break;case"fadeout":if(action)return this.error(errorOnePlaybackAction(arg,action));action="fade",fadeTo=0;break;case"fadeto":if(action)return this.error(errorOnePlaybackAction(arg,action));if(0===args.length)return this.error("fadeto missing required level value");if(action="fade",raw=args.shift(),fadeTo=Number.parseFloat(raw),Number.isNaN(fadeTo)||!Number.isFinite(fadeTo))return this.error("cannot parse fadeto: ".concat(raw));break;case"fadeoverto":if(action)return this.error(errorOnePlaybackAction(arg,action));if(args.length<2){var _errors=[];return args.length<1&&_errors.push("seconds"),args.length<2&&_errors.push("level"),this.error("fadeoverto missing required ".concat(_errors.join(" and ")," value").concat(_errors.length>1?"s":""))}if(action="fade",raw=args.shift(),fadeOver=Number.parseFloat(raw),Number.isNaN(fadeOver)||!Number.isFinite(fadeOver))return this.error("cannot parse fadeoverto: ".concat(raw));if(raw=args.shift(),fadeTo=Number.parseFloat(raw),Number.isNaN(fadeTo)||!Number.isFinite(fadeTo))return this.error("cannot parse fadeoverto: ".concat(raw));break;case"volume":if(0===args.length)return this.error("volume missing required level value");if(raw=args.shift(),volume=Number.parseFloat(raw),Number.isNaN(volume)||!Number.isFinite(volume))return this.error("cannot parse volume: ".concat(raw));break;case"mute":case"unmute":mute="mute"===arg;break;case"time":if(0===args.length)return this.error("time missing required seconds value");if(raw=args.shift(),time=Number.parseFloat(raw),Number.isNaN(time)||!Number.isFinite(time))return this.error("cannot parse time: ".concat(raw));break;case"loop":case"unloop":loop="loop"===arg;break;case"goto":if(0===args.length)return this.error("goto missing required passage title");if(raw=args.shift(),passage="object"===_typeof(raw)?raw.link:raw,!Story.has(passage))return this.error('passage "'.concat(passage,'" does not exist'));break;default:return this.error("unknown action: ".concat(arg))}}try{if(null!=volume&&selected.volume(volume),null!=time&&selected.time(time),null!=mute&&selected.mute(mute),null!=loop&&selected.loop(loop),null!=passage){var nsEnded="ended.macros.macro-".concat(this.name,"_goto");selected.off(nsEnded).one(nsEnded,(function(){selected.off(nsEnded),Engine.play(passage)}))}switch(action){case"fade":selected.fade(fadeOver,fadeTo);break;case"load":selected.load();break;case"pause":selected.pause();break;case"play":selected.playWhenAllowed();break;case"stop":selected.stop();break;case"unload":selected.unload()}Config.debug&&this.debugView.modes({hidden:!0})}catch(ex){return this.error("error executing action: ".concat(ex.message))}}}),Macro.add("cacheaudio",{handler:function(){if(this.args.length<2){var errors=[];return this.args.length<1&&errors.push("track ID"),this.args.length<2&&errors.push("sources"),this.error("no ".concat(errors.join(" or ")," specified"))}var id=String(this.args[0]).trim();try{SimpleAudio.tracks.add(id,this.args.slice(1))}catch(ex){return this.error(ex.message)}if(Config.debug&&!SimpleAudio.tracks.get(id).hasSource())return this.error('track ID "'.concat(id,'": no supported audio sources found'));Config.debug&&this.debugView.modes({hidden:!0})}}),Macro.add("createaudiogroup",{tags:["track"],handler:function(){if(0===this.args.length)return this.error("no group ID specified");if(1===this.payload.length)return this.error("no tracks defined via <<track>>");Config.debug&&this.debugView.modes({nonvoid:!1,hidden:!0});for(var groupId=String(this.args[0]).trim(),trackIds=[],i=1,len=this.payload.length;i<len;++i){if(this.payload[i].args.length<1)return this.error("no track ID specified");trackIds.push(String(this.payload[i].args[0]).trim()),Config.debug&&this.createDebugView(this.payload[i].name,this.payload[i].source).modes({nonvoid:!1,hidden:!0})}try{SimpleAudio.groups.add(groupId,trackIds)}catch(ex){return this.error(ex.message)}Config.debug&&this.createDebugView("/".concat(this.name),"<</".concat(this.name,">>")).modes({nonvoid:!1,hidden:!0})}}),Macro.add("createplaylist",{tags:["track"],handler:function(){if(0===this.args.length)return this.error("no list ID specified");if(1===this.payload.length)return this.error("no tracks defined via <<track>>");var playlist=Macro.get("playlist");if(null!==playlist.from&&"createplaylist"!==playlist.from)return this.error("a playlist has already been defined with <<setplaylist>>");Config.debug&&this.debugView.modes({nonvoid:!1,hidden:!0});for(var listId=String(this.args[0]).trim(),trackObjs=[],i=1,len=this.payload.length;i<len;++i){if(0===this.payload[i].args.length)return this.error("no track ID specified");for(var trackObj={id:String(this.payload[i].args[0]).trim()},args=this.payload[i].args.slice(1);args.length>0;){var arg=args.shift(),raw=void 0,parsed=void 0;switch(arg){case"own":trackObj.own=!0;break;case"rate":args.length>0&&args.shift();break;case"volume":if(0===args.length)return this.error("volume missing required level value");if(raw=args.shift(),parsed=Number.parseFloat(raw),Number.isNaN(parsed)||!Number.isFinite(parsed))return this.error("cannot parse volume: ".concat(raw));trackObj.volume=parsed;break;default:return this.error("unknown action: ".concat(arg))}}trackObjs.push(trackObj),Config.debug&&this.createDebugView(this.payload[i].name,this.payload[i].source).modes({nonvoid:!1,hidden:!0})}try{SimpleAudio.lists.add(listId,trackObjs)}catch(ex){return this.error(ex.message)}null===playlist.from&&(playlist.from="createplaylist"),Config.debug&&this.createDebugView("/".concat(this.name),"<</".concat(this.name,">>")).modes({nonvoid:!1,hidden:!0})}}),Macro.add("masteraudio",{handler:function(){if(0===this.args.length)return this.error("no actions specified");for(var action,mute,muteOnHide,volume,args=this.args.slice(0);args.length>0;){var arg=args.shift(),raw=void 0;switch(arg){case"load":case"stop":case"unload":if(action)return this.error(errorOnePlaybackAction(arg,action));action=arg;break;case"mute":case"unmute":mute="mute"===arg;break;case"muteonhide":case"nomuteonhide":muteOnHide="muteonhide"===arg;break;case"volume":if(0===args.length)return this.error("volume missing required level value");if(raw=args.shift(),volume=Number.parseFloat(raw),Number.isNaN(volume)||!Number.isFinite(volume))return this.error("cannot parse volume: ".concat(raw));break;default:return this.error("unknown action: ".concat(arg))}}try{switch(null!=mute&&SimpleAudio.mute(mute),null!=muteOnHide&&SimpleAudio.muteOnHidden(muteOnHide),null!=volume&&SimpleAudio.volume(volume),action){case"load":SimpleAudio.load();break;case"stop":SimpleAudio.stop();break;case"unload":SimpleAudio.unload()}Config.debug&&this.debugView.modes({hidden:!0})}catch(ex){return this.error("error executing action: ".concat(ex.message))}}}),Macro.add("playlist",{handler:function(){if(this.args.length<2){var errors=[];return this.args.length<1&&errors.push("list ID"),this.args.length<2&&errors.push("actions"),this.error("no ".concat(errors.join(" or ")," specified"))}var id=String(this.args[0]).trim();if(!SimpleAudio.lists.has(id))return this.error('playlist "'.concat(id,'" does not exist'));for(var action,fadeTo,loop,mute,shuffle,volume,list=SimpleAudio.lists.get(id),args=this.args.slice(1),fadeOver=5;args.length>0;){var arg=args.shift(),raw=void 0;switch(arg){case"load":case"pause":case"play":case"skip":case"stop":case"unload":if(action)return this.error(errorOnePlaybackAction(arg,action));action=arg;break;case"fadein":if(action)return this.error(errorOnePlaybackAction(arg,action));action="fade",fadeTo=1;break;case"fadeout":if(action)return this.error(errorOnePlaybackAction(arg,action));action="fade",fadeTo=0;break;case"fadeto":if(action)return this.error(errorOnePlaybackAction(arg,action));if(0===args.length)return this.error("fadeto missing required level value");if(action="fade",raw=args.shift(),fadeTo=Number.parseFloat(raw),Number.isNaN(fadeTo)||!Number.isFinite(fadeTo))return this.error("cannot parse fadeto: ".concat(raw));break;case"fadeoverto":if(action)return this.error(errorOnePlaybackAction(arg,action));if(args.length<2){var _errors2=[];return args.length<1&&_errors2.push("seconds"),args.length<2&&_errors2.push("level"),this.error("fadeoverto missing required ".concat(_errors2.join(" and ")," value").concat(_errors2.length>1?"s":""))}if(action="fade",raw=args.shift(),fadeOver=Number.parseFloat(raw),Number.isNaN(fadeOver)||!Number.isFinite(fadeOver))return this.error("cannot parse fadeoverto: ".concat(raw));if(raw=args.shift(),fadeTo=Number.parseFloat(raw),Number.isNaN(fadeTo)||!Number.isFinite(fadeTo))return this.error("cannot parse fadeoverto: ".concat(raw));break;case"volume":if(0===args.length)return this.error("volume missing required level value");if(raw=args.shift(),volume=Number.parseFloat(raw),Number.isNaN(volume)||!Number.isFinite(volume))return this.error("cannot parse volume: ".concat(raw));break;case"mute":case"unmute":mute="mute"===arg;break;case"loop":case"unloop":loop="loop"===arg;break;case"shuffle":case"unshuffle":shuffle="shuffle"===arg;break;default:return this.error("unknown action: ".concat(arg))}}try{switch(null!=volume&&list.volume(volume),null!=mute&&list.mute(mute),null!=loop&&list.loop(loop),null!=shuffle&&list.shuffle(shuffle),action){case"fade":list.fade(fadeOver,fadeTo);break;case"load":list.load();break;case"pause":list.pause();break;case"play":list.playWhenAllowed();break;case"skip":list.skip();break;case"stop":list.stop();break;case"unload":list.unload()}Config.debug&&this.debugView.modes({hidden:!0})}catch(ex){return this.error("error executing action: ".concat(ex.message))}}}),Macro.add("removeaudiogroup",{handler:function(){if(0===this.args.length)return this.error("no group ID specified");var id=String(this.args[0]).trim();if(!SimpleAudio.groups.has(id))return this.error('group "'.concat(id,'" does not exist'));SimpleAudio.groups.delete(id),Config.debug&&this.debugView.modes({hidden:!0})}}),Macro.add("removeplaylist",{handler:function(){if(0===this.args.length)return this.error("no list ID specified");var id=String(this.args[0]).trim();if(!SimpleAudio.lists.has(id))return this.error('playlist "'.concat(id,'" does not exist'));SimpleAudio.lists.delete(id),Config.debug&&this.debugView.modes({hidden:!0})}}),Macro.add("waitforaudio",{skipArgs:!0,handler:function(){SimpleAudio.loadWithScreen()}})}else Macro.add(["audio","cacheaudio","createaudiogroup","createplaylist","masteraudio","playlist","removeaudiogroup","removeplaylist","waitforaudio"],{skipArgs:!0,handler:function(){Config.debug&&this.debugView.modes({hidden:!0})}})}(),Macro.add(["back","return"],{handler:function(){var passage,content,$link,momentIndex=-1;if(this.args.length>0)if("object"===_typeof(this.args[0]))if(this.args[0].isImage){content=document.createElement("img");var $image=jQuery(content).attr("src",this.args[0].source);Object.hasOwn(this.args[0],"passage")&&$image.attr("data-passage",this.args[0].passage),Object.hasOwn(this.args[0],"title")&&$image.attr("title",this.args[0].title),Object.hasOwn(this.args[0],"align")&&$image.attr("align",this.args[0].align),Object.hasOwn(this.args[0],"link")&&(passage=this.args[0].link)}else content=document.createTextNode(this.args[0].text),passage=this.args[0].link;else{content=document.createDocumentFragment();var forbidden=jQuery(content).wikiWithOptions({cleanup:!1,profile:"core"},this.args[0]).getForbiddenInteractiveContentTagNames();if(forbidden.length>0)throw new Error("text content contains restricted elements: <".concat(forbidden.join(">, <"),">"));passage=this.args.length>1?this.args[1]:undefined}if(null==passage){for(var i=State.length-2;i>=0;--i)if(State.history[i].title!==State.passage){momentIndex=i,passage=State.history[i].title;break}if(null==passage&&"return"===this.name)for(var _i6=State.expired.length-1;_i6>=0;--_i6)if(State.expired[_i6]!==State.passage){passage=State.expired[_i6];break}}else{if(!Story.has(passage))return this.error('passage "'.concat(passage,'" does not exist'));if("back"===this.name){for(var _i7=State.length-2;_i7>=0;--_i7)if(State.history[_i7].title===passage){momentIndex=_i7;break}if(-1===momentIndex)return this.error('cannot find passage "'.concat(passage,'" in the current story history'))}}if(null==passage)return this.error("cannot find passage");"back"!==this.name||-1!==momentIndex?($link=jQuery(document.createElement("a")).addClass("link-internal").ariaClick({one:!0},"return"===this.name?function(){return Engine.play(passage)}:function(){return Engine.goTo(momentIndex)}),content instanceof HTMLImageElement&&$link.addClass("link-image")):$link=jQuery(document.createElement("span")).addClass("link-disabled"),$link.addClass("macro-".concat(this.name)).append(content||document.createTextNode(L10n.get("macro".concat(this.name.toUpperFirst(),"Text")))).appendTo(this.output)}}),Macro.add(["button","link"],{isAsync:!0,tags:null,handler:function(){var _this14=this;if(0===this.args.length)return this.error("no ".concat("button"===this.name?"button":"link"," text specified"));var passage,$link=jQuery(document.createElement("button"===this.name?"button":"a"));if("object"===_typeof(this.args[0]))if(this.args[0].isImage){var $image=jQuery(document.createElement("img")).attr("src",this.args[0].source).appendTo($link);$link.addClass("link-image"),Object.hasOwn(this.args[0],"passage")&&$image.attr("data-passage",this.args[0].passage),Object.hasOwn(this.args[0],"title")&&$image.attr("title",this.args[0].title),Object.hasOwn(this.args[0],"align")&&$image.attr("align",this.args[0].align),passage=this.args[0].link}else $link.append(document.createTextNode(this.args[0].text)),passage=this.args[0].link;else{var $frag=jQuery(document.createDocumentFragment()).wikiWithOptions({cleanup:!1,profile:"core"},this.args[0]),forbidden=$frag.getForbiddenInteractiveContentTagNames();if(forbidden.length>0)throw new Error("text content contains restricted elements: <".concat(forbidden.join(">, <"),">"));$link.append($frag),passage=this.args.length>1?this.args[1]:undefined}null!=passage?($link.attr("data-passage",passage),Story.has(passage)?($link.addClass("link-internal"),Config.addVisitedLinkClass&&State.hasPlayed(passage)&&$link.addClass("link-visited")):$link.addClass("link-broken")):$link.addClass("link-internal"),$link.addClass("macro-".concat(this.name)).ariaClick({namespace:".macros",role:null!=passage?"link":"button",one:null!=passage},this.shadowHandler(""!==this.payload[0].contents?function(){return Wikifier.wikifyEval(_this14.payload[0].contents.trim())}:null,null!=passage?function(){return Engine.play(passage)}:null)).appendTo(this.output)}}),Macro.add("capture",{skipArgs:!0,tags:null,tsVarRe:new RegExp("(".concat(Patterns.variable,")"),"g"),handler:function(){if(0===this.args.raw.length)return this.error("no story/temporary variable list specified");var valueCache={};try{for(var match,tsVarRe=this.self.tsVarRe;null!==(match=tsVarRe.exec(this.args.raw));){var varName=match[1],varKey=varName.slice(1),store="$"===varName[0]?State.variables:State.temporary;Object.hasOwn(store,varKey)&&(valueCache[varKey]=store[varKey]),this.addShadow(varName)}new Wikifier(this.output,this.payload[0].contents)}finally{this.shadows.forEach((function(varName){var varKey=varName.slice(1),store="$"===varName[0]?State.variables:State.temporary;Object.hasOwn(valueCache,varKey)?store[varKey]=valueCache[varKey]:delete store[varKey]}))}}}),Macro.add("checkbox",{isAsync:!0,handler:function(){if(this.args.length<3){var errors=[];return this.args.length<1&&errors.push("variable name"),this.args.length<2&&errors.push("unchecked value"),this.args.length<3&&errors.push("checked value"),this.error("no ".concat(errors.join(" or ")," specified"))}if("string"!=typeof this.args[0])return this.error("variable name argument is not a string");var varName=this.args[0].trim();if("$"!==varName[0]&&"_"!==varName[0])return this.error('variable name "'.concat(this.args[0],'" is missing its sigil ($ or _)'));var varId=createSlug(varName),uncheckValue=this.args[1],checkValue=this.args[2],el=document.createElement("input");switch(jQuery(el).attr({id:"".concat(this.name,"-").concat(varId),name:"".concat(this.name,"-").concat(varId),type:"checkbox",tabindex:0}).addClass("macro-".concat(this.name)).on("change.macros",this.shadowHandler((function(){State.setVar(varName,this.checked?checkValue:uncheckValue)}))).appendTo(this.output),this.args[3]){case"autocheck":State.getVar(varName)===checkValue?el.checked=!0:State.setVar(varName,uncheckValue);break;case"checked":el.checked=!0,State.setVar(varName,checkValue);break;default:State.setVar(varName,uncheckValue)}}}),Macro.add("copy",{handler:function(){if(0===this.args.length)return this.error("no selector specified");var $targets=jQuery(this.args[0]);if(0===$targets.length)return this.error('no elements matched the selector "'.concat(this.args[0],'"'));jQuery(this.output).append($targets.html()),Config.debug&&this.debugView.modes({hidden:!0})}}),Macro.add(["cycle","listbox"],{isAsync:!0,skipArgs:["optionsfrom"],tags:["option","optionsfrom"],handler:function(){var _this15=this;if(0===this.args.length)return this.error("no variable name specified");if("string"!=typeof this.args[0])return this.error("variable name argument is not a string");var varName=this.args[0].trim();if("$"!==varName[0]&&"_"!==varName[0])return this.error('variable name "'.concat(this.args[0],'" is missing its sigil ($ or _)'));var varId=createSlug(varName),len=this.payload.length;if(1===len)return this.error("no options specified");for(var config={autoselect:!1,once:!1},i=1;i<this.args.length;++i){var arg=this.args[i];switch(arg){case"once":config.once=!0;break;case"autoselect":config.autoselect=!0;break;default:return this.error("unknown argument: ".concat(arg))}}for(var _ret,options=[],tagCount={option:0,optionsfrom:0},index=-1,_loop6=function(){var payload=_this15.payload[_i8];if("option"===payload.name){if(++tagCount.option,0===payload.args.length)return{v:_this15.error("no arguments specified for <<".concat(payload.name,">> (#").concat(tagCount.option,")"))};var option={label:String(payload.args[0])},isSelected=!1;switch(payload.args.length){case 1:option.value=payload.args[0];break;case 2:"selected"===payload.args[1]?(option.value=payload.args[0],isSelected=!0):option.value=payload.args[1];break;default:option.value=payload.args[1],"selected"===payload.args[2]&&(isSelected=!0)}if(options.push(option),isSelected){if(config.autoselect)return{v:_this15.error("cannot specify both the autoselect and selected keywords")};if(-1!==index)return{v:_this15.error("multiple selected keywords specified for <<".concat(payload.name,">> (#").concat(index+1," & #").concat(tagCount.option,")"))};index=options.length-1}}else{if(++tagCount.optionsfrom,0===payload.args.full.length)return{v:_this15.error("no expression specified for <<".concat(payload.name,">> (#").concat(tagCount.optionsfrom,")"))};var result;try{var exp=payload.args.full;result=Scripting.evalJavaScript("{"===exp[0]?"(".concat(exp,")"):exp)}catch(ex){return{v:_this15.error("bad evaluation: ".concat(getErrorMessage(ex)))}}if("object"!==_typeof(result)||null===result)return{v:_this15.error("expression must yield a supported collection or generic object (type: ".concat(null===result?"null":_typeof(result),")"))};if(result instanceof Array||result instanceof Set)result.forEach((function(val){return options.push({label:String(val),value:val})}));else if(result instanceof Map)result.forEach((function(val,key){return options.push({label:String(key),value:val})}));else{var oType=getToStringTag(result);if("Object"!==oType)return{v:_this15.error("expression must yield a supported collection or generic object (object type: ".concat(oType,")"))};Object.keys(result).forEach((function(key){return options.push({label:key,value:result[key]})}))}}},_i8=1;_i8<len;++_i8)if(_ret=_loop6())return _ret.v;if(-1===index)if(config.autoselect){var curValue=State.getVar(varName),curValueIndex=options.findIndex((function(opt){return sameValueZero(opt.value,curValue)}));index=-1===curValueIndex?0:curValueIndex}else index=0;if("cycle"===this.name){var lastIndex=options.length-1;if(config.once&&index===lastIndex)jQuery(this.output).wikiWithOptions({cleanup:!1,profile:"core"},options[index].label);else{var cycleIndex=index;jQuery(document.createElement("a")).wikiWithOptions({cleanup:!1,profile:"core"},options[index].label).attr("id","".concat(this.name,"-").concat(varId)).addClass("macro-".concat(this.name)).ariaClick({namespace:".macros",role:"button"},this.shadowHandler((function(){var $this=$(this);cycleIndex=(cycleIndex+1)%options.length,State.setVar(varName,options[cycleIndex].value),$this.empty().wikiWithOptions({cleanup:!1,profile:"core"},options[cycleIndex].label),config.once&&cycleIndex===lastIndex&&$this.off().contents().unwrap()}))).appendTo(this.output)}}else{var $select=jQuery(document.createElement("select"));options.forEach((function(opt,i){jQuery(document.createElement("option")).val(i).text(opt.label).appendTo($select)})),$select.attr({id:"".concat(this.name,"-").concat(varId),name:"".concat(this.name,"-").concat(varId),tabindex:0}).addClass("macro-".concat(this.name)).val(index).on("change.macros",this.shadowHandler((function(){State.setVar(varName,options[Number(this.value)].value)}))).appendTo(this.output)}State.setVar(varName,options[index].value)}}),jQuery(document).on(":redo",(function(ev){var evTags=ev.detail&&ev.detail.tags||[],selector=0===evTags.length?".".concat("redo-target"):evTags.map((function(tag){return".".concat("redo-target",'[data-do-tags~="').concat(tag,'"]')})).join(", ");triggerEvent(":redo-internal",jQuery(selector),{bubbles:!1,detail:ev.detail})})),Macro.add("do",{tags:null,handler:function(){for(var elTag="span",tags=[],options=this.args.slice();options.length>0;){var option=options.shift();switch(option){case"tag":if(0===options.length)return this.error("tag option missing required tag name(s)");var raw=String(options.shift()).trim();if(""===raw)throw new Error("tag option tag name(s) must be non-empty");tags=String(raw).trim().splitOrEmpty(/\s+/);break;case"element":if(0===options.length)return this.error("element option missing required element tag name");if(""===(elTag=String(options.shift()).trim()))throw new Error("element option tag name must be non-empty");break;default:return this.error("unknown option: ".concat(option))}}var contents=this.payload[0].contents;if(""!==contents.trim()){Config.debug&&this.debugView.modes({block:"span"!==elTag});var $target=jQuery(document.createElement(elTag)).addClass("macro-".concat(this.name," ").concat("redo-target")).attr("data-do-tags",tags.join(" ")).wiki(contents).on(":redo-internal",jQuery.throttle(Engine.DOM_DELAY,this.shadowHandler((function(){var frag=document.createDocumentFragment();new Wikifier(frag,contents),$target.empty().append(frag)})))).appendTo(this.output)}}}),Macro.add("redo",{handler:function(){var failRE=/^(?:do|for)$/,passRE=/^(?:button|link(?:append|prepend|replace)?)$/,closest=this.contextFind((function(ctx){return failRE.test(ctx.name)||passRE.test(ctx.name)}));if(closest&&failRE.test(closest.name))return this.error("must not be used directly within macro <<".concat(closest.name,">>"));var tags=this.args.length>0?String(this.args[0]).trim().splitOrEmpty(/\s+/):[];triggerEvent(":redo",document,{detail:{tags:tags}})}}),Macro.add("done",{skipArgs:!0,tags:null,handler:function(){var contents=this.payload[0].contents.trim();""!==contents&&setTimeout(this.shadowHandler((function(){return $.wiki(contents)})),Engine.DOM_DELAY)}}),Macro.add("for",{skipArgs:!0,tags:null,isRangeRe:new RegExp("^(?:\\S".concat(Patterns.anyChar,"*?\\s+)?range\\s+\\S").concat(Patterns.anyChar,"*?$")),rangeRe:new RegExp("^(?:(?:State\\.(variables|temporary)\\.(".concat(Patterns.identifier,")\\s*,\\s*)?State\\.(variables|temporary)\\.(").concat(Patterns.identifier,")\\s+)?range\\s+(\\S").concat(Patterns.anyChar,"*?)$")),threePartRe:/^([^;]*?)\s*;\s*([^;]*?)\s*;\s*([^;]*?)$/,forInRe:/^\S+\s+in\s+\S+/i,forOfRe:/^\S+\s+of\s+\S+/i,handler:function(){var argsStr=this.args.full.trim(),payload=this.payload[0].contents.replace(/\n$/,"");if(0===argsStr.length)this.self.handleFor.call(this,payload,null,!0,null);else if(this.self.isRangeRe.test(argsStr)){var parts=argsStr.match(this.self.rangeRe);if(null===parts)return this.error("invalid range form syntax, format: [[index ,] value] range collection");this.self.handleForRange.call(this,payload,{type:parts[1],name:parts[2]},{type:parts[3],name:parts[4]},parts[5])}else{var init,condition,post;if(-1===argsStr.indexOf(";")){if(this.self.forInRe.test(argsStr))return this.error("invalid syntax, for…in is not supported; see: for…range");if(this.self.forOfRe.test(argsStr))return this.error("invalid syntax, for…of is not supported; see: for…range");condition=argsStr}else{var _parts=argsStr.match(this.self.threePartRe);if(null===_parts)return this.error("invalid 3-part conditional form syntax, format: [init] ; [condition] ; [post]");init=_parts[1],condition=_parts[2].trim(),post=_parts[3],0===condition.length&&(condition=!0)}this.self.handleFor.call(this,payload,init,condition,post)}},handleFor:function(payload,init,condition,post){var evalJavaScript=Scripting.evalJavaScript,first=!0,safety=Config.macros.maxLoopIterations;Config.debug&&this.debugView.modes({block:!0});try{if(TempState.break=null,init)try{evalJavaScript(init)}catch(ex){return this.error("bad init expression: ".concat(getErrorMessage(ex)))}for(;evalJavaScript(condition);){if(--safety<0)return this.error("exceeded configured maximum loop iterations (".concat(Config.macros.maxLoopIterations,")"));if(new Wikifier(this.output,first?payload.replace(/^\n/,""):payload),first&&(first=!1),null!=TempState.break)if(1===TempState.break)TempState.break=null;else if(2===TempState.break){TempState.break=null;break}if(post)try{evalJavaScript(post)}catch(ex){return this.error("bad post expression: ".concat(getErrorMessage(ex)))}}}catch(ex){return this.error("bad conditional expression: ".concat(getErrorMessage(ex)))}finally{TempState.break=null}},handleForRange:function(payload,keyVar,valueVar,rangeExp){var rangeable,first=!0;try{rangeable=this.self.toRangeable(rangeExp)}catch(ex){return this.error(ex.message)}Config.debug&&this.debugView.modes({block:!0});try{for(TempState.break=null;;){var entry=rangeable.next();if(entry.done)break;if(keyVar.name&&(State[keyVar.type][keyVar.name]=entry.key),valueVar.name&&(State[valueVar.type][valueVar.name]=entry.value),new Wikifier(this.output,first?payload.replace(/^\n/,""):payload),first&&(first=!1),null!=TempState.break)if(1===TempState.break)TempState.break=null;else if(2===TempState.break){TempState.break=null;break}}}catch(ex){return this.error(getErrorMessage(ex))}finally{TempState.break=null}},toRangeable:function(rangeExp){var collection;try{collection=Scripting.evalJavaScript("{"===rangeExp[0]?"(".concat(rangeExp,")"):rangeExp)}catch(ex){if("object"!==_typeof(ex))throw new Error("bad range expression: ".concat(ex));throw ex.message="bad range expression: ".concat(ex.message),ex}switch(_typeof(collection)){case"number":if(Number.isNaN(collection)||!Number.isFinite(collection))throw new Error("unsupported range expression type: ".concat(stringFrom(collection)));if(!Number.isInteger(collection))throw new Error("unsupported range expression type: floating-point number");if(!Number.isSafeInteger(collection))throw new Error("unsupported range expression type: unsafe integer");return collection<=0?{next:function(){return{done:!0}}}:{end:collection,pos:0,next:function(){if(this.pos<this.end){var key=this.pos++;return{key:key,value:key,done:!1}}return{done:!0}}};case"string":return{list:collection,end:collection.length,pos:0,next:function(){if(this.pos<this.end){var O=charAndPosAt(this.list,this.pos),key=this.pos;return this.pos=O.end+1,{key:key,value:O.char,done:!1}}return{done:!0}}};case"object":if(collection instanceof Array)return{list:collection,end:collection.length,pos:0,next:function(){if(this.pos<this.end){var key=this.pos++;return{key:key,value:this.list[key],done:!1}}return{done:!0}}};if(collection instanceof Set)return{list:collection=Array.from(collection),end:collection.length,pos:0,next:function(){if(this.pos<this.end){var key=this.pos++;return{key:key,value:this.list[key],done:!1}}return{done:!0}}};if(collection instanceof Map){var keys=Array.from(collection.keys());return{keys:keys,list:collection,end:keys.length,pos:0,next:function(){if(this.pos<this.end){var key=this.keys[this.pos++];return{key:key,value:this.list.get(key),done:!1}}return{done:!0}}}}if("Object"===getToStringTag(collection)){var _keys=Object.keys(collection);return{keys:_keys,list:collection,end:_keys.length,pos:0,next:function(){if(this.pos<this.end){var key=this.keys[this.pos++];return{key:key,value:this.list[key],done:!1}}return{done:!0}}}}throw new Error("unsupported range expression type: ".concat(getToStringTag(collection)));default:throw new Error("unsupported range expression type: ".concat(_typeof(collection)))}}}),Macro.add(["break","continue"],{skipArgs:!0,handler:function(){if(!this.contextSome((function(ctx){return"for"===ctx.name})))return this.error("must only be used in conjunction with its parent macro <<for>>");TempState.break="continue"===this.name?1:2,Config.debug&&this.debugView.modes({hidden:!0})}}),Macro.add("goto",{handler:function(){return 0===this.args.length?this.error("no passage specified"):(passage="object"===_typeof(this.args[0])?this.args[0].link:this.args[0],Story.has(passage)?void setTimeout((function(){return Engine.play(passage)}),Engine.DOM_DELAY):this.error('passage "'.concat(passage,'" does not exist')));var passage}}),Macro.add("if",{skipArgs:!0,tags:["elseif","else"],isElseifWsRE:/^\s*if\b/i,isAssignRE:/[^!%&*+\-/<=>?^|]=[^=>]/,isLiteralRE:new RegExp(["(?:\"\"|''|``)",'(?:"(?:\\\\.|[^"\\\\])+")',"(?:'(?:\\\\.|[^'\\\\])+')","(?:`(?:\\\\.|[^`\\\\])+`)"].join("|"),"g"),handler:function(){var i;try{var len=this.payload.length,isElseifWsRE=this.self.isElseifWsRE,isAssignRE=this.self.isAssignRE,isLiteralRE=this.self.isLiteralRE;for(i=0;i<len;++i)if("else"===this.payload[i].name){if(this.payload[i].args.raw.length>0)return isElseifWsRE.test(this.payload[i].args.raw)?this.error('whitespace is not allowed between the "else" and "if" in <<elseif>> clause'.concat(i>0?" (#".concat(i,")"):"")):this.error("<<else>> does not accept a conditional expression (perhaps you meant to use <<elseif>>), invalid: ".concat(this.payload[i].args.raw));if(i+1!==len)return this.error("<<else>> must be the final clause")}else{if(0===this.payload[i].args.full.length)return this.error("no conditional expression specified for <<".concat(this.payload[i].name,">> clause").concat(i>0?" (#".concat(i,")"):""));if((Config.debug||Config.enableOptionalDebugging)&&isAssignRE.test(this.payload[i].args.full.replace(isLiteralRE,"")))return this.error("assignment operator found within <<".concat(this.payload[i].name,">> clause").concat(i>0?" (#".concat(i,")"):""," (perhaps you meant to use an equality operator: ==, ===, eq, is), invalid: ").concat(this.payload[i].args.raw))}var evalJavaScript=Scripting.evalJavaScript,success=!1;for(i=0;i<len;++i){if(Config.debug&&this.createDebugView(this.payload[i].name,this.payload[i].source).modes({nonvoid:!1}),"else"===this.payload[i].name||evalJavaScript(this.payload[i].args.full)){success=!0,new Wikifier(this.output,this.payload[i].contents);break}Config.debug&&this.debugView.modes({hidden:!0,invalid:!0})}if(Config.debug){for(++i;i<len;++i)this.createDebugView(this.payload[i].name,this.payload[i].source).modes({nonvoid:!1,hidden:!0,invalid:!0});this.createDebugView("/".concat(this.name),"<</".concat(this.name,">>")).modes({nonvoid:!1,hidden:!success,invalid:!success})}}catch(ex){return this.error("bad conditional expression in <<".concat(0===i?"if":"elseif",">> clause").concat(i>0?" (#".concat(i,")"):"",": ").concat(getErrorMessage(ex)))}}}),Macro.add("include",{handler:function(){return"display"===this.name&&console.warn("[DEPRECATED] <<".concat(this.name,">> macro is deprecated.")),0===this.args.length?this.error("no passage specified"):(passage="object"===_typeof(this.args[0])?this.args[0].link:this.args[0],Story.has(passage)?(Config.debug&&this.debugView.modes({block:!0}),passage=Story.get(passage),void(this.args[1]?jQuery(document.createElement(this.args[1])).addClass("".concat(passage.id," macro-").concat(this.name)).attr("data-passage",passage.name).appendTo(this.output):jQuery(this.output)).wiki(passage.processText())):this.error('passage "'.concat(passage,'" does not exist')));var passage}}),Macro.add(["linkappend","linkprepend","linkreplace"],{isAsync:!0,tags:null,t8nRe:/^(?:transition|t8n)$/,handler:function(){var _this16=this;if(0===this.args.length)return this.error("no link text specified");var $link=jQuery(document.createElement("a")),$insert=jQuery(document.createElement("span")),transition=this.args.length>1&&this.self.t8nRe.test(this.args[1]);$link.wikiWithOptions({cleanup:!1,profile:"core"},this.args[0]).addClass("link-internal macro-".concat(this.name)).ariaClick({namespace:".macros",one:!0},this.shadowHandler((function(){if("linkreplace"===_this16.name?$link.remove():$link.wrap('<span class="macro-'.concat(_this16.name,'"></span>')).replaceWith((function(){return $link.html()})),""!==_this16.payload[0].contents){var frag=document.createDocumentFragment();new Wikifier(frag,_this16.payload[0].contents,{cleanup:!1}),$insert.append(frag)}transition&&setTimeout((function(){return $insert.removeClass("macro-".concat(_this16.name,"-in"))}),Engine.DOM_DELAY)}))).appendTo(this.output),$insert.addClass("macro-".concat(this.name,"-insert")),transition&&$insert.addClass("macro-".concat(this.name,"-in")),"linkprepend"===this.name?$insert.insertBefore($link):$insert.insertAfter($link)}}),Macro.add("nobr",{skipArgs:!0,tags:null,handler:function(){new Wikifier(this.output,this.payload[0].contents.replace(/^\n+|\n+$/g,"").replace(/\n+/g," "))}}),Macro.add(["numberbox","textbox"],{isAsync:!0,handler:function(){if(this.args.length<2){var errors=[];return this.args.length<1&&errors.push("variable name"),this.args.length<2&&errors.push("default value"),this.error("no ".concat(errors.join(" or ")," specified"))}if("string"!=typeof this.args[0])return this.error("variable name argument is not a string");var varName=this.args[0].trim();if("$"!==varName[0]&&"_"!==varName[0])return this.error('variable name "'.concat(this.args[0],'" is missing its sigil ($ or _)'));Config.debug&&this.debugView.modes({block:!0});var asNumber="numberbox"===this.name,defaultValue=asNumber?Number(this.args[1]):this.args[1];if(asNumber&&Number.isNaN(defaultValue))return this.error('default value "'.concat(this.args[1],'" is neither a number nor can it be parsed into a number'));var passage,varId=createSlug(varName),el=document.createElement("input"),autofocus=!1;this.args.length>3?(passage=this.args[2],autofocus="autofocus"===this.args[3]):this.args.length>2&&("autofocus"===this.args[2]?autofocus=!0:passage=this.args[2]),"object"===_typeof(passage)&&(passage=passage.link),jQuery(el).attr({id:"".concat(this.name,"-").concat(varId),name:"".concat(this.name,"-").concat(varId),type:asNumber?"number":"text",inputmode:asNumber?"decimal":"text",tabindex:0}).addClass("macro-".concat(this.name)).on("change.macros",this.shadowHandler((function(){State.setVar(varName,asNumber?Number(this.value):this.value)}))).on("keypress.macros",this.shadowHandler((function(ev){13===ev.which&&(ev.preventDefault(),State.setVar(varName,asNumber?Number(this.value):this.value),null!=passage&&Engine.play(passage))}))).appendTo(this.output),asNumber&&(el.step="any"),State.setVar(varName,defaultValue),el.value=defaultValue,autofocus&&(el.setAttribute("autofocus","autofocus"),Engine.isPlaying()?jQuery(document).one(":passageend",(function(){setTimeout((function(){return el.focus()}),Engine.DOM_DELAY)})):setTimeout((function(){return el.focus()}),Engine.DOM_DELAY))}}),Macro.add(["print","=","-"],{skipArgs:!0,handler:function(){if(0===this.args.full.length)return this.error("no expression specified");try{var result=stringFrom(Scripting.evalJavaScript(this.args.full));null!==result&&new Wikifier(this.output,"-"===this.name?encodeEntities(result):result)}catch(ex){return this.error("bad evaluation: ".concat(getErrorMessage(ex)))}}}),Macro.add("radiobutton",{isAsync:!0,handler:function(){if(this.args.length<2){var errors=[];return this.args.length<1&&errors.push("variable name"),this.args.length<2&&errors.push("checked value"),this.error("no ".concat(errors.join(" or ")," specified"))}if("string"!=typeof this.args[0])return this.error("variable name argument is not a string");var varName=this.args[0].trim();if("$"!==varName[0]&&"_"!==varName[0])return this.error('variable name "'.concat(this.args[0],'" is missing its sigil ($ or _)'));var varId=createSlug(varName),checkValue=this.args[1],el=document.createElement("input");switch(Object.hasOwn(TempState,this.name)||(TempState[this.name]={}),Object.hasOwn(TempState[this.name],varId)||(TempState[this.name][varId]=0),jQuery(el).attr({id:"".concat(this.name,"-").concat(varId,"-").concat(TempState[this.name][varId]++),name:"".concat(this.name,"-").concat(varId),type:"radio",tabindex:0}).addClass("macro-".concat(this.name)).on("change.macros",this.shadowHandler((function(){this.checked&&State.setVar(varName,checkValue)}))).appendTo(this.output),this.args[2]){case"autocheck":State.getVar(varName)===checkValue&&(el.checked=!0);break;case"checked":el.checked=!0,State.setVar(varName,checkValue)}}}),Macro.add("remove",{handler:function(){if(0===this.args.length)return this.error("no selector specified");var $targets=jQuery(this.args[0]);if(0===$targets.length)return this.error('no elements matched the selector "'.concat(this.args[0],'"'));$targets.remove(),Config.debug&&this.debugView.modes({hidden:!0})}}),Macro.add("removeclass",{handler:function(){if(0===this.args.length)return this.error("no selector specified");var $targets=jQuery(this.args[0]);if(0===$targets.length)return this.error('no elements matched the selector "'.concat(this.args[0],'"'));this.args.length>1?$targets.removeClass(this.args[1].trim()):$targets.removeClass(),Config.debug&&this.debugView.modes({hidden:!0})}}),Macro.add("repeat",{isAsync:!0,tags:null,timers:new Set,t8nRe:/^(?:transition|t8n)$/,handler:function(){var delay,_this17=this;if(0===this.args.length)return this.error("no time value specified");try{delay=Math.max(Engine.DOM_DELAY,cssTimeToMS(this.args[0]))}catch(ex){return this.error(ex.message)}Config.debug&&this.debugView.modes({block:!0});var transition=this.args.length>1&&this.self.t8nRe.test(this.args[1]),$wrapper=jQuery(document.createElement("span")).addClass("macro-".concat(this.name)).appendTo(this.output);this.self.registerInterval(this.shadowHandler((function(){var frag=document.createDocumentFragment();new Wikifier(frag,_this17.payload[0].contents,{cleanup:!1});var $output=$wrapper;transition&&($output=jQuery(document.createElement("span")).addClass("macro-repeat-insert macro-repeat-in").appendTo($output)),$output.append(frag),transition&&setTimeout((function(){return $output.removeClass("macro-repeat-in")}),Engine.DOM_DELAY)})),delay)},registerInterval:function(callback,delay){var _this18=this;if("function"!=typeof callback)throw new TypeError("callback parameter must be a function");var passage=State.passage,turn=State.turns,timers=this.timers,timerId=null;timerId=setInterval((function(){if(State.passage!==passage||State.turns!==turn)return clearInterval(timerId),void timers.delete(timerId);var timerIdCache;try{TempState.break=null,Object.hasOwn(TempState,"repeatTimerId")&&(timerIdCache=TempState.repeatTimerId),TempState.repeatTimerId=timerId,callback.call(_this18)}finally{void 0!==timerIdCache?TempState.repeatTimerId=timerIdCache:delete TempState.repeatTimerId,TempState.break=null}}),delay),timers.add(timerId),1===timers.size&&jQuery(document).one(":passageinit",(function(){timers.forEach((function(timerId){return clearInterval(timerId)})),timers.clear()}))}}),Macro.add("stop",{skipArgs:!0,handler:function(){if(!Object.hasOwn(TempState,"repeatTimerId"))return this.error("must only be used in conjunction with its parent macro <<repeat>>");var timers=Macro.get("repeat").timers,timerId=TempState.repeatTimerId;clearInterval(timerId),timers.delete(timerId),TempState.break=2,Config.debug&&this.debugView.modes({hidden:!0})}}),Macro.add("script",{tags:null,handler:function(){var evalScript;switch(this.args.length>0?String(this.args[0]).toLowerCase():"javascript"){case"javascript":evalScript=Scripting.evalJavaScript;break;case"twinescript":evalScript=Scripting.evalTwineScript;break;default:return this.error('unknown language "'.concat(this.args[0],'"'))}var output=document.createDocumentFragment();try{evalScript(this.payload[0].contents,output)}catch(ex){return this.error("bad evaluation: ".concat(getErrorMessage(ex)))}Config.debug&&this.createDebugView(),output.hasChildNodes()&&this.output.appendChild(output)}}),Macro.add("set",{skipArgs:!0,handler:function(){if(0===this.args.full.length)return this.error("no expression specified");try{Scripting.evalJavaScript(this.args.full)}catch(ex){return this.error("bad evaluation: ".concat(getErrorMessage(ex)))}Config.debug&&this.debugView.modes({hidden:!0})}}),Macro.add("run","set"),Macro.add("silent",{skipArgs:!0,tags:null,handler:function(){"silently"===this.name&&console.warn("[DEPRECATED] <<".concat(this.name,">> macro is deprecated."));var frag=document.createDocumentFragment();if(new Wikifier(frag,this.payload[0].contents.trim()),Config.debug)this.debugView.modes({block:!0,hidden:!0}),this.output.appendChild(frag);else{var errList=Array.from(frag.querySelectorAll(".error")).map((function(errEl){return errEl.textContent}));if(errList.length>0)return this.error("error".concat(1===errList.length?"":"s"," within contents (").concat(errList.join("; "),")"))}}}),Macro.add("switch",{skipArgs:["switch"],tags:["case","default"],handler:function(){if(0===this.args.full.length)return this.error("no expression specified");var i,result,len=this.payload.length;if(1===len)return this.error("no cases specified");for(i=1;i<len;++i)if("default"===this.payload[i].name){if(this.payload[i].args.length>0)return this.error("<<default>> does not accept values, invalid: ".concat(this.payload[i].args.raw));if(i+1!==len)return this.error("<<default>> must be the final case")}else if(0===this.payload[i].args.length)return this.error("no value(s) specified for <<".concat(this.payload[i].name,">> (#").concat(i,")"));try{result=Scripting.evalJavaScript(this.args.full)}catch(ex){return this.error("bad evaluation: ".concat(getErrorMessage(ex)))}var debugView=this.debugView,success=!1;for(Config.debug&&debugView.modes({nonvoid:!1,hidden:!0}),i=1;i<len;++i){if(Config.debug&&this.createDebugView(this.payload[i].name,this.payload[i].source).modes({nonvoid:!1}),"default"===this.payload[i].name||this.payload[i].args.some((function(val){return val===result}))){success=!0,new Wikifier(this.output,this.payload[i].contents);break}Config.debug&&this.debugView.modes({hidden:!0,invalid:!0})}if(Config.debug){for(++i;i<len;++i)this.createDebugView(this.payload[i].name,this.payload[i].source).modes({nonvoid:!1,hidden:!0,invalid:!0});debugView.modes({nonvoid:!1,hidden:!0,invalid:!success}),this.createDebugView("/".concat(this.name),"<</".concat(this.name,">>")).modes({nonvoid:!1,hidden:!0,invalid:!success})}}}),Macro.add("textarea",{isAsync:!0,handler:function(){if(this.args.length<2){var errors=[];return this.args.length<1&&errors.push("variable name"),this.args.length<2&&errors.push("default value"),this.error("no ".concat(errors.join(" or ")," specified"))}if("string"!=typeof this.args[0])return this.error("variable name argument is not a string");var varName=this.args[0].trim();if("$"!==varName[0]&&"_"!==varName[0])return this.error('variable name "'.concat(this.args[0],'" is missing its sigil ($ or _)'));Config.debug&&this.debugView.modes({block:!0});var varId=createSlug(varName),defaultValue=this.args[1],autofocus="autofocus"===this.args[2],el=document.createElement("textarea");jQuery(el).attr({id:"".concat(this.name,"-").concat(varId),name:"".concat(this.name,"-").concat(varId),rows:4,tabindex:0}).addClass("macro-".concat(this.name)).on("change.macros",this.shadowHandler((function(){State.setVar(varName,this.value)}))).appendTo(this.output),State.setVar(varName,defaultValue),el.textContent=defaultValue,autofocus&&(el.setAttribute("autofocus","autofocus"),Engine.isPlaying()?jQuery(document).one(":passageend",(function(){setTimeout((function(){return el.focus()}),Engine.DOM_DELAY)})):setTimeout((function(){return el.focus()}),Engine.DOM_DELAY))}}),Macro.add("timed",{isAsync:!0,tags:["next"],timers:new Set,t8nRe:/^(?:transition|t8n)$/,handler:function(){if(0===this.args.length)return this.error("no time value specified in <<timed>>");var i,items=[];try{items.push({name:this.name,source:this.source,delay:Math.max(Engine.DOM_DELAY,cssTimeToMS(this.args[0])),content:this.payload[0].contents})}catch(ex){return this.error("".concat(ex.message," in <<timed>>"))}if(this.payload.length>1)try{var len;for(i=1,len=this.payload.length;i<len;++i)items.push({name:this.payload[i].name,source:this.payload[i].source,delay:0===this.payload[i].args.length?items[items.length-1].delay:Math.max(Engine.DOM_DELAY,cssTimeToMS(this.payload[i].args[0])),content:this.payload[i].contents})}catch(ex){return this.error("".concat(ex.message," in <<next>> (#").concat(i,")"))}Config.debug&&this.debugView.modes({block:!0});var transition=this.args.length>1&&this.self.t8nRe.test(this.args[1]),$wrapper=jQuery(document.createElement("span")).addClass("macro-".concat(this.name)).appendTo(this.output);this.self.registerTimeout(this.shadowHandler((function(item){var frag=document.createDocumentFragment();new Wikifier(frag,item.content,{cleanup:!1});var $output=$wrapper;Config.debug&&"next"===item.name&&($output=jQuery(new DebugView($output[0],"macro",item.name,item.source).output)),transition&&($output=jQuery(document.createElement("span")).addClass("macro-timed-insert macro-timed-in").appendTo($output)),$output.append(frag),transition&&setTimeout((function(){return $output.removeClass("macro-timed-in")}),Engine.DOM_DELAY)})),items)},registerTimeout:function(callback,items){if("function"!=typeof callback)throw new TypeError("callback parameter must be a function");var passage=State.passage,turn=State.turns,timers=this.timers,timerId=null,nextItem=items.shift();timerId=setTimeout((function worker(){if(timers.delete(timerId),State.passage===passage&&State.turns===turn){var curItem=nextItem;null!=(nextItem=items.shift())&&(timerId=setTimeout(worker,nextItem.delay),timers.add(timerId)),callback.call(this,curItem)}}),nextItem.delay),timers.add(timerId),1===timers.size&&jQuery(document).one(":passageinit",(function(){timers.forEach((function(timerId){return clearTimeout(timerId)})),timers.clear()}))}}),Macro.add("type",{isAsync:!0,tags:null,typeId:0,handler:function(){if(0===this.args.length)return this.error("no speed specified");var cursor,speed=cssTimeToMS(this.args[0]);if(speed<0)return this.error("speed time value must be non-negative (received: ".concat(this.args[0],")"));for(var elClass="",elId="",elTag="div",skipKey=Config.macros.typeSkipKey,start=400,options=this.args.slice(1);options.length>0;){var option=options.shift();switch(option){case"class":if(0===options.length)return this.error("class option missing required class name(s)");if(""===(elClass=options.shift()))throw new Error('class option class name(s) must be non-empty (received: "")');break;case"element":if(0===options.length)return this.error("element option missing required element tag name");if(""===(elTag=options.shift()))throw new Error('element option tag name must be non-empty (received: "")');break;case"id":if(0===options.length)return this.error("id option missing required ID");if(""===(elId=options.shift()))throw new Error('id option ID must be non-empty (received: "")');break;case"keep":cursor="keep";break;case"none":cursor="none";break;case"skipkey":if(0===options.length)return this.error("skipkey option missing required key value");if(""===(skipKey=options.shift()))throw new Error('skipkey option key value must be non-empty (received: "")');break;case"start":if(0===options.length)return this.error("start option missing required time value");var value=options.shift();if((start=cssTimeToMS(value))<0)throw new Error("start option time value must be non-negative (received: ".concat(value,")"));break;default:return this.error("unknown option: ".concat(option))}}var contents=this.payload[0].contents;if(""!==contents.trim()){Config.debug&&this.debugView.modes({block:!0});var className="macro-".concat(this.name),namespace=".".concat(className),$target=jQuery(document.createElement(elTag)).addClass("".concat(className," ").concat(className,"-target")).appendTo(this.output);TempState.macroTypeQueue||(TempState.macroTypeQueue=[],$(document).off(namespace).one(":passageinit".concat(namespace),(function(){return $(document).off(namespace)})));var startTyping=0===TempState.macroTypeQueue.length,selfId=++this.self.typeId,allowCleanup=this.self.allowCleanup;TempState.macroTypeQueue.push({id:selfId,handler:this.shadowHandler((function(){var $wrapper=jQuery(document.createElement(elTag)).addClass(className);elId&&$wrapper.attr("id",elId),elClass&&$wrapper.addClass(elClass),new Wikifier($wrapper,contents,allowCleanup(elTag)?undefined:{cleanup:!1});var passage=State.passage,turn=State.turns;if(0===speed||!Config.macros.typeVisitedPassages&&State.passages.slice(0,-1).some((function(title){return title===passage}))||$wrapper.find(".error").length>0)return $target.replaceWith($wrapper),TempState.macroTypeQueue.shift(),void(TempState.macroTypeQueue.length>0&&TempState.macroTypeQueue.first().handler());var typer=new NodeTyper({targetNode:$wrapper.get(0),classNames:"none"===cursor?null:"".concat(className,"-cursor")});$target.replaceWith($wrapper);var keydownAndNS="keydown".concat(namespace),typingStopAndNS="".concat(":typingstop").concat(namespace);$(document).off(keydownAndNS).on(keydownAndNS,(function(ev){scrubEventKey(ev.key)!==skipKey||ev.target!==document.body&&ev.target!==document.documentElement||(ev.preventDefault(),$(document).off(keydownAndNS),typer.finish())})).one(typingStopAndNS,(function(){TempState.macroTypeQueue&&(0===TempState.macroTypeQueue.length?triggerEvent(":typingcomplete"):TempState.macroTypeQueue.first().handler())}));var typeNode=function(){var typeNodeMember=function(typeIntervalId){State.passage===passage&&State.turns===turn&&typer.type()||(typeIntervalId&&clearInterval(typeIntervalId),TempState.macroTypeQueue&&TempState.macroTypeQueue.length>0&&TempState.macroTypeQueue.first().id===selfId&&TempState.macroTypeQueue.shift(),triggerEvent(":typingstop",$wrapper),$wrapper.addClass("".concat(className,"-done")),"keep"===cursor&&$wrapper.addClass("".concat(className,"-cursor")))};triggerEvent(":typingstart",$wrapper),typeNodeMember();var typeNodeMemberId=setInterval((function(){return typeNodeMember(typeNodeMemberId)}),speed)};start?setTimeout(typeNode,start):typeNode()}))}),startTyping&&(Engine.isPlaying()?$(document).one(":passageend".concat(namespace),(function(){return TempState.macroTypeQueue.first().handler()})):TempState.macroTypeQueue.first().handler())}},allowCleanup:function(tagName){switch(tagName.toUpperCase()){case"ARTICLE":case"DIV":case"FOOTER":case"FORM":case"HEADER":case"MAIN":case"SECTION":return!0}return!1}}),Macro.add("unset",{skipArgs:!0,handler:function(){if(0===this.args.full.length)return this.error("no story/temporary variable list specified");try{var unsetExp=this.args.full.replace(/[,;\s]*((?:State\.(?:variables|temporary)|setup)\.)/g,(function(_,p1){return"; delete ".concat(p1)})).replace(/^; /,"");Scripting.evalJavaScript(unsetExp)}catch(ex){return this.error("bad evaluation: ".concat(getErrorMessage(ex)))}Config.debug&&this.debugView.modes({hidden:!0})}}),Macro.add("widget",{tags:null,handler:function(){if(0===this.args.length)return this.error("no widget name specified");var widgetCode,widgetName=this.args[0],isNonVoid=this.args.length>1&&"container"===this.args[1];if(Macro.has(widgetName))return this.error("cannot clobber existing ".concat(Macro.get(widgetName).isWidget?"widget":"macro",' "').concat(widgetName,'"'));try{var widgetDef={isWidget:!0,handler:(widgetCode=this.payload[0].contents,function(){var shadowStore={};Object.hasOwn(State.temporary,"args")&&(shadowStore._args=State.temporary.args),State.temporary.args=Array.from(this.args),State.temporary.args.raw=this.args.raw,State.temporary.args.full=this.args.full,State.temporary.args.name=this.name,this.addShadow("_args"),isNonVoid&&(Object.hasOwn(State.temporary,"contents")&&(shadowStore._contents=State.temporary.contents),State.temporary.contents=this.payload[0].contents,this.addShadow("_contents")),Object.hasOwn(State.variables,"args")&&(shadowStore.$args=State.variables.args),State.variables.args=State.temporary.args,this.addShadow("$args");try{var resFrag=document.createDocumentFragment(),errList=[];if(new Wikifier(resFrag,widgetCode),Array.from(resFrag.querySelectorAll(".error")).forEach((function(errEl){errList.push(errEl.textContent)})),0!==errList.length)return this.error("error".concat(errList.length>1?"s":""," within widget code (").concat(errList.join("; "),")"));this.output.appendChild(resFrag)}catch(ex){return this.error("cannot execute widget: ".concat(ex.message))}finally{Object.hasOwn(shadowStore,"_args")?State.temporary.args=shadowStore._args:delete State.temporary.args,isNonVoid&&(Object.hasOwn(shadowStore,"_contents")?State.temporary.contents=shadowStore._contents:delete State.temporary.contents),Object.hasOwn(shadowStore,"$args")?State.variables.args=shadowStore.$args:delete State.variables.args}})};isNonVoid&&(widgetDef.tags=[]),Macro.add(widgetName,widgetDef),Config.debug&&this.debugView.modes({hidden:!0})}catch(ex){return this.error('cannot create widget macro "'.concat(widgetName,'": ').concat(ex.message))}}}),Macro.add("silently","silent"),Macro.add("actions",{handler:function(){console.warn("[DEPRECATED] <<".concat(this.name,">> macro is deprecated."));for(var $list=jQuery(document.createElement("ul")).addClass(this.name).appendTo(this.output),i=0;i<this.args.length;++i){var passage=void 0,text=void 0,$image=void 0,setFn=void 0;if("object"===_typeof(this.args[i])?this.args[i].isImage?($image=jQuery(document.createElement("img")).attr("src",this.args[i].source),Object.hasOwn(this.args[i],"passage")&&$image.attr("data-passage",this.args[i].passage),Object.hasOwn(this.args[i],"title")&&$image.attr("title",this.args[i].title),Object.hasOwn(this.args[i],"align")&&$image.attr("align",this.args[i].align),passage=this.args[i].link,setFn=this.args[i].setFn):(text=this.args[i].text,passage=this.args[i].link,setFn=this.args[i].setFn):text=passage=this.args[i],!(Object.hasOwn(State.variables,"#actions")&&Object.hasOwn(State.variables["#actions"],passage)&&State.variables["#actions"][passage])){var $link=jQuery(Wikifier.createInternalLink(jQuery(document.createElement("li")).appendTo($list),passage,null,function(passage,fn){return function(){Object.hasOwn(State.variables,"#actions")||(State.variables["#actions"]={}),State.variables["#actions"][passage]=!0,"function"==typeof fn&&fn()}}(passage,setFn))).addClass("macro-".concat(this.name)).append($image||document.createTextNode(text));$image&&$link.addClass("link-image")}}}}),Macro.add("choice",{handler:function(){if(console.warn("[DEPRECATED] <<".concat(this.name,">> macro is deprecated.")),0===this.args.length)return this.error("no passage specified");var passage,text,$image,setFn,$link,choiceId=State.passage;if(1===this.args.length?"object"===_typeof(this.args[0])?this.args[0].isImage?($image=jQuery(document.createElement("img")).attr("src",this.args[0].source),Object.hasOwn(this.args[0],"passage")&&$image.attr("data-passage",this.args[0].passage),Object.hasOwn(this.args[0],"title")&&$image.attr("title",this.args[0].title),Object.hasOwn(this.args[0],"align")&&$image.attr("align",this.args[0].align),passage=this.args[0].link,setFn=this.args[0].setFn):(text=this.args[0].text,passage=this.args[0].link,setFn=this.args[0].setFn):text=passage=this.args[0]:(passage=this.args[0],text=this.args[1]),Object.hasOwn(State.variables,"#choice")&&Object.hasOwn(State.variables["#choice"],choiceId)&&State.variables["#choice"][choiceId])return $link=jQuery(document.createElement("span")).addClass("link-disabled macro-".concat(this.name)).attr("tabindex",-1).append($image||document.createTextNode(text)).appendTo(this.output),void($image&&$link.addClass("link-image"));$link=jQuery(Wikifier.createInternalLink(this.output,passage,null,(function(){Object.hasOwn(State.variables,"#choice")||(State.variables["#choice"]={}),State.variables["#choice"][choiceId]=!0,"function"==typeof setFn&&setFn()}))).addClass("macro-".concat(this.name)).append($image||document.createTextNode(text)),$image&&$link.addClass("link-image")}});var Dialog=function(){var DEFAULT_TOP=50,$overlay=null,$dialog=null,$title=null,$body=null,lastActive=null,observer=null,onCloseFn=null,scrollbarWidth=0;function calcInset(top){var $window=jQuery(window),inset={left:"",right:"",top:"",bottom:""};$dialog.css(inset);var horzSpace=$window.width()-$dialog.outerWidth(!0)-1,vertSpace=$window.height()-$dialog.outerHeight(!0)-1;if(horzSpace<=20+scrollbarWidth&&(vertSpace-=scrollbarWidth),vertSpace<=20+scrollbarWidth&&(horzSpace-=scrollbarWidth),inset.left=inset.right=horzSpace<=20?"10px":(horzSpace/2|0)+"px",vertSpace<=20)inset.top=inset.bottom="10px";else{var vertPos=vertSpace/2|0;inset.top=vertPos>top?top+"px":inset.bottom=vertPos+"px"}return inset}function onResize(top){"block"===$dialog.css("display")&&$dialog.css(calcInset(null!=top?top:DEFAULT_TOP))}function close(ev){if(triggerEvent(":dialogclosing",$body),jQuery(document).off(".dialog-close"),observer?(observer.disconnect(),observer=null):$body.off(".dialog-resize"),jQuery(window).off(".dialog-resize"),$dialog.removeClass("open").css({left:"",right:"",top:"",bottom:""}),jQuery("#ui-bar,#story").find("[tabindex=-2]").removeAttr("aria-hidden").attr("tabindex",0),jQuery("body>[tabindex=-3]").removeAttr("aria-hidden").removeAttr("tabindex"),$overlay.removeClass("open"),jQuery(document.documentElement).removeAttr("data-dialog"),$title.empty(),$body.empty().removeClass(),lastActive&&(lastActive.focus(),lastActive=null),onCloseFn)try{onCloseFn(ev)}finally{onCloseFn=null}return triggerEvent(":dialogclose",$body),triggerEvent(":dialogclosed",$body),Dialog}function create(title,classNames){return $title.empty().append((null!=title?String(title):"")||" "),$body.empty().removeClass(),null!=classNames&&$body.addClass(classNames),Dialog}function getBody(){return $body.get(0)}function isOpen(classNames){return $dialog.hasClass("open")&&(!classNames||classNames.splitOrEmpty(/\s+/).every((function(cn){return $body.hasClass(cn)})))}function wiki(){var _$body2;return(_$body2=$body).wiki.apply(_$body2,arguments),Dialog}return Object.preventExtensions(Object.create(null,{append:{value:function(){var _$body;return(_$body=$body).append.apply(_$body,arguments),Dialog}},body:{value:getBody},close:{value:close},create:{value:create},empty:{value:function(){return $body.empty(),Dialog}},init:{value:function(){if(!document.getElementById("ui-dialog")){scrollbarWidth=function(){var calcWidth;try{var inner=document.createElement("p");inner.style.width="100%",inner.style.height="200px";var outer=document.createElement("div");outer.style.position="absolute",outer.style.left="0",outer.style.top="0",outer.style.width="100px",outer.style.height="100px",outer.style.visibility="hidden",outer.style.overflow="hidden",outer.appendChild(inner),document.body.appendChild(outer);var w1=inner.offsetWidth;outer.style.overflow="auto";var w2=inner.offsetWidth;w1===w2&&(w2=outer.clientWidth),document.body.removeChild(outer),calcWidth=w1-w2}catch(ex){}return calcWidth||17}();var $elems=jQuery(document.createDocumentFragment()).append('<div id="ui-overlay" class="ui-close"></div><div id="ui-dialog" tabindex="0" role="dialog" aria-labelledby="ui-dialog-title" aria-modal="true"><div id="ui-dialog-titlebar"><h1 id="ui-dialog-title"></h1>'+'<button id="ui-dialog-close" class="ui-close" tabindex="0" aria-label="'.concat(L10n.get("textClose"),'"></button>')+'</div><div id="ui-dialog-body"></div></div>');$overlay=jQuery($elems.find("#ui-overlay").get(0)),$dialog=jQuery($elems.find("#ui-dialog").get(0)),$title=jQuery($elems.find("#ui-dialog-title").get(0)),$body=jQuery($elems.find("#ui-dialog-body").get(0)),$elems.insertBefore("body>script#script-sugarcube")}}},isOpen:{value:isOpen},open:{value:function(options,onClose){var top=Object.assign({top:DEFAULT_TOP},options).top;if(null!=onClose){var closeType=getTypeOf(onClose);if("function"!==closeType)throw new TypeError("Dialog.open onClose parameter must be a function (received: ".concat(closeType,")"));onCloseFn=onClose}else onCloseFn=null;triggerEvent(":dialogopening",$body),isOpen()||(lastActive=getActiveElement()),jQuery(document.documentElement).attr("data-dialog","open"),$overlay.addClass("open"),jQuery("body>:not(script,#store-area,tw-storydata,#ui-bar,#ui-overlay,#ui-dialog)").attr("tabindex",-3).attr("aria-hidden",!0),jQuery("#ui-bar,#story").find("[tabindex]:not([tabindex^=-])").attr("tabindex",-2).attr("aria-hidden",!0);var resizeHandler=jQuery.throttle(40,(function(){return onResize(top)}));return $body.imagesLoaded().always(resizeHandler),$dialog.css(calcInset(top)).addClass("open").focus(),jQuery(window).off(".dialog-resize").on("resize.dialog-resize",resizeHandler),Has.mutationObserver?(observer=new MutationObserver((function(mutations){for(var i=0;i<mutations.length;++i)if("childList"===mutations[i].type){$body.imagesLoaded().always(resizeHandler),resizeHandler();break}}))).observe(getBody(),{childList:!0,subtree:!0}):$body.off(".dialog-resize").on("DOMNodeInserted.dialog-resize DOMNodeRemoved.dialog-resize",(function(){$body.imagesLoaded().always(resizeHandler),resizeHandler()})),jQuery(document).off(".dialog-close").one("click.dialog-close",".ui-close",(function(ev){close(ev)})).one("keypress.dialog-close",".ui-close",(function(ev){13!==ev.which&&32!==ev.which||triggerEvent("click",this)})),triggerEvent(":dialogopen",$body),triggerEvent(":dialogopened",$body),Dialog}},resize:{value:function(options){return onResize("object"===_typeof(options)?options.top:undefined)}},wiki:{value:wiki},wikiPassage:{value:function(name){return wiki(Story.get(name).processText())}},setup:{value:function(title,classNames){return console.warn("[DEPRECATED] Dialog.setup() is deprecated."),create(title,classNames),getBody()}}}))}(),Engine=function(){var States=enumFrom({Init:"init",Idle:"idle",Playing:"playing",Rendering:"rendering"}),DOM_DELAY=40,_initDebugViews=[],_state=States.Init,_lastPlay=null;function engineGo(offset){var succeded=State.go(offset);return succeded&&engineShow(),succeded}function engineShow(){return enginePlay(State.passage,!0)}function enginePlay(title,noHistory){if(_state===States.Init)return!1;var passageReadyOutput,passageDoneOutput,passageTitle=title;if(_state=States.Playing,TempState={},State.clearTemporary(),"function"==typeof Config.navigation.override)try{var overrideTitle=Config.navigation.override(passageTitle);overrideTitle&&(passageTitle=overrideTitle)}catch(ex){}var passage=Story.get(passageTitle);if(jQuery.event.trigger({passage:passage,type:":passageinit",detail:{passage:passage}}),Object.keys(prehistory).forEach((function(task){"function"==typeof prehistory[task]&&prehistory[task].call(passage,task)})),noHistory||State.create(passage.name),document.body.className&&(document.body.className=""),_lastPlay=now(),Object.keys(predisplay).forEach((function(task){"function"==typeof predisplay[task]&&predisplay[task].call(passage,task)})),Story.has("PassageReady"))try{passageReadyOutput=Wikifier.wikifyEval(Story.get("PassageReady").text)}catch(ex){console.error(ex),Alert.error("PassageReady",ex.message)}_state=States.Rendering;var dataTags=passage.tags.length>0?passage.tags.join(" "):null,passageEl=document.createElement("div");jQuery(passageEl).attr({id:passage.id,"data-passage":passage.name,"data-tags":dataTags}).addClass("passage passage-in ".concat(passage.className)),jQuery(document.body).attr("data-tags",dataTags).addClass(passage.className),jQuery(document.documentElement).attr("data-tags",dataTags),jQuery.event.trigger({content:passageEl,passage:passage,type:":passagestart",detail:{content:passageEl,passage:passage}}),Object.keys(prerender).forEach((function(task){"function"==typeof prerender[task]&&prerender[task].call(passage,passageEl,task)})),Story.has("PassageHeader")&&new Wikifier(passageEl,Story.get("PassageHeader").processText()),passageEl.appendChild(passage.render()),Story.has("PassageFooter")&&new Wikifier(passageEl,Story.get("PassageFooter").processText()),jQuery.event.trigger({content:passageEl,passage:passage,type:":passagerender",detail:{content:passageEl,passage:passage}}),Object.keys(postrender).forEach((function(task){"function"==typeof postrender[task]&&postrender[task].call(passage,passageEl,task)}));var debugView,containerEl=document.getElementById("passages");if(containerEl.hasChildNodes()&&("number"==typeof Config.passages.transitionOut||"string"==typeof Config.passages.transitionOut&&""!==Config.passages.transitionOut&&Has.transitionEndEvent?Array.from(containerEl.childNodes).forEach((function(outgoing){var $outgoing=jQuery(outgoing);if(outgoing.nodeType===Node.ELEMENT_NODE&&$outgoing.hasClass("passage")){if($outgoing.hasClass("passage-out"))return;$outgoing.attr({id:"out-".concat($outgoing.attr("id")),"aria-hidden":"true","aria-live":"off"}).addClass("passage-out"),"string"==typeof Config.passages.transitionOut?$outgoing.on(Has.transitionEndEvent,(function(ev){ev.originalEvent.propertyName===Config.passages.transitionOut&&$outgoing.remove()})):setTimeout((function(){return $outgoing.remove()}),Math.max(DOM_DELAY,Config.passages.transitionOut))}else $outgoing.remove()})):jQuery(containerEl).empty()),jQuery(passageEl).appendTo(containerEl),setTimeout((function(){return jQuery(passageEl).removeClass("passage-in")}),DOM_DELAY/2),window.scroll(0,0),_state=States.Playing,Story.has("PassageDone"))try{passageDoneOutput=Wikifier.wikifyEval(Story.get("PassageDone").text)}catch(ex){console.error(ex),Alert.error("PassageDone",ex.message)}(jQuery.event.trigger({content:passageEl,passage:passage,type:":passagedisplay",detail:{content:passageEl,passage:passage}}),Object.keys(postdisplay).forEach((function(task){"function"==typeof postdisplay[task]&&postdisplay[task].call(passage,task)})),UI.update(),Config.debug)&&(null!=passageReadyOutput&&((debugView=new DebugView(document.createDocumentFragment(),"special","PassageReady","PassageReady")).modes({hidden:!0}),debugView.append(passageReadyOutput),jQuery(passageEl).prepend(debugView.output)),null!=passageDoneOutput&&((debugView=new DebugView(document.createDocumentFragment(),"special","PassageDone","PassageDone")).modes({hidden:!0}),debugView.append(passageDoneOutput),jQuery(passageEl).append(debugView.output)),1===State.turns&&_initDebugViews.length>0&&jQuery(passageEl).prepend(_initDebugViews));return jQuery("#story").find("a,link,button,input,select,textarea").not("[tabindex]").attr("tabindex",0),State.turns>1&&Save.browser.auto.isEnabled()&&Save.browser.auto.save(),jQuery.event.trigger({content:passageEl,passage:passage,type:":passageend",detail:{content:passageEl,passage:passage}}),_state=States.Idle,_lastPlay=now(),passageEl}return Object.preventExtensions(Object.create(null,{States:{value:States},DOM_DELAY:{get:function(){return DOM_DELAY}},init:{value:function(){if(_state===States.Init){jQuery("#init-no-js,#init-lacking").remove();var $main=jQuery('<div id="story" role="main"></div>'),markup=Story.has("StoryInterface")&&Story.get("StoryInterface").text.trim();if(markup){if(Config.ui.updateStoryElements=!1,UIBar.destroy(),jQuery(document.head).find("#style-core-display").remove(),$main.append(markup),$main.find("#story").length>0)throw new Error('element with ID "story" found within "StoryInterface" special passage');var $passages=$main.find("#passages");if(0===$passages.length)throw new Error('no element with ID "passages" found within "StoryInterface" special passage');$passages.empty().not("[aria-live]").attr("aria-live","polite").end();var $dataInitPassages=$main.find("[data-init-passage]"),$dataPassages=$main.find("[data-passage]");$dataInitPassages.each((function(i,el){if("passages"===el.id)throw new Error('"StoryInterface" element <'.concat(el.nodeName.toLowerCase(),' id="passages"> must not contain a "data-init-passage" content attribute'));var passage=el.getAttribute("data-init-passage").trim();if(el.hasAttribute("data-passage"))throw new Error('"StoryInterface" element <'.concat(el.nodeName.toLowerCase(),' data-init-passage="').concat(passage,'"> must not contain a "data-passage" content attribute'));if(null!==el.firstElementChild)throw new Error('"StoryInterface" element <'.concat(el.nodeName.toLowerCase(),' data-init-passage="').concat(passage,'"> contains child elements'));Story.has(passage)&&jQuery(document).one(":uiupdate".concat(".engine"),(function(){var frag=document.createDocumentFragment();new Wikifier(frag,Story.get(passage).processText().trim()),jQuery(el).empty().append(frag)}))})),$dataPassages.each((function(i,el){if("passages"===el.id)throw new Error('"StoryInterface" element <'.concat(el.nodeName.toLowerCase(),' id="passages"> must not contain a "data-passage" content attribute'));var passage=el.getAttribute("data-passage").trim();if(null!==el.firstElementChild)throw new Error('"StoryInterface" element <'.concat(el.nodeName.toLowerCase(),' data-passage="').concat(passage,'"> contains child elements'));Story.has(passage)&&jQuery(document).on(":uiupdate".concat(".engine"),(function(){var frag=document.createDocumentFragment();new Wikifier(frag,Story.get(passage).processText().trim()),jQuery(el).empty().append(frag)}))}))}else $main.append('<div id="passages" aria-live="polite"></div>');$main.insertBefore("body>script#script-sugarcube")}}},runUserScripts:{value:function(){var storyStyle;_state===States.Init&&(storyStyle=document.createElement("style"),new StyleWrapper(storyStyle).add(Story.getStyles().map((function(style){return style.text.trim()})).join("\n")),jQuery(storyStyle).appendTo(document.head).attr({id:"style-story",type:"text/css"}),Story.getScripts().forEach((function(script){try{Scripting.evalJavaScript(script.text)}catch(ex){console.error(ex),Alert.error(script.name,getErrorMessage(ex))}})),Story.getWidgets().forEach((function(widget){try{Wikifier.wikifyEval(widget.processText())}catch(ex){console.error(ex),Alert.error(widget.name,getErrorMessage(ex))}})))}},runUserInit:{value:function(){if(_state===States.Init&&(Story.getInits().forEach((function(passage){try{var debugBuffer=Wikifier.wikifyEval(passage.text);if(Config.debug){var debugView=new DebugView(document.createDocumentFragment(),"special","".concat(passage.name," [init-tagged]"),"".concat(passage.name," [init-tagged]"));debugView.modes({hidden:!0}),debugView.append(debugBuffer),_initDebugViews.push(debugView.output)}}catch(ex){console.error(ex),Alert.error("".concat(passage.name," [init-tagged]"),getErrorMessage(ex))}})),Story.has("StoryInit")))try{var debugBuffer=Wikifier.wikifyEval(Story.get("StoryInit").text);if(Config.debug){var debugView=new DebugView(document.createDocumentFragment(),"special","StoryInit","StoryInit");debugView.modes({hidden:!0}),debugView.append(debugBuffer),_initDebugViews.push(debugView.output)}}catch(ex){console.error(ex),Alert.error("StoryInit",getErrorMessage(ex))}}},start:{value:function(){if(_state===States.Init){if(null==Config.passages.start)throw new Error("starting passage not selected");if(!Story.has(Config.passages.start))throw new Error('starting passage ("'.concat(Config.passages.start,'") not found'));if(_state=States.Idle,document.documentElement.focus(),State.restore())engineShow();else{var autoloadType=_typeof(Config.saves._internal_autoload_);"string"===autoloadType?"prompt"===Config.saves._internal_autoload_&&(UI.buildAutoload(),Dialog.open()):new Promise((function(resolve,reject){if(Save.browser.hasContinue()&&("boolean"===autoloadType&&Config.saves._internal_autoload_||"function"===autoloadType&&Config.saves._internal_autoload_()))return resolve();reject()})).then((function(){return Save.browser.continue()})).catch((function(){enginePlay(Config.passages.start)}))}}}},restart:{value:function(){LoadScreen.show(),window.scroll(0,0),State.reset(),triggerEvent(":enginerestart"),window.location.reload()}},state:{get:function(){return _state}},isIdle:{value:function(){return _state===States.Idle}},isPlaying:{value:function(){return _state!==States.Idle}},isRendering:{value:function(){return _state===States.Rendering}},lastPlay:{get:function(){return _lastPlay}},goTo:{value:function(index){var succeded=State.goTo(index);return succeded&&engineShow(),succeded}},go:{value:engineGo},backward:{value:function(){return engineGo(-1)}},forward:{value:function(){return engineGo(1)}},show:{value:engineShow},play:{value:enginePlay},display:{value:function(title,link,option){console.warn("[DEPRECATED] Engine.display() is deprecated.");var noHistory=!1;switch(option){case undefined:break;case"replace":case"back":noHistory=!0;break;default:throw new Error('Engine.display option parameter called with obsolete value "'.concat(option,'"; please notify the developer'))}enginePlay(title,noHistory)}},minDomActionDelay:{get:function(){return DOM_DELAY}}}))}(),Passage=(tagsToSkip=/^(?:debug|nobr|passage|widget|twine\..*)$/i,encodedRE=/\r/g,hasEncodedRE=new RegExp(encodedRE.source),decodePassageText=function(str){if(null==str)return"";var val=String(str);return val&&hasEncodedRE.test(val)?val.replace(encodedRE,""):val},function(){return _createClass((function Passage(name,el){var _this19=this;_classCallCheck(this,Passage),Object.defineProperties(this,{name:{value:decodeEntities(name)},element:{value:el||null},tags:{value:Object.freeze(el&&el.hasAttribute("tags")?Array.from(new Set(el.getAttribute("tags").trim().splitOrEmpty(/\s+/))):[])}}),Object.defineProperties(this,{id:{value:"passage-".concat(createSlug(this.name))},classes:{value:Object.freeze(0===this.tags.length?[]:_this19.tags.filter((function(tag){return!tagsToSkip.test(tag)})).map((function(tag){return createSlug(tag)})))},domId:{get:function(){return this.id}},title:{get:function(){return this.name}}})}),[{key:"className",get:function(){return this.classes.join(" ")}},{key:"text",get:function(){if(null==this.element){var passage=encodeMarkup(this.name),mesg="".concat(L10n.get("errorViewTitle"),": ").concat(L10n.get("errorNonexistentPassage",{passage:passage}));return'<div class="error-view"><span class="error">'.concat(mesg,"</span></div>")}return decodePassageText(this.element.textContent)}},{key:"processText",value:function(){if(null==this.element)return this.text;if(this.tags.includes("Twine.image"))return"[img[".concat(this.text,"]]");var processed=this.text;return Config.passages.onProcess&&(processed=Config.passages.onProcess.call(null,{title:this.name,tags:this.tags,text:processed})),(Config.passages.nobr||this.tags.includes("nobr"))&&(processed=processed.replace(/^\n+|\n+$/g,"").replace(/\n+/g," ")),processed}},{key:"render",value:function(options){var frag=document.createDocumentFragment();return new Wikifier(frag,this.processText(),options),frag}},{key:"description",value:function(){return"".concat(L10n.get("textTurn")," ").concat(State.turns)}}])}()),encodedRE,hasEncodedRE,tagsToSkip,decodePassageText,Save=function(){var Type=enumFrom({Unknown:0,Auto:1,Slot:2,Disk:3,Base64:4,Autosave:1,Serialize:4}),MAX_INDEX=15,INDEX_DELIMITER=":",AUTO_SUBKEY="".concat("save.","auto."),AUTO_DATA_SUBKEY="".concat(AUTO_SUBKEY,"data").concat(INDEX_DELIMITER),AUTO_INFO_SUBKEY="".concat(AUTO_SUBKEY,"info").concat(INDEX_DELIMITER),SLOT_SUBKEY="".concat("save.","slot."),SLOT_DATA_SUBKEY="".concat(SLOT_SUBKEY,"data").concat(INDEX_DELIMITER),SLOT_INFO_SUBKEY="".concat(SLOT_SUBKEY,"info").concat(INDEX_DELIMITER),onLoadHandlers=new Set,onSaveHandlers=new Set;function createDetails(saveType,description,metadata){var metadataType=_typeof(metadata);if("object"!==metadataType&&"undefined"!==metadataType)throw new TypeError("metadata parameter must be an object or null/undefined");var cfgMetadata=Config.saves.metadata?Config.saves.metadata(saveType):undefined,cfgMetadataType=_typeof(cfgMetadata);if("object"!==cfgMetadataType&&"undefined"!==cfgMetadataType)throw new TypeError("Config.saves.metadata function must return an object or null/undefined");var desc,details={type:saveType};null!=description&&(desc=String(description).trim()),desc||"function"!=typeof Config.saves.descriptions||(desc=String(Config.saves.descriptions(saveType)).trim()),details.desc=desc||"".concat(L10n.get("textTurn")," ").concat(State.turns);var fullMetadata=Object.assign({},cfgMetadata,metadata);return Object.keys(fullMetadata).length>0&&(details.metadata=fullMetadata),details}function findNewest(saveType){var keys;switch(saveType){case Type.Auto:keys=getKeys(isAutoInfoKey);break;case Type.Slot:keys=getKeys(isSlotInfoKey);break;default:keys=getKeys(isInfoKey)}switch(keys.length){case 0:return{index:-1};case 1:return{index:getIndexFromKey(keys[0]),type:getTypeFromKey(keys[0])}}return keys.map((function(key){return{value:{index:getIndexFromKey(key),type:getTypeFromKey(key)},date:storage.get(key).date}})).sort((function(a,b){return b.date-a.date})).first().value}function getIndexFromKey(key){var pos=key.lastIndexOf(INDEX_DELIMITER);if(-1===pos)throw new Error("unable to get index from save key (received: ".concat(key,")"));return Number(key.slice(pos+1))}function getAutoInfoKeyFromIndex(index){return"".concat(AUTO_INFO_SUBKEY).concat(index)}function getAutoDataKeyFromIndex(index){return"".concat(AUTO_DATA_SUBKEY).concat(index)}function getSlotInfoKeyFromIndex(index){return"".concat(SLOT_INFO_SUBKEY).concat(index)}function getSlotDataKeyFromIndex(index){return"".concat(SLOT_DATA_SUBKEY).concat(index)}function getKeys(predicate){return storage.keys().filter(predicate)}function getTypeFromKey(key){return isAutoKey(key)?Type.Auto:Type.Slot}function isInfoKey(key){return key.startsWith(AUTO_INFO_SUBKEY)||key.startsWith(SLOT_INFO_SUBKEY)}function isAutoKey(key){return key.startsWith(AUTO_SUBKEY)}function isAutoInfoKey(key){return key.startsWith(AUTO_INFO_SUBKEY)}function isSlotKey(key){return key.startsWith(SLOT_SUBKEY)}function isSlotInfoKey(key){return key.startsWith(SLOT_INFO_SUBKEY)}function saveToBrowserStorage(saveData){var data=saveData.data,dataKey=saveData.dataKey,info=saveData.info,infoKey=saveData.infoKey;try{storage.set(dataKey,data)&&(storage.set(infoKey,info)||storage.delete(dataKey))}catch(ex){throw storage.delete(dataKey),storage.delete(infoKey),ex}}function saveBlobToDiskAs(data,filename,extension){if("string"!=typeof filename)throw new Error("filename parameter must be a string");var baseName=createFilename(filename);if(""===baseName)throw new Error("filename parameter must not consist solely of illegal characters");var datestamp=function(date){if(!(date instanceof Date))throw new TypeError("createDatestamp date parameter must be a Date object");var MM=date.getMonth()+1,DD=date.getDate(),hh=date.getHours(),mm=date.getMinutes(),ss=date.getSeconds();return MM<10&&(MM="0".concat(MM)),DD<10&&(DD="0".concat(DD)),hh<10&&(hh="0".concat(hh)),mm<10&&(mm="0".concat(mm)),ss<10&&(ss="0".concat(ss)),"".concat(date.getFullYear()).concat(MM).concat(DD,"-").concat(hh).concat(mm).concat(ss)}(new Date),fileExt=createFilename(extension)||"save";saveAs(new Blob([data],{type:"text/plain;charset=UTF-8"}),"".concat(baseName,"-").concat(datestamp,".").concat(fileExt))}function browserClear(){return autoClear(),slotClear(),!0}function browserIsEnabled(){return autoIsEnabled()||slotIsEnabled()}function autoClear(){return getKeys(isAutoKey).forEach((function(key){return storage.delete(key)})),!0}function autoDelete(index){if(!Number.isInteger(index))throw new TypeError("auto save index must be an integer");if(index<0||index>MAX_INDEX)throw new RangeError("auto save index out of bounds (range: 0–".concat(MAX_INDEX,"; received: ").concat(index,")"));return storage.delete(getAutoInfoKeyFromIndex(index)),storage.delete(getAutoDataKeyFromIndex(index)),!0}function autoGet(index){if(!Number.isInteger(index))throw new TypeError("auto save index must be an integer");if(index<0||index>MAX_INDEX)throw new RangeError("auto save index out of bounds (range: 0–".concat(MAX_INDEX,"; received: ").concat(index,")"));return storage.get(getAutoInfoKeyFromIndex(index))}function autoHas(index){if(!Number.isInteger(index))throw new TypeError("auto save index must be an integer");if(index<0||index>MAX_INDEX)throw new RangeError("auto save index out of bounds (range: 0–".concat(MAX_INDEX,"; received: ").concat(index,")"));return storage.has(getAutoInfoKeyFromIndex(index))}function autoIsEnabled(){return"cookie"!==storage.name&&Config.saves.maxAutoSaves>0}function autoLoad(index){return new Promise((function(resolve){if(!Number.isInteger(index))throw new TypeError("auto save index must be an integer");if(index<0||index>MAX_INDEX)throw new RangeError("auto save index out of bounds (range: 0–".concat(MAX_INDEX,"; received: ").concat(index,")"));var info=storage.get(getAutoInfoKeyFromIndex(index)),data=storage.get(getAutoDataKeyFromIndex(index));if(!info||!data)throw new Error(L10n.get("saveErrorNonexistent"));unmarshal(Object.assign(info,data)),resolve(!0)}))}function autoSave(desc,metadata){if(!autoIsEnabled()||"function"==typeof Config.saves.isAllowed&&!Config.saves.isAllowed(Type.Auto))return!1;var index=(findNewest(Type.Auto).index+1)%Config.saves.maxAutoSaves,infoKey=getAutoInfoKeyFromIndex(index),dataKey=getAutoDataKeyFromIndex(index),_splitSave3=splitSave(marshal(createDetails(Type.Auto,desc,metadata))),info=_splitSave3.info;saveToBrowserStorage({data:_splitSave3.data,dataKey:dataKey,info:info,infoKey:infoKey})}function slotClear(){return getKeys(isSlotKey).forEach((function(key){return storage.delete(key)})),!0}function slotDelete(index){if(!Number.isInteger(index))throw new TypeError("slot save index must be an integer");if(index<0||index>MAX_INDEX)throw new RangeError("slot save index out of bounds (range: 0–".concat(MAX_INDEX,"; received: ").concat(index,")"));return storage.delete(getSlotInfoKeyFromIndex(index)),storage.delete(getSlotDataKeyFromIndex(index)),!0}function slotGet(index){if(!Number.isInteger(index))throw new TypeError("slot save index must be an integer");if(index<0||index>MAX_INDEX)throw new RangeError("slot save index out of bounds (range: 0–".concat(MAX_INDEX,"; received: ").concat(index,")"));return storage.get(getSlotInfoKeyFromIndex(index))}function slotHas(index){if(!Number.isInteger(index))throw new TypeError("slot save index must be an integer");if(index<0||index>MAX_INDEX)throw new RangeError("slot save index out of bounds (range: 0–".concat(MAX_INDEX,"; received: ").concat(index,")"));return storage.has(getSlotInfoKeyFromIndex(index))}function slotIsEnabled(){return"cookie"!==storage.name&&Config.saves.maxSlotSaves>0}function slotLoad(index){return new Promise((function(resolve){if(!Number.isInteger(index))throw new TypeError("slot save index must be an integer");if(index<0||index>MAX_INDEX)throw new RangeError("slot save index out of bounds (range: 0–".concat(MAX_INDEX,"; received: ").concat(index,")"));var info=storage.get(getSlotInfoKeyFromIndex(index)),data=storage.get(getSlotDataKeyFromIndex(index));if(!info||!data)throw new Error(L10n.get("saveErrorNonexistent"));unmarshal(Object.assign(info,data)),resolve(!0)}))}function slotSave(index,desc,metadata){if(!Number.isInteger(index))throw new TypeError("slot save index must be an integer");if(index<0||index>=Config.saves.maxSlotSaves)throw new RangeError("slot save index out of bounds (range: 0–".concat(Config.saves.maxSlotSaves-1,"; received: ").concat(index,")"));if(!slotIsEnabled()||"function"==typeof Config.saves.isAllowed&&!Config.saves.isAllowed(Type.Slot))throw new Error(L10n.get("saveErrorDisallowed"));var infoKey=getSlotInfoKeyFromIndex(index),dataKey=getSlotDataKeyFromIndex(index),_splitSave4=splitSave(marshal(createDetails(Type.Slot,desc,metadata))),info=_splitSave4.info;saveToBrowserStorage({data:_splitSave4.data,dataKey:dataKey,info:info,infoKey:infoKey})}function slotSize(){return getKeys(isSlotInfoKey).length}function diskLoad(event){return new Promise((function(resolve,reject){var reader=new FileReader;jQuery(reader).on("loadend",(function(){try{if(reader.error)throw new Error("".concat(L10n.get("saveErrorDiskLoadFail"),": ").concat(reader.error));var save;try{save=Serial.parse(LZString.decompressFromBase64(reader.result))}catch(ex){throw new Error(L10n.get("saveErrorDecodeFail"))}unmarshal(save),resolve(save.metadata)}catch(ex){reject(ex)}})),reader.readAsText(event.target.files[0])}))}function diskSave(filename,metadata){if(null==filename)throw new Error("Save.disk.save filename parameter is required");if("function"==typeof Config.saves.isAllowed&&!Config.saves.isAllowed(Type.Disk))throw new Error(L10n.get("saveErrorDisallowed"));var details=createDetails(Type.Disk,filename,metadata);saveBlobToDiskAs(LZString.compressToBase64(Serial.stringify(marshal(details))),filename,"save")}function base64Load(base64){return new Promise((function(resolve){var save;try{save=Serial.parse(LZString.decompressFromBase64(base64))}catch(ex){throw new Error(L10n.get("saveErrorDecodeFail"))}unmarshal(save),resolve(save.metadata)}))}function base64Save(metadata){if("function"==typeof Config.saves.isAllowed&&!Config.saves.isAllowed(Type.Base64))throw new Error(L10n.get("saveErrorDisallowed"));var details=createDetails(Type.Base64,null,metadata);return LZString.compressToBase64(Serial.stringify(marshal(details)))}function marshal(details){var save=Object.assign({},details,{date:Date.now(),id:Config.saves.id,state:State.marshalForSave()});return null!=Config.saves.version&&(save.version=Config.saves.version),onSaveHandlers.forEach((function(fn){return fn(save,function(save){switch(save.type){case Type.Auto:return{type:"autosave"};case Type.Slot:return{type:"slot"};case Type.Disk:return{type:"disk"};case Type.Base64:return{type:"serialize"}}throw new Error("save.type must be an integer (received: ".concat(_typeof(save.type),")"))}(save))})),save.state.delta=State.deltaEncode(save.state.history),delete save.state.history,save}function splitSave(save){var state=save.state;return{info:_objectWithoutProperties(save,_excluded3),data:{state:state}}}function unmarshal(save){if(null==save||"object"!==_typeof(save)||!Object.hasOwn(save,"id")||!Object.hasOwn(save,"state")||"object"!==_typeof(save.state)||!Object.hasOwn(save.state,"delta"))throw new Error(L10n.get("saveErrorInvalidData"));if(save.id!==Config.saves.id)throw new Error(L10n.get("saveErrorIdMismatch"));if(save.state.history=State.deltaDecode(save.state.delta),delete save.state.delta,"string"==typeof save.type){switch(save.type){case"auto":case"autosave":save.type=Type.Auto;break;case"slot":save.type=Type.Slot;break;case"disk":save.type=Type.Disk;break;case"base64":case"serialize":save.type=Type.Base64}if("number"!=typeof save.type)throw new Error("save.type is unknown")}onLoadHandlers.forEach((function(fn){return fn(save)})),State.unmarshalForSave(save.state)}return Object.preventExtensions(Object.create(null,{Type:{value:Type},MAX_INDEX:{get:function(){return MAX_INDEX}},init:{value:function(){return function(){var oldSaves=storage.get("saves");if(null===oldSaves)return;if(autoClear(),slotClear(),oldSaves.autosave){var _splitSave=splitSave(oldSaves.autosave),info=_splitSave.info,data=_splitSave.data;info.desc=info.title,delete info.title,info.type=Type.Auto;var infoKey=getAutoInfoKeyFromIndex(0),dataKey=getAutoDataKeyFromIndex(0);storage.set(dataKey,data)&&(storage.set(infoKey,info)||storage.delete(dataKey))}oldSaves.slots.forEach((function(save,index){if(save){var _splitSave2=splitSave(save),info=_splitSave2.info,data=_splitSave2.data;info.desc=info.title,delete info.title,info.type=Type.Slot;var infoKey=getSlotInfoKeyFromIndex(index),dataKey=getSlotDataKeyFromIndex(index);storage.set(dataKey,data)&&(storage.set(infoKey,info)||storage.delete(dataKey))}})),storage.delete("saves")}(),!0}},browser:{value:Object.preventExtensions(Object.create(null,{auto:{value:Object.preventExtensions(Object.create(null,{clear:{value:autoClear},delete:{value:autoDelete},entries:{value:function(){return getKeys(isAutoInfoKey).map((function(key){return{index:getIndexFromKey(key),info:storage.get(key)}})).sort((function(a,b){return b.info.date-a.info.date}))}},get:{value:autoGet},has:{value:autoHas},isEnabled:{value:autoIsEnabled},load:{value:autoLoad},save:{value:autoSave},size:{get:function(){return getKeys(isAutoInfoKey).length}}}))},slot:{value:Object.preventExtensions(Object.create(null,{clear:{value:slotClear},delete:{value:slotDelete},entries:{value:function(){return getKeys(isSlotInfoKey).map((function(key){return{index:getIndexFromKey(key),info:storage.get(key)}})).sort((function(a,b){return a.index-b.index}))}},get:{value:slotGet},has:{value:slotHas},isEnabled:{value:slotIsEnabled},load:{value:slotLoad},save:{value:slotSave},size:{get:slotSize}}))},clear:{value:browserClear},continue:{value:function(){var newest=findNewest();return-1===newest.index?Promise.reject(new Error(L10n.get("saveErrorNonexistent"))):newest.type===Type.Auto?autoLoad(newest.index):slotLoad(newest.index)}},isEnabled:{value:browserIsEnabled},size:{get:function(){return getKeys(isInfoKey).length}}}))},disk:{value:Object.preventExtensions(Object.create(null,{export:{value:function(filename){if(null==filename)throw new Error("Save.browser.export filename parameter is required");var auto=getKeys(isAutoInfoKey).map((function(infoKey){var index=getIndexFromKey(infoKey),info=storage.get(infoKey),data=storage.get(getAutoDataKeyFromIndex(index));if(!info||!data)throw new Error("during saves export auto save info or data nonexistent");return{index:index,info:info,data:data}})),slot=getKeys(isSlotInfoKey).map((function(infoKey){var index=getIndexFromKey(infoKey),info=storage.get(infoKey),data=storage.get(getSlotDataKeyFromIndex(index));if(!info||!data)throw new Error("during saves export slot save info or data nonexistent");return{index:index,info:info,data:data}}));saveBlobToDiskAs(LZString.compressToBase64(Serial.stringify({auto:auto,slot:slot})),filename,"savesbundle")}},import:{value:function(event){return new Promise((function(resolve,reject){var reader=new FileReader;jQuery(reader).on("loadend",(function(){try{if(reader.error)throw new Error("".concat(L10n.get("saveErrorDiskLoadFail"),": ").concat(reader.error));var bundle,badSave=function(O){return!Object.hasOwn(O,"index")||!Object.hasOwn(O,"info")||!Object.hasOwn(O,"data")};try{bundle=Serial.parse(LZString.decompressFromBase64(reader.result))}catch(ex){throw new Error(L10n.get("saveErrorDecodeFail"))}if(null==bundle||"object"!==_typeof(bundle)||!Object.hasOwn(bundle,"auto")||!(bundle.auto instanceof Array)||bundle.auto.some(badSave)||!Object.hasOwn(bundle,"slot")||!(bundle.slot instanceof Array)||bundle.slot.some(badSave))throw new Error(L10n.get("saveErrorInvalidData"));autoClear(),slotClear(),bundle.auto.forEach((function(save){return saveToBrowserStorage({data:save.data,dataKey:getAutoDataKeyFromIndex(save.index),info:save.info,infoKey:getAutoInfoKeyFromIndex(save.index)})})),bundle.slot.forEach((function(save){return saveToBrowserStorage({data:save.data,dataKey:getSlotDataKeyFromIndex(save.index),info:save.info,infoKey:getSlotInfoKeyFromIndex(save.index)})})),resolve(!0)}catch(ex){reject(ex)}})),reader.readAsText(event.target.files[0])}))}},load:{value:diskLoad},save:{value:diskSave}}))},base64:{value:Object.preventExtensions(Object.create(null,{export:{value:function(){var auto=getKeys(isAutoInfoKey).map((function(infoKey){var index=getIndexFromKey(infoKey),info=storage.get(infoKey),data=storage.get(getAutoDataKeyFromIndex(index));if(!info||!data)throw new Error("during saves export auto save info or data nonexistent");return{index:index,info:info,data:data}})),slot=getKeys(isSlotInfoKey).map((function(infoKey){var index=getIndexFromKey(infoKey),info=storage.get(infoKey),data=storage.get(getSlotDataKeyFromIndex(index));if(!info||!data)throw new Error("during saves export slot save info or data nonexistent");return{index:index,info:info,data:data}}));return LZString.compressToBase64(Serial.stringify({auto:auto,slot:slot}))}},import:{value:function(base64){return new Promise((function(resolve){var bundle,badSave=function(O){return!Object.hasOwn(O,"index")||!Object.hasOwn(O,"info")||!Object.hasOwn(O,"data")};try{bundle=Serial.parse(LZString.decompressFromBase64(base64))}catch(ex){throw new Error(L10n.get("saveErrorDecodeFail"))}if(null==bundle||"object"!==_typeof(bundle)||!Object.hasOwn(bundle,"auto")||!(bundle.auto instanceof Array)||bundle.auto.some(badSave)||!Object.hasOwn(bundle,"slot")||!(bundle.slot instanceof Array)||bundle.slot.some(badSave))throw new Error(L10n.get("saveErrorInvalidData"));autoClear(),slotClear(),bundle.auto.forEach((function(save){return saveToBrowserStorage({data:save.data,dataKey:getAutoDataKeyFromIndex(save.index),info:save.info,infoKey:getAutoInfoKeyFromIndex(save.index)})})),bundle.slot.forEach((function(save){return saveToBrowserStorage({data:save.data,dataKey:getSlotDataKeyFromIndex(save.index),info:save.info,infoKey:getSlotInfoKeyFromIndex(save.index)})})),resolve(!0)}))}},load:{value:base64Load},save:{value:base64Save}}))},onLoad:{value:Object.preventExtensions(Object.create(null,{add:{value:function(handler){var valueType=getTypeOf(handler);if("function"!==valueType)throw new TypeError("Save.onLoad.add handler parameter must be a function (received: ".concat(valueType,")"));onLoadHandlers.add(handler)}},clear:{value:function(){onLoadHandlers.clear()}},delete:{value:function(handler){return onLoadHandlers.delete(handler)}},size:{get:function(){return onLoadHandlers.size}}}))},onSave:{value:Object.preventExtensions(Object.create(null,{add:{value:function(handler){var valueType=getTypeOf(handler);if("function"!==valueType)throw new TypeError("Save.onSave.add handler parameter must be a function (received: ".concat(valueType,")"));onSaveHandlers.add(handler)}},clear:{value:function(){onSaveHandlers.clear()}},delete:{value:function(handler){return onSaveHandlers.delete(handler)}},size:{get:function(){return onSaveHandlers.size}}}))},get:{value:function(){throw new Error("[REMOVED] Save.get() has been removed.")}},clear:{value:function(){return console.warn("[DEPRECATED] Save.clear() is deprecated."),browserClear()}},ok:{value:function(){return console.warn("[DEPRECATED] Save.ok() is deprecated."),browserIsEnabled()}},autosave:{value:Object.preventExtensions(Object.create(null,{ok:{value:function(){return console.warn("[DEPRECATED] Save.autosave.ok() is deprecated."),autoIsEnabled()}},has:{value:function(){return console.warn("[DEPRECATED] Save.autosave.has() is deprecated."),autoHas(0)}},get:{value:function(){return console.warn("[DEPRECATED] Save.autosave.get() is deprecated."),autoGet(0)}},load:{value:function(){return console.warn("[DEPRECATED] Save.autosave.load() is deprecated."),autoLoad(0)}},save:{value:function(){return console.warn("[DEPRECATED] Save.autosave.save() is deprecated."),autoSave.apply(void 0,arguments)}},delete:{value:function(){return console.warn("[DEPRECATED] Save.autosave.delete() is deprecated."),autoDelete(0)}}}))},slots:{value:Object.preventExtensions(Object.create(null,{ok:{value:function(){return console.warn("[DEPRECATED] Save.slots.ok() is deprecated."),slotIsEnabled()}},length:{get:function(){return console.warn("[DEPRECATED] Save.slots.length is deprecated."),Config.saves.maxSlotSaves}},isEmpty:{value:function(){return console.warn("[DEPRECATED] Save.slots.isEmpty() is deprecated."),0===slotSize()}},count:{value:function(){return console.warn("[DEPRECATED] Save.slots.count() is deprecated."),slotSize()}},has:{value:function(){return console.warn("[DEPRECATED] Save.slots.has() is deprecated."),slotHas.apply(void 0,arguments)}},get:{value:function(){return console.warn("[DEPRECATED] Save.slots.get() is deprecated."),slotGet.apply(void 0,arguments)}},load:{value:function(){return console.warn("[DEPRECATED] Save.slots.load() is deprecated."),slotLoad.apply(void 0,arguments)}},save:{value:function(){return console.warn("[DEPRECATED] Save.slots.save() is deprecated."),slotSave.apply(void 0,arguments)}},delete:{value:function(){return console.warn("[DEPRECATED] Save.slots.delete() is deprecated."),slotDelete.apply(void 0,arguments)}}}))},export:{value:function(){return console.warn("[DEPRECATED] Save.export() is deprecated."),diskSave.apply(void 0,arguments)}},import:{value:function(){return console.warn("[DEPRECATED] Save.import() is deprecated."),diskLoad.apply(void 0,arguments)}},serialize:{value:function(){return console.warn("[DEPRECATED] Save.serialize() is deprecated."),base64Save.apply(void 0,arguments)}},deserialize:{value:function(){return console.warn("[DEPRECATED] Save.deserialize() is deprecated."),base64Load.apply(void 0,arguments)}}}))}(),Setting=function(){var Types=enumFrom({Header:0,Toggle:1,List:2,Range:3,Value:4}),_definitions=[];function updateSettingsObject(value){window.SugarCube.settings=settings=value}function createResultObject(def){var result={name:def.name,value:settings[def.name],default:def.default};return Object.hasOwn(def,"list")&&(result.list=def.list),Object.hasOwn(def,"min")&&(result.min=def.min),Object.hasOwn(def,"max")&&(result.max=def.max),Object.hasOwn(def,"step")&&(result.step=def.step),result}function clear(){return updateSettingsObject(create()),storage.delete("settings"),!0}function create(){return Object.create(null)}function load(){var defaultSettings=create(),loadedSettings=storage.get("settings")||create();_definitions.filter((function(def){return def.type!==Types.Header})).forEach((function(def){return defaultSettings[def.name]=def.default})),updateSettingsObject(Object.assign(defaultSettings,loadedSettings))}function save(){var savedSettings=create();return Object.keys(settings).length>0&&_definitions.filter((function(def){return def.type!==Types.Header&&settings[def.name]!==def.default})).forEach((function(def){return savedSettings[def.name]=settings[def.name]})),0===Object.keys(savedSettings).length?(storage.delete("settings"),!0):storage.set("settings",savedSettings)}function add(type,name,def){if(arguments.length<2){var errors=[];throw arguments.length<1&&errors.push("type"),arguments.length<2&&errors.push("name"),new Error("missing parameters, no ".concat(errors.join(" or ")," specified"))}if(null==def)def={};else if("object"!==_typeof(def))throw new TypeError("definition parameter must be an object");if(has(name))throw new Error('cannot clobber existing setting "'.concat(name,'"'));var str,pos,definition={type:type,name:name};if(type!==Types.Value&&(definition.label="string"==typeof def.label?def.label.trim():""),"string"==typeof def.desc){var desc=def.desc.trim();""!==desc&&(definition.desc=desc)}switch(type){case Types.Header:break;case Types.List:if(!Object.hasOwn(def,"list"))throw new Error("no list specified");if(!Array.isArray(def.list))throw new TypeError("list must be an array");if(0===def.list.length)throw new Error("list must not be empty");if(definition.list=Object.freeze(def.list),null==def.default)definition.default=def.list[0];else{var defaultIndex=def.list.indexOf(def.default);if(-1===defaultIndex)throw new Error("list does not contain default");definition.default=def.list[defaultIndex]}break;case Types.Range:if(!Object.hasOwn(def,"min"))throw new Error("no min specified");if("number"!=typeof def.min||Number.isNaN(def.min)||!Number.isFinite(def.min))throw new TypeError("min must be a finite number");if(!Object.hasOwn(def,"max"))throw new Error("no max specified");if("number"!=typeof def.max||Number.isNaN(def.max)||!Number.isFinite(def.max))throw new TypeError("max must be a finite number");if(!Object.hasOwn(def,"step"))throw new Error("no step specified");if("number"!=typeof def.step||Number.isNaN(def.step)||!Number.isFinite(def.step)||def.step<=0)throw new TypeError("step must be a finite number greater than zero");var fracDigits=(str=String(def.step),-1===(pos=str.lastIndexOf("."))?0:str.length-pos-1);if(function(value){if(fracDigits>0){var ma=Number("".concat(def.min,"e").concat(fracDigits)),sa=Number("".concat(def.step,"e").concat(fracDigits)),_va=Number("".concat(value,"e").concat(fracDigits))-ma;return Number("".concat(_va-_va%sa+ma,"e-").concat(fracDigits))}var va=value-def.min;return va-va%def.step+def.min}(def.max)!==def.max)throw new RangeError("max (".concat(def.max,") is not a multiple of the step (").concat(def.step,") plus the min (").concat(def.min,")"));if(definition.max=def.max,definition.min=def.min,definition.step=def.step,null==def.default)definition.default=def.max;else{if("number"!=typeof def.default||Number.isNaN(def.default)||!Number.isFinite(def.default))throw new TypeError("default must be a finite number");if(def.default<def.min)throw new RangeError("default (".concat(def.default,") is less than min (").concat(def.min,")"));if(def.default>def.max)throw new RangeError("default (".concat(def.default,") is greater than max (").concat(def.max,")"));definition.default=def.default}break;case Types.Toggle:definition.default=Boolean(def.default);break;case Types.Value:definition.default=def.default;break;default:throw new Error("unknown Setting type: ".concat(type))}"function"==typeof def.onInit&&(definition.onInit=Object.freeze(def.onInit)),"function"==typeof def.onChange&&(definition.onChange=Object.freeze(def.onChange)),_definitions.push(Object.freeze(definition))}function get(name){return _definitions.find((function(definition){return definition.name===name}))}function has(name){return _definitions.some((function(definition){return definition.name===name}))}return Object.preventExtensions(Object.create(null,{Types:{value:Types},init:{value:function(){load(),_definitions.forEach((function(def){if(Object.hasOwn(def,"onInit")){var data=createResultObject(def);def.onInit.call(data,data)}}))}},clear:{value:clear},create:{value:create},load:{value:load},reset:{value:function(name){if(0===arguments.length)clear(),load();else{if(null==name||!has(name))throw new Error('nonexistent setting "'.concat(name,'"'));var def=get(name);def.type!==Types.Header&&(settings[name]=def.default)}return save()}},save:{value:save},add:{value:add},addHeader:{value:function(name,desc){add(Types.Header,name,{desc:desc})}},addList:{value:function(){for(var _len20=arguments.length,args=new Array(_len20),_key20=0;_key20<_len20;_key20++)args[_key20]=arguments[_key20];add.apply(void 0,[Types.List].concat(args))}},addRange:{value:function(){for(var _len21=arguments.length,args=new Array(_len21),_key21=0;_key21<_len21;_key21++)args[_key21]=arguments[_key21];add.apply(void 0,[Types.Range].concat(args))}},addToggle:{value:function(){for(var _len22=arguments.length,args=new Array(_len22),_key22=0;_key22<_len22;_key22++)args[_key22]=arguments[_key22];add.apply(void 0,[Types.Toggle].concat(args))}},addValue:{value:function(){for(var _len23=arguments.length,args=new Array(_len23),_key23=0;_key23<_len23;_key23++)args[_key23]=arguments[_key23];add.apply(void 0,[Types.Value].concat(args))}},delete:{value:function(name){for(var i=0;i<_definitions.length;++i)if(_definitions[i].name===name){_definitions.splice(i,1);break}Object.hasOwn(settings,name)&&delete settings[name]}},forEach:{value:function(callback,thisArg){_definitions.forEach(callback,thisArg)}},get:{value:get},has:{value:has},isEmpty:{value:function(){return 0===_definitions.length}},getValue:{value:function(name){return settings[name]}},setValue:{value:function(name,value){if(!has(name))throw new Error("no such setting");settings[name]=value,save();var def=get(name);if(Object.hasOwn(def,"onChange")){var data=createResultObject(def);def.onChange.call(data,data)}return!0}}}))}(),Story=function(){var _ifId="",_id="",_name="",_passages=createPassageStore(),_inits=[],_scripts=[],_styles=[],_widgets=[],codePassageNames=["PassageDone","PassageFooter","PassageHeader","PassageReady","StoryAuthor","StoryBanner","StoryCaption","StoryDisplayTitle","StoryInit","StoryInterface","StoryMenu","StoryShare","StorySubtitle"],codeTagNames=["init","widget"];function createPassageStore(passages){var store=Object.create(null);return passages?Object.assign(store,passages):store}function generateName(rawName){if(null==rawName)throw new Error("story name must not be null or undefined");var name=decodeEntities(String(rawName)).trim();if(""===name)throw new Error("story name must not be empty or consist solely of whitespace");return name}function getId(){return _id}function getName(){return _name}function filter(predicate,thisArg){if("function"!=typeof predicate)throw new TypeError("Story.filter() predicate parameter must be a function");for(var results=[],i=0,keys=Object.keys(_passages);i<keys.length;++i){var passage=_passages[keys[i]];predicate.call(void 0===thisArg?this:thisArg,passage)&&results.push(passage)}return results}return Object.preventExtensions(Object.create(null,{init:{value:function(){function assertNoCodeTags(passage,desc){if(passage.tags.includesAny(codeTagNames))throw new Error("".concat(desc,' passage "').concat(passage.name,'" includes code tags; invalid: "').concat(passage.tags.filter((function(tag){return codeTagNames.includes(tag)})).sort().join('", "'),'"'))}function assertValidCodeTagUsage(passage){var found=passage.tags.filter((function(tag){return codeTagNames.includes(tag)})).sort();if(found.length>1)throw new Error('passage "'.concat(passage.name,'" includes multiple code tags; invalid: "').concat(found.join('", "'),'"'))}var $storydata=jQuery("tw-storydata"),startNode=$storydata.attr("startnode")||"";Config.passages.start=null,Config.debug=/\bdebug\b/.test($storydata.attr("options")),$storydata.children("style").each((function(i){_styles.push(new Passage("tw-user-style-".concat(i),this))})),$storydata.children("script").each((function(i){_scripts.push(new Passage("tw-user-script-".concat(i),this))})),$storydata.children('tw-passagedata:not([tags~="Twine.private"],[tags~="annotation"])').each((function(){var $this=jQuery(this),pid=$this.attr("pid")||"",passage=new Passage($this.attr("name"),this);pid===startNode&&""!==startNode?(Config.passages.start=passage.name,assertNoCodeTags(passage,"starting"),_passages[passage.name]=passage):codePassageNames.includes(passage.name)?(assertNoCodeTags(passage,"code"),_passages[passage.name]=passage):passage.tags.includes("init")?(assertValidCodeTagUsage(passage),_inits.push(passage)):passage.tags.includes("widget")?(assertValidCodeTagUsage(passage),_widgets.push(passage)):_passages[passage.name]=passage})),_ifId=$storydata.attr("ifid"),_name=generateName("NEVERLAND"),_id=function(name){var id=createSlug(name);if(""===id)if(""!==_ifId)id=_ifId;else for(var i=0;i<name.length;++i){var _charAndPosAt2=charAndPosAt(name,i),char=_charAndPosAt2.char,start=_charAndPosAt2.start,end=_charAndPosAt2.end;id+=char.codePointAt(0).toString(16),i+=end-start}return id}(_name),Config.saves.id=_id,document.title=_name}},id:{get:getId},ifId:{get:function(){return _ifId}},name:{get:getName},add:{value:function(descriptor){if("Object"!==getTypeOf(descriptor))throw new TypeError("Story.add() descriptor parameter must be a generic object");if(Object.hasOwn(_passages,descriptor.name))return!1;var elem=document.createElement("div");elem.setAttribute("name",descriptor.name),elem.setAttribute("tags",descriptor.tags),elem.textContent=descriptor.text;var passage=new Passage(descriptor.name,elem);if(codePassageNames.includes(passage.name))throw new Error('Story.add() passage descriptor object "'.concat(passage.name,'" must not be a code passage'));if(passage.tags.includesAny(codeTagNames))throw new Error('Story.add() passage descriptor object "'.concat(passage.name,'" must not include code tags'));return _passages[passage.name]=passage,!0}},delete:{value:function(name){var type=_typeof(name);switch(type){case"number":case"string":var key=String(name);if(!Object.hasOwn(_passages,key))return!1;if(key===Config.passages.start||codePassageNames.includes(key))throw new Error('Story.delete() passage "'.concat(key,'" must not be a code passage'));if(_passages[key].tags.includesAny(codeTagNames))throw new Error('Story.delete() passage "'.concat(key,'" must not include code tags'));return delete _passages[key],!0;case"undefined":break;case"object":type=null===name?"null":"an object";break;default:type="a ".concat(type)}throw new TypeError("Story.delete() name parameter cannot be ".concat(type))}},filter:{value:filter},find:{value:function(predicate,thisArg){if("function"!=typeof predicate)throw new TypeError("Story.find() predicate parameter must be a function");for(var i=0,keys=Object.keys(_passages);i<keys.length;++i){var passage=_passages[keys[i]];if(predicate.call(void 0===thisArg?this:thisArg,passage))return passage}}},get:{value:function(name){var type=_typeof(name);switch(type){case"number":case"string":var key=String(name);return Object.hasOwn(_passages,key)?_passages[key]:new Passage(key||"(unknown)");case"undefined":break;case"object":type=null===name?"null":"an object";break;default:type="a ".concat(type)}throw new TypeError("Story.get() name parameter cannot be ".concat(type))}},getInits:{value:function(){return Object.freeze(Array.from(_inits))}},getNormals:{value:function(){return Object.freeze(createPassageStore(_passages))}},getScripts:{value:function(){return Object.freeze(Array.from(_scripts))}},getStyles:{value:function(){return Object.freeze(Array.from(_styles))}},getWidgets:{value:function(){return Object.freeze(Array.from(_widgets))}},has:{value:function(name){var type=_typeof(name);switch(type){case"number":case"string":return Object.hasOwn(_passages,String(name));case"undefined":break;case"object":type=null===name?"null":"an object";break;default:type="a ".concat(type)}throw new TypeError("Story.has name parameter cannot be ".concat(type))}},domId:{get:function(){return console.warn("[DEPRECATED] Story.domId is deprecated."),getId()}},title:{get:function(){return console.warn("[DEPRECATED] Story.title is deprecated."),getName()}},lookup:{value:function(key,value){var sortKey=arguments.length>2&&arguments[2]!==undefined?arguments[2]:"name";return console.warn("[DEPRECATED] Story.lookup() is deprecated."),filter((function(passage){return"object"===_typeof(passage[key])&&null!==passage[key]?passage[key]instanceof Array&&passage[key].some((function(m){return sameValueZero(m,value)})):sameValueZero(passage[key],value)})).sort((function(a,b){return a[sortKey]==b[sortKey]?0:a[sortKey]<b[sortKey]?-1:1}))}},lookupWith:{value:function(predicate){var sortKey=arguments.length>1&&arguments[1]!==undefined?arguments[1]:"name";if(console.warn("[DEPRECATED] Story.lookupWith() is deprecated."),"function"!=typeof predicate)throw new TypeError("Story.lookupWith() predicate parameter must be a function");return filter(predicate).sort((function(a,b){return a[sortKey]==b[sortKey]?0:a[sortKey]<b[sortKey]?-1:1}))}}}))}(),UI=function(){function assembleLinkList(passage,listEl){var list=listEl,debugState=Config.debug;Config.debug=!1;try{null==list&&(list=document.createElement("ul"));var frag=document.createDocumentFragment();new Wikifier(frag,Story.get(passage).processText().trim(),{cleanup:!1});var errors=Array.from(frag.querySelectorAll(".error")).map((function(errEl){return errEl.textContent.replace(errorPrologRegExp,"")}));if(errors.length>0)throw new Error(errors.join("; "));for(;frag.hasChildNodes();){var node=frag.firstChild;if(node.nodeType===Node.ELEMENT_NODE&&"A"===node.nodeName.toUpperCase()){var li=document.createElement("li");list.appendChild(li),li.appendChild(node)}else frag.removeChild(node)}}finally{Config.debug=debugState}return list}function buildRestart(){return Dialog.create(L10n.get("restartTitle"),"restart").append("<p>".concat(L10n.get("restartMesgPrompt"),'</p><ul class="buttons">')+'<li><button id="restart-ok">'.concat(L10n.get(["restartTextOk","textOk"]),"</button></li>")+'<li><button id="restart-cancel" class="ui-close">'.concat(L10n.get(["restartTextCancel","textCancel"]),"</button></li>")+"</ul>"),jQuery(Dialog.body()).find("#restart-ok").ariaClick({one:!0},(function(){jQuery(document).one(":dialogclosed",(function(){return Engine.restart()})),Dialog.close()})),!0}function buildSaves(){function createFileInput(id,callback){var input=document.createElement("input");return jQuery(input).attr({id:id,type:"file",tabindex:-1,"aria-hidden":!0}).css({display:"block",visibility:"hidden",position:"fixed",left:"-16128px",top:"-16128px",width:"1px",height:"1px"}).on("change",callback),input}function createActionItem(id,classNames,text,label,callback){var $btn=jQuery(document.createElement("button")).attr("id","saves-".concat(id)).text(text);return classNames&&$btn.addClass(classNames),callback?$btn.ariaClick({label:label},callback):$btn.ariaDisabled(!0),jQuery(document.createElement("li")).append($btn)}var browserEnabled=Save.browser.isEnabled();if(!browserEnabled&&!Has.fileAPI)return openAlert(L10n.get("warningNoSaves")),!1;Dialog.create(L10n.get("savesTitle"),"saves");var $dialogBody=jQuery(Dialog.body());if(browserEnabled){jQuery(document.createElement("h2")).text(L10n.get("savesHeaderBrowser")).appendTo($dialogBody),$dialogBody.append(function(){function createButton(id,classNames,kind,index,callback){var text;switch(id){case"delete":text=L10n.get("textDelete");break;case"load":text=L10n.get("textLoad");break;case"save":text=L10n.get("textSave");break;default:throw new Error('buildSaves unknown ID "'.concat(id,'"'))}var $btn=jQuery(document.createElement("button")).attr("id","saves-".concat(id,"-").concat(index)).addClass(id);return classNames&&$btn.addClass(classNames),callback?$btn.ariaClick({label:"".concat(text," ").concat(kind," ").concat(index+1)},(function(){try{callback(index)}catch(ex){openAlert("".concat(ex.message,".</p><p>").concat(L10n.get("textAborting"),"."))}})):$btn.ariaDisabled(!0),$btn}var $tbody=jQuery(document.createElement("tbody"));Save.browser.auto.entries().forEach((function(_ref13){var index=_ref13.index,info=_ref13.info,$tdSlot=jQuery(document.createElement("td")),$tdLoad=jQuery(document.createElement("td")),$tdDesc=jQuery(document.createElement("td")),$tdDele=jQuery(document.createElement("td"));jQuery(document.createElement("div")).text(info.desc).appendTo($tdDesc),jQuery(document.createElement("div")).addClass("details").addClass("datestamp").text("".concat(L10n.get("savesTextBrowserAuto")," ").concat(index+1,"  •  ")).append(info.date?"".concat(new Date(info.date).toLocaleString()):"<em>".concat(L10n.get("savesTextNoDate"),"</em>")).appendTo($tdDesc),$tdLoad.append(createButton("load","ui-close",L10n.get("savesTextBrowserAuto"),index,(function(index){jQuery(document).one(":dialogclosed",(function(){Save.browser.auto.load(index).then(Engine.show,(function(ex){return openAlert("".concat(ex.message.toUpperFirst(),".</p><p>").concat(L10n.get("textAborting"),"."))}))}))}))),$tdDele.append(createButton("delete",null,L10n.get("savesTextBrowserAuto"),index,(function(index){Save.browser.auto.delete(index),buildSaves()}))),jQuery(document.createElement("tr")).append($tdSlot).append($tdLoad).append($tdDesc).append($tdDele).appendTo($tbody)}));var slotAllowed="function"!=typeof Config.saves.isAllowed||Config.saves.isAllowed(Save.Type.Slot);return Save.browser.slot.entries().reduce((function(slots,entry){return slots[entry.index]=entry,slots}),Array.from({length:Config.saves.maxSlotSaves},(function(_,i){return{index:i}}))).forEach((function(_ref14){var index=_ref14.index,info=_ref14.info,$tdSlot=jQuery(document.createElement("td")),$tdLoad=jQuery(document.createElement("td")),$tdDesc=jQuery(document.createElement("td")),$tdDele=jQuery(document.createElement("td"));info?(jQuery(document.createElement("div")).text(info.desc).appendTo($tdDesc),jQuery(document.createElement("div")).addClass("details").addClass("datestamp").text("".concat(L10n.get("savesTextBrowserSlot")," ").concat(index+1,"  •  ")).append(info.date?"".concat(new Date(info.date).toLocaleString()):"<em>".concat(L10n.get("savesTextNoDate"),"</em>")).appendTo($tdDesc),$tdLoad.append(createButton("load","ui-close",L10n.get("savesTextBrowserSlot"),index,(function(index){jQuery(document).one(":dialogclosed",(function(){Save.browser.slot.load(index).then(Engine.show,(function(ex){return openAlert("".concat(ex.message.toUpperFirst(),".</p><p>").concat(L10n.get("textAborting"),"."))}))}))}))),$tdDele.append(createButton("delete",null,L10n.get("savesTextBrowserSlot"),index,(function(index){Save.browser.slot.delete(index),buildSaves()})))):($tdDesc.addClass("empty"),jQuery(document.createElement("div")).text(" ").appendTo($tdDesc),jQuery(document.createElement("div")).addClass("details").addClass("datestamp").text("".concat(L10n.get("savesTextBrowserSlot")," ").concat(index+1)).appendTo($tdDesc),$tdLoad.append(createButton("save",null,L10n.get("savesTextBrowserSlot"),index,index<Config.saves.maxSlotSaves&&slotAllowed?function(index){Save.browser.slot.save(index),buildSaves()}:null)),$tdDele.append(createButton("delete",null,L10n.get("savesTextBrowserSlot"),index))),jQuery(document.createElement("tr")).append($tdSlot).append($tdLoad).append($tdDesc).append($tdDele).appendTo($tbody)})),jQuery(document.createElement("table")).attr("id","saves-list").append($tbody)}());var $slotButtons=jQuery(document.createElement("ul")).addClass("buttons slots").appendTo($dialogBody);if(Has.fileAPI){var slotImportInput=createFileInput("saves-import-handler",(function(ev){Save.disk.import(ev).then(buildSaves,(function(ex){return openAlert("".concat(ex.message.toUpperFirst(),".</p><p>").concat(L10n.get("textAborting"),"."))}))}));$slotButtons.append(createActionItem("export",null,"".concat(L10n.get("textExport"),"…"),L10n.get("savesLabelBrowserExport"),(function(){return Save.disk.export("saves-export-".concat(Story.name))}))).append(createActionItem("import",null,"".concat(L10n.get("textImport"),"…"),L10n.get("savesLabelBrowserImport"),(function(){return slotImportInput.click()}))),jQuery(slotImportInput).appendTo($dialogBody)}$slotButtons.append(createActionItem("clear",null,L10n.get("textClear"),L10n.get("savesLabelBrowserClear"),Save.browser.size>0?function(){Save.browser.clear(),buildSaves()}:null))}if(Has.fileAPI){jQuery(document.createElement("h2")).text(L10n.get("savesHeaderDisk")).appendTo($dialogBody);var $diskButtons=jQuery(document.createElement("ul")).addClass("buttons").appendTo($dialogBody),diskLoadInput=createFileInput("saves-disk-load-handler",(function(ev){jQuery(document).one(":dialogclosed",(function(){Save.disk.load(ev).then(Engine.show,(function(ex){return openAlert("".concat(ex.message.toUpperFirst(),".</p><p>").concat(L10n.get("textAborting"),"."))}))})),Dialog.close()}));$diskButtons.append(createActionItem("disk-save",null,"".concat(L10n.get("textSave"),"…"),L10n.get("savesLabelDiskSave"),"function"!=typeof Config.saves.isAllowed||Config.saves.isAllowed(Save.Type.Disk)?function(){return Save.disk.save(Story.name)}:null)).append(createActionItem("disk-load",null,"".concat(L10n.get("textLoad"),"…"),L10n.get("savesLabelDiskLoad"),(function(){return diskLoadInput.click()}))),jQuery(diskLoadInput).appendTo($dialogBody)}return!0}function buildSettings(){Dialog.create(L10n.get("settingsTitle"),"settings");var $dialogBody=jQuery(Dialog.body());return Setting.forEach((function(control){switch(control.type){case Setting.Types.Header:var _name2=control.name,_id2=createSlug(_name2),$header=jQuery(document.createElement("div")),$heading=jQuery(document.createElement("h2"));return $header.attr("id","header-body-".concat(_id2)).append($heading).appendTo($dialogBody),$heading.attr("id","header-heading-".concat(_id2)).wikiWithOptions({cleanup:!1},_name2),void(control.desc&&jQuery(document.createElement("p")).attr("id","header-desc-".concat(_id2)).wikiWithOptions({cleanup:!1},control.desc).appendTo($header));case Setting.Types.Value:return}var $control,name=control.name,id=createSlug(name),$setting=jQuery(document.createElement("div")),$label=jQuery(document.createElement("label")),$controlBox=jQuery(document.createElement("div"));switch(jQuery(document.createElement("div")).append($label).append($controlBox).appendTo($setting),control.desc&&jQuery(document.createElement("p")).attr("id","setting-desc-".concat(id)).wikiWithOptions({cleanup:!1},control.desc).appendTo($setting),$label.attr({id:"setting-label-".concat(id),for:"setting-control-".concat(id)}).wikiWithOptions({cleanup:!1},control.label),null==Setting.getValue(name)&&Setting.setValue(name,control.default),control.type){case Setting.Types.List:$control=jQuery(document.createElement("select"));for(var i=0,iend=control.list.length;i<iend;++i)jQuery(document.createElement("option")).val(i).text(control.list[i]).appendTo($control);$control.val(control.list.indexOf(Setting.getValue(name))).attr("tabindex",0).on("change",(function(){Setting.setValue(name,control.list[Number(this.value)])}));break;case Setting.Types.Range:($control=jQuery(document.createElement("input"))).attr({type:"range",min:control.min,max:control.max,step:control.step,value:Setting.getValue(name),tabindex:0}).on("change input",(function(){Setting.setValue(name,Number(this.value))})).on("keypress",(function(ev){13===ev.which&&(ev.preventDefault(),triggerEvent("change",$control))}));break;case Setting.Types.Toggle:$control=jQuery(document.createElement("button")),Setting.getValue(name)?$control.addClass("enabled").text(L10n.get("textOn")):$control.text(L10n.get("textOff")),$control.ariaClick((function(){var status=Setting.getValue(name);status?jQuery(this).removeClass("enabled").text(L10n.get("textOff")):jQuery(this).addClass("enabled").text(L10n.get("textOn")),Setting.setValue(name,!status)}))}$control.attr("id","setting-control-".concat(id)).appendTo($controlBox),$setting.attr("id","setting-body-".concat(id)).appendTo($dialogBody)})),$dialogBody.append('<ul class="buttons">'+'<li><button id="settings-ok" class="ui-close">'.concat(L10n.get(["settingsTextOk","textOk"]),"</button></li>")+'<li><button id="settings-reset">'.concat(L10n.get("settingsTextReset"),"</button></li>")+"</ul>").find("#settings-reset").ariaClick({one:!0},(function(){jQuery(document).one(":dialogclosed",(function(){Setting.reset(),window.location.reload()})),Dialog.close()})),!0}function openAlert(message){for(var _Dialog$create$append,_len24=arguments.length,args=new Array(_len24>1?_len24-1:0),_key24=1;_key24<_len24;_key24++)args[_key24-1]=arguments[_key24];(_Dialog$create$append=Dialog.create(L10n.get("alertTitle"),"alert").append("<p>".concat(message,'</p><ul class="buttons">')+'<li><button id="alert-ok" class="ui-close">'.concat(L10n.get(["alertTextOk","textOk"]),"</button></li>")+"</ul>")).open.apply(_Dialog$create$append,args)}function buildJumpto(){console.warn("[DEPRECATED] UI.buildJumpto() is deprecated.");var list=document.createElement("ul");Dialog.create(L10n.get("jumptoTitle"),"jumpto list").append(list);for(var expired=State.expired.length,i=State.size-1;i>=0;--i)if(i!==State.activeIndex){var passage=Story.get(State.history[i].title);passage&&passage.tags.includes("bookmark")&&jQuery(document.createElement("li")).append(jQuery(document.createElement("a")).ariaClick({one:!0},function(index){return function(){return jQuery(document).one(":dialogclosed",(function(){return Engine.goTo(index)}))}}(i)).addClass("ui-close").text("".concat(L10n.get("textTurn")," ").concat(expired+i+1))).appendTo(list)}list.hasChildNodes()||jQuery(list).append("<li><a><em>".concat(L10n.get("jumptoMesgUnavailable"),"</em></a></li>"))}function buildShare(){console.warn("[DEPRECATED] UI.buildShare() is deprecated.");try{Dialog.create(L10n.get("shareTitle"),"share list").append(assembleLinkList("StoryShare"))}catch(ex){return console.error(ex),Alert.error("StoryShare",ex.message),!1}return!0}return Object.preventExtensions(Object.create(null,{assembleLinkList:{value:assembleLinkList},buildRestart:{value:buildRestart},buildSaves:{value:buildSaves},buildSettings:{value:buildSettings},update:{value:function(){triggerEvent(":uiupdate")}},alert:{value:openAlert},restart:{value:function(){buildRestart(),Dialog.open.apply(Dialog,arguments)}},saves:{value:function(){buildSaves(),Dialog.open.apply(Dialog,arguments)}},settings:{value:function(){buildSettings(),Dialog.open.apply(Dialog,arguments)}},buildAutoload:{value:function(){return console.warn("[DEPRECATED] UI.buildAutoload() is deprecated."),Dialog.create(L10n.get("autoloadTitle"),"autoload").append("<p>".concat(L10n.get("autoloadMesgPrompt"),'</p><ul class="buttons">')+'<li><button id="autoload-ok" class="ui-close">'.concat(L10n.get(["autoloadTextOk","textOk"]),"</button></li>")+'<li><button id="autoload-cancel" class="ui-close">'.concat(L10n.get(["autoloadTextCancel","textCancel"]),"</button></li>")+"</ul>"),jQuery(document).one("click.autoload",".ui-close",(function(ev){var isAutoloadOk="autoload-ok"===ev.target.id;jQuery(document).one(":dialogclosed",(function(){new Promise((function(resolve,reject){isAutoloadOk&&resolve(),reject()})).then((function(){return Save.browser.continue()})).catch((function(){Engine.play(Config.passages.start)}))}))})),!0}},buildJumpto:{value:buildJumpto},buildShare:{value:buildShare},jumpto:{value:function(){buildJumpto(),Dialog.open.apply(Dialog,arguments)}},share:{value:function(){buildShare(),Dialog.open.apply(Dialog,arguments)}}}))}(),UIBar=function(){var _$uiBar=null;function stow(noAnimation){var $story;_$uiBar&&!_$uiBar.hasClass("stowed")&&(noAnimation&&(($story=jQuery("#story")).addClass("no-transition"),_$uiBar.addClass("no-transition")),_$uiBar.addClass("stowed"),noAnimation&&setTimeout((function(){$story.removeClass("no-transition"),_$uiBar.removeClass("no-transition")}),Engine.DOM_DELAY));return UIBar}function update(){if(console.warn("[DEPRECATED] UIBar.update() is deprecated."),_$uiBar)return UI.update(),UIBar}return Object.preventExtensions(Object.create(null,{init:{value:function(){if(!document.getElementById("ui-bar")){var toggleLabel,backwardLabel,jumptoLabel,forwardLabel,$backward,$forward,$elems=(toggleLabel=L10n.get("uiBarLabelToggle"),backwardLabel=L10n.get("uiBarLabelBackward"),jumptoLabel=L10n.get("uiBarLabelJumpto"),forwardLabel=L10n.get("uiBarLabelForward"),jQuery(document.createDocumentFragment()).append('<div id="ui-bar" aria-live="polite"><div id="ui-bar-tray">'+'<button id="ui-bar-toggle" tabindex="0" title="'.concat(toggleLabel,'" aria-label="').concat(toggleLabel,'"></button>')+'<div id="ui-bar-history">'+'<button id="history-backward" tabindex="0" title="'.concat(backwardLabel,'" aria-label="').concat(backwardLabel,'"></button>')+'<button id="history-jumpto" tabindex="0" title="'.concat(jumptoLabel,'" aria-label="').concat(jumptoLabel,'"></button>')+'<button id="history-forward" tabindex="0" title="'.concat(forwardLabel,'" aria-label="').concat(forwardLabel,'"></button>')+'</div></div><div id="ui-bar-body"><header id="title" role="banner"><div id="story-banner"></div><h1 id="story-title"></h1><div id="story-subtitle"></div><div id="story-title-separator"></div><p id="story-author"></p></header><div id="story-caption"></div><nav id="menu" role="navigation"><ul id="menu-story"></ul><ul id="menu-core">'+'<li id="menu-item-continue"><a tabindex="0">'.concat(L10n.get("continueTitle"),"</a></li>")+'<li id="menu-item-saves"><a tabindex="0">'.concat(L10n.get("savesTitle"),"</a></li>")+'<li id="menu-item-settings"><a tabindex="0">'.concat(L10n.get("settingsTitle"),"</a></li>")+'<li id="menu-item-restart"><a tabindex="0">'.concat(L10n.get("restartTitle"),"</a></li>")+'<li id="menu-item-share"><a tabindex="0">'.concat(L10n.get("shareTitle"),"</a></li>")+"</ul></nav></div></div>"));_$uiBar=jQuery($elems.find("#ui-bar").get(0)),$elems.insertBefore("body>script#script-sugarcube"),jQuery(document).on(":historyupdate".concat(".ui-bar"),($backward=jQuery("#history-backward"),$forward=jQuery("#history-forward"),function(){$backward.ariaDisabled(State.length<2),$forward.ariaDisabled(State.length===State.size)}))}}},destroy:{value:function(){_$uiBar&&(_$uiBar.hide(),jQuery(document).off(".ui-bar"),jQuery(document.head).find("#style-ui-bar").remove(),_$uiBar.remove(),_$uiBar=null)}},hide:{value:function(){return _$uiBar&&_$uiBar.hide(),UIBar}},isHidden:{value:function(){return _$uiBar&&"none"===_$uiBar.css("display")}},isStowed:{value:function(){return _$uiBar&&_$uiBar.hasClass("stowed")}},show:{value:function(){return _$uiBar&&_$uiBar.show(),UIBar}},start:{value:function(){if(_$uiBar){("boolean"==typeof Config.ui.stowBarInitially?Config.ui.stowBarInitially:jQuery(window).width()<=Config.ui.stowBarInitially)&&stow(!0),jQuery("#ui-bar-toggle").ariaClick({label:L10n.get("uiBarLabelToggle")},(function(){return _$uiBar.toggleClass("stowed")})),Config.history.controls?(jQuery("#history-backward").ariaDisabled(State.length<2).ariaClick({label:L10n.get("uiBarLabelBackward")},(function(){return Engine.backward()})),Story.filter((function(passage){return passage.tags.includes("bookmark")})).length>0?jQuery("#history-jumpto").ariaClick({label:L10n.get("uiBarLabelJumpto")},(function(){return UI.jumpto()})):jQuery("#history-jumpto").remove(),jQuery("#history-forward").ariaDisabled(State.length===State.size).ariaClick({label:L10n.get("uiBarLabelForward")},(function(){return Engine.forward()}))):jQuery("#ui-bar-history").remove();var storyTitleHandler,addUiUpdateHandler=function(handler){return jQuery(document)[Config.ui.updateStoryElements?"on":"one"](":uiupdate".concat(".ui-bar"),handler)},addUpdaterOrRemove=function(selector,passageName){var $el=jQuery(selector);Story.has(passageName)?addUiUpdateHandler((function(){var frag=document.createDocumentFragment();new Wikifier(frag,Story.get(passageName).processText().trim()),$el.empty().append(frag)})):$el.remove()};if(storyTitleHandler=Story.has("StoryDisplayTitle")?function(){return setDisplayTitle(Story.get("StoryDisplayTitle").processText())}:function(){return setDisplayTitle(Story.name,!0)},addUiUpdateHandler(storyTitleHandler),addUpdaterOrRemove("#story-banner","StoryBanner"),addUpdaterOrRemove("#story-subtitle","StorySubtitle"),addUpdaterOrRemove("#story-author","StoryAuthor"),addUpdaterOrRemove("#story-caption","StoryCaption"),Story.has("StoryMenu")){var $menuStory=jQuery("#menu-story");jQuery(document).on(":uiupdate".concat(".ui-bar"),(function(){try{var frag=UI.assembleLinkList("StoryMenu",document.createDocumentFragment());$menuStory.empty().append(frag)}catch(ex){console.error(ex),Alert.error("StoryMenu",ex.message)}}))}else jQuery("#menu-story").remove();Save.browser.size>0?(jQuery("#menu-item-continue a").ariaClick({role:"button"},(function(ev){ev.preventDefault(),Save.browser.continue().then((function(){jQuery(document).off(".menu-item-continue"),jQuery("#menu-item-continue").remove(),Engine.show()}),(function(ex){return UI.alert("".concat(ex.message.toUpperFirst(),".</p><p>").concat(L10n.get("textAborting"),"."))}))})).text(L10n.get("continueTitle")),jQuery(document).on(":passagestart.menu-item-continue",(function(){State.turns>1&&(jQuery(document).off(".menu-item-continue"),jQuery("#menu-item-continue").remove())}))):jQuery("#menu-item-continue").remove(),jQuery("#menu-item-saves a").ariaClick({role:"button"},(function(ev){ev.preventDefault(),UI.buildSaves(),Dialog.open()})).text(L10n.get("savesTitle")),Setting.isEmpty()?jQuery("#menu-item-settings").remove():jQuery("#menu-item-settings a").ariaClick({role:"button"},(function(ev){ev.preventDefault(),UI.buildSettings(),Dialog.open()})).text(L10n.get("settingsTitle")),jQuery("#menu-item-restart a").ariaClick({role:"button"},(function(ev){ev.preventDefault(),UI.buildRestart(),Dialog.open()})).text(L10n.get("restartTitle")),Story.has("StoryShare")?jQuery("#menu-item-share a").ariaClick({role:"button"},(function(ev){ev.preventDefault(),UI.buildShare(),Dialog.open()})).text(L10n.get("shareTitle")):jQuery("#menu-item-share").remove()}}},stow:{value:stow},unstow:{value:function(noAnimation){var $story;return _$uiBar&&_$uiBar.hasClass("stowed")&&(noAnimation&&(($story=jQuery("#story")).addClass("no-transition"),_$uiBar.addClass("no-transition")),_$uiBar.removeClass("stowed"),noAnimation&&setTimeout((function(){$story.removeClass("no-transition"),_$uiBar.removeClass("no-transition")}),Engine.DOM_DELAY)),UIBar}},setStoryElements:{value:update},update:{value:update}}))}(),DebugBar=function(){var STORAGE_KEY="debug.state",WATCH_LIST_DELAY=200,VAR_LIST_DELAY=500,variableRE=new RegExp("^".concat(Patterns.variable,"$")),numericKeyRE=/^\d+$/,watchList=[],varList=[],watchTimerId=null,listTimerId=null,stowed=!0,$debugBar=null,$watchBody=null,$varDataList=null,$turnSelect=null,$passageDataList=null;function debugBarStow(){disableWatchUpdates(),disableVarListUpdates(),$debugBar.css("right","-".concat($debugBar.outerWidth(),"px")),stowed=!0,updateSession()}function debugBarUnstow(){debugBarWatchIsEnabled()&&enableWatchUpdates(),enableVarListUpdates(),$debugBar.css("right",0),stowed=!1,updateSession()}function debugBarToggle(){stowed?debugBarUnstow():debugBarStow()}function debugBarWatchAdd(varName){variableRE.test(varName)&&(watchList.pushUnique(varName),watchList.sort(),updateWatchBody(),updateVarList(),updateSession())}function debugBarWatchAddAll(){Object.keys(State.variables).map((function(name){return watchList.pushUnique("$".concat(name))})),Object.keys(State.temporary).map((function(name){return watchList.pushUnique("_".concat(name))})),watchList.sort(),updateWatchBody(),updateVarList(),updateSession()}function debugBarWatchClear(){watchList.length=0,$watchBody.empty().append("<div>— ".concat(L10n.get("debugBarMesgNoWatches")," —</div>")),updateWatchBody(),updateVarList(),updateSession()}function debugBarWatchDelete(varName){watchList.deleteFirst(varName),$watchBody.find('tr[data-name="'.concat(varName,'"]')).remove(),updateWatchBody(),updateVarList(),updateSession()}function debugBarWatchDisable(){disableWatchUpdates(),disableWatch(),updateSession()}function debugBarWatchEnable(){enableWatchUpdates(),enableWatch(),updateSession()}function debugBarWatchIsEnabled(){return!$watchBody.attr("hidden")}function debugBarWatchToggle(){$watchBody.attr("hidden")?debugBarWatchEnable():debugBarWatchDisable()}function disableWatch(){$watchBody.attr({"aria-hidden":!0,hidden:"hidden"})}function disableWatchUpdates(){null!==watchTimerId&&(clearInterval(watchTimerId),watchTimerId=null)}function enableWatch(){$watchBody.removeAttr("aria-hidden hidden")}function enableWatchUpdates(){null===watchTimerId&&(watchTimerId=setInterval((function(){return updateWatchBody()}),WATCH_LIST_DELAY))}function disableVarListUpdates(){null!==listTimerId&&(clearInterval(listTimerId),listTimerId=null)}function enableVarListUpdates(){null===listTimerId&&(listTimerId=setInterval((function(){return updateVarList()}),VAR_LIST_DELAY))}function clearSession(){session.delete(STORAGE_KEY)}function updateSession(){session.set(STORAGE_KEY,{stowed:stowed,watchList:watchList,watchEnabled:debugBarWatchIsEnabled(),viewsEnabled:DebugView.isEnabled()})}function updateWatchBody(){if(0!==watchList.length){var $tbody,$rowMap=new Map,$table=jQuery($watchBody.children("table"));$table.length>0?($tbody=jQuery($table.children("tbody"))).children("tr").each((function(_,el){return $rowMap.set(el.getAttribute("data-name"),jQuery(el))})):($table=jQuery(document.createElement("table")),$tbody=jQuery(document.createElement("tbody")),$table.append($tbody),$watchBody.empty().append($table));var delLabel=L10n.get("debugBarLabelWatchDelete"),cursor=$rowMap.size>0?$tbody.children("tr").get(0):null;watchList.forEach((function(varName){var varKey=varName.slice(1),value=toWatchString(("$"===varName[0]?State.variables:State.temporary)[varKey]),$row=$rowMap.get(varName);if($row){var $code=$row.children().children("code");value!==$code.text()&&$code.text(value)}else $row=function(varName,value){var $row=jQuery(document.createElement("tr")),$delBtn=jQuery(document.createElement("button")),$code=jQuery(document.createElement("code"));return $row.attr("data-name",varName),$delBtn.addClass("watch-delete").ariaClick({one:!0,label:delLabel},(function(){return debugBarWatchDelete(varName)})),$code.text(value),jQuery(document.createElement("td")).append($delBtn).appendTo($row),jQuery(document.createElement("td")).text(varName).appendTo($row),jQuery(document.createElement("td")).append($code).appendTo($row),$row}(varName,value),cursor?$row.insertAfter(cursor):$row.appendTo($tbody);cursor=$row.get(0)}))}}function updateVarList(){var names=[].concat(Object.keys(State.variables).map((function(name){return"$".concat(name)})),Object.keys(State.temporary).map((function(name){return"_".concat(name)})));if(0===names.length)return varList.length=0,void $varDataList.empty();if(names.sort().deleteAll(watchList),names.length!==varList.length||!names.every((function(m,i){return m===varList[i]}))){varList=names;var options=document.createDocumentFragment();varList.forEach((function(name){jQuery(document.createElement("option")).val(name).appendTo(options)})),$varDataList.empty().append(options)}}function updateTurnSelect(){for(var histLen=State.size,expLen=State.expired.length,options=document.createDocumentFragment(),i=0;i<histLen;++i)jQuery(document.createElement("option")).val(i).text("".concat(expLen+i+1,". ").concat(State.history[i].title)).appendTo(options);$turnSelect.empty().ariaDisabled(histLen<2).append(options).val(State.activeIndex)}function updatePassageList(){var passages=Object.keys(Story.getNormals()).sort(),options=document.createDocumentFragment();passages.forEach((function(name){jQuery(document.createElement("option")).val(name).appendTo(options)})),$passageDataList.empty().append(options)}function toWatchString(O){if(null===O)return"null";switch(_typeof(O)){case"bigint":case"boolean":case"number":case"symbol":case"undefined":return String(O);case"string":return JSON.stringify(O);case"function":return"Function"}var objType=getToStringTag(O);if("Date"===objType)return"Date {".concat(O.toLocaleString(),"}");if("RegExp"===objType)return"RegExp ".concat(O.toString());var result=[];if(O instanceof Array||O instanceof Set){for(var list=O instanceof Array?O:Array.from(O),i=0,len=list.length;i<len;++i)result.push(Object.hasOwn(list,i)?toWatchString(list[i]):"<empty>");return Object.keys(list).filter((function(key){return!numericKeyRE.test(key)})).forEach((function(key){return result.push("".concat(toWatchString(key),": ").concat(toWatchString(list[key])))})),"".concat(objType,"(").concat(list.length,") [").concat(result.join(", "),"]")}return O instanceof Map?(O.forEach((function(val,key){return result.push("".concat(toWatchString(key)," → ").concat(toWatchString(val)))})),"".concat(objType,"(").concat(O.size,") {").concat(result.join(", "),"}")):(Object.keys(O).forEach((function(key){return result.push("".concat(toWatchString(key),": ").concat(toWatchString(O[key])))})),"".concat(objType," {").concat(result.join(", "),"}"))}return Object.preventExtensions(Object.create(null,{init:{value:function(){if(Config.debug){var barToggleLabel=L10n.get("debugBarLabelToggle"),watchAddLabel=L10n.get("debugBarLabelWatchAdd"),watchAllLabel=L10n.get("debugBarLabelWatchAll"),watchClearLabel=L10n.get("debugBarLabelWatchClear"),watchToggleLabel=L10n.get("debugBarLabelWatchToggle"),viewsToggleLabel=L10n.get("debugBarLabelViewsToggle"),passagePlayLabel=L10n.get("debugBarLabelPassagePlay");jQuery(document.createDocumentFragment()).append('<div id="debug-bar"><div id="debug-bar-watch">'+"<div>— ".concat(L10n.get("debugBarMesgNoWatches")," —</div>")+"</div><div>"+'<label id="debug-bar-watch-label" for="debug-bar-watch-input">'.concat(L10n.get("debugBarTextWatch"),"</label>")+'<input id="debug-bar-watch-input" name="debug-bar-watch-input" type="text" placeholder="'.concat(L10n.get("debugBarLabelWatchPlaceholder"),'" list="debug-bar-var-list" tabindex="0">')+'<datalist id="debug-bar-var-list" aria-hidden="true" hidden="hidden"></datalist>'+'<button id="debug-bar-watch-add" tabindex="0" title="'.concat(watchAddLabel,'" aria-label="').concat(watchAddLabel,'"></button>')+'<button id="debug-bar-watch-all" tabindex="0" title="'.concat(watchAllLabel,'" aria-label="').concat(watchAllLabel,'"></button>')+'<button id="debug-bar-watch-clear" tabindex="0" title="'.concat(watchClearLabel,'" aria-label="').concat(watchClearLabel,'"></button>')+"</div><div>"+'<label id="debug-bar-turn-label" for="debug-bar-turn-select">'.concat(L10n.get("textTurn"),"</label>")+'<select id="debug-bar-turn-select" tabindex="0"></select></div><div>'+'<label id="debug-bar-passage-label" for="debug-bar-passage-input">'.concat(L10n.get("debugBarTextPassage"),"</label>")+'<input id="debug-bar-passage-input" name="debug-bar-passage-input" type="text" placeholder="'.concat(L10n.get("debugBarLabelPassagePlaceholder"),'" list="debug-bar-passage-list" tabindex="0">')+'<datalist id="debug-bar-passage-list" aria-hidden="true" hidden="hidden"></datalist>'+'<button id="debug-bar-passage-play" tabindex="0" title="'.concat(passagePlayLabel,'" aria-label="').concat(passagePlayLabel,'"></button>')+"</div><div>"+'<button id="debug-bar-views-toggle" tabindex="0" title="'.concat(viewsToggleLabel,'" aria-label="').concat(viewsToggleLabel,'">').concat(L10n.get("debugBarTextViews"),"</button>")+'<button id="debug-bar-watch-toggle" tabindex="0" title="'.concat(watchToggleLabel,'" aria-label="').concat(watchToggleLabel,'">').concat(L10n.get("debugBarTextWatch"),"</button>")+"</div>"+'<button id="debug-bar-toggle" tabindex="0" title="'.concat(barToggleLabel,'" aria-label="').concat(barToggleLabel,'"></button>')+'</div><div id="debug-bar-hint"></div>').appendTo("body"),$debugBar=jQuery("#debug-bar"),$watchBody=jQuery($debugBar.find("#debug-bar-watch").get(0)),$varDataList=jQuery($debugBar.find("#debug-bar-var-list").get(0)),$turnSelect=jQuery($debugBar.find("#debug-bar-turn-select").get(0)),$passageDataList=jQuery($debugBar.find("#debug-bar-passage-list").get(0));var $watchInput=jQuery($debugBar.find("#debug-bar-watch-input").get(0)),$watchAdd=jQuery($debugBar.find("#debug-bar-watch-add").get(0)),$watchAll=jQuery($debugBar.find("#debug-bar-watch-all").get(0)),$watchClear=jQuery($debugBar.find("#debug-bar-watch-clear").get(0)),$passageInput=jQuery($debugBar.find("#debug-bar-passage-input").get(0)),$passagePlay=jQuery($debugBar.find("#debug-bar-passage-play").get(0)),$viewsToggle=jQuery($debugBar.find("#debug-bar-views-toggle").get(0)),$watchToggle=jQuery($debugBar.find("#debug-bar-watch-toggle").get(0)),$barToggle=jQuery($debugBar.find("#debug-bar-toggle").get(0));$watchInput.on("sc:debug-watch-add",(function(){debugBarWatchAdd(this.value.trim()),this.value=""})).on("keypress",(function(ev){13===ev.which&&(ev.preventDefault(),triggerEvent("sc:debug-watch-add",$watchInput))})),$watchAdd.ariaClick((function(){return triggerEvent("sc:debug-watch-add",$watchInput)})),$watchAll.ariaClick(debugBarWatchAddAll),$watchClear.ariaClick(debugBarWatchClear),$turnSelect.on("change",(function(){Engine.goTo(Number(this.value))})),$passageInput.on("sc:debug-passage-play",(function(){Engine.play(this.value.trim()),this.value=""})).on("keypress",(function(ev){13===ev.which&&(ev.preventDefault(),triggerEvent("sc:debug-passage-play",$passageInput))})).on("focus",updatePassageList),$passagePlay.ariaClick((function(){return triggerEvent("sc:debug-passage-play",$passageInput)})),$viewsToggle.ariaClick((function(){DebugView.toggle(),updateSession()})),$watchToggle.ariaClick(debugBarWatchToggle),$barToggle.ariaClick(debugBarToggle),jQuery(document).on(":passageend.debug-bar",(function(){updateWatchBody(),updateVarList()})).on(":historyupdate.debug-bar",updateTurnSelect).on(":enginerestart.debug-bar",clearSession)}else jQuery(document.head).find('[id|="style-ui-debug"]').remove()}},isStowed:{value:function(){return stowed}},start:{value:function(){Config.debug&&(function(){if(!session.has(STORAGE_KEY))return!1;var debugState=session.get(STORAGE_KEY);watchList.push.apply(watchList,_toConsumableArray(debugState.watchList)),debugState.watchEnabled?(stowed?disableWatchUpdates():enableWatchUpdates(),enableWatch()):(disableWatchUpdates(),disableWatch());debugState.viewsEnabled?DebugView.enable():DebugView.disable();(stowed=debugState.stowed)?(disableVarListUpdates(),debugBarStow()):(enableVarListUpdates(),debugBarUnstow());return!0}()||(debugBarStow(),DebugView.enable(),enableWatchUpdates(),enableWatch()),updateVarList(),updateTurnSelect())}},stow:{value:debugBarStow},toggle:{value:debugBarToggle},unstow:{value:debugBarUnstow},watch:{value:Object.preventExtensions(Object.create(null,{add:{value:debugBarWatchAdd},all:{value:debugBarWatchAddAll},clear:{value:debugBarWatchClear},delete:{value:debugBarWatchDelete},disable:{value:debugBarWatchDisable},enable:{value:debugBarWatchEnable},isEnabled:{value:debugBarWatchIsEnabled},toggle:{value:debugBarWatchToggle}}))}}))}(),LoadScreen=function(){var _locks=new Set,_autoId=0;function loadScreenHide(){jQuery(document.documentElement).removeAttr("data-init")}function loadScreenShow(){jQuery(document.documentElement).attr("data-init","loading")}return Object.preventExtensions(Object.create(null,{init:{value:function(){jQuery(document).on("readystatechange.SugarCube",(function(){_locks.size>0||("complete"===document.readyState?"loading"===jQuery(document.documentElement).attr("data-init")&&(Config.loadDelay>0?setTimeout((function(){0===_locks.size&&loadScreenHide()}),Math.max(Engine.DOM_DELAY,Config.loadDelay)):loadScreenHide()):loadScreenShow())}))}},clear:{value:function(){jQuery(document).off("readystatechange.SugarCube"),_locks.clear(),loadScreenHide()}},hide:{value:loadScreenHide},show:{value:loadScreenShow},lock:{value:function(){return++_autoId,_locks.add(_autoId),loadScreenShow(),_autoId}},unlock:{value:function(id){if(null==id)throw new Error("LoadScreen.unlock called with a null or undefined ID");_locks.has(id)&&_locks.delete(id),0===_locks.size&&triggerEvent("readystatechange")}},size:{get:function(){return _locks.size}}}))}(),Util=Object.preventExtensions(Object.create(null,{charAndPosAt:{value:function(){return console.warn("[DEPRECATED] Util.charAndPosAt() is deprecated."),charAndPosAt.apply(void 0,arguments)}},escape:{value:function(){return console.warn("[DEPRECATED] Util.escape() is deprecated."),encodeEntities.apply(void 0,arguments)}},escapeMarkup:{value:function(){return console.warn("[DEPRECATED] Util.escapeMarkup() is deprecated."),encodeMarkup.apply(void 0,arguments)}},fromCssProperty:{value:function(){return console.warn("[DEPRECATED] Util.fromCssProperty() is deprecated."),cssPropToDOMProp.apply(void 0,arguments)}},fromCssTime:{value:function(){return console.warn("[DEPRECATED] Util.fromCssTime() is deprecated."),cssTimeToMS.apply(void 0,arguments)}},getType:{value:function(){return console.warn("[DEPRECATED] Util.getType() is deprecated."),getTypeOf.apply(void 0,arguments)}},hasMediaQuery:{value:function(){return console.warn("[DEPRECATED] Util.hasMediaQuery() is deprecated."),hasMediaQuery.apply(void 0,arguments)}},newExceptionFrom:{value:function(){return console.warn("[DEPRECATED] Util.newExceptionFrom() is deprecated."),exceptionFrom.apply(void 0,arguments)}},now:{value:function(){return console.warn("[DEPRECATED] Util.now() is deprecated."),now.apply(void 0,arguments)}},parseUrl:{value:function(){return console.warn("[DEPRECATED] Util.parseUrl() is deprecated."),parseURL.apply(void 0,arguments)}},sameValueZero:{value:function(){return console.warn("[DEPRECATED] Util.sameValueZero() is deprecated."),sameValueZero.apply(void 0,arguments)}},sanitizeFilename:{value:function(){return console.warn("[DEPRECATED] Util.sanitizeFilename() is deprecated."),createFilename.apply(void 0,arguments)}},scrubEventKey:{value:function(){return console.warn("[DEPRECATED] Util.scrubEventKey() is deprecated."),scrubEventKey.apply(void 0,arguments)}},slugify:{value:function(){return console.warn("[DEPRECATED] Util.slugify() is deprecated."),createSlug.apply(void 0,arguments)}},toCssTime:{value:function(){return console.warn("[DEPRECATED] Util.toCssTime() is deprecated."),msToCSSTime.apply(void 0,arguments)}},toEnum:{value:function(){return console.warn("[DEPRECATED] Util.toEnum() is deprecated."),enumFrom.apply(void 0,arguments)}},toStringTag:{value:function(){return console.warn("[DEPRECATED] Util.toStringTag() is deprecated."),getToStringTag.apply(void 0,arguments)}},unescape:{value:function(){return console.warn("[DEPRECATED] Util.unescape() is deprecated."),decodeEntities.apply(void 0,arguments)}}})),version=(semVerRE=/^[Vv]?(\d+)(?:\.(\d+)(?:\.(\d+)(?:-[0-9A-Za-z.-]+)?(?:\+[0-9A-Za-z.-]+)?)?)?$/,Object.preventExtensions(Object.create(null,{name:{value:"SugarCube"},major:{value:2},minor:{value:37},patch:{value:0},prerelease:{value:""},build:{value:10283},date:{value:new Date("2024-07-17T10:18:41.083Z")},isOk:{value:function(semver){if("string"!=typeof semver)throw new Error("version.isOk semver parameter must be a string (received: ".concat(_typeof(semver),")"));var trimmed=semver.trim();if(""===trimmed)throw new Error("version.isOk semver parameter must not be empty");var match=semVerRE.exec(trimmed);if(!match)throw new Error("version.isOk semver parameter is invalid (format: [v]MAJOR[.MINOR[.PATCH[-PRERELEASE][+BUILD]]]; received: ".concat(trimmed));var major=Number(match[1]),minor=Number(match[2])||0,patch=Number(match[3])||0;return major===this.major&&(minor<this.minor||minor===this.minor&&patch<=this.patch)}},long:{value:function(){return"".concat(this.name," v").concat(this.toString()," (").concat(this.date.toUTCString(),")")}},short:{value:function(){var prerelease=this.prerelease?"-".concat(this.prerelease):"";return"".concat(this.name," (v").concat(this.major,".").concat(this.minor,".").concat(this.patch).concat(prerelease,")")}},toString:{value:function(){var prerelease=this.prerelease?"-".concat(this.prerelease):"";return"".concat(this.major,".").concat(this.minor,".").concat(this.patch).concat(prerelease,"+").concat(this.build)}},title:{value:"SugarCube"}}))),semVerRE,TempState={},session=null,settings=Setting.create(),setup={},storage=null,macros={},postdisplay={},postrender={},predisplay={},prehistory={},prerender={};Object.defineProperty(window,"SugarCube",{value:Object.seal(Object.assign(Object.create(null),{Browser:Browser,Config:Config,Dialog:Dialog,Engine:Engine,Fullscreen:Fullscreen,Has:Has,L10n:L10n,Macro:Macro,Passage:Passage,Save:Save,Scripting:Scripting,Setting:Setting,SimpleAudio:SimpleAudio,State:State,Story:Story,UI:UI,UIBar:UIBar,DebugBar:DebugBar,Util:Util,Visibility:Visibility,Wikifier:Wikifier,session:session,settings:settings,setup:setup,storage:storage,version:version}))}),jQuery((function(){var lockId=LoadScreen.lock();LoadScreen.init(),document.normalize&&document.normalize(),new Promise((function(resolve){Story.init();try{SugarCube.storage=storage=SimpleStore.create(Story.id,!0),SugarCube.session=session=SimpleStore.create(Story.id,!1)}catch(ex){throw new Error(L10n.get("warningNoStorage"))}Dialog.init(),UIBar.init(),Engine.init(),Outliner.init(),Engine.runUserScripts(),L10n.init(),session.has("rcWarn")||"cookie"!==storage.name||(session.set("rcWarn",1),window.alert(L10n.get("warningNoWebStorage"))),Save.init(),Setting.init(),Macro.init(),DebugBar.init();var $window=jQuery(window),vpReadyId=setInterval((function(){$window.width()&&LoadScreen.size<=1&&(clearInterval(vpReadyId),resolve())}),Engine.DOM_DELAY)})).then((function(){Engine.runUserInit(),UIBar.start(),Engine.start(),DebugBar.start(),triggerEvent(":storyready"),setTimeout((function(){return LoadScreen.unlock(lockId)}),2*Engine.DOM_DELAY)})).catch((function(ex){return console.error(ex),LoadScreen.clear(),Alert.fatal(null,ex.message,ex)}))}))})(window,window.document,jQuery);}
	</script>
</body>
</html>
